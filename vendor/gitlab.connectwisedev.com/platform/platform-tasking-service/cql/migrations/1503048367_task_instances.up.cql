//
// ATTENTION!!! DO NOT EDIT THIS FILE. IT IS CREATED FOLLOWING SCHEMA MIGRATION STRATEGY
//

CREATE TABLE IF NOT EXISTS task_instances (
    id                  uuid,
    task_id             uuid,
    created_at          timestamp,
    targets             set<text>,
    origin_id           uuid,
    started_at          timestamp,
    status              int,
    PRIMARY KEY         (task_id, started_at, id))
WITH CLUSTERING ORDER BY (started_at DESC, id DESC);

CREATE MATERIALIZED VIEW IF NOT EXISTS task_instances_by_id AS
    SELECT id, task_id, origin_id, targets, started_at, created_at, status
    FROM task_instances
    WHERE id IS NOT NULL AND task_id IS NOT NULL AND started_at IS NOT NULL
    PRIMARY KEY (id, task_id, started_at);
