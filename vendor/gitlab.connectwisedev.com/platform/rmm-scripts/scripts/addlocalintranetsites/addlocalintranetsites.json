{"id":"b7e051d8-5ad4-11e9-b59a-00155d130b17","partnerId":"00000000-0000-0000-0000-000000000000","category":["Security"],"description":"Add Local Intranet Sites","engine":"powershell","engineMaxVersion":5,"expectedExecutionTimeSec":300,"failureMessage":"Executed with errors","successMessage":"Executed Successfully","internal":false,"name":"Add local intranet sites","tags":["Windows 7","Windows 10"],"sequence":true,"content":"PCMKICAgIC5TWU5PUFNJUwogICAgICAgIEFkZCBMb2NhbCBJbnRyYW5ldCBTaXRlcwogICAgLkRFU0NSSVBUSU9OCiAgICAgICAgQWRkIExvY2FsIEludHJhbmV0IFNpdGVzLiBab25lcyBkZWZpbmVkIGFzIDEgKExvY2FsIEludHJhbmV0KSwgMiAoVHJ1c3RlZCBTaXRlcyksIDMgKEludGVybmV0KSwgYW5kIDQgKFJlc3RyaWN0ZWQgU2l0ZXMpCiAgICAuSGVscAogICAgICAgIEhLTE06XFNvZnR3YXJlXFBvbGljaWVzXE1pY3Jvc29mdFxXaW5kb3dzXEN1cnJlbnRWZXJzaW9uXEludGVybmV0IFNldHRpbmdzXFpvbmVNYXBcRG9tYWlucwogICAgLkF1dGhvcgogICAgICAgIER1cmdlc2hrdW1hciBQYXRlbAogICAgLlZlcnNpb24KICAgICAgICAxLjAKIz4KIyMjRGVmaW5lICR1cmxzIGFzIHZhcmlhYmxlIGluIEpTT04gU0NIRU1BLiBJdCBjYW4gYWNjZXB0IG5ldyBsaW5lIGlucHV0CiMkdXJscyA9ICJodHRwczovL2NvbnRpbnV1bS5hdGxhc3NpYW4ubmV0CiMgICAgICAgICBodHRwOi8vYWJjZGVmZ2guY29tIiAgICAgCiMgJHVybHMgLS0+IERhdGEgVHlwZSA6LSBTdHJpbmcgLS0+IE11bHRpbGluZSBUZXh0Ym94ICAtLT4gTWFuZGF0b3J5IC0tPiBUaXRsZSA6LSAiVVJMOiIKCgppZiAoJGVudjpQUk9DRVNTT1JfQVJDSElURVc2NDMyIC1lcSAiQU1ENjQiKSB7CiAgICBpZiAoJG15SW52b2NhdGlvbi5MaW5lKSB7CiAgICAgICAgJiIkZW52OnN5c3RlbXJvb3Rcc3lzbmF0aXZlXHdpbmRvd3Nwb3dlcnNoZWxsXHYxLjBccG93ZXJzaGVsbC5leGUiIC1Ob25JbnRlcmFjdGl2ZSAtTm9Qcm9maWxlICRteUludm9jYXRpb24uTGluZQogICAgfQogICAgZWxzZSB7CiAgICAgICAgJiIkZW52OnN5c3RlbXJvb3Rcc3lzbmF0aXZlXHdpbmRvd3Nwb3dlcnNoZWxsXHYxLjBccG93ZXJzaGVsbC5leGUiIC1Ob25JbnRlcmFjdGl2ZSAtTm9Qcm9maWxlIC1maWxlICIkKCRteUludm9jYXRpb24uSW52b2NhdGlvbk5hbWUpIiAkYXJncwogICAgfQogICAgZXhpdCAkbGFzdGV4aXRjb2RlCn0gCgokdXJsc0FyciA9IEAoKQokdXJsc0FyciA9ICR1cmxzIC1zcGxpdCBbU3lzdGVtLkVudmlyb25tZW50XTo6TmV3TGluZQokem9uZSA9IDEgIyBPcHRpb25zIGFyZSAxIChMb2NhbCBJbnRyYW5ldCksIDIgKFRydXN0ZWQgU2l0ZXMpLCAzIChJbnRlcm5ldCksIGFuZCA0IChSZXN0cmljdGVkIFNpdGVzKQokcmVna2V5ID0gIkhLTE06XFNvZnR3YXJlXFBvbGljaWVzXE1pY3Jvc29mdFxXaW5kb3dzXEN1cnJlbnRWZXJzaW9uXEludGVybmV0IFNldHRpbmdzXFpvbmVNYXBcRG9tYWlucyIKZnVuY3Rpb24gaXNTZXR0aW5nRXhpc3RzIHsKICAgIFBhcmFtKCRyZWdpc3RyeVBhdGgsICRuYW1lKQogICAgaWYgKFRlc3QtUGF0aCAkcmVnaXN0cnlQYXRoIC1QYXRoVHlwZSBjb250YWluZXIpIHsKICAgICAgICAka2V5ID0gR2V0LUl0ZW0gLUxpdGVyYWxQYXRoICRyZWdpc3RyeVBhdGgKICAgICAgICBpZiAoJGtleS5HZXRWYWx1ZSgkbmFtZSwgJG51bGwpIC1uZSAkbnVsbCkgewogICAgICAgICAgICByZXR1cm4gJHRydWUKICAgICAgICB9CiAgICB9CiAgICByZXR1cm4gJGZhbHNlCn0KRm9yICgkaSA9IDA7ICRpIC1sdCAkdXJsc0Fyci5MZW5ndGg7ICRpKyspIHsKICAgICR1cmkgPSBbc3lzdGVtLlVSSV0kdXJsc0FyclskaV0KICAgICRzY2hlbWUgPSAoJHVyaSkuU2NoZW1lCiAgICAkZG9tYWlubmFtZSA9ICgkdXJpKS5ob3N0IC1yZXBsYWNlICded3d3XC4nCiAgICAkZG9tYWluUmVnUGF0aCA9ICIkcmVna2V5XCRkb21haW5uYW1lIgogICAgaWYgKCgkdXJpKS5Jc0Fic29sdXRlVXJpIC1lcSAkdHJ1ZSkgewogICAgICAgIGlmIChUZXN0LVBhdGggJGRvbWFpblJlZ1BhdGggLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWUpIHsKICAgICAgICAgICAgaWYgKC1ub3QgKGlzU2V0dGluZ0V4aXN0cyAtcmVnaXN0cnlQYXRoICRkb21haW5SZWdQYXRoIC1uYW1lICRzY2hlbWUpKSB7CiAgICAgICAgICAgICAgICBOZXctSXRlbVByb3BlcnR5IC1QYXRoICRkb21haW5SZWdQYXRoIC1OYW1lICRzY2hlbWUgLVZhbHVlICR6b25lIC1Qcm9wZXJ0eVR5cGUgIkRXb3JkIiA+JG51bGwKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgIFNldC1JdGVtUHJvcGVydHkgLVBhdGggJGRvbWFpblJlZ1BhdGggLU5hbWUgJHNjaGVtZSAtVmFsdWUgJHpvbmUgPiRudWxsCiAgICAgICAgICAgIH0KICAgICAgICAgICAgV3JpdGUtT3V0cHV0ICJgblVSTCAnJGRvbWFpbm5hbWUnIGluIHRoZSBsaXN0IG9mIGludHJhbmV0IHNpdGVzIHVwZGF0ZWQuIgogICAgICAgIH0KICAgICAgICBlbHNlIHsKICAgICAgICAgICAgTmV3LUl0ZW0gLVBhdGggJGRvbWFpblJlZ1BhdGggLUZvcmNlID4kbnVsbAogICAgICAgICAgICBOZXctSXRlbVByb3BlcnR5IC1QYXRoICRkb21haW5SZWdQYXRoIC1OYW1lICRzY2hlbWUgLVZhbHVlICR6b25lIC1Qcm9wZXJ0eVR5cGUgIkRXb3JkIiA+JG51bGwKICAgICAgICAgICAgV3JpdGUtT3V0cHV0ICJgblVSTCAnJGRvbWFpbm5hbWUnIGFkZGVkIHRvIHRoZSBsaXN0IG9mIGludHJhbmV0IHNpdGVzLiIKICAgICAgICB9CiAgICB9CiAgICBlbHNlIHsKICAgICAgICBXcml0ZS1PdXRwdXQgImBuVVJMICckdXJpJyBub3QgYWRkZWQgdG8gaW50cmFuZXQgc2l0ZXMgYXMgaXQgaXMgbm90IGEgYWJzb2x1dGUgVVJMLiAiCiAgICB9Cn0K","jsonSchema":{"type": "object","properties": {"urls": {"type": "string","title": "URLs"}},"required": ["urls"],"additionalProperties": false},"uiSchema":{"urls": {"classNames": "col-sm-12","ui:autofocus": true,"ui:help": "Input URLs (including protocols) separated by new line","ui:widget": "textarea","ui:options": {"rows": 15},"validationSchema": {"type": "areValidURLsSeparatedByNewLine","urls": "urls"},"convertToCommaSeparated": true}},"isHDScript":false}
