{"id":"ae8f1c36-9917-4691-8c7a-383fd6ec87d6","partnerId":"00000000-0000-0000-0000-000000000000","category":["Management"],"description":"Create shortcuts for programs and put them onto desired location","engine":"powershell","engineMaxVersion":5,"expectedExecutionTimeSec":300,"failureMessage":"Executed with errors","successMessage":"The Shortcut operation completed successfully","internal":false,"name":"Create shortcut","tags":["Windows 7","Windows 10"],"sequence":true,"content":"VHJ5ewoKJHN0YXJ0RGF0ZSA9IChHZXQtRGF0ZSkgLSAoTmV3LVRpbWVTcGFuIC1EYXkgMikKJFVzZXJMb2dpblR5cGVzID0gMiwzLDcsMTAsMTEgCiRMYXN0TG9nb25Vc2VyID0gR2V0LVdpbkV2ZW50ICAtRmlsdGVySGFzaHRhYmxlIEB7TG9nbmFtZT0nU2VjdXJpdHknO0lEPTQ2MjQ7U3RhcnRUaW1lPSRzdGFydERhdGV9IGAKCXwgV2hlcmUtT2JqZWN0IHstbm90KCgkXy5Qcm9wZXJ0aWVzWzRdLlZhbHVlIC1saWtlICAiUy0xLTUtMTgiKSAtb3IgKCRfLlByb3BlcnRpZXNbNF0uVmFsdWUgLWxpa2UgICJTLTEtNS0xOSIpIAktb3IgKCRfLlByb3BlcnRpZXNbNF0uVmFsdWUgLWxpa2UgICJTLTEtNS0yMCIpYAogICAgIC1vciAoJF8ucHJvcGVydGllc1s4XS52YWx1ZSAtbGlrZSAnMycpIC1vciAoJF8ucHJvcGVydGllc1s4XS52YWx1ZSAtbGlrZSAnNCcpIC1vciAoJF8ucHJvcGVydGllc1s4XS52YWx1ZSAtbGlrZSAnNScpIC1vciAoJF8ucHJvcGVydGllc1s4XS52YWx1ZSAtbGlrZSAnOCcpIGAKICAgICAgLW9yICgkXy5wcm9wZXJ0aWVzWzhdLnZhbHVlIC1saWtlICc5JykgLW9yICgkXy5wcm9wZXJ0aWVzWzhdLnZhbHVlIC1saWtlICcxMScpKX0gIHwgU0VMRUNUIFRpbWVDcmVhdGVkLCBAe049J1VzZXJuYW1lJzsgRT17JF8uUHJvcGVydGllc1s1XS5WYWx1ZX0gfSwgCglAe049J0RvbWFpbi9NYWNoaW5lJzsgRT17JF8uUHJvcGVydGllc1s2XS5WYWx1ZX0gfSxAe049J1NJRCc7IEU9eyRfLlByb3BlcnRpZXNbNF0uVmFsdWV9fSwgQHtOPSdMb2dvblR5cGUnOyBFPXskXy5Qcm9wZXJ0aWVzWzhdLlZhbHVlfX0sIAoJQHtOPSdJUCBBZGRyZXNzJzsgRT17JF8uUHJvcGVydGllc1sxOF0uVmFsdWV9fSB8IFdIRVJFIHskVXNlckxvZ2luVHlwZXMgLWNvbnRhaW5zICRfLkxvZ29uVHlwZX0gIHwgU29ydC1PYmplY3QgVGltZUNyZWF0ZWQgfCBTZWxlY3QgLWxhc3QgMQp9CkNhdGNoewogICAgICAgIFdyaXRlLUVycm9yICJJbmZvcm1hdGlvbiBpcyBub3QgYXZhaWxhYmxlIGF0IHRoZSBtb21lbnQgOiAkKCRfLkV4Y2VwdGlvbi5NZXNzYWdlKSIKICAgICAgICBFeGl0CiAgICAgfQoKaWYgKCEkYWxsdXNlcnMpewogICAgJExvZ09uVXNlciA9ICAkbGFzdGxvZ29udXNlci5Vc2VybmFtZQogICAgSWYgKCEkTG9nT25Vc2VyKXsKICAgICAgICBXcml0ZS1FcnJvciAiVXNlciBzaG91bGQgYmUgbG9nZ2VkIG9uIHRvIGNyZWF0ZSBwcml2YXRlIHNob3J0Y3V0IgogICAgICAgIHJldHVybgogICAgfQp9IGVsc2UgewogICAgaWYgKCJkZXNrdG9wIiwgImZhdm9yaXRlcyIgLW5vdGNvbnRhaW5zICRsb2NhdGlvbil7CiAgICAgICAgV3JpdGUtRXJyb3IgIldyb25nIGxvY2F0aW9uIGZvciBhbGwgdXNlcnMgc2hvcnRjdXQiCiAgICAgICAgcmV0dXJuCiAgICB9Cn0gCgpXcml0ZS1Ib3N0ICRMb2dPblVzZXIKCnN3aXRjaCAoJGxvY2F0aW9uKXsKICAgICJkZXNrdG9wInsKICAgICAgICBpZiAoISRhbGx1c2VycykgewogICAgICAgICAgICAkRGVzdGluYXRpb25QYXRoID0gIiRlbnY6aG9tZWRyaXZlXFVzZXJzXCRsb2dvbnVzZXJcRGVza3RvcFwkbmFtZSIKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgJERlc3RpbmF0aW9uUGF0aCA9ICIkZW52OnB1YmxpY1xEZXNrdG9wXCRuYW1lIgogICAgICAgIH0KICAgIH0KICAgICJmYXZvcml0ZXMiewogICAgICAgICREZXN0aW5hdGlvblBhdGggPSAiJGVudjpob21lZHJpdmVcVXNlcnNcRGVmYXVsdFxGYXZvcml0ZXNcJG5hbWUiCiAgICAgICAgaWYgKCEkYWxsdXNlcnMpIHsKICAgICAgICAgICAgJERlc3RpbmF0aW9uUGF0aCA9ICIkZW52OmhvbWVkcml2ZVxVc2Vyc1wkbG9nb251c2VyXEZhdm9yaXRlc1wkbmFtZSIKICAgICAgICB9CiAgICB9CiAgICAibWVudSJ7ICAKICAgICAgICAkRGVzdGluYXRpb25QYXRoID0gIiRlbnY6aG9tZWRyaXZlXFVzZXJzXCRsb2dvbnVzZXJcQXBwRGF0YVxSb2FtaW5nXE1pY3Jvc29mdFxXaW5kb3dzXFN0YXJ0IE1lbnVcJG5hbWUiCiAgICB9CiAgICAicHJvZ3JhbXMiewogICAgICAgICREZXN0aW5hdGlvblBhdGggPSAiJGVudjpob21lZHJpdmVcVXNlcnNcJGxvZ29udXNlclxBcHBEYXRhXFJvYW1pbmdcTWljcm9zb2Z0XFdpbmRvd3NcU3RhcnQgTWVudVxQcm9ncmFtc1wkbmFtZSIKICAgIH0KICAgICJzdGFydHVwInsKICAgICAgICAkRGVzdGluYXRpb25QYXRoID0gIiRlbnY6aG9tZWRyaXZlXFVzZXJzXCRsb2dvbnVzZXJcQXBwRGF0YVxSb2FtaW5nXE1pY3Jvc29mdFxXaW5kb3dzXFN0YXJ0IE1lbnVcUHJvZ3JhbXNcU3RhcnRVcFwkbmFtZSIKICAgIH0KICAgICJzZW5kdG8iewogICAgICAgICREZXN0aW5hdGlvblBhdGggPSAiJGVudjpob21lZHJpdmVcVXNlcnNcJGxvZ29udXNlclxBcHBEYXRhXFJvYW1pbmdcTWljcm9zb2Z0XFdpbmRvd3NcU2VuZFRvXCRuYW1lIgogICAgfQogICAgInF1aWNrYmFyInsKICAgICAgICAkRGVzdGluYXRpb25QYXRoID0gIiRlbnY6aG9tZWRyaXZlXFVzZXJzXCRsb2dvbnVzZXJcQXBwRGF0YVxSb2FtaW5nXE1pY3Jvc29mdFxJbnRlcm5ldCBFeHBsb3JlclxRdWljayBMYXVuY2hcJG5hbWUiCiAgICB9CiAgICBkZWZhdWx0IHsKICAgICAgICBXcml0ZS1FcnJvciAiVW5zdXBwb3J0ZWQgc2hvcnRjdXQgbG9jYXRpb24iCiAgICAgICAgcmV0dXJuCiAgICB9Cn0KCmlmICgkdHlwZSAtZXEgInNoZWxsIil7CgkkRGVzdGluYXRpb25QYXRoICs9ICIubG5rIgp9IGVsc2UgewoJJERlc3RpbmF0aW9uUGF0aCArPSAiLnVybCIKfQoKc3dpdGNoICgkYWN0aW9uKXsKCSJjcmVhdGUiIHsKCQlpZiAoISRvdmVyd3JpdGUgLWFuZCAoVGVzdC1QYXRoICREZXN0aW5hdGlvblBhdGgpKXsKCQkJV3JpdGUtRXJyb3IgIlNob3J0Y3V0IGV4aXN0cy4gRGVsZXRlIGV4aXN0aW5nIG9yIGNoZWNrIG92ZXJ3cml0ZSBvcHRpb24iCgkJCXJldHVybgoJCX0KCQkkV3NoU2hlbGwgPSBOZXctT2JqZWN0IC1jb21PYmplY3QgV1NjcmlwdC5TaGVsbAoJCSRTaG9ydGN1dCA9ICRXc2hTaGVsbC5DcmVhdGVTaG9ydGN1dCgkRGVzdGluYXRpb25QYXRoKQoJCSRTaG9ydGN1dC5UYXJnZXRQYXRoID0gIiR0YXJnZXQiCgkJaWYgKCRhcmd1bWVudHMgLW5lICRudWxsKXsKCQkJJFNob3J0Y3V0LkFyZ3VtZW50cyA9ICRhcmd1bWVudHMKCQl9CgkJaWYgKCRzdGFydEluRm9sZGVyIC1uZSAkbnVsbCl7CgkJCSRTaG9ydGN1dC5Xb3JraW5nRGlyZWN0b3J5ID0gJHN0YXJ0SW5Gb2xkZXIKCQl9CgkJaWYgKCRjb21tZW50cyAtbmUgJG51bGwpewoJCQkkU2hvcnRjdXQuRGVzY3JpcHRpb24gPSAkY29tbWVudHMKCQl9CgkJJFNob3J0Y3V0LlNhdmUoKQogICAgICAgIGlmICgkPyl7CiAgICAgICAgICAgIFdyaXRlLU91dHB1dCAiU2hvcnRjdXQgd2FzIHN1Y2Nlc3NmdWxseSBjcmVhdGVkIgogICAgICAgIH1FbHNlIHsiVW5hYmxlIHRvIFNhdmUgdGhlIFNob3J0Y3V0In0KCX0KCSJkZWxldGUiIHsKCQlSZW1vdmUtSXRlbSAkRGVzdGluYXRpb25QYXRoIC1Gb3JjZQogICAgICAgIElGICgkPyl7CiAgICAgICAgICAgIFdyaXRlLU91dHB1dCAiU2hvcnRjdXQgd2FzIHN1Y2Nlc3NmdWxseSBkZWxldGVkIgogICAgICAgIH0KCX0KCWRlZmF1bHQgewoJCVdyaXRlLUVycm9yICJVbnN1cHBvcnRlZCBhY3Rpb24gJGFjdGlvbiwgc2hvdWxkIGJlIG9uZSBvZiBjcmVhdGUsIGRlbGV0ZSIKCX0KfQo=","jsonSchema":{"additionalProperties":false,"dependencies":{"action":{"oneOf":[{"dependencies":{"type":{"oneOf":[{"properties":{"arguments":{"default":"","title":"Arguments","type":"string"},"comments":{"defalut":"","title":"Comments","type":"string"},"startInFolder":{"default":"","title":"Start in folder","type":"string"},"type":{"enum":["shell"]}}},{"properties":{"type":{"enum":["web"]}}}]}},"properties":{"action":{"enum":["create"]},"overwrite":{"title":"Overwrite","type":"boolean"},"target":{"title":"Target","type":"string"}},"required":["target"]},{"properties":{"action":{"enum":["delete"]}}}]}},"patternProperties":{"^arguments$":{},"^comments$":{},"^overwrite$":{},"^startInFolder$":{},"^target$":{}},"properties":{"action":{"enum":["create","delete"],"enumNames":["Create","Delete"],"title":"Action","type":"string"},"allUsers":{"title":"All users","type":"boolean"},"location":{"enum":["desktop","favorites","menu","programs","startup","sendto","quickbar"],"enumNames":["Desktop","Favorites","Menu","Programs","Startup","Send to","Quickbar"],"title":"Location","type":"string"},"name":{"title":"Name","type":"string"},"type":{"enum":["web","shell"],"enumNames":["Web","Shell"],"title":"Type","type":"string"}},"required":["action","type","name","location"],"type":"object"},"uiSchema":{"action":{"classNames":"col-sm-6","ui:placeholder":"Select action"},"allUsers":{"classNames":"col-sm-3 manual-clearfix"},"arguments":{"classNames":"col-sm-6"},"comments":{"classNames":"col-sm-6"},"location":{"classNames":"col-sm-6","ui:placeholder":"Select a location"},"name":{"classNames":"col-sm-6","ui:autofocus":true},"overwrite":{"classNames":"col-sm-3"},"startInFolder":{"classNames":"col-sm-6"},"target":{"classNames":"col-sm-6"},"type":{"classNames":"col-sm-6","ui:placeholder":"Select type"},"ui:order":["action","type","name","location","target","arguments","startInFolder","comments","allUsers","overwrite"]},"isHDScript":false}