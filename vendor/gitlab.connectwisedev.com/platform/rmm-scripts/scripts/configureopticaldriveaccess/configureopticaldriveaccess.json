{"id":"848c13d7-5aea-11e9-9fe8-00155d130b17","partnerId":"00000000-0000-0000-0000-000000000000","category":["Security"],"description":"Script will enable or disable optical drive access","engine":"powershell","engineMaxVersion":5,"expectedExecutionTimeSec":300,"failureMessage":"Executed with errors","successMessage":"Executed with Success","internal":false,"name":"Configure optical drive access","tags":["Windows 7","Windows 10"],"sequence":true,"content":"PCMKICAgIC5TY3JpcHQKICAgIFNjcmlwdCB3aWxsIGVuYWJsZSBvciBkaXNhYmxlIG9wdGljYWwgZHJpdmUgYWNjZXNzLgogICAgLkF1dGhvcgogICAgTmlyYXYgU2FjaG9yYQogICAgLkRlc2NyaXB0aW9uCiAgICBTY3JpcHQgd2lsbCBFbmFibGUgb3IgZGlzYWJsZSBvcHRpY2FsIGRyaXZlIGFjY2Vzcywgc2NyaXB0IGhhdmUgb3B0aW9uIHRvIGV4Y2x1ZGUgYWRtaW5pc3RyYXRvcnMuLgogICAgLlJlcXVpcmVtZW50cwogICAgU2NyaXB0IHNob3VsZCBydW4gd2l0aCBhZG1pbiBwcml2aWxlZ2VzLgojPgoKPCMkT3B0aWNhbERyaXZlQWNjZXNzID0gIkVuYWJsZSIKJEV4Y2x1ZGVBZG1pbiA9ICRmYWxzZSM+CgppZiAoJGVudjpQUk9DRVNTT1JfQVJDSElURVc2NDMyIC1lcSAiQU1ENjQiKSB7CiAgICBpZiAoJG15SW52b2NhdGlvbi5MaW5lKSB7CiAgICAgICAgJiIkZW52OnN5c3RlbXJvb3Rcc3lzbmF0aXZlXHdpbmRvd3Nwb3dlcnNoZWxsXHYxLjBccG93ZXJzaGVsbC5leGUiIC1Ob25JbnRlcmFjdGl2ZSAtTm9Qcm9maWxlICRteUludm9jYXRpb24uTGluZQogICAgfQogICAgZWxzZSB7CiAgICAgICAgJiIkZW52OnN5c3RlbXJvb3Rcc3lzbmF0aXZlXHdpbmRvd3Nwb3dlcnNoZWxsXHYxLjBccG93ZXJzaGVsbC5leGUiIC1Ob25JbnRlcmFjdGl2ZSAtTm9Qcm9maWxlIC1maWxlICIkKCRteUludm9jYXRpb24uSW52b2NhdGlvbk5hbWUpIiAkYXJncwogICAgfQogICAgZXhpdCAkbGFzdGV4aXRjb2RlCn0KCkZ1bmN0aW9uIENyZWF0ZV9yZWdpc3RyeSgkcGF0aCwgJE5hbWUsICRWYWx1ZSwgJHByb3BlcnR5dHlwZSkgewogICAgIyBGdW5jdGlvbiB3aWxsIHNldCByZWdpc3RyeSB2YWx1ZSBhbmQgaWYgaXRlbSBpcyBub3QgcHJlc2VudCB3aWxsIGNyZWF0ZSByZWdpc3RyeSBlbnRyeS4KICAgICREZXRhaWxzID0gR2V0LUl0ZW1Qcm9wZXJ0eSAtUGF0aCAkcGF0aAogICAgaWYgKCREZXRhaWxzIC1uZSAkbnVsbCkgewogICAgICAgICREZXRhaWxzID0gR2V0LUl0ZW1Qcm9wZXJ0eSAtUGF0aCAkcGF0aCB8IGdtIHwgc2VsZWN0IC1FeHBhbmRQcm9wZXJ0eSBOYW1lCiAgICAgICAgaWYgKCREZXRhaWxzIC1jb250YWlucyAkTmFtZSkgewogICAgICAgICAgICBTZXQtSXRlbVByb3BlcnR5ICRwYXRoIC1OYW1lICROYW1lIC1WYWx1ZSAkVmFsdWUKICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIE5ldy1JdGVtUHJvcGVydHkgLVBhdGggJHBhdGggLU5hbWUgJE5hbWUgLVByb3BlcnR5VHlwZSAkcHJvcGVydHl0eXBlIC1WYWx1ZSAkVmFsdWUgfCBPdXQtTnVsbAogICAgICAgIH0KCQogICAgfSAjRW5kIGlmIHN0YXRlbWVudAogICAgZWxzZSB7CiAgICAgICAgTmV3LUl0ZW1Qcm9wZXJ0eSAtUGF0aCAkcGF0aCAtTmFtZSAkTmFtZSAtUHJvcGVydHlUeXBlICRwcm9wZXJ0eXR5cGUgLVZhbHVlICRWYWx1ZSB8IE91dC1OdWxsCiAgICB9ICAjIEVuZCBlbHNlIHN0YXRlbWVudAoKICAgIGlmICgoR2V0LUl0ZW1Qcm9wZXJ0eSAkcGF0aCAtTmFtZSAkTmFtZSB8IHNlbGVjdCAtRXhwYW5kUHJvcGVydHkgJE5hbWUpIC1lcSAkVmFsdWUpIHsgcmV0dXJuICR0cnVlIH0gZWxzZSB7IHJldHVybiAkZmFsc2UgfQp9CgoKJHByb2ZpbGVsaXN0ID0gR2V0LUl0ZW0gIlJFZ2lzdHJ5OjpIS1VcUy0xLTUtMjEtKiIgfCBXaGVyZS1PYmplY3QgeyAkXy5OYW1lIC1ub3RsaWtlICcqX0NsYXNzZXMnIH0gfCBzZWxlY3QgLUV4cGFuZFByb3BlcnR5IG5hbWUKCmZvcmVhY2ggKCRwcm9maWxlIGluICRwcm9maWxlbGlzdCkgewogICAgaWYgKFRlc3QtUGF0aCAiUmVnaXN0cnk6OiRwcm9maWxlXFZvbGF0aWxlIEVudmlyb25tZW50IikgewogICAgICAgICR1c2VybmFtZSA9IEdldC1JdGVtUHJvcGVydHkgLVBhdGggIlJlZ2lzdHJ5OjokcHJvZmlsZVxWb2xhdGlsZSBFbnZpcm9ubWVudCIgLU5hbWUgVXNlcm5hbWUgfCBzZWxlY3QgLUV4cGFuZFByb3BlcnR5IFVzZXJuYW1lCiAgICAgICAgaWYgKCRFeGNsdWRlQWRtaW4gLWVxICR0cnVlKSB7CiAgICAgICAgICAgICRpc2FkbWluID0gbmV0LmV4ZSBsb2NhbGdyb3VwIGFkbWluaXN0cmF0b3JzIHwgd2hlcmUgeyAkXyAtZXEgIiR1c2VybmFtZSIgfQogICAgICAgIH0KICAgICAgICBlbHNlIHsgJGlzYWRtaW4gPSAkbnVsbCB9CiAgICAgICAgaWYgKCRpc2FkbWluIC1lcSAkbnVsbCkgewoKICAgICAgICAgICAgJFBhdGggPSAiUmVnaXN0cnk6OiRwcm9maWxlXFNvZnR3YXJlXFBvbGljaWVzXE1pY3Jvc29mdFxXaW5kb3dzXFJlbW92YWJsZVN0b3JhZ2VEZXZpY2VzIgogICAgICAgICAgICAkQ0RfRFZEX0dVSUQgPSAiezUzZjU2MzA4LWI2YmYtMTFkMC05NGYyLTAwYTBjOTFlZmI4Yn0iCiAgICAgICAgICAgIGlmICgoVGVzdC1QYXRoICJSZWdpc3RyeTo6JHByb2ZpbGVcU29mdHdhcmVcUG9saWNpZXNcTWljcm9zb2Z0XFdpbmRvd3NcUmVtb3ZhYmxlU3RvcmFnZURldmljZXMiKSAtZXEgJGZhbHNlKSB7CiAgICAgICAgICAgICAgICBOZXctSXRlbSAtUGF0aCAiUmVnaXN0cnk6OiRwcm9maWxlXFNvZnR3YXJlXFBvbGljaWVzXE1pY3Jvc29mdFxXaW5kb3dzIiAtTmFtZSAiUmVtb3ZhYmxlU3RvcmFnZURldmljZXMiIC1FcnJvckFjdGlvbiBTdG9wIHwgT3V0LU51bGwKICAgICAgICAgICAgfQoKICAgICAgICAgICAgJENEX0RWRCA9IEdldC1DaGlsZEl0ZW0gLVBhdGggIlJlZ2lzdHJ5OjokcHJvZmlsZVxTb2Z0d2FyZVxQb2xpY2llc1xNaWNyb3NvZnRcV2luZG93c1xSZW1vdmFibGVTdG9yYWdlRGV2aWNlcyIgfCBXaGVyZS1PYmplY3QgeyAkXy5OYW1lIC1saWtlICIqJENEX0RWRF9HVUlEIiB9IC1FcnJvckFjdGlvbiBTaWxlbnRseUNvbnRpbnVlCiAgICAgICAgICAgIGlmICghJENEX0RWRCkgeyAgIAogICAgICAgICAgICAgICAgI0NyZWF0aW5nIG5ldyBlbnRyeSAnJENEX0RWRF9HVUlEJwogICAgICAgICAgICAgICAgTmV3LUl0ZW0gLVBhdGggJFBhdGggLU5hbWUgJENEX0RWRF9HVUlEIC1FcnJvckFjdGlvbiBTdG9wIHwgT3V0LU51bGwKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoJE9wdGljYWxEcml2ZUFjY2VzcyAtZXEgIkVuYWJsZSIpIHsgJHZhbHVlID0gMCB9IGVsc2VpZiAoJE9wdGljYWxEcml2ZUFjY2VzcyAtZXEgIkRpc2FibGUiKSB7ICR2YWx1ZSA9IDEgfQogICAgICAgICAgICAkcmVhZCA9IENyZWF0ZV9yZWdpc3RyeSAtcGF0aCAiUmVnaXN0cnk6OiRwcm9maWxlXFNvZnR3YXJlXFBvbGljaWVzXE1pY3Jvc29mdFxXaW5kb3dzXFJlbW92YWJsZVN0b3JhZ2VEZXZpY2VzXCRDRF9EVkRfR1VJRCIgLU5hbWUgIkRlbnlfUmVhZCIgLVZhbHVlICIkdmFsdWUiIC1wcm9wZXJ0eXR5cGUgIkRXT1JEIgogICAgICAgICAgICAkd3JpdGUgPSBDcmVhdGVfcmVnaXN0cnkgLXBhdGggIlJlZ2lzdHJ5OjokcHJvZmlsZVxTb2Z0d2FyZVxQb2xpY2llc1xNaWNyb3NvZnRcV2luZG93c1xSZW1vdmFibGVTdG9yYWdlRGV2aWNlc1wkQ0RfRFZEX0dVSUQiIC1OYW1lICJEZW55X1dyaXRlIiAtVmFsdWUgIiR2YWx1ZSIgLXByb3BlcnR5dHlwZSAiRFdPUkQiCiAgICAgICAgICAgICRleGVjdXRlID0gQ3JlYXRlX3JlZ2lzdHJ5IC1wYXRoICJSZWdpc3RyeTo6JHByb2ZpbGVcU29mdHdhcmVcUG9saWNpZXNcTWljcm9zb2Z0XFdpbmRvd3NcUmVtb3ZhYmxlU3RvcmFnZURldmljZXNcJENEX0RWRF9HVUlEIiAtTmFtZSAiRGVueV9FeGVjdXRlIiAtVmFsdWUgIiR2YWx1ZSIgLXByb3BlcnR5dHlwZSAiRFdPUkQiCiAgICAgICAgICAgIGlmICgkcmVhZCAtYW5kICR3cml0ZSAtYW5kICRleGVjdXRlKSB7CiAgICAgICAgICAgICAgICBzd2l0Y2ggKCRPcHRpY2FsRHJpdmVBY2Nlc3MpIHsKICAgICAgICAgICAgICAgICAgICAiRW5hYmxlIiB7ICJPcHRpY2FsIERyaXZlIGhhcyBiZWVuIEVuYWJsZWQgZm9yICR1c2VybmFtZSIgfQogICAgICAgICAgICAgICAgICAgICJEaXNhYmxlIiB7ICJPcHRpY2FsIERyaXZlIGhhcyBiZWVuIERpc2FibGVkIGZvciAkdXNlcm5hbWUiIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBlbHNlIHsKICAgICAgICAgICAgV3JpdGUtT3V0cHV0ICIkdXNlcm5hbWUgYWNjb3VudCBpcyBtZW1iZXIgb2YgQWRtaW5pc3RyYXRvcnMgZ3JvdXAuIgogICAgICAgIH0KICAgIH0KfQo=","jsonSchema":{"type":"object","properties":{"OpticalDriveAccess":{"title":"Optical Drive Access","type":"string","enum":["Enable","Disable"],"enumNames":["Enable","Disable"]},"ExcludeAdmin":{"type":"boolean","title":"Exclude Administrator"}},"additionalproperties":false},"uiSchema":{"OpticalDriveAccess":{"classNames":"col-sm-3 col-sm-offset-right-9","ui:autofocus":true,"ui:placeholder":"No Change"},"ExcludeAdmin":{"classNames":"col-sm-3","ui:autofocus":true},"ui:order":["OpticalDriveAccess","ExcludeAdmin"]},"isHDScript":false}
