{"id":"117373fa-2e16-11e9-9ebe-00155d130b01","partnerId":"00000000-0000-0000-0000-000000000000","category":["Data Collection"],"description":"Retrieves wakeon lan status ","engine":"powershell","engineMaxVersion":5,"expectedExecutionTimeSec":300,"failureMessage":"Executed with errors","successMessage":"Excecuted successfully.","internal":false,"name":"Retrieve wakeon lan status","tags":["Windows 7","Windows 10"],"sequence":true,"content":"dHJ5IHsKICAgICRFcnJvckFjdGlvblByZWZlcmVuY2UgPSAnU3RvcCcKICAgICMgY2FwdHVyZSBhbGwgbmV0d29yayBhZGFwdGVycyB0aGF0IGFyZSBwaHlzY2FsLCBhY3RpdmUgYW5kIG5vdCBmb3Igd2lyZWxlc3Mgb3IgYmx1ZXRvb3RoCiAgICAkbmljcyA9IEdldC1XbWlPYmplY3QgV2luMzJfTmV0d29ya0FkYXB0ZXIgLWZpbHRlciAibmV0Y29ubmVjdGlvbnN0YXR1cyA9IDIgQU5EIEFkYXB0ZXJUeXBlSUQgPSAnMCcgQU5EIFBoeXNpY2FsQWRhcHRlciA9ICd0cnVlJyBBTkQgTk9UIERlc2NyaXB0aW9uIExJS0UgJyVDZW50cmlubyUnIEFORCBOT1QgRGVzY3JpcHRpb24gTElLRSAnJXdpcmVsZXNzJScgQU5EIE5PVCBEZXNjcmlwdGlvbiBMSUtFICcldmlydHVhbCUnIEFORCBOT1QgRGVzY3JpcHRpb24gTElLRSAnJVdpRmklJyBBTkQgTk9UIERlc2NyaXB0aW9uIExJS0UgJyVCbHVldG9vdGglJyIKCiAgICAjIGNhcHR1cmUgYWxsIG5ldHdvcmsgYWRhcHRlcnMgdGhhdCBoYXZlIAogICAgJFdha2VPbkxhbiA9IEdldC1XbWlPYmplY3QgTVNQb3dlcl9EZXZpY2VXYWtlRW5hYmxlIC1OYW1lc3BhY2Ugcm9vdFx3bWkgfCB3aGVyZSB7JF8uZW5hYmxlIC1lcSAkdHJ1ZX0KICAgIAogICAgSWYgKCRXYWtlT25MYW4pIHsKICAgICAgICAkTWFnaWNQYWNrZXRzID0gR2V0LVdtaU9iamVjdCBNU05kaXNfRGV2aWNlV2FrZU9uTWFnaWNQYWNrZXRPbmx5IC1OYW1lc3BhY2Ugcm9vdFx3bWl8IHdoZXJlIHsgJF8uRW5hYmxlV2FrZU9uTWFnaWNQYWNrZXRPbmx5IC1lcSAkdHJ1ZX0KICAgICAgICAkTWFnaWNQYWNrZXRzT3V0cHV0ID0gJFdha2Vvbkxhbk91dHB1dCA9IEAoKQogICAgICAgIAogICAgICAgICMgaXRlcmF0ZSBlYWNoIE5ldHdvcmsgYWRhcHRlciBhbmQgaWRlbnRpZnkgc3RhdHVzIG9mIGBXYWtlT25MYW5gIGFuZCBhYmlsaXR5IHRvIHdha2V1cCBvbiAnTWFnaWNQYWNrZXRzT25seScKICAgICAgICBGb3JlYWNoICgkbmljIGluICRuaWNzKSB7CiAgICAgICAgICAgIEZvcmVhY2ggKCRpdGVtIGluICRXYWtlT25MYW4pIHsKICAgICAgICAgICAgICAgIElmICgkaXRlbS5lbmFibGUgLWFuZCAkaXRlbS5pbnN0YW5jZW5hbWUgLW1hdGNoIFtyZWdleF06OmVzY2FwZSgkbmljLlBOUERldmljZUlEKSkgewogICAgICAgICAgICAgICAgICAgICRXYWtlb25MYW5PdXRwdXQgKz0gJG5pYyB8U2VsZWN0LU9iamVjdCBOYW1lLCBzdGF0dXMsIEFkYXB0ZXJUeXBlLCBEZXZpY2VJRCwgTWFjQWRkcmVzcywgQHtuID0gJ1dha2VPbkxhbkVuYWJsZWQ/JzsgZSA9IHskdHJ1ZX19CiAgICAgICAgICAgICAgICB9IAogICAgICAgICAgICB9CiAgICAgICAgICAgIEZvcmVhY2ggKCRpdGVtIGluICRNYWdpY1BhY2tldHMpIHsKICAgICAgICAgICAgICAgIElmICgkaXRlbS5FbmFibGVXYWtlT25NYWdpY1BhY2tldE9ubHkgLWFuZCAkaXRlbS5pbnN0YW5jZW5hbWUgLW1hdGNoIFtyZWdleF06OmVzY2FwZSgkbmljLlBOUERldmljZUlEKSkgewogICAgICAgICAgICAgICAgICAgICRNYWdpY1BhY2tldHNPdXRwdXQgKz0gJG5pYyB8U2VsZWN0LU9iamVjdCBOYW1lLCBzdGF0dXMsIEFkYXB0ZXJUeXBlLCBEZXZpY2VJRCwgTWFjQWRkcmVzcywgQHtuID0gJ1dha2VPbk1hZ2ljUGFja2V0T25seT8nOyBlID0geyR0cnVlfX0KICAgICAgICAgICAgICAgIH0gCiAgICAgICAgICAgIH0KICAgIAogICAgICAgIH0gCiAgICAgICAgSWYgKCRXYWtlb25MYW5PdXRwdXQpIHsKICAgICAgICAgICAgV3JpdGUtT3V0cHV0ICJgbidXYWtlT25MYW4nIGlzIEVuYWJsZWQgb24gZm9sbG93aW5nICdBY3RpdmUnIE5ldHdvcmsgQWRwYXRlcnMiCiAgICAgICAgICAgIFdyaXRlLU91dHB1dCAkV2FrZW9uTGFuT3V0cHV0CiAgICAgICAgfQogICAgICAgIElmICgkTWFnaWNQYWNrZXRzT3V0cHV0KSB7CiAgICAgICAgICAgIFdyaXRlLU91dHB1dCAiJ1dha2VPbk1hZ2ljUGFja2V0T25seScgaXMgRW5hYmxlZCBvbiBmb2xsb3dpbmcgJ0FjdGl2ZScgTmV0d29yayBBZHBhdGVyc2BuIgogICAgICAgICAgICBXcml0ZS1PdXRwdXQgJE1hZ2ljUGFja2V0c091dHB1dAogICAgICAgIH0KICAgIH0KICAgIGVsc2UgewogICAgICAgIFdyaXRlLU91dHB1dCAiYG5UaGlzIGZlYXR1cmUgaXMgbm90IHN1cHBvcnRlZCBvbiB0aGUgU3lzdGVtIgogICAgfQp9CmNhdGNoIHsKICAgIFdyaXRlLUVycm9yICRfLkV4Y2VwdGlvbi5tZXNzYWdlCn0K","jsonSchema":"","uiSchema":"","isHDScript":false}
