{"id":"97cc5656-e37c-11e9-8fa7-00155d130b01","partnerId":"00000000-0000-0000-0000-000000000000","category":["Setup"],"description":"Task will update earlier versions of Windows 10  to version 1903 feature update.","engine":"powershell","engineMaxVersion":5,"expectedExecutionTimeSec":28800,"failureMessage":"Executed with errors","successMessage":"Executed successfully","internal":false,"name":"Windows 10 1903 feature update","tags":["Windows 7","Windows 10"],"sequence":true,"content":"aWYgKCRlbnY6UFJPQ0VTU09SX0FSQ0hJVEVXNjQzMiAtZXEgIkFNRDY0IikgewogICAgaWYgKCRteUludm9jYXRpb24uTGluZSkgewogICAgICAgICYiJGVudjpzeXN0ZW1yb290XHN5c25hdGl2ZVx3aW5kb3dzcG93ZXJzaGVsbFx2MS4wXHBvd2Vyc2hlbGwuZXhlIiAtTm9uSW50ZXJhY3RpdmUgLU5vUHJvZmlsZSAkbXlJbnZvY2F0aW9uLkxpbmUKICAgIH0KICAgIGVsc2UgewogICAgICAgICYiJGVudjpzeXN0ZW1yb290XHN5c25hdGl2ZVx3aW5kb3dzcG93ZXJzaGVsbFx2MS4wXHBvd2Vyc2hlbGwuZXhlIiAtTm9uSW50ZXJhY3RpdmUgLU5vUHJvZmlsZSAtZmlsZSAiJCgkbXlJbnZvY2F0aW9uLkludm9jYXRpb25OYW1lKSIgJGFyZ3MKICAgIH0KICAgIGV4aXQgJGxhc3RleGl0Y29kZQp9CgokRXJyb3JBY3Rpb25QcmVmZXJlbmNlID0gJ1N0b3AnClRyeSB7CiAgICAkTG9jYWxQYXRoID0gIiRFbnY6VGVtcFxXaW5kb3dzMTBVcGdyYWRlLmV4ZSIKICAgICRVUkwgPSAnaHR0cDovL3NkdXBkdC5pdHN1cHBvcnQyNDcubmV0L3RwdXBkYXRlL1dpbmRvd3MxMFVwZ3JhZGUuZXhlJwogICAgJFBhcmFtZXRlcnMgPSAiL0luc3RhbGwgL0NsaWVudElEIFdpbjEwVXBncmFkZTpWTkw6TkhWMTk6e30gL1NraXBFVUxBIC9Fb3NVaSAvcXVpZXQJL25vcmVzdGFydCIKCiAgICAjIGRvd25sb2FkcyBmaWxlLCBpZiBkb3dubG9hYSBmYWlscyB5b3UgZ2V0IGEgZmFpbHVyZSBtZXNzYWdlCiAgICBmdW5jdGlvbiBEb3dubG9hZC1Gcm9tVVJMICgkVVJMLCAkTG9jYWxGaWxlUGF0aCkgewogICAgICAgICRXZWJDbGllbnQgPSBOZXctT2JqZWN0IFN5c3RlbS5OZXQuV2ViQ2xpZW50CiAgICAgICAgJFdlYkNsaWVudC5Eb3dubG9hZEZpbGUoJFVSTCwgJExvY2FsRmlsZVBhdGgpCiAgICAgICAgaWYgKC1ub3QoVGVzdC1QYXRoICRMb2NhbEZpbGVQYXRoKSkgeyBXcml0ZS1FcnJvciAiVW5hYmxlIHRvIGRvd25sb2FkIHRoZSBmaWxlIGZyb20gVVJMOiAkVVJMIiB9CiAgICB9CgogICAgRnVuY3Rpb24gSXNVcGRhdGVSdW5uaW5nIHsKICAgICAgICAoR2V0LVByb2Nlc3MgV2luZG93czEwVXBncmFkZXJBcHAgLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWUpIC1hcyBbQm9vbF0KICAgIH0KCgogICAgIyBjb25kaXRpb24gMSAtIGNoZWNrcyBvcGVyYXRpbmcgc3lzdGVtIHZlcnNpb24KICAgICRPUyA9IEdldC1XbWlPYmplY3Qgd2luMzJfb3BlcmF0aW5nc3lzdGVtCiAgICAkSXNXaW5kb3dzMTAgPSAoJE9TIHwgV2hlcmUtT2JqZWN0IHsgJF8uY2FwdGlvbiAtbGlrZSAiKldpbmRvd3MgMTAqIiB9KSAtYXMgW2Jvb2xdCiAgICBpZiAoISRJc1dpbmRvd3MxMCkgewogICAgICAgIFdyaXRlLU91dHB1dCAiTm90IEFwcGxpY2FibGUgOiBUYXNrIGFwcGxpZXMgdG8gb25seSBXaW5kb3dzIDEwIgogICAgICAgIEJyZWFrOwogICAgfQoKICAgICMgY29uZGl0aW9uIDIgLSBjaGVjayByZWxlYXNlIGlkCiAgICBbaW50XSRSZWxlYXNlSUQgPSAoR2V0LUl0ZW1Qcm9wZXJ0eSAiSEtMTTpcU09GVFdBUkVcTWljcm9zb2Z0XFdpbmRvd3MgTlRcQ3VycmVudFZlcnNpb24iKS5SZWxlYXNlSWQKICAgIGlmICgkUmVsZWFzZUlEIC1nZSAxOTAzKSB7CiAgICAgICAgV3JpdGUtT3V0cHV0ICJObyBBY3Rpb24gTmVlZGVkIDogTGF0ZXN0IEZlYXR1cmUgdXBkYXRlIGFscmVhZHkgaW5zdGFsbGVkIgogICAgICAgIEJyZWFrOwogICAgfQoKICAgICMgY29uZGl0aW9uIDMgLSBjaGVjayBzeXN0ZW0gZHJpdmUgZnJlZSBzcGFjZQogICAgJFN5c3RlbURyaXZlTGV0dGVyID0gR2V0LVBhcnRpdGlvbiB8IFdoZXJlLU9iamVjdCB7ICRfLmlzYm9vdCB9IHwgU2VsZWN0LU9iamVjdCAtRXhwYW5kUHJvcGVydHkgRHJpdmVMZXR0ZXIKICAgICRTeXN0ZW1Ecml2ZUZyZWVTcGFjZSA9IChHZXQtV21pT2JqZWN0IC1DbGFzcyBXaW4zMl9sb2dpY2FsZGlzayAtRmlsdGVyICJEcml2ZVR5cGUgPSAnMycgQU5EIERldmljZUlEID0gJyR7U3lzdGVtRHJpdmVMZXR0ZXJ9OiciKS5GcmVlU3BhY2UgLyAxR0IKICAgIGlmICgkU3lzdGVtRHJpdmVGcmVlU3BhY2UgLWx0IDMyKSB7CiAgICAgICAgV3JpdGUtT3V0cHV0ICJQcmVyZXF1aXNpdGUgY2hlY2sgZmFpbGVkIDogTWluaW11bSAzMkdCIGZyZWUgc3BhY2UgaXMgbmVlZGVkIG9uIHN5c3RlbSBkcml2ZSIKICAgICAgICBCcmVhazsKICAgIH0KCiAgICAjIGNvbmRpdGlvbiA0IC0gaWYgYSBwcm9jZXNzIGlzIGFscmVhZHkgcnVubmluZwogICAgaWYgKElzVXBkYXRlUnVubmluZykgewogICAgICAgIFdyaXRlLUVycm9yICJGYWlsZWQgOiBPbmUgaW5zdGFuY2Ugb2YgdXBkYXRlIGlzIGFscmVhZHkgcnVubmluZy4gTm8gYWN0aW9uIHdpbGwgYmUgcGVyZm9ybWVkLiIKICAgICAgICBCcmVhazsKICAgIH0KCgogICAgJFVwZ3JhZGVGb2xkZXIgPSAiJHtTeXN0ZW1Ecml2ZUxldHRlcn06XFdpbmRvd3MxMFVwZ3JhZGVcIgogICAgJExvZ0ZpbGUgPSBKb2luLVBhdGggJFVwZ3JhZGVGb2xkZXIgJ3VwZ3JhZGVyX2RlZmF1bHQubG9nJwogICAgCiAgICAjIHJlbW92ZSBpZiBmb2xkZXIgZXhpc3RzCiAgICBSZW1vdmUtSXRlbSAkVXBncmFkZUZvbGRlciAtRm9yY2UgLUNvbmZpcm06JGZhbHNlIC1FcnJvckFjdGlvbiBTaWxlbnRseUNvbnRpbnVlIC1SZWN1cnNlCgogICAgIyBkb3dubG9hZHMgdGhlIFVSTAogICAgRG93bmxvYWQtRnJvbVVSTCAtVVJMICRVUkwgLUxvY2FsRmlsZVBhdGggJExvY2FsUGF0aAogICAgJFByb2Nlc3MgPSBTdGFydC1Qcm9jZXNzICRMb2NhbFBhdGggLUFyZ3VtZW50TGlzdCAkUGFyYW1ldGVycyAtUGFzc1RocnUKCiAgICAjIGFsbG93IHVwZGF0ZSBmb2xkZXJzIGFuZCBkZXBlbmRlY2llcyB0byBiZSBkb3dubG9hZGVkCiAgICBXaGlsZSAoIShUZXN0LVBhdGggIiR7U3lzdGVtRHJpdmVMZXR0ZXJ9OlxXaW5kb3dzMTBVcGdyYWRlXFdpbmRvd3MxMFVwZ3JhZGVyQXBwLmV4ZSIpKSB7CiAgICAgICAgU3RhcnQtU2xlZXAgLVNlY29uZHMgMQogICAgfQogICAgU3RhcnQtU2xlZXAgLVNlY29uZHMgMjAgIyBhZGRpdGlvbmFsIGRlbGF5IHRvIHdhaXQgdXBkYXRlIGV4ZSB0byBsYXVuY2gKCiAgICAkRG93bmxvYWRmbGFnICA9ICRmYWxzZQoKICAgICMgd2FpdCBmb3IgZG9ud2xvYWQgc3RhdHVzIHRvIGFwcGVhciBpbiBsb2dzCiAgICBXaGlsZSgxKXsKICAgICAgICAkRG93bmxvYWRTdHJpbmcgPSAoR2V0LUNvbnRlbnQgJExvZ0ZpbGUgLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWUgfCBXaGVyZS1PYmplY3QgeyRfIC1saWtlICIqRG93bmxvYWRlciBocmVzdWx0KiJ9KSAtYXMgW2Jvb2xdCiAgICAgICAgSWYoJERvd25sb2FkU3RyaW5nKXsKICAgICAgICAgICBicmVhazsgCiAgICAgICAgfQogICAgICAgIFN0YXJ0LVNsZWVwIC1TZWNvbmRzICg2MCkKICAgIH0KCiAgICBXaGlsZSgxKXsKICAgICAgICAjIGNoZWNrIGRvbndsb2FkIHN0YXR1cwogICAgICAgICRTdWNjZXNzZnVsRG93bmxvYWQgPSAoR2V0LUNvbnRlbnQgJExvZ0ZpbGUgIHwgV2hlcmUtT2JqZWN0IHskXyAtbGlrZSAiKkRvd25sb2FkZXIgaHJlc3VsdDogMHgwKiJ9KSAtYXMgW2Jvb2xdCiAgICAgICAgSWYoJFN1Y2Nlc3NmdWxEb3dubG9hZCAtYW5kICEkRG93bmxvYWRmbGFnKXsKICAgICAgICAgICAgV3JpdGUtT3V0cHV0ICJEb3dubG9hZCBjb21wbGV0ZWQiCiAgICAgICAgICAgICREb3dubG9hZGZsYWcgPSAkVHJ1ZQogICAgICAgIH0KICAgICAgICBlbHNlaWYoISREb3dubG9hZGZsYWcpewogICAgICAgICAgICBXcml0ZS1FcnJvciAiRmFpbGVkIHRvIGRvd25sb2FkIHRoZSB1cGRhdGUsIHBsZWFzZSBjaGVjayB0aGUgbG9nIGZpbGUgZm9yIG1vcmUgZGV0YWlsczpgIiRMb2dGaWxlYCIgIgogICAgICAgICAgICBFeGl0OwogICAgICAgIH0KICAgICAgICAKICAgICAgICAjIGNoZWNrIGxvZyBzdGF0dXMKICAgICAgICAkVXBkYXRlU3VjY2VzZnVsID0gKEdldC1Db250ZW50ICRMb2dGaWxlIHwgV2hlcmUtT2JqZWN0IHskXyAtbGlrZSAiKlN0YXRlIG1hbmFnZXIgZ2V0IGNhbGxlZCBiYWNrIHdpdGggc3RhdGUgUG9zdEluc3RhbGxTdGF0ZSwgaHIgMHgwKiJ9KSAtYXMgW0Jvb2xdCiAgICAgICAgaWYgKCRVcGRhdGVTdWNjZXNmdWwpIHsKICAgICAgICAgICAgaWYoJFVwZGF0ZVN1Y2Nlc2Z1bCl7CiAgICAgICAgICAgICAgICBXcml0ZS1PdXRwdXQgIkluc3RhbGxhdGlvbiBvZiB2ZXJzaW9uIDE5MDMgZmVhdHVyZSB1cGRhdGUgY29tcGxldGVkIHN1Y2Nlc3NmdWxseS4gYG5QbGVhc2UgcmVib290IHRoZSBzeXN0ZW0gZm9yIGNoYW5nZXMgdG8gdGFrZSBhZmZlY3QsIG9yIHN5c3RlbSB3aWxsIHJlYm9vdCBhZnRlciAzMCBtaW51dGVzLiIKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlewogICAgICAgICAgICAgICAgV3JpdGUtRXJyb3IgIkZlYXR1cmUgdXBkYXRlIGhhcyBmYWlsZWQuIFNlZSBsb2cgYCIkTG9nRmlsZWAiIGZvciBtb3JlIGRldGFpbHMuIgogICAgICAgICAgICB9CiAgICAgICAgICAgIGV4aXQ7CiAgICAgICAgfQoKICAgICAgICBTdGFydC1TbGVlcCAtU2Vjb25kcyAoNSo2MCkKICAgIH0KCn0KY2F0Y2ggewogICAgV3JpdGUtT3V0cHV0ICJGYWlsZWQuIgogICAgV3JpdGUtRXJyb3IgJF8KfQo=","jsonSchema":"","uiSchema":"","isHDScript":false}