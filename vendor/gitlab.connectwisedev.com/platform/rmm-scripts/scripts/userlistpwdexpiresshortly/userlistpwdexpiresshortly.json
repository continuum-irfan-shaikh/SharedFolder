{"id":"411e3ecb-3151-11e9-94fc-00155d130b17","partnerId":"00000000-0000-0000-0000-000000000000","category":["Data Collection"],"description":"Retrieve List of users whose passwords will expire shortly","engine":"powershell","engineMaxVersion":5,"expectedExecutionTimeSec":300,"failureMessage":"Executed with errors","successMessage":"Script executed successfully","internal":false,"name":"Users whose Password expires shortly","tags":["Windows 7","Windows 10"],"sequence":true,"content":"IDwjCiAgICAuU3lub3BzaXMKICAgICBSZXRyaXZlIExpc3Qgb2YgVXNlcnMgd2hvc2UgcGFzc3dvcmRzIHdpbGwgZXhwaXJlIHNob3J0bHkgIAogICAgLkRlc2NyaXB0aW9uIAogICAgIFRvIGdldCB0aGUgZGV0YWlscyBvZiB0aGUgdXNlcnMgd2hvc2Ugd2lsbCBnZXQgZXhwaXJlZCBzb29uIG9uIHRoZSBtYWNoaW5lCiAgICAuSGVscAogICAgIFRvIGdldCBtb3JlIGluZm9ybWF0aW9uIGFib3V0IHRoZSB1c2VycyB3aG9zZSBwYXNzd29yZCB3aWxsIGJlIGdvaW5nIHRvIGV4cGlyZWQgc29vbiB0aGVuIHJlZmVyIGJlbG93IGRldGFpbHMKICAgICBHZXQtV21pT2JqZWN0IC1DbGFzcyBXaW4zMl9Vc2VyQWNjb3VudAogICAgLkF1dGhvcgogICAgIHN1c2htYS55ZXJhc2lAY29udGludXVtLm5ldAogICAgLk5hbWUgCiAgICAgUmV0cml2ZSBMaXN0IG9mIFVzZXJzIHdob3NlIHBhc3N3b3JkcyB3aWxsIGV4cGlyZSBzaG9ydGx5CiM+CgokRXhlY3V0aW9uTG9nPUAoKQokT2JqID0gQCgpCiMkZGF5cyA9ICI1IgpbZG91YmxlXSRPU1ZlcnNpb249W0Vudmlyb25tZW50XTo6T1NWZXJzaW9uLlZlcnNpb24uVG9TdHJpbmcoMikKIyBPUyBWZXJzaW9uIGFuZCBQb3dlcnNoZWxsIGNvbXBhcmlzb24uCmlmICgoJG9zdmVyc2lvbiAtbHQgJzYuMScpIC1vciAoJFBTVmVyc2lvblRhYmxlLlBTVmVyc2lvbi5NYWpvciAtbHQgJzInKSkKICAgICAgICB7CiAgICAgICAgICAgICRleGVjdXRpb25sb2cgKz0gJ1ByZXJlcXVpc2l0ZXMgdG8gcnVuIHRoZSBzY3JpcHQgaXMgbm90IHZhbGlkLCBIZW5jZSBTY3JpcHQgRXhjZXV0aW9uIHN0b3BwZWQnICMnU2NyaXB0IGlzIGRlc2lnbiBmb3Igd2luZG93cyA3IGFuZCBBYm92ZSBNZW1iZXJzIG9ubHksIFNjcmlwdCBFeGVjdXRpb24gU3RvcHBlZC4nCiAgICAgICAgICAgIFdyaXRlLU91dHB1dCAkZXhlY3V0aW9ubG9nCiAgICAgICAgICAgIGV4aXQ7CiAgICAgICAgfSAKCiNUbyBjaGVjayB0aGUgcm9sZSBvZiB0aGUgY29tcHV0ZXIKdHJ5IHsKCiAgICAkQ29tcD1nZXQtd21pb2JqZWN0IHdpbjMyX2NvbXB1dGVyc3lzdGVtCiAgICAkY29tcHV0ZXIgPSAkY29tcC5uYW1lIDsgJERvbWFpbk5hbWVlID0gJGNvbXAuZG9tYWluCiAgICAkRXhlY3V0aW9uTG9nICs9ICJDb21wdXRlck5hbWUgOiAkY29tcHV0ZXIiCiAgICAkRXhlY3V0aW9uTG9nICs9ICJEb21haW4vV29ya2dyb3VwIDogJERvbWFpbk5hbWVlIgoKICAgIGlmICg0LDUgLWNvbnRhaW5zICRDb21wLkRvbWFpblJvbGUpewkKCQkJIEltcG9ydC1Nb2R1bGUgQWN0aXZlRGlyZWN0b3J5CgkJCSAkdXNlcnMgPSBHZXQtQURVc2VyIC1maWx0ZXIge0VuYWJsZWQgLWVxICRUcnVlIC1hbmQgUGFzc3dvcmROZXZlckV4cGlyZXMgLWVxICRGYWxzZX0gIOKAk1Byb3BlcnRpZXMgIlNhbUFjY291bnROYW1lIiwibXNEUy1Vc2VyUGFzc3dvcmRFeHBpcnlUaW1lQ29tcHV0ZWQiIHwgU2VsZWN0LU9iamVjdCAgQHtOYW1lPSJBY2NvdW50IE5hbWUiO0V4cHJlc3Npb249eyRfLiJTYW1BY2NvdW50TmFtZSJ9fSwgQHtOYW1lPSJQYXNzd29yZCBFeHBpcnkgRGF0ZSI7RXhwcmVzc2lvbj17W2RhdGV0aW1lXTo6RnJvbUZpbGVUaW1lKCRfLiJtc0RTLVVzZXJQYXNzd29yZEV4cGlyeVRpbWVDb21wdXRlZCIpfX0gfCBXaGVyZS1PYmplY3QgeyRfLidQYXNzd29yZCBleHBpcnkgZGF0ZScgLWx0IChHZXQtRGF0ZSkuQWRkRGF5cygkZGF5cykuVG9TdHJpbmcoImQiKX0gfCBmbAoJCQkgaWYgKCR1c2VycyAtbmUgJG51bGwpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICRFeGVjdXRpb25Mb2cgKz0gJHVzZXJzCgkJCSBXcml0ZS1PdXRwdXQgJEV4ZWN1dGlvbkxvZwogICAgICAgICAgICAgICAgICAgICAgICAgRXhpdDsgfQoJCQllbHNlIHsgICAgCgkJCQkkRXhlY3V0aW9uTG9nICs9ICJUaGVyZSBhcmUgbm8gdXNlcnMgb24gdGhlIE1hY2hpbmUgd2hvc2UgcGFzc293cmQgd2lsbCBiZSBnb2luZyB0byBiZSBleHBpcmVkIHNvb24iCgkJCQlXcml0ZS1PdXRwdXQgJGV4ZWN1dGlvbmxvZwoJCQkgICAgICAgIGV4aXQ7fSAgICAgIH0KICAgIGVsc2UgewkKCQkJJG5vdyA9IEdldC1EYXRlCgkJCSRBbGxMb2NhbEFjY291bnRzID0gR2V0LVdtaU9iamVjdCAtQ2xhc3MgV2luMzJfVXNlckFjY291bnQgLWZpbHRlciB7TG9jYWxBY2NvdW50ID0gIlRydWUiIGFuZCBkaXNhYmxlZCA9ICJGYWxzZSIgfSAKCQkJJE9iaiA9ICRBbGxMb2NhbEFjY291bnRzIHwgRm9yRWFjaC1PYmplY3QgewogICAgICAgICAgICAgICAgICAgICAgICAkdXNlciA9IChbYWRzaV0iV2luTlQ6Ly8kY29tcHV0ZXIvJCgkXy5OYW1lKSx1c2VyIikKCQkgICAgICAgICRwd0FnZSAgICA9ICR1c2VyLlBhc3N3b3JkQWdlLlZhbHVlCgkJICAgICAgICAkbWF4UHdBZ2UgPSAkdXNlci5NYXhQYXNzd29yZEFnZS5WYWx1ZQoJCSAgICAgICAgTmV3LU9iamVjdCAtVHlwZU5hbWUgUFNPYmplY3QgLVByb3BlcnR5IEB7CgkJICAgICAgICdBY2NvdW50IE5hbWUnICAgICAgICAgPSAkXy5OYW1lCgkJICAgICAgICdQYXNzd29yZCBFeHBpcmVzJyAgICAgPSAkXy5QYXNzd29yZEV4cGlyZXMKCQkgICAgICAgJ1Bhc3N3b3JkIExhc3QgU2V0JyAgICA9ICRwd0xhc3RTZXQKCQkgICAgICAgJ1Bhc3N3b3JkIEV4cGlyeSBEYXRlJyA9ICRub3cuQWRkU2Vjb25kcygkbWF4UHdBZ2UgLSAkcHdBZ2UpCgkJICAgICAgICAgIH0KCQkgICAgICAgICB9CgkJICAgICAgICRPdXB1dCA9ICRPYmogfCBzZWxlY3QgIkFjY291bnQgTmFtZSIsICJQYXNzd29yZCBFeHBpcnkgRGF0ZSIsICJQYXNzd29yZCBFeHBpcmVzIiB8IFdoZXJlLU9iamVjdCB7JF8uJ1Bhc3N3b3JkIEV4cGlyeSBEYXRlJyAtbHQgKEdldC1EYXRlKS5BZGREYXlzKCRkYXlzKS5Ub1N0cmluZygiZCIpIH0gfCBXaGVyZS1PYmplY3QgeyAkXy4nUGFzc3dvcmQgRXhwaXJlcycgLWVxICRUcnVlfQkJCgkJICAgICAgIGlmICgkT3VwdXQgLW5lICRudWxsKSB7CiAgICAgICAgICAgICAgICAkRXhlY3V0aW9uTG9nICs9ICRPdXB1dCB8IHNlbGVjdCAiQWNjb3VudCBOYW1lIiwgIlBhc3N3b3JkIEV4cGlyeSBEYXRlIiB8IGZsCgkgICAgICAgCSAgICAgICBXcml0ZS1PdXRwdXQgJEV4ZWN1dGlvbkxvZwogICAgICAgICAgICAgICAgICAgICAgIEV4aXQ7fQoJCSAgICAgICBlbHNlIHsKCQkJCSRFeGVjdXRpb25Mb2cgKz0gIlRoZXJlIGFyZSBubyB1c2VycyBvbiB0aGUgTWFjaGluZSB3aG9zZSBwYXNzb3dyZCB3aWxsIGJlIGdvaW5nIHRvIGJlIGV4cGlyZWQgc29vbiIKCQkJCVdyaXRlLU91dHB1dCAkZXhlY3V0aW9ubG9nCgkJCSAgICAgICAgZXhpdDt9CgkJICAgICAgIAkgICAgICAgfQp9CkNhdGNoIHsgCgkkRXhlY3V0aW9uTG9nICs9ICJOb3QgYWJsZSB0byByZWFjaCB0aGUgY29tcHV0ZXIgcmVtb3RseSB0aHJvdWdoIFdNSSIKCVdyaXRlLU91dHB1dCAkZXhlY3V0aW9ubG9nCiAgICAgICAgICAgICAgZXhpdDt9Cg==","jsonSchema":{"type":"object","properties":{"days":{"type":"integer","title":"No of Days","minLength":1}},"required":["days"],"additionalProperties": false},"uiSchema":{"days":{"ui:autofocus":true,"classNames":"col-sm-12"},"ui:order":["days"]},"isHDScript":false}
