{"id":"d45181d3-50a8-11e9-b550-00155d130b01","partnerId":"00000000-0000-0000-0000-000000000000","category":["Setup"],"description":"Create new Active Directory user","engine":"powershell","engineMaxVersion":5,"expectedExecutionTimeSec":300,"failureMessage":"Executed with errors","successMessage":"Excecuted Successfully","internal":false,"name":"Add Active Directory User","tags":["Windows 7","Windows 10"],"sequence":true,"content":"IyAkVXNlckxvZ29uTmFtZSA9ICdXaWxsLnNtaXRoJwojICRQYXNzd29yZCA9ICdUZXN0QDEyMycKIyAkRG9tYWluID0gJ3NjcmlwdGRjMS5sb2NhbCcKIyAkT3JnYW5pemF0aW9uYWxVbml0ID0gJ09VPVRlc3RPVSxEQz1zY3JpcHRkYzEsREM9bG9jYWwnCiMgJEdyb3VwID0gJ0VudGVycHJpc2UgQWRtaW5zJwojICRGaXJzdE5hbWUgPSAnV2lsbCcKIyAkSW5pdGlhbCA9ICdOUycKIyAkTGFzdE5hbWUgPSAnU21pdGgnCiMgJERpc3BsYXlOYW1lID0gJ1dpbGwgc21pdGgnCiMgJERlc2NyaXB0aW9uID0gJ1Bvd2VyU0hlbGwgRGV2ZWxvcGVyJwojICRUZWxlcGhvbmVOdW1iZXJzID0gJycKIyAkRU1haWwgPSAnV2lsbEBnbWFpbC5jb20nCiMgJFdlYlBhZ2UgPSAnaHR0cHM6Ly90ZWNobmV0Lm1pY3Jvc29mdC5jb20vZW4tZ2IvJwojICRTdHJlZXQgPSAnR2hhdGtvcGFyJwojICRQT0JveCA9ICcnCiMgJENpdHkgPSAnTmV3IERlbGhpJwojICRTdGF0ZSA9ICdNYWhhcmFzaHRyYScKIyAkWmlwID0gJzQwMDA1MicKIyAkQ291bnRyeSA9ICdJTicKIyAkUGhvbmUgPSAnMjIyMjIyMicKIyAkTW9iaWxlID0gJzg4MDA3NDQ1NTknCiMgJEZheCA9ICcnCiMgJElQUGhvbmUgPSAnMTIzMTIzMTIzMTIzJwojICROb3RlcyA9ICd0ZXN0IG5vdGUnCiMgJEpvYnRpdGxlID0gJ1RlY2ggU3VwcG9ydCcKIyAkRGVwYXJ0bWVudCA9ICdHUlQnCiMgJENvbXBhbnkgPSAnQ29udGludXVtJwoKaWYgKCRlbnY6UFJPQ0VTU09SX0FSQ0hJVEVXNjQzMiAtZXEgIkFNRDY0IikgewogICAgaWYgKCRteUludm9jYXRpb24uTGluZSkgewogICAgICAgICYiJGVudjpzeXN0ZW1yb290XHN5c25hdGl2ZVx3aW5kb3dzcG93ZXJzaGVsbFx2MS4wXHBvd2Vyc2hlbGwuZXhlIiAtTm9uSW50ZXJhY3RpdmUgLU5vUHJvZmlsZSAkbXlJbnZvY2F0aW9uLkxpbmUKICAgIH0KICAgIGVsc2UgewogICAgICAgICYiJGVudjpzeXN0ZW1yb290XHN5c25hdGl2ZVx3aW5kb3dzcG93ZXJzaGVsbFx2MS4wXHBvd2Vyc2hlbGwuZXhlIiAtTm9uSW50ZXJhY3RpdmUgLU5vUHJvZmlsZSAtZmlsZSAiJCgkbXlJbnZvY2F0aW9uLkludm9jYXRpb25OYW1lKSIgJGFyZ3MKICAgIH0KICAgIGV4aXQgJGxhc3RleGl0Y29kZQp9Cgp0cnl7CgokRXJyb3JBY3Rpb25QcmVmZXJlbmNlID0gJ1N0b3AnCgppZighKEdldC1Nb2R1bGUgLU5hbWUgIkFjdGl2ZURpcmVjdG9yeSIpKXsKICAgIGlmKCEoSW1wb3J0LU1vZHVsZSBBY3RpdmVEaXJlY3RvcnkgLVBhc3NUaHJ1KSl7CiAgICAgICAgV3JpdGUtRXJyb3IgIlVuYWJsZSB0byBpbXBvcnQgdGhlIG1vZHVsZSBbQWN0aXZlRGlyZWN0b3J5XSIKICAgIH0KfQoKaWYoKEdldC1XbWlPYmplY3QgLUNsYXNzIFdpbjMyX09wZXJhdGluZ1N5c3RlbSkucHJvZHVjdHR5cGUgLW5lIDIpewogICAgV3JpdGUtT3V0cHV0ICJgblNjcmlwdCBjYW4gb25seSBydW4gb24gRG9tYWluIGNvbnRyb2xsZXJzLCBubyBhY3Rpb24gaXMgcGVyZm9ybWVkLiIKICAgIGV4aXQKfQoKI3JlZ2lvbiB2ZXJpZnktdGhlLXVzZXItYXJndW1lbnRzCmlmICgtbm90IChHZXQtQUREb21haW4gLUlkZW50aXR5ICREb21haW4pKSB7CiAgICBXcml0ZS1FcnJvciAiVW5hYmxlIHRvIGNvbnRhY3QgdGhlIERvbWFpbiBbJERvbWFpbl0sIHBsZWFzZSB2ZXJpZnkgdGhlIGNvbm5lY3RpdnR5IHRvIEFjdGl2ZSBEaXJlY3RvcnkuIgp9CmlmIChHZXQtQURVc2VyIC1GaWx0ZXIgIk5hbWUgLWVxICckVXNlckxvZ29uTmFtZSciKSB7CiAgICBXcml0ZS1FcnJvciAiVGhlIFVzZXIgTG9nb24gTmFtZSBbJFVzZXJMb2dvbk5hbWVdIGlzIG5vdCBhdmFpbGFibGUsIGFuZCBhbHJlYWR5IGV4aXN0cy4gUGxlYXNlIHRyeSBhZ2FpbiB3aXRoIGEgZGlmZmVyZW50IE5hbWUuIgp9CmlmICgtbm90IChHZXQtQURPcmdhbml6YXRpb25hbFVuaXQgLUZpbHRlciAiRGlzdGluZ3Vpc2hlZE5hbWUgLWVxICckT3JnYW5pemF0aW9uYWxVbml0JyIpKSB7CiAgICBXcml0ZS1FcnJvciAiVGhlIHVzZXIgT3JnYW5pemF0aW9uYWwgVW5pdCBbJCgkT3JnYW5pemF0aW9uYWxVbml0KV0gZG9lcyBub3QgZXhpc3QuIENhbid0IGFkZCBhIHVzZXIgdGhlcmUuIiAgICAKfQppZiAoLW5vdCAoR2V0LUFER3JvdXAgLUZpbHRlciAiTmFtZSAtZXEgJyRHcm91cCciKSkgewogICAgV3JpdGUtRXJyb3IgIlRoZSBncm91cCBbJCgkRGVwYXJ0bWVudCldIGRvZXMgbm90IGV4aXN0LiBDYW4ndCBhZGQgdGhlIHVzZXIgdG8gdGhpcyBncm91cC4iICAgIAp9CiNlbmRyZWdpb24gdmVyaWZ5LXRoZS11c2VyLWFyZ3VtZW50cwoKI3JlZ2lvbiBidWlsZC1hdHRyaWJ1dGVzLWZvci1zcGxhdHRpbmcKJEF0dHJpYnV0ZXMgPSBAeyAgCiAgICBFbmFibGVkICAgICAgICAgICA9ICR0cnVlIAogICAgU0FNQWNjb3VudE5hbWUgICAgPSAkVXNlckxvZ29uTmFtZQogICAgdXNlclByaW5jaXBhbE5hbWUgPSAkVXNlckxvZ29uTmFtZQogICAgQWNjb3VudFBhc3N3b3JkICAgPSAkUGFzc3dvcmQgfCBDb252ZXJ0VG8tU2VjdXJlU3RyaW5nIC1Bc1BsYWluVGV4dCAtRm9yY2UKICAgIFNlcnZlciAgICAgICAgICAgID0gJERvbWFpbgogICAgUGF0aCAgICAgICAgICAgICAgPSAkT3JnYW5pemF0aW9uYWxVbml0CiAgICBHaXZlbk5hbWUgICAgICAgICA9ICRGaXJzdE5hbWUKICAgIEluaXRpYWxzICAgICAgICAgID0gJEluaXRpYWwKICAgIFN1ck5hbWUgICAgICAgICAgID0gJExhc3ROYW1lCiAgICBOYW1lICAgICAgICAgICAgICA9ICQoaWYoJERpc3BsYXlOYW1lKXskRGlzcGxheU5hbWV9ZWxzZXsiJEZpcnN0TmFtZSAkTGFzdE5hbWUiLnRyaW0oKX0pCiAgICBEZXNjcmlwdGlvbiAgICAgICA9ICREZXNjcmlwdGlvbgogICAgT2ZmaWNlICAgICAgICAgICAgPSAkb2ZmaWNlCiAgICBFbWFpbEFkZHJlc3MgICAgICA9ICRFTWFpbAogICAgSG9tZVBhZ2UgICAgICAgICAgPSAkV2ViUGFnZQogICAgU3RyZWV0QWRkcmVzcyAgICAgPSAkU3RyZWV0CiAgICBQT0JveCAgICAgICAgICAgICA9ICRQT0JveAogICAgQ2l0eSAgICAgICAgICAgICAgPSAkQ2l0eQogICAgU3RhdGUgICAgICAgICAgICAgPSAkU3RhdGUKICAgIFBvc3RhbENvZGUgICAgICAgID0gJFppcCAKICAgIENvdW50cnkgICAgICAgICAgID0gJENvdW50cnkKICAgIEhvbWVQaG9uZSAgICAgICAgID0gJFBob25lCiAgICBNb2JpbGVQaG9uZSAgICAgICA9ICRNb2JpbGUKICAgIEZheCAgICAgICAgICAgICAgID0gJEZheAogICAgT2ZmaWNlUGhvbmUgICAgICAgPSAkVGVsZXBob25lTnVtYmVycwogICAgVGl0bGUgICAgICAgICAgICAgPSAkSm9idGl0bGUKICAgIERlcGFydG1lbnQgICAgICAgID0gJERlcGFydG1lbnQKICAgIENvbXBhbnkgICAgICAgICAgID0gJENvbXBhbnkKfQojZW5kcmVnaW9uIGJ1aWxkLWF0dHJpYnV0ZXMtZm9yLXNwbGF0dGluZwoKJHVzZXIgPSBOZXctQURVc2VyIEBBdHRyaWJ1dGVzIC1QYXNzVGhydQoKaWYgKCR1c2VyKSB7CiAgICBpZiAoJEdyb3VwKSB7CiAgICAgICAgQWRkLUFER3JvdXBNZW1iZXIgLUlkZW50aXR5ICRHcm91cCAtTWVtYmVycyAkVXNlci5TYW1BY2NvdW50TmFtZQogICAgfQogICAgaWYgKCROb3RlcykgewogICAgICAgIFNldC1BRFVzZXIgJFVzZXIuU2FtQWNjb3VudE5hbWUgLVJlcGxhY2UgQHtpbmZvID0gJE5vdGVzfQogICAgfQogICAgaWYgKCRJUFBob25lKSB7CiAgICAgICAgU2V0LUFEVXNlciAkVXNlci5TYW1BY2NvdW50TmFtZSAtUmVwbGFjZSBAe0lQUGhvbmUgPSAkSVBQaG9uZX0KICAgIH0gCiAgIFdyaXRlLU91dHB1dCAiYG5OZXcgQWN0aXZlIERpcmVjdG9yeSB1c2VyIFskKCR1c2VyLlVzZXJQcmluY2lwYWxOYW1lKV0gYWRkZWQgc3VjZXNzZnVseS4iCn0KCn0KY2F0Y2h7CiAgICBXcml0ZS1PdXRwdXQgImBuRmFpbGVkIHRvIGFkZCBuZXcgQWN0aXZlIERpcmVjdG9yeSB1c2VyIFskKCR1c2VyLlVzZXJQcmluY2lwYWxOYW1lKV0uIgogICAgV3JpdGUtRXJyb3IgJF8KfQo=","jsonSchema":{"type":"object","properties":{"UserLogonName":{"title":"User Logon Name","type":"string"},"password":{"type":"string","title":"Password"},"passwordConfirmation":{"type":"string","title":"Password Confirmation"},"Domain":{"title":"Domain Name","type":"string"},"OrganizationalUnit":{"title":"Organizational Unit","type":"string"},"Group":{"title":"Group Name","type":"string"},"FirstName":{"title":"First Name","type":"string"},"Initial":{"title":"Initial","type":"string"},"LastName":{"title":"Last Name","type":"string"},"DisplayName":{"title":"Display Name","type":"string"},"Description":{"title":"Description","type":"string"},"TelephoneNumbers":{"title":"Telephone Numbers","type":"string"},"EMail":{"title":"Email","type":"string","format":"email"},"WebPage":{"title":"Web Page","type":"string","format":"uri"},"Street":{"title":"Street","type":"string"},"POBox":{"title":"PO. Box","type":"string"},"City":{"title":"City","type":"string"},"State":{"title":"State","type":"string"},"Zip":{"title":"Zip Code","type":"integer"},"Country":{"title":"Country Name","type":"string","enum":["AF","AX","AL","DZ","AS","AD","AO","AI","AQ","AG","AR","AM","AW","AU","AT","AZ","BS","BH","BD","BB","BY","BE","BZ","BJ","BM","BT","BO","BA","BW","BV","BR","IO","BN","BG","BF","BI","KH","CM","CA","CV","KY","CF","TD","CL","CN","CX","CC","CO","KM","CG","CD","CK","CR","CI","HR","CU","CY","CZ","DK","DJ","DM","DO","EC","EG","SV","GQ","ER","EE","ET","EU","FK","FO","FJ","FI","FR","GF","PF","TF","GA","GM","GE","DE","GH","GI","GR","GL","GD","GP","GU","GT","GN","GW","GY","HT","HM","HN","HK","HU","IS","IN","ID","IR","IQ","IE","IL","IT","JM","JP","JO","KZ","KE","KI","KR","KP","KW","KG","LA","LV","LB","LS","LR","LY","LI","LT","LU","MO","MK","MG","MW","MY","MV","ML","MT","MH","MQ","MR","MU","YT","MX","FM","MD","MC","MN","MS","MA","MZ","MM","NA","NR","NP","NL","AN","NC","NZ","NI","NE","NG","NU","NF","MP","NO","OM","PK","PW","PS","PA","PG","PY","PE","PH","PN","PL","PT","PR","QA","RE","RO","RU","RW","SH","KN","LC","VC","PM","WS","SM","ST","SA","SN","CS","SC","SL","SG","SK","SI","SB","SO","ZA","GS","ES","LK","SD","SR","SJ","SZ","SE","CH","SY","TW","TJ","TZ","TH","TL","TG","TK","TO","TT","TN","TR","TM","TC","TV","UG","UA","AE","GB","US","UM","UY","UZ","VU","VA","VE","VN","VG","VI","WF","EH","YE","ZM","ZW"],"enumNames":["Afghanistan","Aland Islands","Albania","Algeria","American Samoa","Andorra","Angola","Anguilla","Antarctica","Antigua and Barbuda","Argentina","Armenia","Aruba","Australia","Austria","Azerbaijan","Bahamas","Bahrain","Bangladesh","Barbados","Belarus","Belgium","Belize","Benin","Bermuda","Bhutan","Bolivia","Bosnia and Herzegovina","Botswana","Bouvet Island","Brazil","British Indian Ocean Territory","Brunei Darussalam","Bulgaria","Burkina Faso","Burundi","Cambodia","Cameroon","Canada","Cape Verde","Cayman Islands","Central African Republic","Chad","Chile","China","Christmas Island","Cocos (Keeling) Islands","Colombia","Comoros","Congo Republic of the","Congo The Democratic Republic Of The","Cook Islands","Costa Rica","CÃ´te d'Ivoire","Croatia","Cuba","Cyprus","Czech Republic","Denmark","Djibouti","Dominica","Dominican Republic","Ecuador","Egypt","El Salvador","Equatorial Guinea","Eritrea","Estonia","Ethiopia","European Union","Falkland Islands","Faroe Islands","Fiji","Finland","France","French Guiana","French Polynesia","French Southern Territories","Gabon","Gambia","Georgia","Germany","Ghana","Gibraltar","Greece","Greenland","Grenada","Guadeloupe","Guam","Guatemala","Guinea","Guinea-Bissau","Guyana","Haiti","Heard Island and McDonald Islands","Honduras","Hong Kong","Hungary","Iceland","India","Indonesia","Iran Islamic Republic of","Iraq","Ireland","Israel","Italy","Jamaica","Japan","Jordan","Kazakhstan","Kenya","Kiribati","Korea","Korea Democratic People's Republic of","Kuwait","Kyrgyzstan","Lao People's Democratic Republic","Latvia","Lebanon","Lesotho","Liberia","Libyan Arab Jamahiriya","Liechtenstein","Lithuania","Luxembourg","Macao","Macedonia The Former Yugoslav Republic of","Madagascar","Malawi","Malaysia","Maldives","Mali","Malta","Marshall Islands","Martinique","Mauritania","Mauritius","Mayotte","Mexico","Micronesia, Federated States of","Moldova, Republic of","Monaco","Mongolia","Montserrat","Morocco","Mozambique","Myanmar","Namibia","Nauru","Nepal","Netherlands","Netherlands Antilles","New Caledonia","New Zealand","Nicaragua","Niger","Nigeria","Niue","Norfolk Island","Northern Mariana Islands","Norway","Oman","Pakistan","Palau","Palestinian Territory, Occupied","Panama","Papua New Guinea","Paraguay","Peru","Philippines","Pitcairn","Poland","Portugal","Puerto Rico","Qatar","Reunion","Romania","Russia","Rwanda","Saint Helena","Saint Kitts and Nevis","Saint Lucia","Saint Vincent and the Grenadines","Saint-Pierre and Miquelon","Samoa","San Marino","SÃ£o TomÃ© and PrÃ­ncipe","Saudi Arabia","Senegal","Serbia and Montenegro","Seychelles","Sierra Leone","Singapore","Slovakia","Slovenia","Solomon Islands","Somalia","South Africa","South Georgia and the South Sandwich Islands","Spain","Sri Lanka","Sudan","Suriname","Svalbard and Jan Mayen","Swaziland","Sweden","Switzerland","Syrian Arab Republic","Taiwan (Republic of China)","Tajikistan","Tanzania, United Republic Of","Thailand","Timor-Leste","Togo","Tokelau","Tonga","Trinidad and Tobago","Tunisia","Turkey","Turkmenistan","Turks and Caicos Islands","Tuvalu","Uganda","Ukraine","United Arab Emirates","United Kingdom","United States","United States Minor Outlying Islands","Uruguay","Uzbekistan","Vanuatu","Vatican City State","Venezuela","Viet Nam","Virgin Islands, British","Virgin Islands, U.S.","Wallis and Futuna","Western Sahara","Yemen","Zambia","Zimbabwe"]},"Phone":{"type":"string","title":"Phone"},"Mobile":{"type":"integer","title":"Mobile"},"Fax":{"type":"integer","title":"Fax"},"IPPhone":{"type":"integer","title":"IP Phone"},"Notes":{"type":"string","title":"Notes"},"Jobtitle":{"type":"string","title":"Job Title"},"Department":{"type":"string","title":"Department"},"Company":{"type":"string","title":"Company"}},"required":["UserLogonName","password","passwordConfirmation","Domain","OrganizationalUnit","FirstName"],"additionalproperties":false},"uiSchema":{"UserLogonName":{"classNames":"col-sm-6 col-sm-offset-right-6","ui:autofocus":true},"password":{"ui:widget":"password","ui:help":"Hint: Make it strong!","classNames":"col-sm-6","validationSchema":{"fields":["password","passwordConfirmation"],"type":"shouldBeEqual"}},"passwordConfirmation":{"ui:widget":"password","ui:help":"Input password one more time","classNames":"col-sm-6"},"Domain":{"classNames":"col-sm-6","ui:autofocus":true},"OrganizationalUnit":{"classNames":"col-sm-6","ui:autofocus":true},"Group":{"classNames":"col-sm-6 col-sm-offset-right-6","ui:autofocus":true},"FirstName":{"classNames":"col-sm-6","ui:autofocus":true},"Initial":{"classNames":"col-sm-2","ui:autofocus":true},"LastName":{"classNames":"col-sm-4","ui:autofocus":true},"DisplayName":{"classNames":"col-sm-6 col-sm-offset-right-8","ui:autofocus":true},"Description":{"classNames":"col-sm-12","ui:autofocus":true},"TelephoneNumbers":{"classNames":"col-sm-6","ui:autofocus":true},"EMail":{"classNames":"col-sm-6 col-sm-offset-right-3","ui:autofocus":true},"WebPage":{"classNames":"col-sm-6","ui:autofocus":true},"Street":{"classNames":"col-sm-6","ui:autofocus":true},"POBox":{"classNames":"col-sm-6","ui:autofocus":true},"City":{"classNames":"col-sm-6","ui:autofocus":true},"State":{"classNames":"col-sm-6","ui:autofocus":true},"Zip":{"classNames":"col-sm-6","ui:autofocus":true},"Country":{"classNames":"col-sm-6","ui:autofocus":true},"Phone":{"classNames":"col-sm-6","ui:autofocus":true},"Mobile":{"classNames":"col-sm-6","ui:autofocus":true},"Fax":{"classNames":"col-sm-6","ui:autofocus":true},"IPPhone":{"classNames":"col-sm-4","ui:autofocus":true},"Notes":{"classNames":"col-sm-8","ui:autofocus":true},"Jobtitle":{"classNames":"col-sm-4","ui:autofocus":true},"Department":{"classNames":"col-sm-4","ui:autofocus":true},"Company":{"classNames":"col-sm-4","ui:autofocus":true},"ui:order":["UserLogonName","password","passwordConfirmation","Domain","OrganizationalUnit","FirstName","LastName","Initial","Group","DisplayName","Description","EMail","WebPage","TelephoneNumbers","Street","POBox","City","State","Zip","Country","Phone","Mobile","Fax","IPPhone","Notes","Jobtitle","Department","Company"]},"isHDScript":false}
