{"id":"bac8383e-44ed-11e9-b4f7-00155d130b01","partnerId":"00000000-0000-0000-0000-000000000000","category":["Data Collection"],"description":"Retrieves Exchange mailbox size","engine":"powershell","engineMaxVersion":5,"expectedExecutionTimeSec":300,"failureMessage":"Executed with errors","successMessage":"Excecution success","internal":false,"name":"Retrieve Exchange mailbox size","tags":["Windows 7","Windows 10"],"sequence":true,"content":"CjwjCiAgICAuU1lOT1BTSVMKICAgICAgIFJldHJpZXZlIEV4Y2hhbmdlIG1haWxib3ggc2l6ZQogICAgLkRFU0NSSVBUSU9OCiAgICAgICBSZXRyaWV2ZSBFeGNoYW5nZSBtYWlsYm94IHNpemUKICAgIC5BdXRob3IKICAgICAgIFNhbnRvc2guRGFrb2xpYUBjb250aW51dW0ubmV0CiM+CgoKaWYgKCRlbnY6UFJPQ0VTU09SX0FSQ0hJVEVXNjQzMiAtZXEgIkFNRDY0IikgewogICAgd3JpdGUtd2FybmluZyAiRXhjZWN1dGluZyB0aGUgc2NyaXB0IHVuZGVyIDY0IGJpdCBwb3dlcnNoZWxsIgogICAgaWYgKCRteUludm9jYXRpb24uTGluZSkgewogICAgICAgICYiJGVudjpzeXN0ZW1yb290XHN5c25hdGl2ZVx3aW5kb3dzcG93ZXJzaGVsbFx2MS4wXHBvd2Vyc2hlbGwuZXhlIiAtTm9uSW50ZXJhY3RpdmUgLU5vUHJvZmlsZSAkbXlJbnZvY2F0aW9uLkxpbmUKICAgIH1lbHNlewogICAgICAgICYiJGVudjpzeXN0ZW1yb290XHN5c25hdGl2ZVx3aW5kb3dzcG93ZXJzaGVsbFx2MS4wXHBvd2Vyc2hlbGwuZXhlIiAtTm9uSW50ZXJhY3RpdmUgLU5vUHJvZmlsZSAtZmlsZSAiJCgkbXlJbnZvY2F0aW9uLkludm9jYXRpb25OYW1lKSIgJGFyZ3MKICAgIH0KZXhpdCAkbGFzdGV4aXRjb2RlCn0KCiRQcm9kdWN0VHlwZSA9IChHZXQtV21pT2JqZWN0IC1DbGFzcyBXaW4zMl9PcGVyYXRpbmdTeXN0ZW0pLlByb2R1Y3RUeXBlIAokY29tcHV0ZXJuYW1lPSAkZW52OmNvbXB1dGVybmFtZQoKVHJ5ewoKICAgIElGKCRQcm9kdWN0VHlwZSAtZXEgMSl7IickY29tcHV0ZXJuYW1lJyBpcyBhIENsaWVudCBNYWNoaW5lIGhlbmNlIHVuYWJsZSB0byBmZXRjaCBJbmZvcm1hdGlvbiI7IGV4aXR9CiAgICBJRigkUHJvZHVjdFR5cGUgLWVxIDIgLW9yICRQcm9kdWN0VHlwZSAtZXEgMyl7Cgokd2FybmluZ3ByZWZlcmVuY2UgPSAiU2lsZW50bHlDb250aW51ZSIKJFNlcnZpY2UgPSBHZXQtU2VydmljZSAtTmFtZSBNU0V4Y2hhbmdlSVMgCiRTdGF1dHMgPSAkU2VydmljZS5TdGF0dXMKJEV4Y2gyMDA3ID0gQCgpCiRFeGNoMjAxMCA9IEAoKQoKICAgICAgICBJRighJFNlcnZpY2UpIHvigJxNU0V4Y2hhbmdlSVMgc2VydmljZSBub3QgZm91bmTigJ19CiAgICAgICAgSUYoKCRTZXJ2aWNlKSAtYW5kICgkU3RhdXRzIC1lcSAnc3RvcHBlZCcpKXsiTVNFeGNoYW5nZUlTIFNlcnZpY2UgaXMgTm90IFJ1bm5pbmcifQogICAgICAgIElGKCRTZXJ2aWNlIC1hbmQgJFN0YXV0cyAtZXEgJ3J1bm5pbmcnKSB7CgoKICAgIEFkZC1QU1NuYXBpbiAqRXhjaCogLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWUgCgogICAgJGRhdGEgPSBHZXQtTWFpbGJveCAtUmVzdWx0U2l6ZSB1bmxpbWl0ZWQgfCBHZXQtTWFpbGJveFN0YXRpc3RpY3MKCiAgICAkdmVyID0gKEdldC1FeGNoYW5nZVNlcnZlciAtSWRlbnRpdHkgJGVudjpDT01QVVRFUk5BTUUpLmFkbWluZGlzcGxheXZlcnNpb24ubWFqb3IKSUYoJHZlciAtZXEgOCl7CgogICAgRm9yRWFjaCgkTUIgaW4gJGRhdGEpewogICAgJFNpemVNID0gJE1CLlRvdGFsSXRlbXNpemUuVmFsdWUKICAgICAgICAgICAgSUYoJFNpemVNIC1nZSAxR0IpeyRTaXpldSA9ICJ7MDpOMn0gR0IiIC1mICgkTUIuVG90YWxJdGVtU2l6ZS5WYWx1ZS5Ub0dCKCkpIH0gCiAgICAgICAgICAgICAgICBlbHNlaWYoJFNpemVNIC1nZSAxTWIpIHskU2l6ZXUgPSAiezA6TjJ9IE1CIiAtZiAoJE1CLlRvdGFsSXRlbVNpemUuVmFsdWUuVG9NQigpKSAgfSAKICAgICAgICAgICAgICAgICAgICBlbHNlIHskU2l6ZXUgPSAiezA6TjJ9IEJZdGVzIiAtZiAoJE1CLlRvdGFsSXRlbVNpemUuVmFsdWUuVG9LQigpKX0gCiAgICAgICAgICAKICAgICAgICAkb3V0cHV0RGF0YSA9IE5ldy1PYmplY3QgLVR5cGVOYW1lIHBzb2JqZWN0IAogICAgICAgICRvdXRwdXREYXRhIHwgQWRkLU1lbWJlciAtTWVtYmVyVHlwZSBOb3RlUHJvcGVydHkgLU5hbWUgU2VydmVyTmFtZSAtVmFsdWUgJE1CLnNlcnZlcm5hbWUKICAgICAgICAkb3V0cHV0RGF0YSB8IEFkZC1NZW1iZXIgLU1lbWJlclR5cGUgTm90ZVByb3BlcnR5IC1OYW1lIFN0b3JhZ2VHcm91cCAtVmFsdWUgJE1CLlN0b3JhZ2VHcm91cE5hbWUKICAgICAgICAkb3V0cHV0RGF0YSB8IEFkZC1NZW1iZXIgLU1lbWJlclR5cGUgTm90ZVByb3BlcnR5IC1OYW1lIERhdGFiYXNlTmFtZSAtVmFsdWUgJE1CLkRhdGFiYXNlTmFtZQogICAgICAgICRvdXRwdXREYXRhIHwgQWRkLU1lbWJlciAtTWVtYmVyVHlwZSBOb3RlUHJvcGVydHkgLU5hbWUgTWFpbGJveERpc3BsYXlOYW1lIC1WYWx1ZSAkTUIuRGlzcGxheU5hbWUKICAgICAgICAkb3V0cHV0RGF0YSB8IEFkZC1NZW1iZXIgLU1lbWJlclR5cGUgTm90ZVByb3BlcnR5IC1OYW1lIFNpemUgLVZhbHVlICRTaXpldQogICAgICAgICRvdXRwdXREYXRhIHwgQWRkLU1lbWJlciAtTWVtYmVyVHlwZSBOb3RlUHJvcGVydHkgLU5hbWUgVG90YWxJdGVtcyAtVmFsdWUgJE1CLkl0ZW1jb3VudAogICAgICAgICRFeGNoMjAwNyArPSAkb3V0cHV0ZGF0YQogICAgICAgICAgICB9CiAgICAgICAgICAgJEV4Y2gyMDA3CiAgICAgICAgfQogICAgfQoKSUYoJFZlciAtZ2UgMTQpewogICAgRm9yRWFjaCgkTWFpbGJveCBpbiAkZGF0YSl7CiAgICAkU2l6ZU1CID0gJE1haWxib3guVG90YWxJdGVtc2l6ZS5WYWx1ZQogICAgICAgICAgICBJRigkU2l6ZU1CIC1nZSAxR0IpeyRTaXplV2l0aFVuaXQgPSAiezA6TjJ9IEdCIiAtZiAoJE1haWxib3guVG90YWxJdGVtU2l6ZS5WYWx1ZS5Ub0dCKCkpIH0gCiAgICAgICAgICAgICAgICBlbHNlaWYoJFNpemVNQiAtZ2UgMU1iKSB7JFNpemVXaXRoVW5pdCA9ICJ7MDpOMn0gTUIiIC1mICgkTWFpbGJveC5Ub3RhbEl0ZW1TaXplLlZhbHVlLlRvTUIoKSkgIH0gCiAgICAgICAgICAgICAgICAgICAgZWxzZSB7JFNpemVXaXRoVW5pdCA9ICJ7MDpOMn0gS0IiIC1mICgkTWFpbGJveC5Ub3RhbEl0ZW1TaXplLlZhbHVlLlRvS0IoKSl9IAoKICAgICAgICAkb3V0cHV0ID0gTmV3LU9iamVjdCAtVHlwZU5hbWUgcHNvYmplY3QgCiAgICAgICAgJG91dHB1dCB8IEFkZC1NZW1iZXIgLU1lbWJlclR5cGUgTm90ZVByb3BlcnR5IC1OYW1lIFNlcnZlck5hbWUgLVZhbHVlICRtYWlsYm94LnNlcnZlcm5hbWUKICAgICAgICAkb3V0cHV0IHwgQWRkLU1lbWJlciAtTWVtYmVyVHlwZSBOb3RlUHJvcGVydHkgLU5hbWUgRGF0YUJhc2VOYW1lIC1WYWx1ZSAkbWFpbGJveC5kYXRhYmFzZW5hbWUKICAgICAgICAkb3V0cHV0IHwgQWRkLU1lbWJlciAtTWVtYmVyVHlwZSBOb3RlUHJvcGVydHkgLU5hbWUgTWFpbGJveERpc3BsYXlOYW1lIC1WYWx1ZSAkbWFpbGJveC5EaXNwbGF5TmFtZQogICAgICAgICRvdXRwdXQgfCBBZGQtTWVtYmVyIC1NZW1iZXJUeXBlIE5vdGVQcm9wZXJ0eSAtTmFtZSBTaXplIC1WYWx1ZSAkU2l6ZVdpdGhVbml0CiAgICAgICAgJG91dHB1dCB8IEFkZC1NZW1iZXIgLU1lbWJlclR5cGUgTm90ZVByb3BlcnR5IC1OYW1lIFRvdGFsSXRlbXMgLVZhbHVlICRtYWlsYm94Lkl0ZW1jb3VudAogICAgICAgICRFeGNoMjAxMCArPSAkb3V0cHV0CiAgICAgICAgICAgIH0KICAgICAgICAgICAkRXhjaDIwMTAKICAgICAgICB9CiAgICB9Cn0KQ2F0Y2h7CgogICAgV3JpdGUtRXJyb3IgIkVycm9yIG9jY3VyZWQgd2hpbGUgcmV0cmlldmluZyBEYXRhLi4hISAkXy5FeGNlcHRpb24uTWVzc2FnZSIKfQo=","jsonSchema":"","uiSchema":"","isHDScript":false}
