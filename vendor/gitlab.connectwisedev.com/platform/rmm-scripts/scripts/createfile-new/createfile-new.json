{"id":"2f150836-4381-11ea-98d5-00155d130b01","partnerId":"00000000-0000-0000-0000-000000000000","category":["Setup"],"description":"Create a file on end client desktops and servers. Creation of any Image (.jpeg, .jpg, .png, .bmp), Excel (.xls, .xlsx, .ods) file(s) are not supported through this script.","engine":"powershell","engineMaxVersion":5,"expectedExecutionTimeSec":300,"failureMessage":"Executed with errors","successMessage":"Executed successfully","internal":false,"name":"Create file (new)","tags":["Windows 7","Windows 10"],"sequence":true,"content":"aWYgKCRlbnY6UFJPQ0VTU09SX0FSQ0hJVEVXNjQzMiAtZXEgIkFNRDY0IikgewogICAgaWYgKCRteUludm9jYXRpb24uTGluZSkgewogICAgICAgICYiJGVudjpzeXN0ZW1yb290XHN5c25hdGl2ZVx3aW5kb3dzcG93ZXJzaGVsbFx2MS4wXHBvd2Vyc2hlbGwuZXhlIiAtTm9uSW50ZXJhY3RpdmUgLU5vUHJvZmlsZSAkbXlJbnZvY2F0aW9uLkxpbmUKICAgIH0KICAgIGVsc2UgewogICAgICAgICYiJGVudjpzeXN0ZW1yb290XHN5c25hdGl2ZVx3aW5kb3dzcG93ZXJzaGVsbFx2MS4wXHBvd2Vyc2hlbGwuZXhlIiAtTm9uSW50ZXJhY3RpdmUgLU5vUHJvZmlsZSAtZmlsZSAiJCgkbXlJbnZvY2F0aW9uLkludm9jYXRpb25OYW1lKSIgJGFyZ3MKICAgIH0KICAgIGV4aXQgJGxhc3RleGl0Y29kZQp9CgojIyMjIyMjIyMjIyMjIyMjIyMjI3ZhbGlkYXRpbmcgaW5wdXQgcGF0aCMjIyMjIyMjIyMjIyMjIyMjIyMjCmlmICgoVGVzdC1wYXRoICROZXdGaWxlTG9jYXRpb24pIC1hbmQgKCEkT3ZlcndyaXRlRXhpc3RpbmdGaWxlKSkgewogICAgV3JpdGUtRXJyb3IgIkZpbGUgbmFtZSBwcm92aWRlZCBpcyBhbHJlYWR5IGV4aXN0LiIKICAgIEV4aXQ7Cn0KCmlmICgoJEZpbGVDb250ZW50cykgLWFuZCAoKCRGaWxlQ29udGVudHMuTGVuZ3RoIC1ndCAxMDI0MDAwICkpKSB7CiAgICBXcml0ZS1FcnJvciAiRmlsZSBDb250ZW50cyBtb3JlIHRoYW4gMSBNQiBpcyBub3QgYWxsb3dlZCIKICAgIEV4aXQKfSAKCiR0ZXN0cGF0aCA9IFNwbGl0LVBhdGggLVBhdGggJE5ld0ZpbGVMb2NhdGlvbiAtUGFyZW50CmlmICghKHRlc3QtcGF0aCAkdGVzdHBhdGgpIC1hbmQgKCRDcmVhdGVEaXJlY3RvcnlJZlJlcXVpcmVkKSkgewogICAgJG5ld3Rlc3RwYXRoID0gU3BsaXQtUGF0aCAtUGF0aCAkdGVzdHBhdGggLVBhcmVudAogICAgaWYgKCEoVGVzdC1QYXRoICRuZXd0ZXN0cGF0aCkpIHsKICAgICAgICBXcml0ZS1FcnJvciAiUGF0aCBwcm92aWRlZCBpcyBpbmNvcnJlY3QiCiAgICAgICAgRXhpdDsKICAgIH0KICAgIGVsc2UgewogICAgICAgIE5ldy1JdGVtIC1JdGVtVHlwZSBEaXJlY3RvcnkgLVBhdGggKHNwbGl0LXBhdGggJHRlc3RwYXRoIC1wYXJlbnQpIC1OYW1lIChzcGxpdC1wYXRoICR0ZXN0cGF0aCAtTGVhZikgfCBPdXQtTnVsbAogICAgICAgIGlmICghKFRlc3QtUGF0aCAkdGVzdHBhdGgpKSB7CiAgICAgICAgICAgIFdyaXRlLWVycm9yICJGYWlsZWQgdG8gY3JlYXRlIGZvbGRlciIKICAgICAgICAgICAgRXhpdAogICAgICAgIH0KICAgIH0KfQplbHNlaWYgKCEodGVzdC1wYXRoICR0ZXN0cGF0aCkpIHsKICAgIFdyaXRlLUVycm9yICJQYXRoIHByb3ZpZGVkIGlzIGluY29ycmVjdCIKICAgIEV4aXQ7Cn0KCiRuYW1lID0gU3BsaXQtUGF0aCAkTmV3RmlsZUxvY2F0aW9uIC1MZWFmCgp0cnkgewogICAgTmV3LUl0ZW0gLXBhdGggKFNwbGl0LVBhdGggJE5ld0ZpbGVMb2NhdGlvbiAtUGFyZW50KSAtTmFtZSAkbmFtZSAtSXRlbVR5cGUgRmlsZSAtVmFsdWUgJEZpbGVDb250ZW50cyAgLUZvcmNlIC1FcnJvckFjdGlvbiBTdG9wIHwgT3V0LU51bGwKICAgIGlmICggKFRlc3QtUGF0aCAkTmV3RmlsZUxvY2F0aW9uKSAtQW5kICgtbm90ICRGaWxlQ29udGVudHMpKSB7CiAgICAgICAgV3JpdGUtT3V0cHV0ICJGaWxlIGNvbnRlbnQgd2FzIG5vdCBwcm92aWRlZCBoZW5jZSBlbXB0eSBmaWxlIGlzIGNyZWF0ZWQgc3VjY2Vzc2Z1bGx5LmBuJE5ld0ZpbGVMb2NhdGlvbiIKICAgICAgICBFeGl0CiAgICB9CiAgICBFbHNlaWYgKCAoVGVzdC1QYXRoICROZXdGaWxlTG9jYXRpb24pIC1BbmQgKCRGaWxlQ29udGVudHMpKXsKICAgICAgIFdyaXRlLU91dHB1dCAiRmlsZSBjcmVhdGVkIHN1Y2Nlc3NmdWxseS5gbiROZXdGaWxlTG9jYXRpb24iCiAgICAgICAgIEV4aXQKICAgIH0KfQpjYXRjaCB7CiAgICBXcml0ZS1FcnJvciAiRmFpbGVkIHRvIGNyZWF0ZSB0aGUgZmlsZWBuLiAkXy5FeGNlcHRpb24uTWVzc2FnZSIgCiAgICBFeGl0Cn0gICAgCg==","jsonSchema":{"properties":{"CreateDirectoryIfRequired":{"title":"Create directory if required","type":"boolean"},"FileContents":{"title":"File Contents","type":"string"},"NewFileLocation":{"title":"New File Location","type":"string"},"OverwriteExistingFile":{"title":"Overwrite existing file","type":"boolean"}},"required":["NewFileLocation"],"type":"object"},"uiSchema":{"CreateDirectoryIfRequired":{"classNames":"col-sm-12"},"FileContents":{"classNames":"col-sm-8","ui:autofocus":true,"ui:description":"The contents to be added in the file. Maximum size allowed is 1 MB.","ui:widget":"textarea"},"NewFileLocation":{"classNames":"col-sm-6"},"OverwriteExistingFile":{"classNames":"col-sm-12"},"ui:order":["NewFileLocation","OverwriteExistingFile","CreateDirectoryIfRequired","FileContents"]},"isHDScript":false}
