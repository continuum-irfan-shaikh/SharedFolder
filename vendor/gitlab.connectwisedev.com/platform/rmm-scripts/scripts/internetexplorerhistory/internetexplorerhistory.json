{"id":"b7b16807-3131-11e9-b99f-00155d130b17","partnerId":"00000000-0000-0000-0000-000000000000","category":["Data Collection"],"description":"Script to capture IE History from all user profiles on a workstation or a server.","engine":"powershell","engineMaxVersion":5,"expectedExecutionTimeSec":300,"failureMessage":"Executed with errors","successMessage":"Script executed successfully","internal":false,"name":"Retrieve Internet Explorer history","tags":["Windows 7","Windows 10"],"sequence":true,"content":"PCMKU2NyaXB0IHRvIGNhcHR1cmUgSUUgSGlzdG9yeSBmcm9tIGFsbCB1c2VyIHByb2ZpbGVzIG9uIGEgd29ya3N0YXRpb24gb3IgYSBzZXJ2ZXIuCiM+Cgp0cnkgewogICAgJEVycm9yQWN0aW9uUHJlZmVyZW5jZSA9ICdzdG9wJwogICAgJFNoZWxsID0gTmV3LU9iamVjdCAtQ29tT2JqZWN0IFNoZWxsLkFwcGxpY2F0aW9uCiAgICAkVXNlclBhdGhzID0gR2V0LVdtaU9iamVjdCB3aW4zMl91c2VycHJvZmlsZSB8IFdoZXJlLU9iamVjdCB7ICRfLnNpZCAtbGlrZSAiUy0xLTUtMjEqIn18IFNlbGVjdC1PYmplY3QgLUV4cGFuZFByb3BlcnR5IGxvY2FscGF0aAogICAgJGNvbXB1dGVyID0gJGVudjpDT01QVVRFUk5BTUUKfQpjYXRjaCB7CiAgICBXcml0ZS1FcnJvciAkXwp9CgojIHNvbWV0aW1lcyBuYW1lc3BhY2UgaXMgbm90IGFibGUgdG8gb3BlbiB0aGUgZm9sZGVyLCAnU2lsZW50bHlDb250aW51ZScgdG8gc2tpcCB0aG9zZSBlcnJvcnMKIyBhbmQgY2FwdHVyZSBJRSBoaXN0b3J5IGZyb20gcmVtYWluaW5nIHVzZXIgcHJvZmlsZXMKJEVycm9yQWN0aW9uUHJlZmVyZW5jZSA9ICdTaWxlbnRseUNvbnRpbnVlJyAKRm9yRWFjaCAoJFVzZXJQYXRoIGluICRVc2VyUGF0aHMpIHsKICAgICRJRUhpc3RvcnkgPSAkU2hlbGwuTmFtZVNwYWNlKCIkVXNlclBhdGhcQXBwRGF0YVxMb2NhbFxNaWNyb3NvZnRcV2luZG93c1xIaXN0b3J5IikKICAgIGlmICgkSUVIaXN0b3J5KSB7CiAgICAgICAgIyBuZXN0ZWQgbG9vcHMgdG8gaXRlcmF0ZSB0aHJvdWdoIG5lc3RlZCBoaXN0b3J5IGZvbGRlciBoaWVyYXJjaHkgICAgICAgIAogICAgICAgIEZvcmVhY2ggKCRJdGVtIGluICRJRUhpc3RvcnkuSXRlbXMoKSkgewogICAgICAgICAgICBGb3JlYWNoICgkV2ViU2l0ZUl0ZW0gaW4gJEl0ZW0uR2V0Rm9sZGVyLkl0ZW1zKCkpIHsKICAgICAgICAgICAgICAgIElmICgkV2ViU2l0ZUl0ZW0uSXNGb2xkZXIpIHsKICAgICAgICAgICAgICAgICAgICAkU2l0ZUZvbGRlciA9ICRXZWJTaXRlSXRlbS5HZXRGb2xkZXIKICAgICAgICAgICAgICAgICAgICBGb3JFYWNoICgkU2l0ZSBpbiAkU2l0ZUZvbGRlci5JdGVtcygpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICRUaXRsZSA9ICQoJFNpdGVGb2xkZXIuR2V0RGV0YWlsc09mKCRTaXRlLCAxKSkKICAgICAgICAgICAgICAgICAgICAgICAgJFVSTCA9ICQoJFNpdGVGb2xkZXIuR2V0RGV0YWlsc09mKCRTaXRlLCAwKSkKICAgICAgICAgICAgICAgICAgICAgICAgJERhdGUgPSAkKCRTaXRlRm9sZGVyLkdldERldGFpbHNPZigkU2l0ZSwgMikpCiAgICAgICAgICAgICAgICAgICAgICAgICR1c2VybmFtZSA9IChTcGxpdC1QYXRoICRVc2VyUGF0aCAtTGVhZikKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRVcmwgLWxpa2UgImh0dHAqIikgeyAjIHRvIGV4Y2x1ZGUgZmlsZSBwYXRocyBpbiBoaXN0b3J5IGZvbGRlciBhbmQgaW5jbHVkZSBVUkxzIHN0YXJ0aW5nIHdpdGggSFRUUCBvciBIVFRQUwogICAgICAgICAgICAgICAgICAgICAgICAgICAgV3JpdGUtT3V0cHV0ICJgbkNvbXB1dGVyICAgICA6ICRjb21wdXRlciIKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFdyaXRlLU91dHB1dCAiVXNlciAgICAgICAgIDogJChpZigkZW52OlVTRVJOQU1FIC1lcSAkdXNlcm5hbWUpeyIkdXNlcm5hbWUgKEN1cnJlbnQgbG9nZ2VkLW9uIFVzZXIpIn1lbHNleyR1c2VybmFtZX0pIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgV3JpdGUtT3V0cHV0ICJMYXN0IFZpc2l0ZWQgOiAkRGF0ZSIKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFdyaXRlLU91dHB1dCAiVVJMICAgICAgICAgIDogJFVSTCIKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KfQo=","jsonSchema":"","uiSchema":"","isHDScript":false}
