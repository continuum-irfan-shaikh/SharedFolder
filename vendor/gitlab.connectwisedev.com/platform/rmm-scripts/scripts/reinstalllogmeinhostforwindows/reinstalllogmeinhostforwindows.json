{"id":"ed6fb707-7247-11e9-a18f-00155d130b01","partnerId":"00000000-0000-0000-0000-000000000000","category":["Application"],"description":"Uninstalls existing version of LogMeIn from Windows desktops and servers and installs LogMeIn latest version.","engine":"powershell","engineMaxVersion":5,"expectedExecutionTimeSec":1800,"failureMessage":"Executed with errors","successMessage":"Excecuted successfully","internal":false,"name":"Reinstall LogMeIn Host Software for Windows","tags":["Windows 7","Windows 10"],"sequence":true,"content":"PCMKICAgIC5TWU5PUFNJUwogICAgICAgUmVpbnN0YWxsIExvZ01lSW4gSG9zdCBTb2Z0d2FyZQogICAgLkRFU0NSSVBUSU9OCiAgICAgICBSZWluc3RhbGwgTG9nTWVJbiBIb3N0IFNvZnR3YXJlCiAgICAuSGVscAogICAgICAgIFVzZSBtc2lleGVjLmV4ZQogICAgICAgIFVzZSBiZWxvdyBwYXRoIAogICAgICAgICNodHRwczovL3NlY3VyZS5sb2dtZWluLmNvbS9Mb2dNZUluLm1zaSAgIAogICAgLkF1dGhvcgogICAgICAgIER1cmdlc2hrdW1hciBQYXRlbAogICAgLlZlcnNpb24KICAgICAgICAxLjAKIz4KJGFjdGlvbiA9ICJyZWluc3RhbGwiCiNHZXQgUHJvZHVjdCBHVUlECiRSZWdpc3RyeSA9ICdIS0xNOlxTT0ZUV0FSRVxXb3c2NDMyTm9kZVxNaWNyb3NvZnRcV2luZG93c1xDdXJyZW50VmVyc2lvblxVbmluc3RhbGwnLCAnSEtMTTpcU09GVFdBUkVcTWljcm9zb2Z0XFdpbmRvd3NcQ3VycmVudFZlcnNpb25cVW5pbnN0YWxsJwoKJFByb2R1Y3QgPSBHZXQtQ2hpbGRJdGVtICRSZWdpc3RyeSAtRXJyb3JBY3Rpb24gJ1NpbGVudGx5Q29udGludWUnIHwgR2V0LUl0ZW1Qcm9wZXJ0eSB8IFdoZXJlLU9iamVjdCB7ICRfLkRpc3BsYXlOYW1lIC1tYXRjaCAiTG9nTWVJbiIgfSAKCiRQcm9kdWN0R1VJRCA9ICRQcm9kdWN0IHwgU2VsZWN0LU9iamVjdCAtRXhwYW5kUHJvcGVydHkgUFNDaGlsZE5hbWUgLUZpcnN0IDEKCiNHZXQgUHJvZHVjdCB0eXBlIGFuZCBzZXQgRGVwb3lJRAokUHJvZHVjdFR5cGUgPSAoR2V0LVdtaU9iamVjdCAtQ2xhc3MgV2luMzJfT3BlcmF0aW5nU3lzdGVtKS5wcm9kdWN0dHlwZSAKaWYgKCRQcm9kdWN0VHlwZSAtZXEgJzEnKSB7CiAgICAkRHBpZCA9ICJERVBMT1lJRD16dWFyMzJmNTRrZG55YWw2MmFidTBxbTVkMTM0Y2Q4MWlybThiYWE4Igp9CmVsc2UgewogICAgJERwaWQgPSAiREVQTE9ZSUQ9ODZ0MWc3cWtia21naDl2N3c4dGg4cjQ0bThrOGxmd3FieW5pZ296NSIKfQoKZnVuY3Rpb24gRG93bmxvYWRfRmlsZSgkcmVxdXJsLCAkZHBhdGgpIHsKICAgICRkbiA9IE5ldy1PYmplY3QgU3lzdGVtLk5ldC5XZWJDbGllbnQKICAgICRkbi5Eb3dubG9hZEZpbGUoIiRyZXF1cmwiLCAiJGRwYXRoIikKfQoKI0Rvd25sb2FkIExvZ01lSW4ubXNpIGZpbGUgaWYgcHJvZHVjdCBhdmFpbGFibGUKaWYgKCRQcm9kdWN0R1VJRCkgewogICAgJHVybCA9ICJodHRwczovL3NlY3VyZS5sb2dtZWluLmNvbS9Mb2dNZUluLm1zaSIKICAgICRkb3dubG9hZHBhdGggPSAiQzpcV2luZG93c1xUZW1wXExvZ01lSW4ubXNpIgogICAgRG93bmxvYWRfRmlsZSAtcmVxdXJsICR1cmwgLWRwYXRoICRkb3dubG9hZHBhdGgKfQoKVHJ5IHsgIAoKICAgIGlmICgkYWN0aW9uIC1lcSAicmVpbnN0YWxsIikgewoKICAgICAgICBpZiAoJFByb2R1Y3RHVUlEKSB7CiAgICAgICAgICAgIAogICAgICAgICAgICAjVW5pbnN0YWxsIExvZ01lSW4gUHJvY2VzcwogICAgICAgICAgICAkdW5pbnN0YWxsID0gU3RhcnQtUHJvY2VzcyAibXNpZXhlYy5leGUiIC1hcmcgIi9YICRQcm9kdWN0R1VJRCAvcXVpZXQiIC1XYWl0IC1QYXNzVGhydSAtRXJyb3JBY3Rpb24gJ1N0b3AnCiAgICAgICAgICAgIAogICAgICAgICAgICAjRXhpdENvZGUgZm9yIHVuaW5zdGFsbCBwcm9jZXNzCiAgICAgICAgICAgIElmICgoJHVuaW5zdGFsbC5leGl0Y29kZSAtZXEgJzMwMTAnKSAtb3IgKCR1bmluc3RhbGwuZXhpdGNvZGUgLWVxICcwJykpIHsKCiAgICAgICAgICAgICAgICBpZiAoVGVzdC1QYXRoICRkb3dubG9hZHBhdGgpIHsKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAjSW5zdGFsbCBMb2dNZUluIFByb2Nlc3MKICAgICAgICAgICAgICAgICAgICAkcHJvY2Vzc2luZm8gPSBOZXctb2JqZWN0IFN5c3RlbS5EaWFnbm9zdGljcy5Qcm9jZXNzU3RhcnRJbmZvCiAgICAgICAgICAgICAgICAgICAgJHByb2Nlc3NpbmZvLkNyZWF0ZU5vV2luZG93ID0gJHRydWUKICAgICAgICAgICAgICAgICAgICAkcHJvY2Vzc2luZm8uVXNlU2hlbGxFeGVjdXRlID0gJGZhbHNlCiAgICAgICAgICAgICAgICAgICAgJHByb2Nlc3NpbmZvLlJlZGlyZWN0U3RhbmRhcmRPdXRwdXQgPSAkdHJ1ZQogICAgICAgICAgICAgICAgICAgICRwcm9jZXNzaW5mby5SZWRpcmVjdFN0YW5kYXJkRXJyb3IgPSAkdHJ1ZQogICAgICAgICAgICAgICAgICAgICRwcm9jZXNzaW5mby5GaWxlTmFtZSA9ICJtc2lleGVjLmV4ZSIKICAgICAgICAgICAgICAgICAgICAkcHJvY2Vzc2luZm8uQXJndW1lbnRzID0gIi9xdWlldCAvaSAkZG93bmxvYWRwYXRoICREcGlkIgogICAgICAgICAgICAgICAgICAgICRwcm9jZXNzID0gTmV3LU9iamVjdCBTeXN0ZW0uRGlhZ25vc3RpY3MuUHJvY2VzcwogICAgICAgICAgICAgICAgICAgICRwcm9jZXNzLlN0YXJ0SW5mbyA9ICRwcm9jZXNzaW5mbwogICAgICAgICAgICAgICAgICAgIFt2b2lkXSRwcm9jZXNzLlN0YXJ0KCkKICAgICAgICAgICAgICAgICAgICAkcHJvY2Vzcy5XYWl0Rm9yRXhpdCgpCgogICAgICAgICAgICAgICAgICAgICNFeGl0Q29kZSBmb3IgaW5zdGFsbCBwcm9jZXNzCiAgICAgICAgICAgICAgICAgICAgSWYgKCgkcHJvY2Vzcy5leGl0Y29kZSAtZXEgJzMwMTAnKSAtb3IgKCRwcm9jZXNzLmV4aXRjb2RlIC1lcSAnMCcpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICBEb3dubG9hZF9GaWxlIC1yZXF1cmwgImh0dHA6Ly91cGRhdGUuaXRzdXBwb3J0MjQ3Lm5ldC9sbWkvbnVtaG9zdGlkd3AuZXhlIiAtZHBhdGggIkM6XFdpbmRvd3NcVGVtcFxudW1ob3N0aWR3cC5leGUiCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChUZXN0LVBhdGggIkM6XFdpbmRvd3NcVGVtcFxudW1ob3N0aWR3cC5leGUiKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBTdGFydC1Qcm9jZXNzICJDOlxXaW5kb3dzXFRlbXBcbnVtaG9zdGlkd3AuZXhlIiAtV2FpdCAtUGFzc1RocnUgLUVycm9yQWN0aW9uICdTdG9wJyB8IE91dC1OdWxsCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgIFdyaXRlLU91dHB1dCAiTG9nTWVJbiBIb3N0IHNvZnR3YXJlIHJlaW5zdGFsbGVkIHN1Y2Nlc3NmdWxseSBvbiBzeXN0ZW0gJEVOVjpDT01QVVRFUk5BTUUiICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgV3JpdGUtT3V0cHV0ICJMb2dNZUluIEhvc3Qgc29mdHdhcmUgcmVpbnN0YWxsYXRpb24gZmFpbGVkIG9uIHN5c3RlbSAkRU5WOkNPTVBVVEVSTkFNRSIKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBXcml0ZS1PdXRwdXQgIkRvd25sb2FkIEZhaWxlZCBmb3IgTG9nTWVJbiBIb3N0IHNvZnR3YXJlLiBLaW5kbHkgZXhlY3V0ZSBzY3JpcHQgYWdhaW4iCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICBXcml0ZS1PdXRwdXQgIkxvZ01lSW4gSG9zdCBzb2Z0d2FyZSBVbmluc3RhbGxhdGlvbiBmYWlsZWQgb24gc3lzdGVtICRFTlY6Q09NUFVURVJOQU1FIgogICAgICAgICAgICB9CiAgICAgICAgfSAgICAgICAKICAgICAgICBlbHNlIHsKICAgICAgICAgICAgV3JpdGUtT3V0cHV0ICJMb2dNZUluIEhvc3Qgc29mdHdhcmUgbm90IGluc3RhbGxlZCBvbiB0aGlzIHN5c3RlbSAkRU5WOkNPTVBVVEVSTkFNRSIKICAgICAgICB9CiAgICB9CiAgICBlbHNlIHsKICAgICAgICBXcml0ZS1PdXRwdXQgIktpbmRseSBzZWxlY3QgYWN0aW9uIGFzIHJlaW5zdGFsbCIKICAgIH0KfQpjYXRjaCB7CiAgICBXcml0ZS1FcnJvciAkXy5FeGNlcHRpb24uTWVzc2FnZQp9Cg==","jsonSchema":"","uiSchema":"","isHDScript":false}
