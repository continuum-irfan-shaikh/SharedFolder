{"id":"9825ef05-557c-4990-9dc8-ac3063878b14","partnerId":"00000000-0000-0000-0000-000000000000","category":["Security"],"description":"Adds trusted sites to Internet Explorer security settings","engine":"powershell","engineMaxVersion":5,"expectedExecutionTimeSec":300,"failureMessage":"Executed with errors","successMessage":"The trusted site(s) was successfully added to the machine","internal":false,"name":"Add trusted sites","tags":["Windows 7","Windows 10"],"sequence":true,"content":"JHVybHNBcnIgPSBAKCkKJHVybHNBcnIgPSAkdXJscyAtc3BsaXQgImBuIgokem9uZSA9IDIgIyBPcHRpb25zIGFyZSAxIChMb2NhbCBJbnRyYW5ldCksIDIgKFRydXN0ZWQgU2l0ZXMpLCAzIChJbnRlcm5ldCksIGFuZCA0IChSZXN0cmljdGVkIFNpdGVzKQokcmVna2V5ID0gIkhLTE06XFNvZnR3YXJlXFBvbGljaWVzXE1pY3Jvc29mdFxXaW5kb3dzXEN1cnJlbnRWZXJzaW9uXEludGVybmV0IFNldHRpbmdzXFpvbmVNYXBcRG9tYWlucyIKZnVuY3Rpb24gaXNTZXR0aW5nRXhpc3RzIHsKICAgIFBhcmFtKCRyZWdpc3RyeVBhdGgsICRuYW1lKQogICAgaWYgKFRlc3QtUGF0aCAkcmVnaXN0cnlQYXRoIC1QYXRoVHlwZSBjb250YWluZXIpIHsKICAgICAgICAka2V5ID0gR2V0LUl0ZW0gLUxpdGVyYWxQYXRoICRyZWdpc3RyeVBhdGgKICAgICAgICBpZiAoJGtleS5HZXRWYWx1ZSgkbmFtZSwgJG51bGwpIC1uZSAkbnVsbCkgewogICAgICAgICAgICByZXR1cm4gJHRydWUKICAgICAgICB9CiAgICB9CiAgICByZXR1cm4gJGZhbHNlCn0KRm9yICgkaSA9IDA7ICRpIC1sdCAkdXJsc0Fyci5MZW5ndGg7ICRpKyspIHsKICAgICAgICAKICAgIHRyeSB7CiAgICAgICAgJEVycm9yQWN0aW9uUHJlZmVyZW5jZSA9ICdTdG9wJwogICAgICAgICR1cmkgPSBbc3lzdGVtLnVyaV0oJHVybHNBcnJbJGldKS5yZXBsYWNlKCI6Ly8qLiIsICI6Ly8iKSAKICAgICAgICAkc2NoZW1lID0gKCR1cmkpLlNjaGVtZQogICAgICAgICRkb21haW5uYW1lID0gKCR1cmkpLmhvc3QgLXJlcGxhY2UgJ153d3dcLicKICAgICAgICAkZG9tYWluUmVnUGF0aCA9ICIkcmVna2V5XCRkb21haW5uYW1lIgogICAgICAgIAogICAgICAgIGlmIChUZXN0LVBhdGggJGRvbWFpblJlZ1BhdGggLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWUpIHsKICAgICAgICAgICAgaWYgKC1ub3QgKGlzU2V0dGluZ0V4aXN0cyAtcmVnaXN0cnlQYXRoICRkb21haW5SZWdQYXRoIC1uYW1lICRzY2hlbWUpKSB7CiAgICAgICAgICAgICAgICBOZXctSXRlbVByb3BlcnR5IC1QYXRoICRkb21haW5SZWdQYXRoIC1OYW1lICRzY2hlbWUgLVZhbHVlICR6b25lIC1Qcm9wZXJ0eVR5cGUgIkRXb3JkIiA+JG51bGwKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgIFNldC1JdGVtUHJvcGVydHkgLVBhdGggJGRvbWFpblJlZ1BhdGggLU5hbWUgJHNjaGVtZSAtVmFsdWUgJHpvbmUgPiRudWxsCiAgICAgICAgICAgIH0KICAgICAgICAgICAgV3JpdGUtT3V0cHV0ICJgbiBEb21haW4gJGRvbWFpbm5hbWUgaW4gdGhlIGxpc3Qgb2YgdHJ1c3RlZCBzaXRlcyB3YXMgdXBkYXRlZC4iCiAgICAgICAgfQogICAgICAgIGVsc2UgewogICAgICAgICAgICBOZXctSXRlbSAtUGF0aCAkZG9tYWluUmVnUGF0aCAtRm9yY2UgPiRudWxsCiAgICAgICAgICAgIE5ldy1JdGVtUHJvcGVydHkgLVBhdGggJGRvbWFpblJlZ1BhdGggLU5hbWUgJHNjaGVtZSAtVmFsdWUgJHpvbmUgLVByb3BlcnR5VHlwZSAiRFdvcmQiID4kbnVsbAogICAgICAgICAgICBXcml0ZS1PdXRwdXQgImBuIERvbWFpbiAkZG9tYWlubmFtZSB3YXMgYWRkZWQgdG8gdGhlIGxpc3Qgb2YgdHJ1c3RlZCBzaXRlcy4iCiAgICAgICAgfQogICAgICAgIAogICAgfSAKICAgIGNhdGNoIHsgCiAgICAgICAgV3JpdGUtT3V0cHV0ICAiYG4gJyQoJHVybHNBcnJbJGldKScgaXMgSW52YWxpZCBVUkwuIEtpbmRseSBwcm92aWRlIGNvcnJlY3QgVVJMIiAKICAgIH0KfSAK","jsonSchema":{"additionalProperties":false,"properties":{"urls":{"title":"URLs","type":"string"}},"required":["urls"],"type":"object"},"uiSchema":{"urls":{"classNames":"col-sm-12","convertToCommaSeparated":true,"ui:autofocus":true,"ui:help":"Input URLs (including protocols) separated by new line","ui:options":{"rows":15},"ui:widget":"textarea","validationSchema":{"type":"areValidURLsSeparatedByNewLine","urls":"urls"}}},"isHDScript":false}
