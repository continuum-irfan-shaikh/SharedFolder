{"id":"c6bde4ed-4a5d-11e9-8b6f-00155d130b01","partnerId":"00000000-0000-0000-0000-000000000000","category":["Security"],"description":"Configure User Access Control","engine":"powershell","engineMaxVersion":5,"expectedExecutionTimeSec":300,"failureMessage":"Executed with errors","successMessage":"Excecution success","internal":false,"name":"Configure User Access Control","tags":["Windows 7","Windows 10"],"sequence":true,"content":"PCMKICR1YWNTZXR0aW5ncyA9ICAkRGVmYXVsdE5vdGlmeS8kQ29uZGl0aW9uYWxOb3RpZnkvJEFsd2F5c05vdGlmeS8kTmV2ZXJOb3RpZnkKIz4KaWYgKCRlbnY6UFJPQ0VTU09SX0FSQ0hJVEVXNjQzMiAtZXEgIkFNRDY0IikgewogICAgd3JpdGUtd2FybmluZyAiRXhjZWN1dGluZyB0aGUgc2NyaXB0IHVuZGVyIDY0IGJpdCBwb3dlcnNoZWxsIgogICAgaWYgKCRteUludm9jYXRpb24uTGluZSkgewogICAgICAgICYiJGVudjpzeXN0ZW1yb290XHN5c25hdGl2ZVx3aW5kb3dzcG93ZXJzaGVsbFx2MS4wXHBvd2Vyc2hlbGwuZXhlIiAtTm9uSW50ZXJhY3RpdmUgLU5vUHJvZmlsZSAkbXlJbnZvY2F0aW9uLkxpbmUKICAgIH1lbHNlewogICAgICAgICYiJGVudjpzeXN0ZW1yb290XHN5c25hdGl2ZVx3aW5kb3dzcG93ZXJzaGVsbFx2MS4wXHBvd2Vyc2hlbGwuZXhlIiAtTm9uSW50ZXJhY3RpdmUgLU5vUHJvZmlsZSAtZmlsZSAiJCgkbXlJbnZvY2F0aW9uLkludm9jYXRpb25OYW1lKSIgJGFyZ3MKICAgIH0KZXhpdCAkbGFzdGV4aXRjb2RlCn0KCiRleGVjdXRpb25sb2cgPSBAKCkKaWYoJHVhY1NldHRpbmdzIC1lcSAiRGVmYXVsdE5vdGlmeSIpIHsKJGxldmVsMSA9ICJEaXNhYmxlZCIKJGxldmVsMiA9ICJEaXNhYmxlZCIKJGxldmVsMyA9ICJFbmFibGVkIgokbGV2ZWw0ID0gIkRpc2FibGVkIn0gZWxzZWlmICgkdWFjU2V0dGluZ3MgLWVxICJDb25kaXRpb25hbE5vdGlmeSIpIHsKJGxldmVsMSA9ICJEaXNhYmxlZCIKJGxldmVsMiA9ICJFbmFibGVkIgokbGV2ZWwzID0gIkRpc2FibGVkIgokbGV2ZWw0ID0gIkRpc2FibGVkIn0gZWxzZWlmICgkdWFjU2V0dGluZ3MgLWVxICJBbHdheXNOb3RpZnkiKSB7CiRsZXZlbDEgPSAiRGlzYWJsZWQiCiRsZXZlbDIgPSAiRGlzYWJsZWQiCiRsZXZlbDMgPSAiRGlzYWJsZWQiCiRsZXZlbDQgPSAiRW5hYmxlZCJ9IGVsc2VpZiAoJHVhY1NldHRpbmdzIC1lcSAiTmV2ZXJOb3RpZnkiKSB7CiRsZXZlbDEgPSAiRW5hYmxlZCIKJGxldmVsMiA9ICJEaXNhYmxlZCIKJGxldmVsMyA9ICJEaXNhYmxlZCIKJGxldmVsNCA9ICJEaXNhYmxlZCJ9CnRyeSB7CgogICAgJENvbXA9Z2V0LXdtaW9iamVjdCB3aW4zMl9jb21wdXRlcnN5c3RlbQogICAgJGNvbXB1dGVyID0gJGNvbXAubmFtZSA7ICREb21haW5OYW1lZSA9ICRjb21wLmRvbWFpbgogICAgJEV4ZWN1dGlvbkxvZyArPSAiQ29tcHV0ZXJOYW1lIDogJGNvbXB1dGVyIgogICAgJEV4ZWN1dGlvbkxvZyArPSAiRG9tYWluL1dvcmtncm91cCA6ICREb21haW5OYW1lZSIKICAgICRwYXRoID0gIkhLTE06XFNvZnR3YXJlXE1pY3Jvc29mdFxXaW5kb3dzXEN1cnJlbnRWZXJzaW9uXFBvbGljaWVzXFN5c3RlbSIKCiAgIGlmKCRsZXZlbDEgLWVxICJFbmFibGVkIikKICAgICAgICB7CiAgICAgICAgdHJ5CiAgICAgICAgewogICAgICAgIFNldC1JdGVtUHJvcGVydHkgLVBhdGggJHBhdGggLU5hbWUgIkZpbHRlckFkbWluaXN0cmF0b3JUb2tlbiIgLVZhbHVlIDAKICAgICAgICBTZXQtSXRlbVByb3BlcnR5IC1QYXRoICRwYXRoIC1OYW1lICJFbmFibGVVSUFEZXNrdG9wVG9nZ2xlIiAtVmFsdWUgMAogICAgICAgIFNldC1JdGVtUHJvcGVydHkgLVBhdGggJHBhdGggLU5hbWUgIkNvbnNlbnRQcm9tcHRCZWhhdmlvckFkbWluIiAtVmFsdWUgMAogICAgICAgIFNldC1JdGVtUHJvcGVydHkgLVBhdGggJHBhdGggLU5hbWUgIkNvbnNlbnRQcm9tcHRCZWhhdmlvclVzZXIiIC1WYWx1ZSAzCiAgICAgICAgU2V0LUl0ZW1Qcm9wZXJ0eSAtUGF0aCAkcGF0aCAtTmFtZSAiRW5hYmxlSW5zdGFsbGVyRGV0ZWN0aW9uIiAtVmFsdWUgMQogICAgICAgIFNldC1JdGVtUHJvcGVydHkgLVBhdGggJHBhdGggLU5hbWUgIlZhbGlkYXRlQWRtaW5Db2RlU2lnbmF0dXJlcyIgLVZhbHVlIDAKICAgICAgICBTZXQtSXRlbVByb3BlcnR5IC1QYXRoICRwYXRoIC1OYW1lICJFbmFibGVTZWN1cmVVSUFQYXRocyIgLVZhbHVlIDEKICAgICAgICBTZXQtSXRlbVByb3BlcnR5IC1QYXRoICRwYXRoIC1OYW1lICJFbmFibGVMVUEiIC1WYWx1ZSAwCiAgICAgICAgU2V0LUl0ZW1Qcm9wZXJ0eSAtUGF0aCAkcGF0aCAtTmFtZSAiUHJvbXB0T25TZWN1cmVEZXNrdG9wIiAtVmFsdWUgMAogICAgICAgIFNldC1JdGVtUHJvcGVydHkgLVBhdGggJHBhdGggLU5hbWUgIkVuYWJsZVZpcnR1YWxpemF0aW9uIiAtVmFsdWUgMQogICAgICAgICRleGVjdXRpb25sb2cgKz0gIlRoZSBVQUMgc2V0dGluZ3Mgc3VjY2Vzc2Z1bGx5IGNoYW5nZWQgdG8gJHVhY1NldHRpbmdzLCBwbGVhc2UgcmVzdGFydCB0aGUgY29tcHV0ZXIgaW4gb3JkZXIgdG8gYXBwbHkgdGhlIGNoYW5nZXMgb24gdGhlIHN5c3RlbSIKICAgICAgICBXcml0ZS1PdXRwdXQgJGV4ZWN1dGlvbmxvZwogICAgICAgIGV4aXQ7CiAgICAgICAgfQogICAgICAgIENhdGNoCiAgICAgICAgewogICAgICAgICRleGVjdXRpb25sb2cgKz0gIk5vdCBhYmxlIHRvIGZpbmQgdGhlIHJldXFpcmVkIHByb3BlcnRpZXMgdG8gY2hhbmdlIHRoZSBVQUMgU2V0dGluZ3Mgb24gdGhlIHN5c3RlbSwgUGxlYXNlIGNvbnRhY3QgdGhlIEFkbWluaXN0YXJ0b3IgVGVhbSBmb3IgdGhlIHNhbWUuIgogICAgICAgIFdyaXRlLU91dHB1dCAkZXhlY3V0aW9ubG9nCiAgICAgICAgZXhpdDsKICAgICAgICB9CiAgICB9CiAgIGVsc2VpZigkbGV2ZWwyIC1lcSAiRW5hYmxlZCIpCiAgICAgICAgewogICAgICAgIHRyeQogICAgICAgIHsKICAgICAgICBTZXQtSXRlbVByb3BlcnR5IC1QYXRoICRwYXRoIC1OYW1lICJGaWx0ZXJBZG1pbmlzdHJhdG9yVG9rZW4iIC1WYWx1ZSAwCiAgICAgICAgU2V0LUl0ZW1Qcm9wZXJ0eSAtUGF0aCAkcGF0aCAtTmFtZSAiRW5hYmxlVUlBRGVza3RvcFRvZ2dsZSIgLVZhbHVlIDAKICAgICAgICBTZXQtSXRlbVByb3BlcnR5IC1QYXRoICRwYXRoIC1OYW1lICJDb25zZW50UHJvbXB0QmVoYXZpb3JBZG1pbiIgLVZhbHVlIDUKICAgICAgICBTZXQtSXRlbVByb3BlcnR5IC1QYXRoICRwYXRoIC1OYW1lICJDb25zZW50UHJvbXB0QmVoYXZpb3JVc2VyIiAtVmFsdWUgMwogICAgICAgIFNldC1JdGVtUHJvcGVydHkgLVBhdGggJHBhdGggLU5hbWUgIkVuYWJsZUluc3RhbGxlckRldGVjdGlvbiIgLVZhbHVlIDEKICAgICAgICBTZXQtSXRlbVByb3BlcnR5IC1QYXRoICRwYXRoIC1OYW1lICJWYWxpZGF0ZUFkbWluQ29kZVNpZ25hdHVyZXMiIC1WYWx1ZSAwCiAgICAgICAgU2V0LUl0ZW1Qcm9wZXJ0eSAtUGF0aCAkcGF0aCAtTmFtZSAiRW5hYmxlU2VjdXJlVUlBUGF0aHMiIC1WYWx1ZSAxCiAgICAgICAgU2V0LUl0ZW1Qcm9wZXJ0eSAtUGF0aCAkcGF0aCAtTmFtZSAiRW5hYmxlTFVBIiAtVmFsdWUgMQogICAgICAgIFNldC1JdGVtUHJvcGVydHkgLVBhdGggJHBhdGggLU5hbWUgIlByb21wdE9uU2VjdXJlRGVza3RvcCIgLVZhbHVlIDAKICAgICAgICBTZXQtSXRlbVByb3BlcnR5IC1QYXRoICRwYXRoIC1OYW1lICJFbmFibGVWaXJ0dWFsaXphdGlvbiIgLVZhbHVlIDEKICAgICAgICAkZXhlY3V0aW9ubG9nICs9ICJUaGUgVUFDIHNldHRpbmdzIHN1Y2Nlc3NmdWxseSBjaGFuZ2VkIHRvICR1YWNTZXR0aW5ncywgcGxlYXNlIHJlc3RhcnQgdGhlIGNvbXB1dGVyIGluIG9yZGVyIHRvIGFwcGx5IHRoZSBjaGFuZ2VzIG9uIHRoZSBzeXN0ZW0iCiAgICAgICAgV3JpdGUtT3V0cHV0ICRleGVjdXRpb25sb2cKICAgICAgICBleGl0OwogICAgICAgIH0KICAgICAgICBDYXRjaAogICAgICAgIHsKICAgICAgICAkZXhlY3V0aW9ubG9nICs9ICJOb3QgYWJsZSB0byBmaW5kIHRoZSByZXVxaXJlZCBwcm9wZXJ0aWVzIHRvIGNoYW5nZSB0aGUgVUFDIFNldHRpbmdzIG9uIHRoZSBzeXN0ZW0sIFBsZWFzZSBjb250YWN0IHRoZSBBZG1pbmlzdGFydG9yIFRlYW0gZm9yIHRoZSBzYW1lLiIKICAgICAgICBXcml0ZS1PdXRwdXQgJGV4ZWN1dGlvbmxvZwogICAgICAgIGV4aXQ7CiAgICAgICAgfQogICAgICAgIH0KICAgZWxzZWlmKCRsZXZlbDMgLWVxICJFbmFibGVkIikKICAgICAgICB7CiAgICAgICAgdHJ5CiAgICAgICAgewogICAgICAgIFNldC1JdGVtUHJvcGVydHkgLVBhdGggJHBhdGggLU5hbWUgIkZpbHRlckFkbWluaXN0cmF0b3JUb2tlbiIgLVZhbHVlIDAKICAgICAgICBTZXQtSXRlbVByb3BlcnR5IC1QYXRoICRwYXRoIC1OYW1lICJFbmFibGVVSUFEZXNrdG9wVG9nZ2xlIiAtVmFsdWUgMAogICAgICAgIFNldC1JdGVtUHJvcGVydHkgLVBhdGggJHBhdGggLU5hbWUgIkNvbnNlbnRQcm9tcHRCZWhhdmlvckFkbWluIiAtVmFsdWUgNQogICAgICAgIFNldC1JdGVtUHJvcGVydHkgLVBhdGggJHBhdGggLU5hbWUgIkNvbnNlbnRQcm9tcHRCZWhhdmlvclVzZXIiIC1WYWx1ZSAzCiAgICAgICAgU2V0LUl0ZW1Qcm9wZXJ0eSAtUGF0aCAkcGF0aCAtTmFtZSAiRW5hYmxlSW5zdGFsbGVyRGV0ZWN0aW9uIiAtVmFsdWUgMQogICAgICAgIFNldC1JdGVtUHJvcGVydHkgLVBhdGggJHBhdGggLU5hbWUgIlZhbGlkYXRlQWRtaW5Db2RlU2lnbmF0dXJlcyIgLVZhbHVlIDAKICAgICAgICBTZXQtSXRlbVByb3BlcnR5IC1QYXRoICRwYXRoIC1OYW1lICJFbmFibGVTZWN1cmVVSUFQYXRocyIgLVZhbHVlIDEKICAgICAgICBTZXQtSXRlbVByb3BlcnR5IC1QYXRoICRwYXRoIC1OYW1lICJFbmFibGVMVUEiIC1WYWx1ZSAxCiAgICAgICAgU2V0LUl0ZW1Qcm9wZXJ0eSAtUGF0aCAkcGF0aCAtTmFtZSAiUHJvbXB0T25TZWN1cmVEZXNrdG9wIiAtVmFsdWUgMQogICAgICAgIFNldC1JdGVtUHJvcGVydHkgLVBhdGggJHBhdGggLU5hbWUgIkVuYWJsZVZpcnR1YWxpemF0aW9uIiAtVmFsdWUgMQogICAgICAgICRleGVjdXRpb25sb2cgKz0gIlRoZSBVQUMgc2V0dGluZ3Mgc3VjY2Vzc2Z1bGx5IGNoYW5nZWQgdG8gJHVhY1NldHRpbmdzLCBwbGVhc2UgcmVzdGFydCB0aGUgY29tcHV0ZXIgaW4gb3JkZXIgdG8gYXBwbHkgdGhlIGNoYW5nZXMgb24gdGhlIHN5c3RlbSIKICAgICAgICBXcml0ZS1PdXRwdXQgJGV4ZWN1dGlvbmxvZwogICAgICAgIGV4aXQ7CiAgICAgICAgfQogICAgICAgIENhdGNoCiAgICAgICAgewogICAgICAgICRleGVjdXRpb25sb2cgKz0gIk5vdCBhYmxlIHRvIGZpbmQgdGhlIHJldXFpcmVkIHByb3BlcnRpZXMgdG8gY2hhbmdlIHRoZSBVQUMgU2V0dGluZ3Mgb24gdGhlIHN5c3RlbSwgUGxlYXNlIGNvbnRhY3QgdGhlIEFkbWluaXN0YXJ0b3IgVGVhbSBmb3IgdGhlIHNhbWUuIgogICAgICAgIFdyaXRlLU91dHB1dCAkZXhlY3V0aW9ubG9nCiAgICAgICAgZXhpdDsKICAgICAgICB9CiAgICAgICAgfQogICBlbHNlaWYoJGxldmVsNCAtZXEgIkVuYWJsZWQiKQogICAgICAgIHsKICAgICAgICB0cnkKICAgICAgICB7CiAgICAgICAgU2V0LUl0ZW1Qcm9wZXJ0eSAtUGF0aCAkcGF0aCAtTmFtZSAiRmlsdGVyQWRtaW5pc3RyYXRvclRva2VuIiAtVmFsdWUgMAogICAgICAgIFNldC1JdGVtUHJvcGVydHkgLVBhdGggJHBhdGggLU5hbWUgIkVuYWJsZVVJQURlc2t0b3BUb2dnbGUiIC1WYWx1ZSAwCiAgICAgICAgU2V0LUl0ZW1Qcm9wZXJ0eSAtUGF0aCAkcGF0aCAtTmFtZSAiQ29uc2VudFByb21wdEJlaGF2aW9yQWRtaW4iIC1WYWx1ZSAyCiAgICAgICAgU2V0LUl0ZW1Qcm9wZXJ0eSAtUGF0aCAkcGF0aCAtTmFtZSAiQ29uc2VudFByb21wdEJlaGF2aW9yVXNlciIgLVZhbHVlIDMKICAgICAgICBTZXQtSXRlbVByb3BlcnR5IC1QYXRoICRwYXRoIC1OYW1lICJFbmFibGVJbnN0YWxsZXJEZXRlY3Rpb24iIC1WYWx1ZSAxCiAgICAgICAgU2V0LUl0ZW1Qcm9wZXJ0eSAtUGF0aCAkcGF0aCAtTmFtZSAiVmFsaWRhdGVBZG1pbkNvZGVTaWduYXR1cmVzIiAtVmFsdWUgMAogICAgICAgIFNldC1JdGVtUHJvcGVydHkgLVBhdGggJHBhdGggLU5hbWUgIkVuYWJsZVNlY3VyZVVJQVBhdGhzIiAtVmFsdWUgMQogICAgICAgIFNldC1JdGVtUHJvcGVydHkgLVBhdGggJHBhdGggLU5hbWUgIkVuYWJsZUxVQSIgLVZhbHVlIDEKICAgICAgICBTZXQtSXRlbVByb3BlcnR5IC1QYXRoICRwYXRoIC1OYW1lICJQcm9tcHRPblNlY3VyZURlc2t0b3AiIC1WYWx1ZSAxCiAgICAgICAgU2V0LUl0ZW1Qcm9wZXJ0eSAtUGF0aCAkcGF0aCAtTmFtZSAiRW5hYmxlVmlydHVhbGl6YXRpb24iIC1WYWx1ZSAxCiAgICAgICAgJGV4ZWN1dGlvbmxvZyArPSAiVGhlIFVBQyBzZXR0aW5ncyBzdWNjZXNzZnVsbHkgY2hhbmdlZCB0byAkdWFjU2V0dGluZ3MsIHBsZWFzZSByZXN0YXJ0IHRoZSBjb21wdXRlciBpbiBvcmRlciB0byBhcHBseSB0aGUgY2hhbmdlcyBvbiB0aGUgc3lzdGVtIgogICAgICAgIFdyaXRlLU91dHB1dCAkZXhlY3V0aW9ubG9nCiAgICAgICAgZXhpdDsKICAgICAgICB9CiAgICAgICAgQ2F0Y2gKICAgICAgICB7CiAgICAgICAgJGV4ZWN1dGlvbmxvZyArPSAiTm90IGFibGUgdG8gZmluZCB0aGUgcmV1cWlyZWQgcHJvcGVydGllcyB0byBjaGFuZ2UgdGhlIFVBQyBTZXR0aW5ncyBvbiB0aGUgc3lzdGVtLCBQbGVhc2UgY29udGFjdCB0aGUgQWRtaW5pc3RhcnRvciBUZWFtIGZvciB0aGUgc2FtZS4iCiAgICAgICAgV3JpdGUtT3V0cHV0ICRleGVjdXRpb25sb2cKICAgICAgICBleGl0OwogICAgICAgIH0KICAgICAgICB9Cn0KQ2F0Y2ggewogICAgICAgICRFeGVjdXRpb25Mb2cgKz0gIk5vdCBhYmxlIHRvIHJlYWNoIHRoZSBjb21wdXRlciByZW1vdGx5IHRocm91Z2ggV01JIgogICAgICAgIFdyaXRlLU91dHB1dCAkZXhlY3V0aW9ubG9nCiAgICAgICAgICAgICAgZXhpdDt9Cgo=","jsonSchema":{"properties":{"uacSettings":{"enum":["DefaultNotify","ConditionalNotify","AlwaysNotify","NeverNotify"],"enumNames":["Default Notify","Conditional Notify","Always Notify","Never Notify"],"title":"Select UAC Settings","type":"string"}},"title":" User Account Control (UAC) settings","type":"object"},"uiSchema":{"uacSettings":{"classNames":"col-sm-4","ui:option":{"inline":false},"ui:widget":"radio"}},"isHDScript":false}