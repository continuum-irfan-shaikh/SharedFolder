{"id":"fd321328-77fc-11e9-a4e6-00155d130b01","partnerId":"00000000-0000-0000-0000-000000000000","category":["Setup"],"description":"Add Network printers to machine.","engine":"powershell","engineMaxVersion":5,"expectedExecutionTimeSec":600,"failureMessage":"Executed with errors","successMessage":"Excecuted Successfully","internal":false,"name":"Map network printer","tags":["Windows 7","Windows 10"],"sequence":true,"content":"IyAkYWN0aW9uID0gIkNvbm5lY3QiICMgU1RSSU5HCiMgIyR0eXBlID0gJ1RDUC9JUCcgIyBTVFJJTkcKIyAkdHlwZSA9ICdTaGFyZWQnICMgU1RSSU5HCiMgIyRQcmludGVyU2hhcmUgPSAiXFwxMC4yLjE5LjExNlxteSBIUCBQcmludGVyIgojICRQcmludGVyU2hhcmUgPSAiXFwxMC4yLjE5LjEwXEhQUHJpbnRlciIgIyBTVFJJTkcKIyAkRGVmYXVsdCA9ICR0cnVlICMgQk9PTEVBTgojICR1c2VybmFtZSA9ICJHcnRkY1xwcmF0ZWVrIiAjIFNUUklORwojICRwYXNzd29yZCA9ICJJbmRpYUAxMjM0IiAjIFNUUklORwoKCmlmICgkZW52OlBST0NFU1NPUl9BUkNISVRFVzY0MzIgLWVxICJBTUQ2NCIpIHsKICAgIGlmICgkbXlJbnZvY2F0aW9uLkxpbmUpIHsKICAgICAgICAmIiRlbnY6c3lzdGVtcm9vdFxzeXNuYXRpdmVcd2luZG93c3Bvd2Vyc2hlbGxcdjEuMFxwb3dlcnNoZWxsLmV4ZSIgLU5vbkludGVyYWN0aXZlIC1Ob1Byb2ZpbGUgJG15SW52b2NhdGlvbi5MaW5lCiAgICB9CiAgICBlbHNlIHsKICAgICAgICAmIiRlbnY6c3lzdGVtcm9vdFxzeXNuYXRpdmVcd2luZG93c3Bvd2Vyc2hlbGxcdjEuMFxwb3dlcnNoZWxsLmV4ZSIgLU5vbkludGVyYWN0aXZlIC1Ob1Byb2ZpbGUgLWZpbGUgIiQoJG15SW52b2NhdGlvbi5JbnZvY2F0aW9uTmFtZSkiICRhcmdzCiAgICB9CiAgICBleGl0ICRsYXN0ZXhpdGNvZGUKfQoKCiRFcnJvckFjdGlvblByZWZlcmVuY2UgPSAnU3RvcCcKJFVSSSA9IFt1cmldICRQcmludGVyU2hhcmUKaWYgKCRVUkkuSXNVbmMpIHsKICAgICRTaGFyZU5hbWUgPSAkVVJJLmFic29sdXRlcGF0aCAtcmVwbGFjZSAnLycsICcnCn0KCmZ1bmN0aW9uIENvbm5lY3RQcmludGVyIHsKICAgIHRyeSB7CiAgICAgICAgaWYgKCR1c2VybmFtZSAtYW5kICRwYXNzd29yZCkgewogICAgICAgICAgICBuZXQgdXNlICRQcmludGVyU2hhcmUgL1VTRVI6JHVzZXJuYW1lICRwYXNzd29yZCAvcGVyc2lzdGVudDpubwogICAgICAgIH0KICAgICAgICAkbmV0ID0gTmV3LU9iamVjdCAtQ29tT2JqZWN0IFdTY3JpcHQuTmV0d29yawogICAgICAgICRuZXQuQWRkV2luZG93c1ByaW50ZXJDb25uZWN0aW9uKCIkUHJpbnRlclNoYXJlIikgfCBPdXQtTnVsbAoKICAgICAgICBpZiAoJGRlZmF1bHQpIHsKICAgICAgICAgICAgJG5ldC5TZXREZWZhdWx0UHJpbnRlcigkUHJpbnRlclNoYXJlKQogICAgICAgIH0KCiAgICAgICAgJG9iaiA9IE5ldy1PYmplY3QgUFNPYmplY3QgLVByb3BlcnR5IEB7CiAgICAgICAgICAgICdpc1ByaW50ZXJNYXBwZWQnID0gaWYgKChMaXN0UHJpbnRlcnMpLlNoYXJlTmFtZSAtY29udGFpbnMgJFNoYXJlTmFtZSkgeyAkVHJ1ZSB9ZWxzZSB7ICRmYWxzZSB9CiAgICAgICAgICAgICdzZXRUb0RlZmF1bHQnICAgID0gaWYgKEdldC1XbWlPYmplY3QgV2luMzJfUHJpbnRlciB8IFdoZXJlLU9iamVjdCB7ICRfLkRlZmF1bHQgLWVxICR0cnVlIC1hbmQgJF8uU2hhcmVOYW1lIC1lcSAkU2hhcmVOYW1lIH0pIHsgJHRydWUgfWVsc2UgeyAkZmFsc2UgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gJG9iagogICAgfQogICAgY2F0Y2ggewogICAgICAgICRNZXNzYWdlID0gIkZhaWxlZCB0byBtYXAgdGhlIFByaW50ZXIgYCckUHJpbnRlclNoYXJlYCciCiAgICAgICAgaWYgKCRFcnJvclswXS5leGNlcHRpb24gLWxpa2UgIiplcnJvciA4NioiKSB7CiAgICAgICAgICAgIFdyaXRlLU91dHB1dCAiJE1lc3NhZ2UuIFBsZWFzZSBjaGVjayB0aGUgdXNlcm5hbWVccGFzc3dvcmQgYW5kIHRyeSBhZ2Fpbi4iCiAgICAgICAgfQogICAgICAgIGVsc2UgewogICAgICAgICAgICBXcml0ZS1FcnJvciAiJE1lc3NhZ2UuICQoJEVycm9yWzBdLmV4Y2VwdGlvbi5NZXNzYWdlKWBuUGxlYXNlIGNoZWNrIHRoZSBQcmludGVyIG5ldHdvcmsgcGF0aCBhbmQgY3JlZGVudGlhbHMgYW5kIHRyeSBhZ2Fpbi4iCiAgICAgICAgfQogICAgfQp9CgpmdW5jdGlvbiBEaXNjb25uZWN0UHJpbnRlciB7CiAgICAkbmV0ID0gTmV3LU9iamVjdCAtQ29tT2JqZWN0IFdTY3JpcHQuTmV0d29yawogICAgJG5ldC5SZW1vdmVQcmludGVyQ29ubmVjdGlvbigkUHJpbnRlclNoYXJlKQogICAgaWYgKCQ/KSB7IHJldHVybiAkdHJ1ZSB9IGVsc2UgeyByZXR1cm4gJGZhbHNlIH0KICAgIAp9CgpmdW5jdGlvbiBEaXNjb25uZWN0QWxsUHJpbnRlciB7CiAgICBMaXN0UHJpbnRlcnMgfCBGb3JFYWNoLU9iamVjdCB7ICRfLmRlbGV0ZSgpIH0KICAgIGlmIChMaXN0UHJpbnRlcnMpIHsgJGZhbHNlIH0KICAgIGVsc2UgeyByZXR1cm4gJHRydWUgfQp9CgpGdW5jdGlvbiBMaXN0UHJpbnRlcnMgewogICAgR2V0LVdtaU9iamVjdCBXaW4zMl9QcmludGVyIC1GaWx0ZXIgIk5ldHdvcms9VHJ1ZSIKfQoKdHJ5IHsKICAgIHN3aXRjaCAoJHR5cGUpIHsKICAgICAgICAnU2hhcmVkJyB7CiAgICAgICAgICAgIHN3aXRjaCAoJGFjdGlvbikgewogICAgICAgICAgICAgICAgIkNvbm5lY3QiIHsgCiAgICAgICAgICAgICAgICAgICAgaWYgKChMaXN0UHJpbnRlcnMpLlNoYXJlTmFtZSAtY29udGFpbnMgJFNoYXJlTmFtZSkgewogICAgICAgICAgICAgICAgICAgICAgICBXcml0ZS1PdXRwdXQgIlByaW50ZXIgYCckUHJpbnRlclNoYXJlYCcgYWxyZWFkeSBFeGlzdHMuIE5vIGFjdGlvbiBwZXJmb3JtZWQuIgogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgJHJlc3VsdCA9IENvbm5lY3RQcmludGVyCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkcmVzdWx0LmlzUHJpbnRlck1hcHBlZCkgeyBXcml0ZS1PdXRwdXQgIlByaW50ZXI6YCckUHJpbnRlclNoYXJlYCcgYWRkZWQgc3VjY2Vzc2Z1bGx5LCBpdCBtYXkgdGFrZSBmZXcgbWludXRlcyB0byBwb3B1bGF0ZSBpbiAnRGV2aWNlcyBhbmQgUHJpbnRlcnMnIiB9IGVsc2UgeyBXcml0ZS1PdXRwdXQgIkZhaWxlZCB0byBhZGQgcHJpbnRlcjpgJyRQcmludGVyU2hhcmVgJyIgfQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoJHJlc3VsdC5zZXRUb0RlZmF1bHQpIHsgV3JpdGUtT3V0cHV0ICJQcmludGVyOmAnJFByaW50ZXJTaGFyZWAnIGlzIG5vdyBkZWZhdWx0IHByaW50ZXIiIH0gZWxzZSB7IFdyaXRlLU91dHB1dCAiVW5hYmxlIHRvIHNldCBgJyRQcmludGVyU2hhcmVgJyBhcyBkZWZhdWx0IHByaW50ZXIuIiB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgIkRpc2Nvbm5lY3QiIHsgCiAgICAgICAgICAgICAgICAgICAgaWYgKERpc2Nvbm5lY3RQcmludGVyKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIFdyaXRlLU91dHB1dCAiUHJpbnRlcjpgJyRQcmludGVyU2hhcmVgJyByZW1vdmVkIHN1Y2Nlc3NmdWxseSIgICAKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIFdyaXRlLU91dHB1dCAiRmFpbGVkIHRvIHJlbW92ZSBQcmludGVyOmAnJFByaW50ZXJTaGFyZWAnIgogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICJEaXNjb25uZWN0IEFsbCIgewogICAgICAgICAgICAgICAgICAgICRhbGwgPSBMaXN0UHJpbnRlcnMKICAgICAgICAgICAgICAgICAgICBpZiAoJGFsbCkgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoRGlzY29ubmVjdEFsbFByaW50ZXIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFdyaXRlLU91dHB1dCAiQWxsIG5ldHdvcmsgcHJpbnRlcnMgcmVtb3ZlZCBzdWNjZXNzZnVsbHkuIiAgIAogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgV3JpdGUtT3V0cHV0ICJGYWlsZWQgdG8gcmVtb3ZlIGFsbCBuZXR3b3JrIHByaW50ZXJzLiIKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgV3JpdGUtT3V0cHV0ICJObyBuZXR3b3JrIHByaW50ZXIgZm91bmQuIgogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgJ1RDUC9JUCcgeyB9CiAgICB9CiAgICAgICAgCn0KY2F0Y2ggewogICAgV3JpdGUtT3V0cHV0ICJgbiIkXy5FeGNlcHRpb24uTWVzc2FnZQp9Cg==","jsonSchema":{"type":"object","properties":{"action":{"title":"Action","type":"string","enum":["Connect","Disconnect","Disconnect All"],"default":"Connect"}},"required":["action","type"],"additionalproperties":false,"dependencies":{"action":{"oneOf":[{"properties":{"action":{"enum":["Connect"]},"type":{"title":"Type","type":"string","enum":["Shared","TCP/IP"],"default":"Shared"},"PrinterShare":{"type":"string","title":"Printer Path"},"Default":{"type":"boolean","title":"Set as default"},"username":{"type":"string","title":"User Name"},"password":{"type":"string","title":"Password"}}},{"properties":{"action":{"enum":["Disconnect"]},"type":{"title":"Type","type":"string","enum":["Shared","TCP/IP"],"default":"Shared"},"PrinterShare":{"type":"string","title":"Printer Path"}}},{"properties":{"action":{"enum":["Disconnect All"]}}}]}}},"uiSchema":{"action":{"classNames":"col-sm-6","ui:autofocus":true},"type":{"classNames":"col-sm-6","ui:autofocus":true},"PrinterShare":{"classNames":"col-sm-8","ui:autofocus":true},"Default":{"classNames":"col-sm-12","ui:autofocus":true},"username":{"classNames":"col-sm-6","validationSchema":{"type":"requiredFieldsIfNotEmpty","notEmpty":"username","required":["password"]}},"password":{"classNames":"col-sm-6","ui:widget":"password"},"ui:order":["action","type","PrinterShare","Default","username","password"]},"isHDScript":false}
