{"id":"e0b13b03-285c-11e9-8ef4-00155d130b01","partnerId":"00000000-0000-0000-0000-000000000000","category":["Maintenance"],"description":"Removes kaseya agent","engine":"powershell","engineMaxVersion":5,"expectedExecutionTimeSec":600,"failureMessage":"Executed with errors","successMessage":"Keseya agent removed successfully","internal":false,"name":"Remove Kaseya agent","tags":["Windows 7","Windows 10"],"sequence":true,"content":"PCMKICAgIC5TWU5PUFNJUwogICAgICAgIFJlbW92ZS9Vbmluc3RhbGwgS2FzZXlhCiAgICAuREVTQ1JJUFRJT04KICAgICAgICBSZW1vdmUvVW5pbnN0YWxsIEthc2V5YSBzb2Z0d2FyZSBmcm9tIHRoZSB3aW5kb3dzIHN5c3RlbS4gCiAgICAuSGVscAogICAgICAgIFRvIGdldCBtb3JlIGRldGFpbHMgcmVmZXIgYmVsb3cgY29tbWFuZC4gCiAgICAgICAgSEtMTTpcU09GVFdBUkVcTWljcm9zb2Z0XFdpbmRvd3NcQ3VycmVudFZlcnNpb25cVW5pbnN0YWxsLCBIS0xNOlxTT0ZUV0FSRVxXb3c2NDMyTm9kZVxNaWNyb3NvZnRcV2luZG93c1xDdXJyZW50VmVyc2lvblxVbmluc3RhbGwKICAgICAgICBTdGFydC1Qcm9jZXNzIC1Ob05ld1dpbmRvdyAtRmlsZVBhdGggUGF0aF9vZl9Vbmluc3RhbGxhdGlvbiAtQXJndW1lbnRMaXN0ICIgL3MiIC13YWl0CiAgICAuQXV0aG9yCiAgICAgICAgRHVyZ2VzaGt1bWFyIFBhdGVsCiAgICAuVmVyc2lvbgogICAgICAgIDEuMAojPgoKZnVuY3Rpb24gdmVyaWZ5IHsKaWYgKChnd21pIHdpbjMyX29wZXJhdGluZ3N5c3RlbSB8IHNlbGVjdCBvc2FyY2hpdGVjdHVyZSkub3NhcmNoaXRlY3R1cmUgLWVxICI2NC1iaXQiKQp7CiAgICAkYSA9ICBHZXQtQ2hpbGRJdGVtIC1QYXRoIEhLTE06XFNPRlRXQVJFXFdvdzY0MzJOb2RlXE1pY3Jvc29mdFxXaW5kb3dzXEN1cnJlbnRWZXJzaW9uXFVuaW5zdGFsbCB8IEdldC1JdGVtUHJvcGVydHkgfCBXaGVyZS1PYmplY3QgeyRfLkRpc3BsYXlOYW1lIC1tYXRjaCAia2FzZXlhIiB9IHwgU2VsZWN0LU9iamVjdCAtRXhwYW5kUHJvcGVydHkgVW5pbnN0YWxsU3RyaW5nCn0KZWxzZQp7CiAgICAkYSA9IEdldC1DaGlsZEl0ZW0gLVBhdGggSEtMTTpcU09GVFdBUkVcTWljcm9zb2Z0XFdpbmRvd3NcQ3VycmVudFZlcnNpb25cVW5pbnN0YWxsIHwgR2V0LUl0ZW1Qcm9wZXJ0eSB8IFdoZXJlLU9iamVjdCB7JF8uRGlzcGxheU5hbWUgLW1hdGNoICJrYXNleWEiIH0gfCBTZWxlY3QtT2JqZWN0IC1leHBhbmRQcm9wZXJ0eSBVbmluc3RhbGxTdHJpbmcKfQpyZXR1cm4gJGEKfQoKZnVuY3Rpb24gRmV0Y2hTZXJ2aWNlcyB7CgogICAgICRTZXJ2aWNlTmFtZXMgPSBHZXQtU2VydmljZSAtZGlzcGxheW5hbWUga2FzZXlhKiB8IFNlbGVjdC1PYmplY3QgbmFtZSAtRXhwYW5kUHJvcGVydHkgbmFtZQogICAgcmV0dXJuICRTZXJ2aWNlTmFtZXMKfQoKVHJ5IAp7CiAgICR2ZXIgPSB2ZXJpZnkKICAgaWYgKCEkdmVyKQogICAgewogICAgICAgIFdyaXRlLU91dHB1dCAiYG5LYXNleWEgYWdlbnQgbm90IGluc3RhbGxlZCBpbiB0aGlzIHN5c3RlbSAkRU5WOkNvbXB1dGVyTmFtZSIKICAgIH0KICAgIGVsc2UKICAgIHsKICAgICAgICAkRmV0Y2hpbmcgPSBGZXRjaFNlcnZpY2VzCiAgICAgICAgU3RhcnQtU2xlZXAgMTAKICAgICAgICBmb3JlYWNoICgkZmV0Y2ggaW4gJEZldGNoaW5nKXsKICAgICAgICBTdG9wLVNlcnZpY2UgLW5hbWUgJGZldGNoIC1Gb3JjZSAtV2FybmluZ0FjdGlvbiAgU2lsZW50bHlDb250aW51ZQogICAgICAgIFN0YXJ0LVNsZWVwIDEwIAogICAgICAgICRTZXJ2aWNlU3RhdHVzICA9IEdldC1XbWlPYmplY3Qgd2luMzJfc2VydmljZSB8IHdoZXJlICB7JF8ubmFtZSAgLWVxICRmZXRjaH0gfCBzZWxlY3Qgc3RhcnRtb2RlIC1FeHBhbmRQcm9wZXJ0eSBzdGFydG1vZGUKICAgICAgICBpZiAoJFNlcnZpY2VTdGF0dXMgLW5lICJ1bmtub3duIikKICAgICAgICB7CiAgICAgICAgU2V0LVNlcnZpY2UgJGZldGNoIC1TdGFydHVwVHlwZSBEaXNhYmxlZAogICAgICAgIH0KICAgICAgICB9CgogICAgICAgIFN0YXJ0LVNsZWVwIDEwIAogICAgICAgIFN0YXJ0LVByb2Nlc3MgLU5vTmV3V2luZG93ICR2ZXIgLUFyZ3VtZW50TGlzdCAiIC9zIgogICAgICAgIFN0YXJ0LVNsZWVwIDEwIAogICAgICAgCiAgICAgICAgJHZlcjEgPSB2ZXJpZnkKICAKICAgIGlmKCEkdmVyMSkKICAgICAgICB7CiAgICAgICAgICBXcml0ZS1PdXRwdXQgImBuS2FzZXlhIGFnZW50IGlzIHN1Y2Nlc3NmdWxseSByZW1vdmVkIGZyb20gdGhlIHN5c3RlbSAkRU5WOkNvbXB1dGVyTmFtZSIgCiAgICAgICAgICAgV3JpdGUtT3V0cHV0ICJLaW5kbHkgcmVib290IHRoZSBzeXN0ZW0gJEVOVjpDb21wdXRlck5hbWUiIAogICAgICAgICAgCiAgICAgICAgICAka2V5cGF0aCA9IChHZXQtU2VydmljZSAtRGlzcGxheU5hbWUgIkthc2V5YSBBZ2VudCBFbmRwb2ludCoiKS5uYW1lCiAgICAgICAgICBpZiAoJGtleXBhdGggLW5lICRudWxsKQogICAgICAgICAgewogICAgICAgICAgaWYgKHRlc3QtcGF0aCAiSEtMTTpTWVNURU1cQ3VycmVudENvbnRyb2xTZXRcU2VydmljZXNcJGtleXBhdGgiKQogICAgICAgICAgewogICAgICAgICAgUmVtb3ZlLUl0ZW0gLXBhdGggIkhLTE06U1lTVEVNXEN1cnJlbnRDb250cm9sU2V0XFNlcnZpY2VzXCRrZXlwYXRoIiAtcmVjdXJzZSAgICAgICAKICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9IAogICAgZWxzZQogICAgICAgIHsKICAgICAgICBXcml0ZS1FcnJvciAiYG5UaGVyZSBpcyBzb21lIGlzc3VlIHdpdGggdW5pbnN0YWxsYXRpb24uIEtpbmRseSBjaGVjayBtYW51YWxseS4iCiAgICAgICAgfSAgICAgICAgICAgIAogICAgfQp9CmNhdGNoCnsKICAgIHdyaXRlLW91dHB1dCAiYG4iJF8uRXhjZXB0aW9uLk1lc3NhZ2UKfQo=","jsonSchema":"","uiSchema":"","isHDScript":false}