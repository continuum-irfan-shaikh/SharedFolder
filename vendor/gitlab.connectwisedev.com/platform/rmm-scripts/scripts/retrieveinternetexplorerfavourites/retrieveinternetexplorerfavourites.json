{
  "id": "5f394403-44eb-11e9-a14e-00155d130b01",
  "partnerId": "00000000-0000-0000-0000-000000000000",
  "category": [
    "Data Collection"
  ],
  "description": "Retrieves Internet Explorer favourites",
  "engine": "powershell",
  "engineMaxVersion": 5,
  "expectedExecutionTimeSec": 300,
  "failureMessage": "Executed with errors",
  "successMessage": "Excecution success",
  "internal": false,
  "name": "Retrieve Internet explorer favourites",
  "tags": [
    "Windows 7",
    "Windows 10"
  ],
  "sequence": true,
  "content": "IyR1c2VybmFtZSA9ICJEaXBhayIgIHBhcmFtZXRlcgokRXhlY3V0aW9uTG9nID0gQCgpCltCb29sXSRhc3NpZ25lZHVzZXIgPSAkRmFsc2UKJG91cHV0ID0gQCgpCiRkb21haW5uYW1lcyA9IEAoKQokb3VwdXQgPSBAKCkKJG91cHV0cyA9IEAoKQokbmFtZXMgPSBAKCkKJGdsb2JhbDpQcm9ncmVzc1ByZWZlcmVuY2UgPSAnU2lsZW50bHlDb250aW51ZScgIApbZG91YmxlXSRPU1ZlcnNpb24gPSBbRW52aXJvbm1lbnRdOjpPU1ZlcnNpb24uVmVyc2lvbi5Ub1N0cmluZygyKQojIE9TIFZlcnNpb24gYW5kIFBvd2Vyc2hlbGwgY29tcGFyaXNvbi4KaWYgKCgkb3N2ZXJzaW9uIC1sdCAnNi4xJykgLW9yICgkUFNWZXJzaW9uVGFibGUuUFNWZXJzaW9uLk1ham9yIC1sdCAnMicpKSB7CiAgICAkZXhlY3V0aW9ubG9nICs9ICdQcmVyZXF1aXNpdGVzIHRvIHJ1biB0aGUgc2NyaXB0IGlzIG5vdCB2YWxpZCwgSGVuY2UgU2NyaXB0IEV4Y2V1dGlvbiBzdG9wcGVkJyAjJ1NjcmlwdCBpcyBkZXNpZ24gZm9yIHdpbmRvd3MgNyBhbmQgQWJvdmUgTWVtYmVycyBvbmx5LCBTY3JpcHQgRXhlY3V0aW9uIFN0b3BwZWQuJwogICAgV3JpdGUtT3V0cHV0ICRleGVjdXRpb25sb2cKICAgICNleGl0Owp9IAojVG8gY2hlY2sgdGhlIHN0YXR1cyBvZiB0aGUgY29tcHV0ZXIKaWYgKFtCb29sXSRhc3NpZ25lZHVzZXIgLWVxICRUcnVlKSB7ICRDdXJyZW50VXNlcnMgPSAkdXNlcm5hbWUgfQplbHNlIHsgCiAgICAkQWxsVXNlcnMgPSBxdWVyeSB1c2VyIC9zZXJ2ZXI6JGNvbXB1dGVyIDI+JjEKICAgICRVc2VycyA9ICRBbGxVc2VycyB8IEZvckVhY2gtT2JqZWN0IHsoKCRfLnRyaW0oKSAtcmVwbGFjZSAiPiIgLXJlcGxhY2UgIig/bSleKFtBLVphLXowLTldezMsfSlccysoXGR7MSwyfVxzK1x3KykiLCAnJDEgIG5vbmUgICQyJyAtcmVwbGFjZSAiXHN7Mix9IiwgIiwiIC1yZXBsYWNlICJub25lIiwgJG51bGwpKX0gfCBDb252ZXJ0RnJvbS1Dc3YKICAgICRDdXJyZW50VXNlcnMgPSBAKCkKICAgIEZvckVhY2ggKCRVc2VyciBpbiAkVXNlcnMpCiAgICB7CiAgICAkQ1VzZXIgPSAoJHVzZXJyIHwgP3skXy5zdGF0ZSAtbmUgJ0Rpc2MnfSB8IFNlbGVjdC1PYmplY3QgdXNlcm5hbWUpLnVzZXJuYW1lCiAgICAkQ3VycmVudFVzZXJzKz0gJENVc2VyCiAgICB9CiB9CnRyeSB7CiAgICAkQ29tcCA9IGdldC13bWlvYmplY3Qgd2luMzJfY29tcHV0ZXJzeXN0ZW0KICAgICRjb21wdXRlciA9ICRjb21wLm5hbWUgOyAkRG9tYWluTmFtZWUgPSAkY29tcC5kb21haW4KICAgICRFeGVjdXRpb25Mb2cgKz0gIkNvbXB1dGVyTmFtZSA6ICRjb21wdXRlciIKICAgICRFeGVjdXRpb25Mb2cgKz0gIkRvbWFpbi9Xb3JrZ3JvdXAgOiAkRG9tYWluTmFtZWUiIAogICAgZm9yZWFjaCAoJHVzZXIgaW4gJEN1cnJlbnRVc2VycykKICAgIHsKICAKICAgIGlmICg0LCA1IC1jb250YWlucyAkQ29tcC5Eb21haW5Sb2xlKSB7CiAgICAgICAgSW1wb3J0LU1vZHVsZSBBY3RpdmVEaXJlY3RvcnkKICAgICAgICAkZG9tYWlubmFtZXMgPSBHZXQtQURVc2VyIC1maWx0ZXIge0VuYWJsZWQgLWVxICRUcnVlfSB8IFdoZXJlLW9iamVjdCB7JF8uTmFtZSAtbGlrZSAiKiR1c2VyKiJ9CiAgICAgICAgaWYgKCRkb21haW5uYW1lcyAtbmUgJG51bGwpIHsKICAgICAgICAgICAgZm9yZWFjaCAoJGRvbWFpbm5hbWUgaW4gJGRvbWFpbm5hbWVzKSB7CiAgICAgICAgICAgICAgICAkdXNlcm5hbWUgPSAkZG9tYWlubmFtZS5OYW1lCiAgICAgICAgICAgICAgICAkcGF0aCA9ICJDOlx1c2Vyc1wkdXNlcm5hbWVcRmF2b3JpdGVzIgogICAgICAgICAgICAgICAgJG91cHV0cyArPSBHZXQtQ2hpbGRJdGVtICRwYXRoIC1SZWN1cnNlICB8IHNlbGVjdCBOYW1lLCBAe05hbWUgPSAiTGluayI7IEV4cHJlc3Npb24gPSB7KCRfIHwgU2VsZWN0LVN0cmluZyAiXlVSTCIgKS5MaW5lLlRyaW0oIlVSTD0iKX19CiAgICAgICAgICAgICAgICAkb3VwdXQgKz0gJG91cHV0cyB8ID8geyRfLk5hbWUgLW5vdGxpa2UgIipMaW5rcyoiIH0KICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgaWYgKCRvdXB1dC5jb3VudCAtbmUgMCkgewogICAgICAgICAgICAgICAgICAgICRleGVjdXRpb25sb2cgKz0gIkRvbWFpbiBVc2VyIDogJHVzZXJuYW1lIiAgIAogICAgICAgICAgICAgICAgICAgICRleGVjdXRpb25sb2cgKz0gIlRoZSBGYXZvcml0ZSBzaXRlcyBmb3IgdGhlIHVzZXIgJHVzZXJuYW1lIG9uIHRoZSBJbnRlcm5ldCBFeHBsb3JlciBhcmUgbWVudGlvbmVkIGJlbG93IiAKICAgICAgICAgICAgICAgICAgICBmb3JlYWNoICgkb3V0cHV0IGluICRvdXB1dCkgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoJG91dHB1dC5saW5rIC1uZSAkbnVsbCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgJGV4ZWN1dGlvbmxvZyArPSAiYG4iICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkZXhlY3V0aW9ubG9nICs9ICgkb3V0cHV0IHwgc2VsZWN0IE5hbWUsIExpbmsgfCBmbCB8IE91dC1TdHJpbmcpLlRyaW0oKQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZSB7IAogICAgICAgICAgICAgICAgICAgICRleGVjdXRpb25sb2cgKz0gIlRoZXJlIGFyZSBubyBmYXZvcml0ZSBzaXRlcyBpbiB0aGUgSW50ZXJuZXQgRXhwbG9yZXIgZm9yIHRoZSB1c2VyICR1c2VybmFtZSB0aGUgTWFjaGluZSIKICAgICAgICAgICAgICAgICAgICAkRXhlY3V0aW9uTG9nICs9ICJgbiIKICAgICAgICAgICAgICAgIH0gCiAgICAgICAgICAgIH0gCiAgICAgICAgfQogICAgICAgIGVsc2UgeyAKICAgICAgICAgICAgJGV4ZWN1dGlvbmxvZyArPSAiV2UgY2Fubm90IGFibGUgdG8gZmluZCB0aGUgdXNlciBuYW1lIG9uIHRoZSBNYWNoaW5lLCBQbGVhc2UgY2hlY2sgdGhlIHVzZXIgbmFtZSBhbmQgdHJ5IGFnYWluIgogICAgICAgICAgCiAgICAgICAgfQoKICAgICAgICAKICAgIH0KICAgIGVsc2UgewogICAgICAgICRuYW1lcyA9IEdldC1XbWlPYmplY3QgLUNsYXNzIFdpbjMyX1VzZXJBY2NvdW50IC1maWx0ZXIge2Rpc2FibGVkID0gIkZhbHNlIiB9IHwgV2hlcmUtb2JqZWN0IHskXy5OYW1lIC1saWtlICIqJHVzZXIqIn0KICAgICAgICBpZiAoJG5hbWVzIC1uZSAkbnVsbCkgewogICAgICAgICAgICBmb3JlYWNoICgkbmFtZSBpbiAkbmFtZXMpIHsKICAgICAgICAgICAgICAgICR1c2VybmFtZSA9ICRuYW1lLk5hbWUKICAgICAgICAgICAgICAgICRFeGVjdXRpb25Mb2cgKz0gIkxvYWNsIFVzZXIgOiAkdXNlcm5hbWUiIAogICAgICAgICAgICAgICAgJHBhdGggPSAiQzpcdXNlcnNcJHVzZXJuYW1lXEZhdm9yaXRlcyIKICAgICAgICAgICAgICAgICRvdXB1dHMgPSBHZXQtQ2hpbGRJdGVtICRwYXRoIC1SZWN1cnNlICB8IHNlbGVjdCBOYW1lLCBAe05hbWUgPSAiTGluayI7IEV4cHJlc3Npb24gPSB7KCRfIHwgU2VsZWN0LVN0cmluZyAiXlVSTCIgKS5MaW5lLlRyaW0oIlVSTD0iKX19CiAgICAgICAgICAgICAgICAkb3VwdXQgPSAkb3VwdXRzfCA/IHskXy5OYW1lIC1ub3RsaWtlICIqTGlua3MqIiB9CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGlmICgkb3VwdXQuY291bnQgLW5lIDApIHsKICAgICAgICAgICAgICAgICAgICAkRXhlY3V0aW9uTG9nICs9ICJUaGUgRmF2b3JpdGUgc2l0ZXMgZm9yIHRoZSB1c2VyICR1c2VybmFtZSBvbiB0aGUgSW50ZXJuZXQgRXhwbG9yZXIgYXJlIG1lbnRpb25lZCBiZWxvdyIKICAgICAgICAgICAgICAgICAgICBmb3JlYWNoICgkb3V0cHV0IGluICRvdXB1dCkgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoJG91dHB1dC5saW5rIC1uZSAkbnVsbCkgewogICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAjJEV4ZWN1dGlvbkxvZyArPSAiYG4iICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkZXhlY3V0aW9ubG9nICs9ICJgbiIgKyAoJG91dHB1dCB8IHNlbGVjdCBOYW1lLCBMaW5rIHwgZmwgfCBPdXQtU3RyaW5nKS5UcmltKCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRFeGVjdXRpb25Mb2cgKz0gImBuIgogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgeyAKICAgICAgICAgICAgICAgICAgICAkZXhlY3V0aW9ubG9nICs9ICJUaGVyZSBhcmUgbm8gZmF2b3JpdGUgc2l0ZXMgaW4gdGhlIEludGVybmV0IEV4cGxvcmVyIGZvciB0aGUgdXNlciAkdXNlcm5hbWUgdGhlIE1hY2hpbmUiCiAgICAgICAgICAgICAgICAgICAgJEV4ZWN1dGlvbkxvZyArPSAiYG4iCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAKICAgICAgICB9CiAgICAgICAgICAgICAgCiAgICAgICAgZWxzZSB7IAogICAgICAgICAgICAkZXhlY3V0aW9ubG9nICs9ICJXZSBjYW5ub3QgYWJsZSB0byBmaW5kIHRoZSB1c2VyIG5hbWUgb24gdGhlIE1hY2hpbmUsIFBsZWFzZSBjaGVjayB0aGUgdXNlciBuYW1lIGFuZCB0cnkgYWdhaW4iCiAgICAgICAgICAgCiAgICAgICAgfQogICAgfQogICAgfQogICAgIFdyaXRlLW91dHB1dCAkZXhlY3V0aW9ubG9nIAogICAgICAgICAgICAjZXhpdDsKfQpDYXRjaCB7IAogICAgJEV4ZWN1dGlvbkxvZyArPSAiTm90IGFibGUgdG8gcmVhY2ggdGhlIGNvbXB1dGVyIHJlbW90ZWx0IHRocm91Z2ggV01JIgogICAgV3JpdGUtT3V0cHV0ICRleGVjdXRpb25sb2cKICAgICNleGl0Owp9CiAgICAgICAKCg==",
  "jsonSchema": {
    "type": "object",
    "properties": {
      "username": {
        "type": "string",
        "title": "User name"
      }
    },
    "additionalProperties": false
  },
  "uiSchema": {
    "username": {
      "classNames": "col-sm-6",
      "ui:autofocus": true,
      "ui:help": "If user name is left blank, it will check for currently logged in user."
    }
  },
  "isHDScript": false
}
