{"id":"fe41054f-81d0-11e9-bf86-00155d130b89","partnerId":"00000000-0000-0000-0000-000000000000","category":["HD Automation"],"description":"Machine Tasking Availability","engine":"powershell","engineMaxVersion":5,"expectedExecutionTimeSec":300,"failureMessage":"Executed with errors","successMessage":"Executed Successfully","internal":false,"name":"MachineTaskingAvailability","tags":["Windows 7","Windows 10"],"sequence":true,"content":"DQpDbGVhci1Ib3N0DQoNCmZ1bmN0aW9uIEVzY2FwZS1KU09OU3RyaW5nKCRzdHIpew0KICAgIGlmICgkc3RyIC1lcSAkbnVsbCkge3JldHVybiAiIn0NCiAgICAgICAgICRzdHIgPSAkc3RyLlRvU3RyaW5nKCkuUmVwbGFjZSgnIicsJ1wiJykuUmVwbGFjZSgnXCcsJ1xcJykuUmVwbGFjZSgiYG4iLCdcbicpLlJlcGxhY2UoImByIiwnXHInKS5SZXBsYWNlKCJgdCIsJ1x0JykNCiAgICByZXR1cm4gJHN0cjsNCn0NCg0KDQpmdW5jdGlvbiBDb252ZXJ0VG8tSlNPTlAyKCRtYXhEZXB0aCA9IDEwLCRmb3JjZUFycmF5ID0gJGZhbHNlKSB7DQpiZWdpbiB7DQokZGF0YSA9IEAoKQ0KfQ0KcHJvY2Vzc3sNCiRkYXRhICs9ICRfDQp9DQplbmR7DQppZiAoJGRhdGEubGVuZ3RoIC1lcSAxIC1hbmQgJGZvcmNlQXJyYXkgLWVxICRmYWxzZSkgew0KJHZhbHVlID0gJGRhdGFbMF0NCn0gZWxzZSB7IA0KJHZhbHVlID0gJGRhdGENCn0NCg0KDQppZiAoJHZhbHVlIC1lcSAkbnVsbCkgew0KcmV0dXJuICJudWxsIg0KfQ0KDQoNCg0KDQokZGF0YVR5cGUgPSAkdmFsdWUuR2V0VHlwZSgpLk5hbWUNCnN3aXRjaCAtcmVnZXggKCRkYXRhVHlwZSkgew0KICAgICAgICAgICAgJ1N0cmluZycgIHsNCnJldHVybiAgImAiezB9YCIiIC1mIChFc2NhcGUtSlNPTlN0cmluZyAkdmFsdWUgKQ0KfQ0KICAgICAgICAgICAgJyhTeXN0ZW1cLik/RGF0ZVRpbWUnICB7cmV0dXJuICAiYCJ7MDp5eXl5LU1NLWRkfVR7MDpISDptbTpzc31gIiIgLWYgJHZhbHVlfQ0KICAgICAgICAgICAgJ0ludDMyfERvdWJsZScge3JldHVybiAgIiR2YWx1ZSJ9DQonQm9vbGVhbicge3JldHVybiAgIiR2YWx1ZSIuVG9Mb3dlcigpfQ0KICAgICAgICAgICAgJyhTeXN0ZW1cLik/T2JqZWN0XFtcXScgeyAjIGFycmF5DQppZiAoJG1heERlcHRoIC1sZSAwKXtyZXR1cm4gImAiJHZhbHVlYCIifQ0KJGpzb25SZXN1bHQgPSAnJw0KZm9yZWFjaCgkZWxlbSBpbiAkdmFsdWUpew0KI2lmICgkZWxlbSAtZXEgJG51bGwpIHtjb250aW51ZX0NCmlmICgkanNvblJlc3VsdC5MZW5ndGggLWd0IDApIHskanNvblJlc3VsdCArPScsICd9IA0KJGpzb25SZXN1bHQgKz0gKCRlbGVtIHwgQ29udmVydFRvLUpTT05QMiAtbWF4RGVwdGggKCRtYXhEZXB0aCAtMSkpDQp9DQpyZXR1cm4gIlsiICsgJGpzb25SZXN1bHQgKyAiXSINCiAgICAgICAgICAgIH0NCicoU3lzdGVtXC4pP0hhc2h0YWJsZScgeyAjIGhhc2h0YWJsZQ0KJGpzb25SZXN1bHQgPSAnJw0KZm9yZWFjaCgka2V5IGluICR2YWx1ZS5LZXlzKXsNCmlmICgkanNvblJlc3VsdC5MZW5ndGggLWd0IDApIHskanNvblJlc3VsdCArPScsICd9DQokanNvblJlc3VsdCArPSANCkAiDQoiezB9IjogezF9DQoiQCAtZiAka2V5ICwgKCR2YWx1ZVska2V5XSB8IENvbnZlcnRUby1KU09OUDIgLW1heERlcHRoICgkbWF4RGVwdGggLTEpICkNCn0NCnJldHVybiAieyIgKyAkanNvblJlc3VsdCArICJ9Ig0KfQ0KICAgICAgICAgICAgZGVmYXVsdCB7ICNvYmplY3QNCmlmICgkbWF4RGVwdGggLWxlIDApe3JldHVybiAgImAiezB9YCIiIC1mIChFc2NhcGUtSlNPTlN0cmluZyAkdmFsdWUpfQ0KcmV0dXJuICJ7IiArDQooKCR2YWx1ZSB8IEdldC1NZW1iZXIgLU1lbWJlclR5cGUgKnByb3BlcnR5IHwgJSB7IA0KQCINCiJ7MH0iOiB7MX0NCiJAIC1mICRfLk5hbWUgLCAoJHZhbHVlLigkXy5OYW1lKSB8IENvbnZlcnRUby1KU09OUDIgLW1heERlcHRoICgkbWF4RGVwdGggLTEpICkgDQp9KSAtam9pbiAnLCAnKSArICJ9Ig0KICAgIH0NCn0NCn0NCn0NCg0KDQpGdW5jdGlvbiBDaGVja01hY2hpbmVUYXNraW5nQXZhaWxhYmlsaXR5eyANCg0KICAgJE1hY1Rhc2tpbmdPYmplY3QgPSBOZXctT2JqZWN0IC1UeXBlTmFtZSBwc29iamVjdA0KICAgJE1hY1Rhc2tpbmdPYmplY3QgfCBBZGQtTWVtYmVyIC1NZW1iZXJUeXBlIE5vdGVQcm9wZXJ0eSAtTmFtZSBUYXNrTmFtZSAtVmFsdWUgIk1hY2hpbmUgVGFza2luZyBBdmFpbGFiaWxpdHkiDQoNCg0KICAgJGhvc3RWZXJTaW9uTWFqb3IgPSAoJFBTVmVyc2lvblRhYmxlLlBTVmVyc2lvbi5NYWpvcikuVG9TdHJpbmcoKQ0KICAgJGhvc3RWZXJTaW9uTWlub3IgPSAoJFBTVmVyc2lvblRhYmxlLlBTVmVyc2lvbi5NaW5vcikuVG9TdHJpbmcoKQ0KICAgJGhvc3RWZXJzaW9uID0gJGhvc3RWZXJTaW9uTWFqb3IgKycuJysgJGhvc3RWZXJTaW9uTWlub3IgDQoNCiAgICRvc1ZlcnNpb25NYWpvciA9IChbU3lzdGVtLkVudmlyb25tZW50XTo6T1NWZXJzaW9uLlZlcnNpb24ubWFqb3IpLlRvU3RyaW5nKCkNCiAgICRvc1ZlcnNpb25NaW5vciA9IChbU3lzdGVtLkVudmlyb25tZW50XTo6T1NWZXJzaW9uLlZlcnNpb24ubWlub3IpLlRvU3RyaW5nKCkNCiAgICRvc1ZlcnNpb24gPSAkb3NWZXJzaW9uTWFqb3IgKycuJysgJG9zVmVyc2lvbk1pbm9yDQoNCiAgIFtib29sZWFuXSRpc1BzVmVyc2lvbk9rID0gKFt2ZXJzaW9uXSRob3N0VmVyc2lvbiAtZ2UgW3ZlcnNpb25dJzYuMCcpDQogICBbYm9vbGVhbl0kaXNPU1ZlcnNpb25PayA9IChbdmVyc2lvbl0kb3NWZXJzaW9uIC1nZSBbdmVyc2lvbl0nNi4wJykNCg0KICANCiAgIGlmKCRpc1BzVmVyc2lvbk9rIC1hbmQgJGlzT1NWZXJzaW9uT2speyANCiAgICAgDQogICAgICRTdGRPdXRBcnIgPSBAKCkgICAgDQogICAgICRTdGRPdXRBcnIgKz0gKCJTZXJ2ZXIgOiAkKCRlbnY6Q09NUFVURVJOQU1FKSBpcyBhdmFpbGFibGUgYW5kIE9LIikNCg0KICAgICAkTWFjVGFza2luZ09iamVjdCB8IEFkZC1NZW1iZXIgLU1lbWJlclR5cGUgTm90ZVByb3BlcnR5IC1OYW1lIFN0YXR1cyAtVmFsdWUgIlN1Y2Nlc3MiIA0KICAgICAkTWFjVGFza2luZ09iamVjdCB8IEFkZC1NZW1iZXIgLU1lbWJlclR5cGUgTm90ZVByb3BlcnR5IC1OYW1lIENvZGUgLVZhbHVlIDANCiAgICAgJE1hY1Rhc2tpbmdPYmplY3QgfCBBZGQtTWVtYmVyIC1NZW1iZXJUeXBlIE5vdGVQcm9wZXJ0eSAtTmFtZSBSZXN1bHQgLVZhbHVlICJTdWNjZXNzIDogU2VydmVyIDogJCgkZW52OkNPTVBVVEVSTkFNRSkgaXMgYXZhaWxhYmxlIGFuZCBPSyINCiAgICAgJE1hY1Rhc2tpbmdPYmplY3QgfCBBZGQtTWVtYmVyIC1NZW1iZXJUeXBlIE5vdGVQcm9wZXJ0eSAtTmFtZSBzdGRvdXQgLVZhbHVlICAkU3RkT3V0QXJyDQogICAgDQogICAgIHJldHVybiAgJE1hY1Rhc2tpbmdPYmplY3QNCiAgICANCiAgIH0NCg0KICAgaWYoJGlzUHNWZXJzaW9uT2sgLWFuZCAtbm90ICRpc09TVmVyc2lvbk9rKXsNCiAgICAgICAgDQogICAgICMgV3JpdGUtV2FybmluZyAiU2VydmVyIDogJCgkZW52OkNPTVBVVEVSTkFNRSkgaXMgYXZhaWxhYmxlIGFuZCB0aGUgT1MgdmVyc2lvbiBpcyBub3QgT0siDQoNCiAgICAgJFN0ZEVyciA9IE5ldy1PYmplY3QgUFNPYmplY3QgLVByb3BlcnR5IEB7CQkgICAgICAgDQoJCSAgICAgICAgICAgICAgICAgIGlkID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGUgPSAiU2VydmVyIDogJCgkZW52OkNPTVBVVEVSTkFNRSkgaXMgYXZhaWxhYmxlIGFuZCB0aGUgT1MgdmVyc2lvbiBpcyBub3QgT0siDQogICAgICAgICAgICAgICAgICAgICAgICAgIGRldGFpbCA9ICJTZXJ2ZXIgOiAkKCRlbnY6Q09NUFVURVJOQU1FKSBpcyBhdmFpbGFibGUgYW5kIHRoZSBPUyB2ZXJzaW9uIGlzIG5vdCBPSyINCg0KICAgICAgICAgICAgICAgfQ0KDQogICAgDQogICAgICAkU3RkT3V0QXJyID0gQCgpDQoNCiAgICAgICRTdGRPdXRBcnIgKz0gIlNlcnZlciA6ICQoJGVudjpDT01QVVRFUk5BTUUpIGlzIGF2YWlsYWJsZSBhbmQgdGhlIE9TIHZlcnNpb24gaXMgbm90IE9LIg0KICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIA0KICAgICAgJE1hY1Rhc2tpbmdPYmplY3QgfCBBZGQtTWVtYmVyIC1NZW1iZXJUeXBlIE5vdGVQcm9wZXJ0eSAtTmFtZSBTdGF0dXMgLVZhbHVlICJmYWlsIiANCiAgICAgICRNYWNUYXNraW5nT2JqZWN0IHwgQWRkLU1lbWJlciAtTWVtYmVyVHlwZSBOb3RlUHJvcGVydHkgLU5hbWUgQ29kZSAtVmFsdWUgMQ0KICAgICAgJE1hY1Rhc2tpbmdPYmplY3QgfCBBZGQtTWVtYmVyIC1NZW1iZXJUeXBlIE5vdGVQcm9wZXJ0eSAtTmFtZSBzdGRlcnIgLVZhbHVlICRTdGRFcnINCiAgICAgICRNYWNUYXNraW5nT2JqZWN0IHwgQWRkLU1lbWJlciAtTWVtYmVyVHlwZSBOb3RlUHJvcGVydHkgLU5hbWUgUmVzdWx0IC1WYWx1ZSAiRXJyb3IgOiBTZXJ2ZXIgOiAkKCRlbnY6Q09NUFVURVJOQU1FKSBpcyBhdmFpbGFibGUgYW5kIHRoZSBPUyB2ZXJzaW9uIGlzIG5vdCBPSyINCiAgICAgICRNYWNUYXNraW5nT2JqZWN0IHwgQWRkLU1lbWJlciAtTWVtYmVyVHlwZSBOb3RlUHJvcGVydHkgLU5hbWUgc3Rkb3V0IC1WYWx1ZSAkU3RkT3V0QXJyDQogICAgICAgICAgIA0KICAgICAgcmV0dXJuICRNYWNUYXNraW5nT2JqZWN0DQogICAgDQogICB9DQoNCiAgIGlmKC1ub3QgJGlzUHNWZXJzaW9uT2sgLWFuZCAkaXNPU1ZlcnNpb25Payl7DQogICAgICAgIA0KICAgIyAgV3JpdGUtV2FybmluZyAiU2VydmVyIDogJCgkZW52OkNPTVBVVEVSTkFNRSkgaXMgYXZhaWxhYmxlIGFuZCB0aGUgUFMgdmVyc2lvbiBpcyBub3QgT0siDQogICAgIA0KICAgICAkU3RkRXJyID0gTmV3LU9iamVjdCBQU09iamVjdCAtUHJvcGVydHkgQHsJCSAgICAgICANCgkJICAgICAgICAgICAgICAgICAgaWQgPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZSA9ICJTZXJ2ZXIgOiAkKCRlbnY6Q09NUFVURVJOQU1FKSBpcyBhdmFpbGFibGUgYW5kIHRoZSBQUyB2ZXJzaW9uIGlzIG5vdCBPSyINCiAgICAgICAgICAgICAgICAgICAgICAgICAgZGV0YWlsID0gIlNlcnZlciA6ICQoJGVudjpDT01QVVRFUk5BTUUpIGlzIGF2YWlsYWJsZSBhbmQgdGhlIFBTIHZlcnNpb24gaXMgbm90IE9LIg0KDQogICAgICAgICAgICAgICB9DQoNCiAgICANCiAgICAgICRTdGRPdXRBcnIgPSBAKCkNCg0KICAgICAgJFN0ZE91dEFyciArPSAiU2VydmVyIDogJCgkZW52OkNPTVBVVEVSTkFNRSkgaXMgYXZhaWxhYmxlIGFuZCB0aGUgUFMgdmVyc2lvbiBpcyBub3QgT0siDQogICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgDQogICAgICAkTWFjVGFza2luZ09iamVjdCB8IEFkZC1NZW1iZXIgLU1lbWJlclR5cGUgTm90ZVByb3BlcnR5IC1OYW1lIFN0YXR1cyAtVmFsdWUgImZhaWwiIA0KICAgICAgJE1hY1Rhc2tpbmdPYmplY3QgfCBBZGQtTWVtYmVyIC1NZW1iZXJUeXBlIE5vdGVQcm9wZXJ0eSAtTmFtZSBDb2RlIC1WYWx1ZSAxDQogICAgICAkTWFjVGFza2luZ09iamVjdCB8IEFkZC1NZW1iZXIgLU1lbWJlclR5cGUgTm90ZVByb3BlcnR5IC1OYW1lIHN0ZGVyciAtVmFsdWUgJFN0ZEVycg0KICAgICAgJE1hY1Rhc2tpbmdPYmplY3QgfCBBZGQtTWVtYmVyIC1NZW1iZXJUeXBlIE5vdGVQcm9wZXJ0eSAtTmFtZSBSZXN1bHQgLVZhbHVlICJFcnJvciA6IFNlcnZlciA6ICQoJGVudjpDT01QVVRFUk5BTUUpIGlzIGF2YWlsYWJsZSBhbmQgdGhlIFBTIHZlcnNpb24gaXMgbm90IE9LIg0KICAgICAgJE1hY1Rhc2tpbmdPYmplY3QgfCBBZGQtTWVtYmVyIC1NZW1iZXJUeXBlIE5vdGVQcm9wZXJ0eSAtTmFtZSBzdGRvdXQgLVZhbHVlICRTdGRPdXRBcnINCiAgICAgICAgICAgDQogICAgICByZXR1cm4gJE1hY1Rhc2tpbmdPYmplY3QNCiAgICAgDQogICB9DQoNCiAgIGlmKC1ub3QgJGlzUHNWZXJzaW9uT2sgLWFuZCAtbm90ICRpc09TVmVyc2lvbk9rKXsNCiAgICAgICAgDQogICAgICMgV3JpdGUtV2FybmluZyAiU2VydmVyIDogJCgkZW52OkNPTVBVVEVSTkFNRSkgaXMgYXZhaWxhYmxlIGFuZCB0aGUgT1MgYW5kIFBTIHZlcnNpb24gaXMgbm90IE9LIiANCiAgICAgDQogICAgICAkU3RkRXJyID0gTmV3LU9iamVjdCBQU09iamVjdCAtUHJvcGVydHkgQHsJCSAgICAgICANCgkJICAgICAgICAgICAgICAgICAgaWQgPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZSA9ICJTZXJ2ZXIgOiAkKCRlbnY6Q09NUFVURVJOQU1FKSBpcyBhdmFpbGFibGUgYW5kIHRoZSBPUyBhbmQgUFMgdmVyc2lvbiBpcyBub3QgT0siIA0KICAgICAgICAgICAgICAgICAgICAgICAgICBkZXRhaWwgPSAiU2VydmVyIDogJCgkZW52OkNPTVBVVEVSTkFNRSkgaXMgYXZhaWxhYmxlIGFuZCB0aGUgT1MgYW5kIFBTIHZlcnNpb24gaXMgbm90IE9LIiANCg0KICAgICAgICAgICAgICAgfQ0KDQogICAgIA0KICAgICAgJFN0ZE91dEFyciA9IEAoKQ0KDQogICAgICAkU3RkT3V0QXJyICs9ICJTZXJ2ZXIgOiAkKCRlbnY6Q09NUFVURVJOQU1FKSBpcyBhdmFpbGFibGUgYW5kIHRoZSBPUyBhbmQgUFMgdmVyc2lvbiBpcyBub3QgT0siIA0KICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIA0KICAgICAgJE1hY1Rhc2tpbmdPYmplY3QgfCBBZGQtTWVtYmVyIC1NZW1iZXJUeXBlIE5vdGVQcm9wZXJ0eSAtTmFtZSBTdGF0dXMgLVZhbHVlICJmYWlsIiANCiAgICAgICRNYWNUYXNraW5nT2JqZWN0IHwgQWRkLU1lbWJlciAtTWVtYmVyVHlwZSBOb3RlUHJvcGVydHkgLU5hbWUgQ29kZSAtVmFsdWUgMQ0KICAgICAgJE1hY1Rhc2tpbmdPYmplY3QgfCBBZGQtTWVtYmVyIC1NZW1iZXJUeXBlIE5vdGVQcm9wZXJ0eSAtTmFtZSBzdGRlcnIgLVZhbHVlICRTdGRFcnINCiAgICAgICRNYWNUYXNraW5nT2JqZWN0IHwgQWRkLU1lbWJlciAtTWVtYmVyVHlwZSBOb3RlUHJvcGVydHkgLU5hbWUgUmVzdWx0IC1WYWx1ZSAiRXJyb3IgOiBTZXJ2ZXIgOiAkKCRlbnY6Q09NUFVURVJOQU1FKSBpcyBhdmFpbGFibGUgYW5kIHRoZSBPUyBhbmQgUFMgdmVyc2lvbiBpcyBub3QgT0siIA0KICAgICAgJE1hY1Rhc2tpbmdPYmplY3QgfCBBZGQtTWVtYmVyIC1NZW1iZXJUeXBlIE5vdGVQcm9wZXJ0eSAtTmFtZSBzdGRvdXQgLVZhbHVlICRTdGRPdXRBcnINCiAgICAgICAgICAgDQogICAgICByZXR1cm4gJE1hY1Rhc2tpbmdPYmplY3QNCiAgICAgDQoNCiAgIH0NCg0KICAgDQp9DQogDQogaWYoJFBTVmVyc2lvblRhYmxlLlBTVmVyc2lvbi5NYWpvciAtZXEgMil7DQoNCiAgICBDaGVja01hY2hpbmVUYXNraW5nQXZhaWxhYmlsaXR5IHwgIENvbnZlcnRUby1KU09OUDINCg0KfWVsc2V7DQoNCiAgICBDaGVja01hY2hpbmVUYXNraW5nQXZhaWxhYmlsaXR5IHwgIENvbnZlcnRUby1Kc29uIC1EZXB0aCAxMA0KfSANCg0KDQo=","jsonSchema":"","uiSchema":"","isHDScript":true}
