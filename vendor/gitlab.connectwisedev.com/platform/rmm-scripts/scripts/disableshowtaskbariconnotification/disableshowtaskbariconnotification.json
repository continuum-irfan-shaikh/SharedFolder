{"id":"7c6e503d-2be5-11e9-b7c4-00155d130b17","partnerId":"00000000-0000-0000-0000-000000000000","category":["Maintenance"],"description":"Disable Always Show for taskbar icons/notifications","engine":"powershell","engineMaxVersion":5,"expectedExecutionTimeSec":300,"failureMessage":"Executed with errors","successMessage":"Script executed successfully","internal":false,"name":"Disable Always Show for taskbar icons or notifications","tags":["Windows 7","Windows 10"],"sequence":true,"content":"PCMKICAuU2NyaXB0CiAgRGlzYWJsZSBhbHdheXMgc2hvdyBmb3IgaWNvbnMgYW5kIG5vdGlmaWNhdGlvbi4KICAuQXV0aG9yCiAgTmlyYXYgU2FjaG9yYS4KICAuVmVyc2lvbgogIDIuMCBhbmQgYWJvdmUuCiAgLlJlcXVpcmVtZW50cwogIFNjcmlwdCBzaG91bGQgcnVuIHdpdGggaGlnaGVzdCBwcml2aWxlZ2VzLgojPgoKJHVzZXJzID0gQCgpCgpGdW5jdGlvbiBDcmVhdGVfcmVnaXN0cnkoJHBhdGgpICAgICMgRnVuY3Rpb24gd2lsbCBzZXQgcmVnaXN0cnkgdmFsdWUgYW5kIGlmIGl0ZW0gaXMgbm90IHByZXNlbnQgd2lsbCBjcmVhdGUgcmVnaXN0cnkgZW50cnkuCnsKJERldGFpbHMgPSBHZXQtSXRlbVByb3BlcnR5IC1QYXRoICRwYXRoCmlmKCREZXRhaWxzIC1uZSAkbnVsbCkKICAgIAl7CiAgICAkRGV0YWlscyA9IEdldC1JdGVtUHJvcGVydHkgLVBhdGggJHBhdGggfCBnbSB8IHNlbGVjdCAtRXhwYW5kUHJvcGVydHkgTmFtZQogICAgaWYoJERldGFpbHMgLWNvbnRhaW5zICdFbmFibGVBdXRvVHJheScpCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgU2V0LUl0ZW1Qcm9wZXJ0eSAkcGF0aCAtTmFtZSAnRW5hYmxlQXV0b1RyYXknIC1WYWx1ZSAxCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIE5ldy1JdGVtUHJvcGVydHkgLVBhdGggJHBhdGggLU5hbWUgJ0VuYWJsZUF1dG9UcmF5JyAtUHJvcGVydHlUeXBlICJEV29yZCIgLVZhbHVlIDEgfCBPdXQtTnVsbAogICAgICAgICAgICAgICAgICAgICAgICB9CgkKCX0gI0VuZCBpZiBzdGF0ZW1lbnQKZWxzZQoJewoJTmV3LUl0ZW1Qcm9wZXJ0eSAtUGF0aCAkcGF0aCAtTmFtZSAnRW5hYmxlQXV0b1RyYXknIC1Qcm9wZXJ0eVR5cGUgIkRXb3JkIiAtVmFsdWUgMSB8IE91dC1OdWxsCgl9ICAjIEVuZCBlbHNlIHN0YXRlbWVudAoKCWlmKChHZXQtSXRlbVByb3BlcnR5ICRwYXRoIC1OYW1lICdFbmFibGVBdXRvVHJheScgIHwgU2VsZWN0IC1FeHBhbmRQcm9wZXJ0eSBFbmFibGVBdXRvVHJheSkgLWVxIDEpe3JldHVybiAkdHJ1ZX0gZWxzZSB7cmV0dXJuICRmYWxzZX0KfSAgIyBFbmQgRnVuY3Rpb24gQ3JlYXRlX3JlZ2lzdHJ5CgojcmVnaXN0cnkgZWRpdCBmb3IgY3VycmVudGx5IGxvZ2dlZCB1aW4gdXNlcnMKdHJ5CnsKJHByb2ZpbGVsaXN0ID0gR2V0LUl0ZW0gIlJFZ2lzdHJ5OjpIS1VcUy0xLTUtMjEtKiIgfCBXaGVyZS1PYmplY3QgeyRfLk5hbWUgLW5vdGxpa2UgJypfQ2xhc3Nlcyd9IHwgc2VsZWN0IC1FeHBhbmRQcm9wZXJ0eSBuYW1lCmZvcmVhY2goJHByb2ZpbGUgaW4gJHByb2ZpbGVsaXN0KQogICAgewogICAgaWYoVGVzdC1wYXRoICJSZWdpc3RyeTo6JHByb2ZpbGVcVm9sYXRpbGUgRW52aXJvbm1lbnQiKQogICAgewogICAgJHVzZXJuYW1lID0gR2V0LUl0ZW1Qcm9wZXJ0eSAtUGF0aCAiUmVnaXN0cnk6OiRwcm9maWxlXFZvbGF0aWxlIEVudmlyb25tZW50IiAtTmFtZSBVc2VybmFtZSB8IFNlbGVjdCAtRXhwYW5kUHJvcGVydHkgVXNlcm5hbWUKCiAgICAkdGVzdCA9ICJSZWdpc3RyeTo6JHByb2ZpbGVcU29mdHdhcmVcTWljcm9zb2Z0XFdpbmRvd3NcQ3VycmVudFZlcnNpb25cRXhwbG9yZXIiCiAgICBpZigkdGVzdCkKICAgICAgICB7CiAgICAgICAgJGN1ID0gQ3JlYXRlX3JlZ2lzdHJ5IC1wYXRoICJSZWdpc3RyeTo6JHByb2ZpbGVcU29mdHdhcmVcTWljcm9zb2Z0XFdpbmRvd3NcQ3VycmVudFZlcnNpb25cRXhwbG9yZXIiCiAgICAgICAgaWYoJGN1IC1lcSAkZmFsc2UpCiAgICAgICAgICAgewogICAgICAgICAgIFdyaXRlLUVycm9yICJFcnJvciAkcHJvZmlsZSIKICAgICAgICAgICB9CiAgICAgICAgZWxzZQogICAgICAgICAgICB7CiAgICAgICAgJFVzZXJzICs9ICR1c2VybmFtZQogICAgICAgIH0KICAgICAgICB9CiAgICB9CiAgICBlbHNlCiAgICB7CiAgICBDb250aW51ZQogICAgfQogICAgfQp9CmNhdGNoCnsKICAgICRfLkV4Y2VwdGlvbi5NZXNzYWdlCn0KCiMgUmVnaXN0cnkgZWRpdCBmb3IgZGVmYXVsdCBwcm9maWxlcwogICAgCiAgICBSRUcgTE9BRCBIS1VcVEVNUCAiQzpcVXNlcnNcZGVmYXVsdFxOVFVTRVIuREFUIiB8IE91dC1OdWxsCiAgICBpZigkPykKICAgIHsKICAgICAgICAkZGVmYXVsdHBhdGggPSAiUmVnaXN0cnk6OkhLVVxURU1QXFNvZnR3YXJlXE1pY3Jvc29mdFxXaW5kb3dzXEN1cnJlbnRWZXJzaW9uXEV4cGxvcmVyIgogICAgICAgICRkZWZhdWx0cmVzdWx0ID0gQ3JlYXRlX3JlZ2lzdHJ5IC1wYXRoICRkZWZhdWx0cGF0aAogICAgICAgICAgICBpZigkZGVmYXVsdHJlc3VsdCAtZXEgJGZhbHNlKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBXcml0ZS1FcnJvciAiRXJyb3IgRGVmYXVsdCIKICAgICAgICAgICAgfSAgICAgICAgICAgICAgICAgICAgICAKICAgICAgIFJFRyBVTkxPQUQgSEtVXFRFTVAgfCBPdXQtTnVsbAogICAgfQogICAgZWxzZQogICAgewogICAgICAgIFdyaXRlLUVycm9yICJGYWlsZWQgdG8gbG9hZCByZWdpc3RyeSBmb3IgZGVmYXVsdCBwcm9maWxlIgogICAgfQoKI1JlZ2lzdHJ5IGVkaXQgZm9yIGN1cnJlbnQgcHJvZmlsZXMKCiRwcm9maWxlcyA9IGdldC1jaGlsZGl0ZW0gQzpcVXNlcnMgfCBzZWxlY3QgLUV4cGFuZFByb3BlcnR5IE5hbWUKZm9yZWFjaCgkcHJvZmlsZSBpbiAkcHJvZmlsZXMpCnsKICAgICRudHVzZXIgPSBUZXN0LVBhdGggQzpcVXNlcnNcJHByb2ZpbGVcTlRVU0VSLkRBVAogICAgaWYoJG50dXNlcikKICAgICAgICB7CiAgICAgICAgdHJ5CiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAkRmlsZVN0cmVhbSA9IFtTeXN0ZW0uSU8uRmlsZV06Ok9wZW4oIkM6XFVzZXJzXCRwcm9maWxlXE5UVVNFUi5EQVQiLCdPcGVuJywnV3JpdGUnKQogICAgICAgICAgICAgICAgICAgICRGaWxlU3RyZWFtLkNsb3NlKCkKICAgICAgICAgICAgICAgICAgICAkRmlsZVN0cmVhbS5EaXNwb3NlKCkKICAgICAgICAgICAgICAgICAgICBSRUcgTE9BRCBIS1VcVEVNUCAiQzpcVXNlcnNcJHByb2ZpbGVcTlRVU0VSLkRBVCIgfCBPdXQtTnVsbAogICAgICAgICAgICAgICAgICAgICRwYXRoID0gIlJlZ2lzdHJ5OjpIS1VcVEVNUFxTb2Z0d2FyZVxNaWNyb3NvZnRcV2luZG93c1xDdXJyZW50VmVyc2lvblxFeHBsb3JlciIKICAgICAgICAgICAgICAgICAgICAkcmVnaXN0cnkgPSBUZXN0LXBhdGggJHBhdGgKICAgICAgICAgICAgICAgICAgICBpZigkcmVnaXN0cnkpCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAkcmVzdWx0ID0gQ3JlYXRlX3JlZ2lzdHJ5IC1wYXRoICRwYXRoCiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCRyZXN1bHQgLWVxICRmYWxzZSkKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBXcml0ZS1PdXRwdXQgIkVycm9yICRwcm9maWxlIgogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAkVXNlcnMgKz0gJHByb2ZpbGUKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0gI0Nsb3NpbmcgSUYgTGluZSAyMwoKICAgICAgICAgICAgICAgICAgICBSRUcgVU5MT0FEIEhLVVxURU1QIHwgT3V0LU51bGwKICAgICAgICAgICAgfSAjQ2xvc2luZyBUcnkKICAgICAgICBjYXRjaAogICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBDb250aW51ZQogICAgICAgICAgIH0KICAgICAgICAgICAgCiAgICAgICAgfSAjQ2xvc2luZyBJRiBTdGF0ZW1lbnQgTGluZSAxMiAgCgp9ICMgQ2xvc2luZyBGb3JlYWNoIExvb3AKV3JpdGUtT3V0cHV0ICJBbHdheXMgc2hvdyBmb3IgaWNvbnMgYW5kIG5vdGlmaWNhdGlvbnMgaGFzIGJlZW4gZGlzYWJsZWQgZm9yIGJlbG93IHVzZXJzIG9uIHRoaXMgc3lzdGVtYG4iCldyaXRlLU91dHB1dCAkVXNlcnMKV3JpdGUtT3V0cHV0ICJgblBsZWFzZSBsb2dvZmYgYW5kIGxvZ2luLCBpZiBjaGFuZ2VzIGFyZSBub3QgcmVmbGVjdGVkLiIK","jsonSchema":"","uiSchema":"","isHDScript":false}
