{"id":"372a70c4-65d3-11e9-8bbd-00155d130b17","partnerId":"00000000-0000-0000-0000-000000000000","category":["Application"],"description":"Script will Install and Uninstall Webroot from the system","engine":"powershell","engineMaxVersion":5,"expectedExecutionTimeSec":600,"failureMessage":"Executed with errors","successMessage":"Task Executed Successfully","internal":false,"name":"Webroot Install and Uninstall","tags":["Windows 7","Windows 10"],"sequence":true,"content":"PCMKICAgIC5TeW5vcHNpcwogICAgICAgIFNjcmlwdCB3aWxsIEluc3RhbGwvVW5pbnN0YWxsL1VwZ3JhZGUgV2Vicm9vdCBmcm9tIHRoZSBzeXN0ZW0uCiAgICAuQXV0aG9yCiAgICAgICAgTmlyYXYgU2FjaG9yYQogICAgLlJlcXVpcmVtZW50cwogICAgICAgIFNjcmlwdCBTaG91bGQgcnVuIHdpdGggYWRtaW4gcHJpdmlsZWdlcy4KIz4KaWYgKCRlbnY6UFJPQ0VTU09SX0FSQ0hJVEVXNjQzMiAtZXEgIkFNRDY0IikgewogICAgaWYgKCRteUludm9jYXRpb24uTGluZSkgewogICAgICAgICYiJGVudjpzeXN0ZW1yb290XHN5c25hdGl2ZVx3aW5kb3dzcG93ZXJzaGVsbFx2MS4wXHBvd2Vyc2hlbGwuZXhlIiAtTm9uSW50ZXJhY3RpdmUgLU5vUHJvZmlsZSAkbXlJbnZvY2F0aW9uLkxpbmUKICAgIH0KICAgIGVsc2UgewogICAgICAgICYiJGVudjpzeXN0ZW1yb290XHN5c25hdGl2ZVx3aW5kb3dzcG93ZXJzaGVsbFx2MS4wXHBvd2Vyc2hlbGwuZXhlIiAtTm9uSW50ZXJhY3RpdmUgLU5vUHJvZmlsZSAtZmlsZSAiJCgkbXlJbnZvY2F0aW9uLkludm9jYXRpb25OYW1lKSIgJGFyZ3MKICAgIH0KICAgIGV4aXQgJGxhc3RleGl0Y29kZQp9CgokYml0ID0gKEdldC1XbWlPYmplY3QgV2luMzJfb3BlcmF0aW5nc3lzdGVtKS5Pc2FyY2hpdGVjdHVyZQoKaWYgKCRiaXQgLWVxICI2NC1iaXQiKSB7CiAgICAkd3JwYXRoID0gIkM6XFByb2dyYW0gRmlsZXMgKHg4NilcV2Vicm9vdCIKfQplbHNlIHsKICAgICR3cnBhdGggPSAiQzpcUHJvZ3JhbSBGaWxlc1xXZWJyb290Igp9CgoKRnVuY3Rpb24gQ2hlY2tfV2Vicm9vdCB7CiAgICAKJGJpdCA9IChHZXQtV21pT2JqZWN0IFdpbjMyX29wZXJhdGluZ3N5c3RlbSkuT3NhcmNoaXRlY3R1cmUKICAgIGlmICgkYml0IC1lcSAiNjQtYml0IikgewogICAgICAgICR3cnBhdGggPSAiQzpcUHJvZ3JhbSBGaWxlcyAoeDg2KVxXZWJyb290IgogICAgfQogICAgZWxzZSB7CiAgICAgICAgJHdycGF0aCA9ICJDOlxQcm9ncmFtIEZpbGVzXFdlYnJvb3QiCiAgICB9CgogICAgJHdyZXhpc3QgPSBUZXN0LVBhdGggJHdycGF0aAogICAgaWYgKCR3cmV4aXN0IC1lcSAkdHJ1ZSkgewogICAgICAgIHJldHVybiAkdHJ1ZQogICAgfQogICAgZWxzZSB7CiAgICAgICAgcmV0dXJuICRmYWxzZQogICAgfQp9CgoKRnVuY3Rpb24gVW5pbnN0YWxsIHsKICAgIGlmICgtbm90IChDaGVja19XZWJyb290KSkgewogICAgICAgIFdyaXRlLU91dHB1dCAiV2Vicm9vdCBpcyBub3QgaW5zdGFsbGVkIG9uIHRoaXMgc3lzdGVtLiIKICAgICAgICBFeGl0OwogICAgfQogICAgJHVybCA9ICJodHRwOi8vdXBkYXRlLml0c3VwcG9ydDI0Ny5uZXQvd2Vicm9vdC9VbnN0V2Vicm9vdC5leGUiCiAgICAkZG93bmxvYWRwYXRoID0gIkM6XFdpbmRvd3NcVGVtcFxVbnN0V2Vicm9vdC5leGUiCiAgICAkRXJyb3JBY3Rpb25QcmVmZXJlbmNlID0gIlNpbGVudGx5Q29udGludWUiCiAgICAkd2MgPSBOZXctT2JqZWN0IFN5c3RlbS5OZXQuV2ViQ2xpZW50CiAgICAkd2MuRG93bmxvYWRGaWxlKCIkdXJsIiwgIiRkb3dubG9hZHBhdGgiKQogICAgJHBpbmZvID0gTmV3LU9iamVjdCBTeXN0ZW0uRGlhZ25vc3RpY3MuUHJvY2Vzc1N0YXJ0SW5mbwogICAgJHBpbmZvLkZpbGVOYW1lID0gIkM6XFdpbmRvd3NcVGVtcFxVbnN0V2Vicm9vdC5leGUiCiAgICAkcGluZm8uUmVkaXJlY3RTdGFuZGFyZEVycm9yID0gJHRydWUKICAgICRwaW5mby5SZWRpcmVjdFN0YW5kYXJkT3V0cHV0ID0gJHRydWUKICAgICRwaW5mby5Vc2VTaGVsbEV4ZWN1dGUgPSAkZmFsc2UKICAgICRwaW5mby5Bcmd1bWVudHMgPSAiVW5pbnN0YWxsIgogICAgJHAgPSBOZXctT2JqZWN0IFN5c3RlbS5EaWFnbm9zdGljcy5Qcm9jZXNzCiAgICAkcC5TdGFydEluZm8gPSAkcGluZm8KICAgICRwLlN0YXJ0KCkgfCBPdXQtTnVsbAogICAgJHAuV2FpdEZvckV4aXQoKQogICAgJHJlc3VsdCA9ICRwLkV4aXRDb2RlCiAgICBpZigkcmVzdWx0IC1lcSAwKXsKICAgICAgICBXcml0ZS1PdXRwdXQgIldlYnJyb3QgaGFzIGJlZW4gdW5pc3RhbGxlZCBmcm9tIHRoZSBzeXN0ZW0uIiAgIAogICAgfQogICAgRWxzZXsKICAgICAgICBXcml0ZS1PdXRwdXQgIkZhaWxlZCB0byB1bmluc3RhbGwgd2Vicm9vdC4iCiAgICB9CiAgICBSZW1vdmUtSXRlbSAiQzpcV2luZG93c1xUZW1wXFVuc3RXZWJyb290LmV4ZSIKfQoKCkZ1bmN0aW9uIFdlYnJvb3RfSW5zdGFsbCgka2V5KSB7CiAgICAkdXJsID0gImh0dHA6Ly91cGRhdGUuaXRzdXBwb3J0MjQ3Lm5ldC93ZWJyb290L3dzYXNtZS5tc2kiCiAgICAkZG93bmxvYWRwYXRoID0gIkM6XFdpbmRvd3NcVGVtcFx3c2FzbWUubXNpIgogICAgJHdjID0gTmV3LU9iamVjdCBTeXN0ZW0uTmV0LldlYkNsaWVudAogICAgJHdjLkRvd25sb2FkRmlsZSgiJHVybCIsICIkZG93bmxvYWRwYXRoIikKICAgIAogICAgJHBpbmZvID0gTmV3LU9iamVjdCBTeXN0ZW0uRGlhZ25vc3RpY3MuUHJvY2Vzc1N0YXJ0SW5mbwogICAgJHBpbmZvLkZpbGVOYW1lID0gIm1zaWV4ZWMiCiAgICAkcGluZm8uUmVkaXJlY3RTdGFuZGFyZEVycm9yID0gJHRydWUKICAgICRwaW5mby5SZWRpcmVjdFN0YW5kYXJkT3V0cHV0ID0gJHRydWUKICAgICRwaW5mby5Vc2VTaGVsbEV4ZWN1dGUgPSAkZmFsc2UKICAgICRwaW5mby5Bcmd1bWVudHMgPSAiL2kgIEM6XFdpbmRvd3NcVGVtcFx3c2FzbWUubXNpIEdVSUxJQz0ka2V5IC9xbiIKICAgICRwID0gTmV3LU9iamVjdCBTeXN0ZW0uRGlhZ25vc3RpY3MuUHJvY2VzcwogICAgJHAuU3RhcnRJbmZvID0gJHBpbmZvCiAgICAkcC5TdGFydCgpIHwgT3V0LU51bGwKICAgICRwLldhaXRGb3JFeGl0KCkKICAgICRyZXN1bHQgPSAkcC5FeGl0Q29kZQogICAgaWYoJHJlc3VsdCAtZXEgMCkgewogICAgICAgIFdyaXRlLU91dHB1dCAiV2Vicm9vdCBoYXMgYmVlbiBpbnN0YWxsZWQgdG8gdGhlIHN5c3RlbS4iICAKICAgIH0KICAgIEVsc2V7CiAgICAgICAgV3JpdGUtT3V0cHV0ICJGYWlsZWQgdG8gaW5zdGFsbCB3ZWJyb290LiIKICAgIH0KICAgIFJlbW92ZS1JdGVtICJDOlxXaW5kb3dzXFRlbXBcd3Nhc21lLm1zaSIKfQoKCnN3aXRjaCgkb3BlcmF0aW9uKXsKICAgICJJbnN0YWxsIntXZWJyb290X0luc3RhbGwgLWtleSAka2V5Y29kZX0KICAgICJVbmluc3RhbGwie1VuaW5zdGFsbH0KfQo=","jsonSchema":{"additionproperties":false,"dependencies":{"operation":{"oneOf":[{"properties":{"keycode":{"title":"Enter Key Code:","type":"string"},"operation":{"enum":["Install"]}},"required":["keycode"]},{"properties":{"operation":{"enum":["Uninstall"]}}}]}},"patternpropertries":{"^keycode$":{}},"properties":{"operation":{"enum":["Install","Uninstall"],"enumNames":["Install","Uninstall"],"title":"Operation:","type":"string"}},"type":"object"},"uiSchema":{"keycode":{"classNames":"col-sm-8","ui:autofocus":true},"operation":{"classNames":"col-sm-3","ui:placeholder":"Select"},"ui:order":["operation","keycode"]},"isHDScript":false}
