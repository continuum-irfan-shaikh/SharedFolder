{"id":"09f30a9b-9152-11e9-866e-00155d130b01","partnerId":"00000000-0000-0000-0000-000000000000","category":["Maintenance"],"description":"O365 password reset","engine":"powershell","engineMaxVersion":5,"expectedExecutionTimeSec":300,"failureMessage":"Executed with errors","successMessage":"Executed Successfully","internal":false,"name":"O365 User Password Reset","tags":["Windows 7","Windows 10"],"sequence":true,"content":"Q2xlYXItSG9zdAoKPCMKW3N0cmluZ10kVXNlcklEID0gImphbmV0QEluZmluaXRlTG9jYWwub25taWNyb3NvZnQuY29tIgpbc3RyaW5nXSROZXdQYXNzd29yZCA9ICJqYW4jMTIzNDYiCgokQWRtaW5JRCA9ICJIZWxwZGVza0BJbmZpbml0ZUxvY2FsLm9ubWljcm9zb2Z0LmNvbSIKJEFkbWluUGFzc3dvcmQgPSAiSG9uZXlqYWluMTk4MiIKIz4KCiRBZG1pblBhc3N3b3JkID0gJEFkbWluUGFzc3dvcmQgfCBDb252ZXJ0VG8tU2VjdXJlU3RyaW5nIC1hc1BsYWluVGV4dCAtRm9yY2UgCiRBZG1pbkNyZWRlbnRpYWwgPSBOZXctT2JqZWN0IFN5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24uUFNDcmVkZW50aWFsKCRBZG1pbklELCRBZG1pblBhc3N3b3JkKSAKCiR0aW1lb3V0U2Vjb25kcyA9IDYwMAoKCiRTdWNjZXNzT2JqID0gTmV3LU9iamVjdCBQU09iamVjdAoKZnVuY3Rpb24gRXNjYXBlLUpTT05TdHJpbmcoJHN0cil7CiAgICBpZiAoJHN0ciAtZXEgJG51bGwpIHtyZXR1cm4gIiJ9CiAgICAgICAgICRzdHIgPSAkc3RyLlRvU3RyaW5nKCkuUmVwbGFjZSgnIicsJ1wiJykuUmVwbGFjZSgnXCcsJ1xcJykuUmVwbGFjZSgiYG4iLCdcbicpLlJlcGxhY2UoImByIiwnXHInKS5SZXBsYWNlKCJgdCIsJ1x0JykKICAgIHJldHVybiAkc3RyOwp9CgoKZnVuY3Rpb24gQ29udmVydFRvLUpTT05QMigkbWF4RGVwdGggPSAxMCwkZm9yY2VBcnJheSA9ICRmYWxzZSkgewpiZWdpbiB7CiRkYXRhID0gQCgpCn0KcHJvY2Vzc3sKJGRhdGEgKz0gJF8KfQplbmR7CmlmICgkZGF0YS5sZW5ndGggLWVxIDEgLWFuZCAkZm9yY2VBcnJheSAtZXEgJGZhbHNlKSB7CiR2YWx1ZSA9ICRkYXRhWzBdCn0gZWxzZSB7IAokdmFsdWUgPSAkZGF0YQp9CgoKaWYgKCR2YWx1ZSAtZXEgJG51bGwpIHsKcmV0dXJuICJudWxsIgp9CgoKCgokZGF0YVR5cGUgPSAkdmFsdWUuR2V0VHlwZSgpLk5hbWUKc3dpdGNoIC1yZWdleCAoJGRhdGFUeXBlKSB7CiAgICAgICAgICAgICdTdHJpbmcnICB7CnJldHVybiAgImAiezB9YCIiIC1mIChFc2NhcGUtSlNPTlN0cmluZyAkdmFsdWUgKQp9CiAgICAgICAgICAgICcoU3lzdGVtXC4pP0RhdGVUaW1lJyAge3JldHVybiAgImAiezA6eXl5eS1NTS1kZH1UezA6SEg6bW06c3N9YCIiIC1mICR2YWx1ZX0KICAgICAgICAgICAgJ0ludDMyfERvdWJsZScge3JldHVybiAgIiR2YWx1ZSJ9CidCb29sZWFuJyB7cmV0dXJuICAiJHZhbHVlIi5Ub0xvd2VyKCl9CiAgICAgICAgICAgICcoU3lzdGVtXC4pP09iamVjdFxbXF0nIHsgIyBhcnJheQppZiAoJG1heERlcHRoIC1sZSAwKXtyZXR1cm4gImAiJHZhbHVlYCIifQokanNvblJlc3VsdCA9ICcnCmZvcmVhY2goJGVsZW0gaW4gJHZhbHVlKXsKI2lmICgkZWxlbSAtZXEgJG51bGwpIHtjb250aW51ZX0KaWYgKCRqc29uUmVzdWx0Lkxlbmd0aCAtZ3QgMCkgeyRqc29uUmVzdWx0ICs9JywgJ30gCiRqc29uUmVzdWx0ICs9ICgkZWxlbSB8IENvbnZlcnRUby1KU09OUDIgLW1heERlcHRoICgkbWF4RGVwdGggLTEpKQp9CnJldHVybiAiWyIgKyAkanNvblJlc3VsdCArICJdIgogICAgICAgICAgICB9CicoU3lzdGVtXC4pP0hhc2h0YWJsZScgeyAjIGhhc2h0YWJsZQokanNvblJlc3VsdCA9ICcnCmZvcmVhY2goJGtleSBpbiAkdmFsdWUuS2V5cyl7CmlmICgkanNvblJlc3VsdC5MZW5ndGggLWd0IDApIHskanNvblJlc3VsdCArPScsICd9CiRqc29uUmVzdWx0ICs9IApAIgoiezB9IjogezF9CiJAIC1mICRrZXkgLCAoJHZhbHVlWyRrZXldIHwgQ29udmVydFRvLUpTT05QMiAtbWF4RGVwdGggKCRtYXhEZXB0aCAtMSkgKQp9CnJldHVybiAieyIgKyAkanNvblJlc3VsdCArICJ9Igp9CiAgICAgICAgICAgIGRlZmF1bHQgeyAjb2JqZWN0CmlmICgkbWF4RGVwdGggLWxlIDApe3JldHVybiAgImAiezB9YCIiIC1mIChFc2NhcGUtSlNPTlN0cmluZyAkdmFsdWUpfQpyZXR1cm4gInsiICsKKCgkdmFsdWUgfCBHZXQtTWVtYmVyIC1NZW1iZXJUeXBlICpwcm9wZXJ0eSB8ICUgeyAKQCIKInswfSI6IHsxfQoiQCAtZiAkXy5OYW1lICwgKCR2YWx1ZS4oJF8uTmFtZSkgfCBDb252ZXJ0VG8tSlNPTlAyIC1tYXhEZXB0aCAoJG1heERlcHRoIC0xKSApIAp9KSAtam9pbiAnLCAnKSArICJ9IgogICAgfQp9Cn0KfQoKRnVuY3Rpb24gQ2hlY2stUHJlQ29uZGl0aW9ueyAgIAogICAKICAgICMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMgICAgCiAgICAjIENoZWNrIGlmIGl0IGhhcyB0aGUgY29ycmVjdCBQUyBWZXJzaW9uCiAgICAjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCgogICAgaWYoLU5PVCgkUFNWZXJzaW9uVGFibGUuUFNWZXJzaW9uLk1ham9yIC1nZSAyKSl7ICAgCiAgICAgICAgICAgCiAgICAgICByZXR1cm4gIkVycm9yOlBvd2Vyc2hlbGwgdmVyc2lvbiBiZWxvdyAyLjAgaXMgbm90IHN1cHBvcnRlZCwgUGxlYXNlIHVwYWRldCBwb3dlcnNoZWxsIgoKICAgIH1lbHNleyB9CiAgICAKICAgICMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwogICAgIyBWZXJpZnkgd2hldGhlciBNU29ubGluZSBpcyBpbnN0YWxsZWQKICAgICMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwoKICAgIGlmKC1OT1QoR2V0LU1vZHVsZSAtTGlzdEF2YWlsYWJsZSAtTmFtZSAiTXNvbmxpbmUiKSl7CgogICAgICAgRG93bmxvYWRQb3dlclNoZWxsTW9kdWxlIC1Nb2R1bGVOYW1lICdNU09ubGluZScgJEZhbHNlCiAgICAgIAogICAgICB9ZWxzZXsgfSAgICAgICAgCiAgICAgIAogICAgIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjICAKICAgICMgVmVyaWZ5IHdoZXRoZXIgQXp1cmVBRCBpcyBpbnN0YWxsZWQKICAgICMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwoKICAgICBpZigtTk9UKEdldC1Nb2R1bGUgLUxpc3RBdmFpbGFibGUgLU5hbWUgIkF6dXJlQUQiKSl7CgogICAgICAgRG93bmxvYWRQb3dlclNoZWxsTW9kdWxlIC1Nb2R1bGVOYW1lICdBenVyZUFEJyAkRmFsc2UKICAgICAgCiAgICAgIH1lbHNleyAgfQogICAgCiAgICAjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMgIAogICAgIyBWZXJpZnkgd2hldGhlciBBenVyZXJSTS5wcm9maWxlIGlzIGluc3RhbGxlZAogICAgIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiAgICAKICAgICBpZigtTk9UKEdldC1Nb2R1bGUgLUxpc3RBdmFpbGFibGUgLU5hbWUgIkF6dXJlUk0ucHJvZmlsZSIpKXsKCiAgICAgICBEb3dubG9hZFBvd2VyU2hlbGxNb2R1bGUgLU1vZHVsZU5hbWUgJ0F6dXJlUk0ucHJvZmlsZScgJEZhbHNlCiAgICAgIAogICAgICB9ZWxzZXsgfQogICAgICAgICAKICAgICMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyAgIAogICAgIyBDaGVjayBBZG1pbiBJbnB1dHMKICAgICMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyAgCgogICAgaWYoKFtzdHJpbmddOjpJc051bGxPckVtcHR5KCRBZG1pbklEKSkgLWFuZCAtbm90KFtzdHJpbmddOjpJc051bGxPckVtcHR5KCRBZG1pblBhc3N3b3JkKSkpCiAgICB7ICAgICAgIAogICAgICAgIHJldHVybiAiRXJyb3I6UGxlYXNlIHByb3ZpZGUgYWRtaW4gbG9naW4gaWQiIAoKICAgIH1lbHNlaWYoLW5vdChbc3RyaW5nXTo6SXNOdWxsT3JFbXB0eSgkQWRtaW5JRCkpIC1hbmQgKFtzdHJpbmddOjpJc051bGxPckVtcHR5KCRBZG1pblBhc3N3b3JkKSkpewoKICAgICAgICByZXR1cm4gIkVycm9yOlBsZWFzZSBwcm92aWRlIGFkbWluIGxvZ2luIHBhc3N3b3JkIiAKCiAgICB9ZWxzZWlmKChbc3RyaW5nXTo6SXNOdWxsT3JFbXB0eSgkQWRtaW5JRCkpIC1hbmQgKFtzdHJpbmddOjpJc051bGxPckVtcHR5KCRBZG1pblBhc3N3b3JkKSkpewoKICAgICAgICByZXR1cm4gIkVycm9yOlBsZWFzZSBwcm92aWRlIGFkbWluIGxvZ2luIGlkIGFuZCBwYXNzd29yZCIKICAKICAgIH0KCiAgICAgICAgCiAgICMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyAgIAogICAgIyBJZiBNRkEge011bHRpIEZhY3RvciBBdXRoZW50aWNhdGlvbn0gaXMgZW5hYmxlZAogICAgIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjICAKICAgIAogICAgdHJ5eyAgICAKICAgICAgICAkbnVsbCA9IENvbm5lY3QtQXp1cmVSbUFjY291bnQgLUNyZWRlbnRpYWwgJEFkbWluQ3JlZGVudGlhbCAtRXJyb3JBY3Rpb24gU3RvcCAgICAKICAgICAgICAKICAgICB9Y2F0Y2h7CiAgICAgICAgICAKICAgICAgICAgICAgICAgCiAgICAgICAgIGlmKCgkXy5FeGNlcHRpb24uTWVzc2FnZSkuVG9TdHJpbmcoKS5Db250YWlucygiRHVlIHRvIGEgY29uZmlndXJhdGlvbiBjaGFuZ2UgbWFkZSBieSB5b3VyIGFkbWluaXN0cmF0b3IiKSl7CiAgICAgICAgICAgIAogICAgICAgICAgIHJldHVybiAiRXJyb3I6QmFkIHVzZXJuYW1lIG9yIHBhc3N3b3JkIgogICAgICAgICAgICAKICAgICAgICAgfWVsc2V7CgogICAgICAgICAgICByZXR1cm4gIkVycm9yOiQoJF8uRXhjZXB0aW9uLk1lc3NhZ2UpIgogICAgICAgICB9CiAgICAgICAgCiAgICAgfSAKICAgICMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMgICAKICAgICMgQ2hlY2sgaWYgTzM2NSBBZG1pbiBjcmVkZW50aWFscyB3b3JrICAKICAgICMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMgCgogICAgdHJ5CiAgICB7ICAgCiAgICAgICAkbnVsbCA9IENvbm5lY3QtTXNvbFNlcnZpY2UgLUNyZWRlbnRpYWwgJEFkbWluQ3JlZGVudGlhbCAtRXJyb3JBY3Rpb24gU3RvcAogICAgICAgICRyb2xlID0gR2V0LU1zb2xSb2xlIC1Sb2xlTmFtZSAiSGVscGRlc2sgQWRtaW5pc3RyYXRvciIgLUVycm9yQWN0aW9uIFN0b3AKCiAgICAgICAgaWYoR2V0LU1zb2xSb2xlTWVtYmVyIC1Sb2xlT2JqZWN0SWQgJHJvbGUuT2JqZWN0SWQgfCBXaGVyZS1PYmplY3QgeyRfLkVtYWlsQWRkcmVzcyAtZXEgJEFkbWluSUQgfSl7CiAgICAgICAgICAKICAgICAgICB9ZWxzZXsKICAgICAgICAgIHJldHVybiAiRXJyb3I6QWRtaW4gY3JlZGVudGlhbHMgcHJvdmlkZWQgYXJlIGluY29ycmVjdCBhbmQgbmVlZCB1cGRhdGVkIgogICAgICAgIH0KCiAgICB9Y2F0Y2h7CiAgICAgICAgICAgICAgICAKICAgICAgICAgcmV0dXJuICJFcnJvcjokKCRfLkV4Y2VwdGlvbi5NZXNzYWdlKSIgCiAgICAKICAgIH0gICAKICAgIAoKICAgICMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyAgICAKICAgICMgQ2hlY2sgaWYgaXQgY2FuIHJlYWNoIE8zNjUKICAgICMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKCiAgICBpZigtTk9UKEdldC1Nc29sRG9tYWluIC1FcnJvckFjdGlvbiBTaWxlbnRseUNvbnRpbnVlKSl7CiAgIAogICAgICAgcmV0dXJuICJFcnJvcjpPZmZpY2UgMzY1IHNlcnZpY2UgaXMgbm90IHJlYWNoYWJsZSIKCiAgICAgfWVsc2V7IH0KICAgCiAgICAjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKICAgICMgaWYgdXNlciBleGlzdHMgCiAgICAjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKCiAgICBpZigoW3N0cmluZ106OklzTnVsbE9yRW1wdHkoJFVzZXJJRCkpIC1hbmQgLW5vdChbc3RyaW5nXTo6SXNOdWxsT3JFbXB0eSgkTmV3UGFzc3dvcmQpKSkKICAgIHsKICAgICAgICByZXR1cm4gIkVycm9yOlBsZWFzZSBwcm92aWRlIHVzZXIgbmFtZSIKCiAgICB9ZWxzZWlmKC1ub3QoW3N0cmluZ106OklzTnVsbE9yRW1wdHkoJFVzZXJJRCkpIC1hbmQgKFtzdHJpbmddOjpJc051bGxPckVtcHR5KCROZXdQYXNzd29yZCkpKXsKICAgICAgICAgICAgCiAgICAgICAgcmV0dXJuICJFcnJvcjpQbGVhc2UgcHJvdmlkZSBuZXcgcGFzc3dvcmQiIAoKICAgIH1lbHNlaWYoKFtzdHJpbmddOjpJc051bGxPckVtcHR5KCRVc2VySUQpKSAtYW5kIChbc3RyaW5nXTo6SXNOdWxsT3JFbXB0eSgkTmV3UGFzc3dvcmQpKSl7CiAgICAgICAgCiAgICAgICAgcmV0dXJuICJFcnJvcjpQbGVhc2UgcHJvdmlkZSB1c2VyIG5hbWUgYW5kIG5ldyBwYXNzd29yZCIKICAgIH0KCiAgICBpZigkTmV3UGFzc3dvcmQuVG9DaGFyQXJyYXkoKS5MZW5ndGggLWx0IDgpewogICAgICAgcmV0dXJuICJFcnJvcjpVc2VyIHBhc3N3b3JkIHNob3VsZCBiZSBhdCBsZWFzdCBvZiA4IGNoYXJhY3RlcnMiIAogICAgfQogICAKICAgIDwjIGlmKEdldC1Nc29sVXNlciB8IFdoZXJlLU9iamVjdCB7JF8uVXNlclByaW5jaXBhbE5hbWUgLWVxICRVc2VySUQgfSl7CiAgICAgICAgICAgICAKICAgICAgICAkQWxsTGljZW5zZXMgPSBHZXQtTXNvbFVzZXIgfCBXaGVyZS1PYmplY3QgeyRfLlVzZXJQcmluY2lwYWxOYW1lIC1tYXRjaCAkVXNlcklEIH0gfCBzZWxlY3QgTGljZW5zZXMgfCBPdXQtRGVmYXVsdAoKICAgICAgICAkU3VjY2Vzc09iaiB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5IC1OYW1lIEFsbExpY2Vuc2VzIC12YWx1ZSAgJEFsbExpY2Vuc2VzCiAgICAgICAgIAogICAgfWVsc2V7ICAgICAgICAKICAgICAKICAgICAgaWYoKEdldC1Nc29sVXNlciB8IFdoZXJlLU9iamVjdCB7JF8uVXNlclByaW5jaXBhbE5hbWUgLWxpa2UgICQoJFVzZXJJRC5Ub0NoYXJBcnJheSgwLDEpKSArJyonIH0pIC1lcSAkbnVsbCl7CiAgICAgICAgICAgCiAgICAgICAgICAgIHJldHVybiAiRXJyb3I6VXNlciBub3QgZm91bmQgLE5vIFVzZXIgZm91bmQgc3RhcnRpbmcgd2l0aCAkKCgkVXNlcklELlRvQ2hhckFycmF5KDAsMSkpWzBdLlRvU3RyaW5nKCkuVG9VcHBlcigpKSIgICAgICAgICAgCgogICAgICAgfWVsc2V7CiAgICAgICAgICAgIAogICAgICAgICAgICAgcmV0dXJuICJFcnJvcjE6VXNlciBub3QgZm91bmQsIFVzZXJzIGZvdW5kIHN0YXJ0aW5nIHdpdGggJCgoJFVzZXJJRC5Ub0NoYXJBcnJheSgwLDEpKVswXS5Ub1N0cmluZygpLlRvVXBwZXIoKSkiICAgICAgICAgIAogICAgICAgICAgICAgCiAgICAgICAgICAgIDwjICAkayA9IFN0YXJ0LUpvYiAtU2NyaXB0QmxvY2sgewoKICAgICAgICAgICAgICAgICAgJHVzZXIyID0gR2V0LU1zb2xVc2VyIHwgV2hlcmUtT2JqZWN0IHskXy5Vc2VyUHJpbmNpcGFsTmFtZSAtbGlrZSAgJCgkVXNlcklELlRvQ2hhckFycmF5KDAsMSkpICsnKicgfQogICAgICAgICAgICAgICAgICAkdXNlcjIgfCBzZWxlY3QgRGlzcGxheU5hbWUgLCBVc2VyUHJpbmNpcGFsTmFtZSB8ICBPdXQtRGVmYXVsdCAKICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgV2FpdC1Kb2IgJGsgLVRpbWVvdXQgJHRpbWVvdXRTZWNvbmRzIHwgb3V0LW51bGwKCiAgICAgICAgICAgICAgICBpZiAoJGsuU3RhdGUgLWVxICJDb21wbGV0ZWQiKXsgCgogICAgICAgICAgICAgICAgICAkdXNlcjIgPSBHZXQtTXNvbFVzZXIgfCBXaGVyZS1PYmplY3QgeyRfLlVzZXJQcmluY2lwYWxOYW1lIC1saWtlICAkKCRVc2VySUQuVG9DaGFyQXJyYXkoMCwxKSkgKycqJyB9CiAgICAgICAgICAgICAgICAgICR1c2VyMiB8IHNlbGVjdCBEaXNwbGF5TmFtZSAsIFVzZXJQcmluY2lwYWxOYW1lIHwgIE91dC1EZWZhdWx0IAogICAgICAgICAgICAgICAgICAkRXJyb3JBcnIgKz0gJHVzZXIyIAogICAgICAgICAgICAKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2VpZiAoJGsuU3RhdGUgLWVxICJSdW5uaW5nIil7IAoKICAgICAgICAgICAgICAgICAgICBXcml0ZS1XYXJuaW5nICJTeXN0ZW0gdGltZW91dCIKICAgICAgICAgICAgICAgICAgICBleGl0CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlewoKICAgICAgICAgICAgICAgICAgICBXcml0ZS1XYXJuaW5nICJTeXN0ZW0gdGltZW91dCIKICAgICAgICAgICAgICAgICAgICBleGl0CiAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgUmVtb3ZlLUpvYiAtZm9yY2UgJEsgCgogICAgICAgICAgICAgICAgIz4KICAgICAgICAgIAogICAgIDwjICB9CgogICAgICAKICAgIAogICAgfSM+CiAgICAKICAgICMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwogICAgIyBHZXQgQmxvY2sgU3RhdHVzCiAgICAjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKCiAgICAgICAgIAogICAgIGlmKChHZXQtTXNvbFVzZXIgLVVzZXJQcmluY2lwYWxOYW1lICRVc2VySUQgfCBTZWxlY3QgVXNlcnByaW5jaXBhbG5hbWUsYmxvY2tjcmVkZW50aWFsKS5ibG9ja2NyZWRlbnRpYWwpewoKICAgICAgICByZXR1cm4gIkVycm9yOkN1cnJlbnQgU3RhdHVzIC0gQmxvY2tlZCIKICAgICB9CiAgICAgZWxzZSB7IAogICAgICAgJFN1Y2Nlc3NPYmogfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAtTmFtZSBDdXJyZW50U3RhdHVzIC12YWx1ZSAiTm90IEJsb2NrZWQiCiAgICAgIH0KICAgIAoKICAgICMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwogICAgIyBHZXQgRW5hYmxlIC8gRGlzYWJsZSBTdGF0dXMKICAgICMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwoKICAgIAogICAgdHJ5ewoKICAgICAgICRudWxsID0gQ29ubmVjdC1BenVyZUFEIC1DcmVkZW50aWFsICRBZG1pbkNyZWRlbnRpYWwgLUVycm9yQWN0aW9uIFN0b3AKCiAgICAgICAkbnVsbCA9ICRBRFVzZXIgPSBHZXQtQXp1cmVBRFVzZXIgfCBXaGVyZS1PYmplY3QgeyRfLlVzZXJQcmluY2lwYWxOYW1lIC1lcSAkVXNlcklEIH0KCiAgICAKICAgICAgICBpZigkQURVc2VyLkFjY291bnRFbmFibGVkKXsgCiAgICAKICAgICAgICAgICRudWxsID0gJFN1Y2Nlc3NPYmogfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAtTmFtZSBDdXJyZW50VXNlckFjY291bnRTdGF0dXMgLXZhbHVlICJFbmFibGVkIgogICAgICAgIAogICAgICAgICB9CiAgICAgICAgZWxzZXsKICAgICAgICAgICAgICAgICAKICAgIAogICAgICAgICAgICRudWxsID0gJFN1Y2Nlc3NPYmogfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAtTmFtZSBDdXJyZW50VXNlckFjY291bnRTdGF0dXMgLXZhbHVlICJEaXNhYmxlZCIKICAgICAgICAKICAgICAgICAgfSAgCiAgICAKICAgIH1jYXRjaHsKICAgICAgICAgICAgCiAgICAgICAgIHJldHVybiAiRXJyb3I6WyQoJF8uRXhjZXB0aW9uLk1lc3NhZ2UpIgoKICAgIH0gICAKICAgICAgICAKICAgIHJldHVybiAiU3VjY2VzczpQcmVDb25kaXRpb24gZXhlY3V0ZWQgc3VjY2Vzc2Z1bGx5IiAgCiAgIAp9CgoKCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIyMjLS0tLS0tRG93bmxvYWQgTVNPbmxpbmUvIEF6dXJlQUQgZnJvbSBHYWxsZXJ5IC0tLS0tLS0tLQojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCgokTnVHZXRQYWNrYWdlQ29kZSA9IEAiCnVzaW5nIFN5c3RlbS5OZXQ7CgpwdWJsaWMgY2xhc3MgR2V0TnVHZXRQYWNrYWdlIDogV2ViQ2xpZW50CnsgICAKICAgIHByb3RlY3RlZCBvdmVycmlkZSBXZWJSZXF1ZXN0IEdldFdlYlJlcXVlc3QoU3lzdGVtLlVyaSBhZGRyZXNzKQogICAgewogICAgICAgIFdlYlJlcXVlc3QgcmVxdWVzdCA9IGJhc2UuR2V0V2ViUmVxdWVzdChhZGRyZXNzKTsKICAgICAgICBpZiAocmVxdWVzdCAhPSBudWxsKQogICAgICAgIHsKICAgICAgICAgICAgcmV0dXJuIHJlcXVlc3Q7CiAgICAgICAgfQogICAgICAgIHJldHVybiByZXF1ZXN0OwogICAgfSAgIAp9CiJAOwojIGNoZWNrIHR5cGUgaWYgYWxyZWFkeSBhZGRlZAppZiAoLW5vdCAoW1N5c3RlbS5NYW5hZ2VtZW50LkF1dG9tYXRpb24uUFNUeXBlTmFtZV0nR2V0TnVHZXRQYWNrYWdlJykuVHlwZSkKewogICAgQWRkLVR5cGUgLVR5cGVEZWZpbml0aW9uICROdUdldFBhY2thZ2VDb2RlIC1MYW5ndWFnZSBDU2hhcnAKfQoKZnVuY3Rpb24gSXNEb3ROZXRGcmFtZVdvcms0NU9yQWJvdmUKewogICAgcGFyYW0oCiAgICAgICAgW3N0cmluZ10kQ29tcHV0ZXJOYW1lID0gJGVudjpDT01QVVRFUk5BTUUKICAgICkKICAgIAogICAgJHRlbXBPYmogPSBOZXctT2JqZWN0IFBTT2JqZWN0CiAgICAkdGVtcE9iaiB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5IC1OYW1lIHRlbXBWZXJzaW9uICAtdmFsdWUgIjAuMCIgICAgCiAgICAKICAgICRkb3ROZXRSZWdpc3RyeSAgPSAnU09GVFdBUkVcTWljcm9zb2Z0XE5FVCBGcmFtZXdvcmsgU2V0dXBcTkRQJwogICAgCiAgICAgaWYoJHJlZ0tleSA9IFtNaWNyb3NvZnQuV2luMzIuUmVnaXN0cnlLZXldOjpPcGVuUmVtb3RlQmFzZUtleSgnTG9jYWxNYWNoaW5lJywgJENvbXB1dGVyTmFtZSkpCiAgICAgIHsKICAgICAgICAgaWYgKCRuZXRSZWdLZXkgPSAkcmVnS2V5Lk9wZW5TdWJLZXkoIiRkb3ROZXRSZWdpc3RyeSIpKQogICAgICAgICAgewogICAgICAgICAgICAgZm9yZWFjaCAoJHZlcnNpb25LZXlOYW1lIGluICRuZXRSZWdLZXkuR2V0U3ViS2V5TmFtZXMoKSkKICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgaWYgKCR2ZXJzaW9uS2V5TmFtZSAtbWF0Y2ggJ152WzEyM10nKSB7CiAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICR2ZXJzaW9uS2V5ID0gJG5ldFJlZ0tleS5PcGVuU3ViS2V5KCR2ZXJzaW9uS2V5TmFtZSkKICAgICAgICAgICAgICAgICAgICAgJHZlcnNpb24gPSBbU3lzdGVtLlZlcnNpb25dKCR2ZXJzaW9uS2V5LkdldFZhbHVlKCdWZXJzaW9uJywgJycpKQogICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgJEROZXRNYWpvciA9ICR2ZXJzaW9uLk1ham9yLlRvU3RyaW5nKCkKICAgICAgICAgICAgICAgICAgICAgJEROZXRNaW5vciA9ICR2ZXJzaW9uLk1pbm9yLlRvU3RyaW5nKCkKICAgICAgICAgICAgICAgICAgICAgJEROZXRWZXJzaW9uID0gJEROZXRNYWpvciArICcuJyArICRETmV0TWlub3IKICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICR0ZW1wT2JqLnRlbXBWZXJzaW9uID0gW1N5c3RlbS5WZXJzaW9uXSIwLjAiCiAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICBpZihbVmVyc2lvbl0kRE5ldFZlcnNpb24gLWd0IFtWZXJzaW9uXSR0ZW1wT2JqLnRlbXBWZXJzaW9uKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgJHRlbXBPYmoudGVtcFZlcnNpb24gPSAkRE5ldFZlcnNpb24KICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAKICAgICAgICAgICAgICBpZihbVmVyc2lvbl0kdGVtcE9iai50ZW1wVmVyc2lvbiAtZ2UgW1ZlcnNpb25dIjQuNSIpewogICAgICAgICAgICAgICAgcmV0dXJuICR0cnVlCiAgICAgICAgICAgICAgfWVsc2V7IHJldHVybiAkZmFsc2UgfQogICAgICAgICAgIH0gICAgICAgICAgIAogICAgICAgICAgIAogICAgICB9ICAKfQoKCmZ1bmN0aW9uIFVuemlwLTIwKCR6aXBmaWxlLCAkZGVzdGluYXRpb24pCnsKICAgICRzaGVsbCA9IE5ldy1PYmplY3QgLUNvbU9iamVjdCBTaGVsbC5BcHBsaWNhdGlvbgogICAgJHppcCA9ICRzaGVsbC5OYW1lU3BhY2UoJHppcGZpbGUpCiAgICBmb3JlYWNoKCRpdGVtIGluICR6aXAuaXRlbXMoKSkKICAgIHsgICAgICAgIAogICAgICAgICRzaGVsbC5OYW1lc3BhY2UoJGRlc3RpbmF0aW9uKS5jb3B5aGVyZSgkaXRlbSkKICAgIH0KfQoKCmZ1bmN0aW9uIFVuemlwLTQ1KCR6aXBmaWxlLCAkZGVzdGluYXRpb24pCnsKICAgIEFkZC1UeXBlIC1Bc3NlbWJseU5hbWUgU3lzdGVtLklPLkNvbXByZXNzaW9uLkZpbGVTeXN0ZW0KICAgIHBhcmFtKFtzdHJpbmddJHppcGZpbGUsIFtzdHJpbmddJGRlc3RpbmF0aW9uKQogICAgW1N5c3RlbS5JTy5Db21wcmVzc2lvbi5aaXBGaWxlXTo6RXh0cmFjdFRvRGlyZWN0b3J5KCR6aXBmaWxlLCAkZGVzdGluYXRpb24pCn0KCkZ1bmN0aW9uIERvd25sb2FkUG93ZXJTaGVsbE1vZHVsZShbU3RyaW5nXSAkTW9kdWxlTmFtZSwgW2Jvb2xdICRJc1ZlcnNpb25Gb2xkZXJFeGlzdCkKewogICAKICAgICRwYWNrYWdlT2JqID0gTmV3LU9iamVjdCBQU09iamVjdAogICAgJHBhY2thZ2VPYmogfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAtTmFtZSBQYWNrYWdlQVBJIC12YWx1ZSAiaHR0cHM6Ly93d3cucG93ZXJzaGVsbGdhbGxlcnkuY29tL2FwaSIKICAgICRwYWNrYWdlT2JqIHwgQWRkLU1lbWJlciBOb3RlcHJvcGVydHkgLU5hbWUgUGFja2FnZVZlciAtdmFsdWUgInYyIgogICAgJHBhY2thZ2VPYmogfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAtTmFtZSBNc01vZHVsZSAtdmFsdWUgIk1TT25saW5lLzEuMS4xODMuMTciCiAgICAkcGFja2FnZU9iaiB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5IC1OYW1lIEFkTW9kdWxlIC12YWx1ZSAiQXp1cmVBRC8yLjAuMi40IgogICAgJHBhY2thZ2VPYmogfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAtTmFtZSBBelJNTW9kdWxlIC12YWx1ZSAiYXp1cmVybS5wcm9maWxlLzUuOC4zIgogICAgJHBhY2thZ2VPYmogfCBBZGQtTWVtYmVyIE5vdGVwcm9wZXJ0eSAtTmFtZSBEb3dubG9hZFN0cmluZyAtdmFsdWUgIiIKCiAgICBpZigkTW9kdWxlTmFtZSAtZXEgIk1TT25saW5lIil7CiAgICAgICAgICAgIAogICAgICAgICRwYWNrYWdlT2JqLkRvd25sb2FkU3RyaW5nID0gJHBhY2thZ2VPYmouUGFja2FnZUFQSSArIi8iICsgJHBhY2thZ2VPYmouUGFja2FnZVZlciArIi9wYWNrYWdlLyIrICRwYWNrYWdlT2JqLk1zTW9kdWxlIAogICAgICAgIAogICAgfWVsc2VpZigkTW9kdWxlTmFtZSAtZXEgIkF6dXJlQUQiKXsgICAgICAgCiAgICAgICAgCiAgICAgICAgJHBhY2thZ2VPYmouRG93bmxvYWRTdHJpbmcgPSAkcGFja2FnZU9iai5QYWNrYWdlQVBJICsiLyIgKyAkcGFja2FnZU9iai5QYWNrYWdlVmVyICsiL3BhY2thZ2UvIisgJHBhY2thZ2VPYmouQWRNb2R1bGUgCgogICAgfWVsc2VpZigkTW9kdWxlTmFtZSAtZXEgIkF6dXJlUk0ucHJvZmlsZSIpeyAgICAgICAKICAgICAgICAKICAgICAgICAkcGFja2FnZU9iai5Eb3dubG9hZFN0cmluZyA9ICRwYWNrYWdlT2JqLlBhY2thZ2VBUEkgKyIvIiArICRwYWNrYWdlT2JqLlBhY2thZ2VWZXIgKyIvcGFja2FnZS8iKyAkcGFja2FnZU9iai5BelJNTW9kdWxlIAogICAgIH0KCiAgICB0cnl7CiAgICAgICAKICAgICAgICAkd2ViQ2xpZW50ID0gTmV3LU9iamVjdCBHZXROdUdldFBhY2thZ2UKICAgICAgICAkZG93bmxvYWRlZCA9ICR3ZWJDbGllbnQuZG93bmxvYWRTdHJpbmcoJHBhY2thZ2VPYmouRG93bmxvYWRTdHJpbmcpIAogICAgICAgICR0ZW1wUGF0aCA9IGpvaW4tcGF0aCAkKFtTeXN0ZW0uSU8uUGF0aF06OkdldFRlbXBQYXRoKCkpICQoJE1vZHVsZU5hbWUgKyIuemlwIikgICAgCiAgICAgICAgQWRkLUNvbnRlbnQgLXBhdGggJHRlbXBQYXRoIC12YWx1ZSAkZG93bmxvYWRlZAogICAgICAgICAgICAgIAogICAgICAgICR1blppcE1vZHVsZVBhdGggPSBqb2luLXBhdGggJChbU3lzdGVtLklPLlBhdGhdOjpHZXRUZW1wUGF0aCgpKSAtQ2hpbGRQYXRoICJudWdldFBhY2thZ2UiCiAgICAgICAgCiAgICAgICAgaWYoIShUZXN0LVBhdGggLVBhdGggJHVuWmlwTW9kdWxlUGF0aCApKXsKICAgICAgICAKICAgICAgICAgICAkZGlyID0gTmV3LUl0ZW0gLUl0ZW1UeXBlIGRpcmVjdG9yeSAtUGF0aCAkdW5aaXBNb2R1bGVQYXRoCiAgICAgICAgfQogICAgICAgIAogICAgICAgIGlmKElzRG90TmV0RnJhbWVXb3JrNDVPckFib3ZlKXsKICAgICAgICAKICAgICAgICAgICAgVW56aXAtNDUgJHRlbXBQYXRoICR1blppcE1vZHVsZVBhdGgKICAgICAgICAKICAgICAgICB9ZWxzZXsgCiAgICAgICAgCiAgICAgICAgICAgIFVuemlwLTIwICR0ZW1wUGF0aCAkdW5aaXBNb2R1bGVQYXRoCiAgICAgICAgCiAgICAgICAgfSAgICAgICAgICAgICAgIAoKICAgICAgICBpZigtbm90KCRJc1ZlcnNpb25Gb2xkZXJFeGlzdCkpCiAgICAgICAgewogICAgICAgICAgICBmb3JlYWNoKCRwYXRoIGluICRlbnY6UFNNb2R1bGVQYXRoLlNwbGl0KCc7JykgKQogICAgICAgICAgICB7ICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgaWYoJHBhdGguY29udGFpbnMoInN5c3RlbTMyIikgLW9yICRwYXRoLmNvbnRhaW5zKCJQcm9ncmFtIEZpbGVzIikgKQogICAgICAgICAgICAgICAgeyAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgdHJ5CiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAkcHNNb2R1bGVQYXRoID0gSm9pbi1QYXRoIC1QYXRoICRwYXRoIC1DaGlsZFBhdGggJE1vZHVsZU5hbWUKICAgICAgICAgICAgICAgICAgICAgICAgaWYoIShUZXN0LVBhdGggLVBhdGggJHBzTW9kdWxlUGF0aCApKXsgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICRkaXIgPSBOZXctSXRlbSAtSXRlbVR5cGUgZGlyZWN0b3J5IC1QYXRoICRwc01vZHVsZVBhdGggICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICB9IAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgJHNvdXJjZVBhdGggPSBKb2luLVBhdGggLVBhdGggJHVuWmlwTW9kdWxlUGF0aCAtQ2hpbGRQYXRoICJcKiIKICAgICAgICAgICAgICAgICAgICAgICAgQ29weS1JdGVtIC1QYXRoICRzb3VyY2VQYXRoIC1EZXN0aW5hdGlvbiAkcHNNb2R1bGVQYXRoIC1yZWN1cnNlIC1Gb3JjZSAKICAgICAgICAgICAgICAgICAgICB9ICAgICAKICAgICAgICAgICAgICAgICAgICBjYXRjaAogICAgICAgICAgICAgICAgICAgIHsgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gIkVycm9yOiQoJF8uRXhjZXB0aW9uLk1lc3NhZ2UpIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gIAogICAgICAgICAgIAogICAgICAgICB9CiAgICAgICAgIGVsc2UKICAgICAgICAgewogICAgICAgICAgICBmb3JlYWNoKCRmb2xkZXIgaW4gR2V0LUNoaWxkSXRlbSAtUGF0aCAkdW5aaXBNb2R1bGVQYXRoIC1SZWN1cnNlIHwgP3sgJF8uUFNJc0NvbnRhaW5lciB9KQogICAgICAgICAgICB7ICAgICAgICAKICAgICAgICAgICAgICAgIGlmKCRmb2xkZXIuTmFtZSAtZXEgJE1vZHVsZU5hbWUpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgZm9yZWFjaCgkcGF0aCBpbiAkZW52OlBTTW9kdWxlUGF0aC5TcGxpdCgnOycpICkKICAgICAgICAgICAgICAgICAgICB7IAogICAgICAgICAgICAgICAgICAgICAgICBpZigkcGF0aC5jb250YWlucygic3lzdGVtMzIiKSAtb3IgJHBhdGguY29udGFpbnMoIlByb2dyYW0gRmlsZXMiKSApCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeQogICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRwc01vZHVsZVBhdGggPSBKb2luLVBhdGggLVBhdGggJHBhdGggLUNoaWxkUGF0aCAkTW9kdWxlTmFtZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCEoVGVzdC1QYXRoIC1QYXRoICRwc01vZHVsZVBhdGggKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7ICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRkaXIgPSAgTmV3LUl0ZW0gLUl0ZW1UeXBlIGRpcmVjdG9yeSAtUGF0aCAkcHNNb2R1bGVQYXRoICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzb3VyY2VQYXRoID0gIEpvaW4tUGF0aCAtUGF0aCAkZm9sZGVyLkZ1bGxOYW1lIC1DaGlsZFBhdGggKEdldC1DaGlsZEl0ZW0gLVBhdGggJGZvbGRlci5GdWxsTmFtZSkgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNvdXJjZVBhdGhXaXRoU3ViRm9sZGVyID0gSm9pbi1QYXRoIC1QYXRoICRzb3VyY2VQYXRoIC1DaGlsZFBhdGggIlwqIgogCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQ29weS1JdGVtIC1QYXRoICRzb3VyY2VQYXRoV2l0aFN1YkZvbGRlciAtRGVzdGluYXRpb24gJHBzTW9kdWxlUGF0aCAtcmVjdXJzZSAtRm9yY2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0Y2gKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gIkVycm9yOiQoJF8uRXhjZXB0aW9uLk1lc3NhZ2UpIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0gICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgIAogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICAKICAgICAgIFJlbW92ZS1JdGVtIC1MaXRlcmFsUGF0aCAkdGVtcFBhdGggLUZvcmNlIC1SZWN1cnNlCiAgICAgICBSZW1vdmUtSXRlbSAtTGl0ZXJhbFBhdGggJHVuWmlwTW9kdWxlUGF0aCAtRm9yY2UgLVJlY3Vyc2UKICAgICAgCiAgICAgICByZXR1cm4gIlN1Y2Nlc3M6RG93bmxvYWRpbmcgJE1vZHVsZU5hbWUgY29tcGxldGVkIgogICAgICAgICAgICAgICAgCiAgICB9Y2F0Y2h7CiAgICAgICAKICAgICAgICByZXR1cm4gIkVycm9yOiQoJF8uRXhjZXB0aW9uLk1lc3NhZ2UpIgogICAgfQoKfQoKIyBjaGFuZ2UgdXNlciBQYXNzd29yZApGdW5jdGlvbiBQYXNzd29yZFJlc2V0IHsKCiAgICAgICAKICAgICAgICAkUGFzc1Jlc2V0RXJyT2JqZWN0ID0gTmV3LU9iamVjdCAtVHlwZU5hbWUgcHNvYmplY3QKICAgICAgICAkUGFzc1Jlc2V0RXJyT2JqZWN0IHwgQWRkLU1lbWJlciAtTWVtYmVyVHlwZSBOb3RlUHJvcGVydHkgLU5hbWUgVGFza05hbWUgLVZhbHVlICJQYXNzd29yZCByZXNldCIKICAgICAgICAkUGFzc1Jlc2V0RXJyT2JqZWN0IHwgQWRkLU1lbWJlciAtTWVtYmVyVHlwZSBOb3RlUHJvcGVydHkgLU5hbWUgU3RhdHVzIC1WYWx1ZSAiZmFpbCIgCiAgICAgICAgJFBhc3NSZXNldEVyck9iamVjdCB8IEFkZC1NZW1iZXIgLU1lbWJlclR5cGUgTm90ZVByb3BlcnR5IC1OYW1lIENvZGUgLVZhbHVlIDEKICAgICAgICAkUGFzc1Jlc2V0RXJyT2JqZWN0IHwgQWRkLU1lbWJlciAtTWVtYmVyVHlwZSBOb3RlUHJvcGVydHkgLU5hbWUgc3RkZXJyIC1WYWx1ZSAkbnVsbAogICAgICAgICRQYXNzUmVzZXRFcnJPYmplY3QgfCBBZGQtTWVtYmVyIC1NZW1iZXJUeXBlIE5vdGVQcm9wZXJ0eSAtTmFtZSBSZXN1bHQgLVZhbHVlICRudWxsCiAgICAgICAgJFBhc3NSZXNldEVyck9iamVjdCB8IEFkZC1NZW1iZXIgLU1lbWJlclR5cGUgTm90ZVByb3BlcnR5IC1OYW1lIHN0ZG91dCAtVmFsdWUgJG51bGwgIAogICAgICAgIAogICAgICAgIAogICAgICAgIyAkU3VjY2Vzc0FyciA9IEAoKQogICAgICAgICRTdWNjZXNzT3V0QXJyID0gQCgpICAgICAgICAKICAgICAgICAkU3VjY2Vzc1Jlc3VsdCA9ICIiICAgCgogICAgICAgICRPZmZpY2VSZXBhaXJTdWNjT2JqZWN0ID0gTmV3LU9iamVjdCAtVHlwZU5hbWUgcHNvYmplY3QKICAgICAgICAkT2ZmaWNlUmVwYWlyU3VjY09iamVjdCB8IEFkZC1NZW1iZXIgLU1lbWJlclR5cGUgTm90ZVByb3BlcnR5IC1OYW1lIFRhc2tOYW1lIC1WYWx1ZSAiUGFzc3dvcmQgcmVzZXQiCiAgICAgICAgJE9mZmljZVJlcGFpclN1Y2NPYmplY3QgfCBBZGQtTWVtYmVyIC1NZW1iZXJUeXBlIE5vdGVQcm9wZXJ0eSAtTmFtZSBTdGF0dXMgLVZhbHVlICJTdWNjZXNzIiAKICAgICAgICAkT2ZmaWNlUmVwYWlyU3VjY09iamVjdCB8IEFkZC1NZW1iZXIgLU1lbWJlclR5cGUgTm90ZVByb3BlcnR5IC1OYW1lIENvZGUgLVZhbHVlIDAKICAgICAgICAkT2ZmaWNlUmVwYWlyU3VjY09iamVjdCB8IEFkZC1NZW1iZXIgLU1lbWJlclR5cGUgTm90ZVByb3BlcnR5IC1OYW1lIFJlc3VsdCAtVmFsdWUgJG51bGwKICAgICAgICAkT2ZmaWNlUmVwYWlyU3VjY09iamVjdCB8IEFkZC1NZW1iZXIgLU1lbWJlclR5cGUgTm90ZVByb3BlcnR5IC1OYW1lIHN0ZG91dCAtVmFsdWUgJG51bGwgIAogICAgICAgICRPZmZpY2VSZXBhaXJTdWNjT2JqZWN0IHwgQWRkLU1lbWJlciAtTWVtYmVyVHlwZSBOb3RlUHJvcGVydHkgLU5hbWUgZGF0YU9iamVjdCAtVmFsdWUgJG51bGwgIAoKCgogICRSZXN1bHQgPSAgQ2hlY2stUHJlQ29uZGl0aW9uCgogIFdyaXRlLUhvc3QgIiRSZXN1bHQiCgogIGlmKCRSZXN1bHQuU3BsaXQoJzonKVswXSAtZXEgJ0Vycm9yJyl7CiAgCiAgICAgJFN0ZEFyciA9IEAoKQogICAgICRTdGRPdXRBcnIgPSBAKCkKICAgICAkU3RkRXJyQXJyID0gQCgpCiAgICAgJFJlc3VsdCA9ICIiCiAgIAogICAgJFN0ZEVyckFyciA9ICRSZXN1bHQuU3BsaXQoJzonKVsxXQogICAgJFJlc3VsdCA9ICJQcmVjb25kaXRpb24gRmFpbGVkIgoKICAgICRQYXNzUmVzZXRFcnJPYmplY3Quc3RkZXJyID0gJFN0ZEVyckFycgogICAgJFBhc3NSZXNldEVyck9iamVjdC5SZXN1bHQgPSAkUmVzdWx0CiAgICAkUGFzc1Jlc2V0RXJyT2JqZWN0LnN0ZG91dCA9ICRTdGRPdXRBcnIKICAgICAgICAKICAgIHJldHVybiAkUGFzc1Jlc2V0RXJyT2JqZWN0CiAgfQoKICBpZigkUmVzdWx0LlNwbGl0KCc6JylbMF0gLWVxICdFcnJvcjEnKXsKIAogICAgJFBhc3NSZXNldEVyck9iamVjdCB8IEFkZC1NZW1iZXIgLU1lbWJlclR5cGUgTm90ZVByb3BlcnR5IC1OYW1lIGRhdGFPYmplY3QgLVZhbHVlICRudWxsICAKICAgIAogICAgJFN0ZE91dEFyciA9IEAoKQogICAgJFN0ZEVyckFyciA9ICRSZXN1bHQuU3BsaXQoJzonKVsxXQogICAgJFJlc3VsdCA9ICJQcmVjb25kaXRpb24gRmFpbGVkIgoKICAgICR1c2VyMiA9IEdldC1Nc29sVXNlciB8IFdoZXJlLU9iamVjdCB7JF8uVXNlclByaW5jaXBhbE5hbWUgLWxpa2UgICQoJFVzZXJJRC5Ub0NoYXJBcnJheSgwLDEpKSArJyonIH0KICAgICR1c2VyMiB8IHNlbGVjdCBEaXNwbGF5TmFtZSAsIFVzZXJQcmluY2lwYWxOYW1lIHwgIE91dC1EZWZhdWx0IAoKCiAgICAkUGFzc1Jlc2V0RXJyT2JqZWN0LnN0ZGVyciA9ICRTdGRFcnJBcnIKICAgICRQYXNzUmVzZXRFcnJPYmplY3QuUmVzdWx0ID0gJFJlc3VsdAogICAgJFBhc3NSZXNldEVyck9iamVjdC5zdGRvdXQgPSAkU3RkT3V0QXJyCiAgICAkUGFzc1Jlc2V0RXJyT2JqZWN0LmRhdGFPYmplY3QgPSAkdXNlcjIKICAgICAgICAKICAgIHJldHVybiAkUGFzc1Jlc2V0RXJyT2JqZWN0CiAgfQoKICBpZigkUmVzdWx0LlNwbGl0KCc6JylbMF0gLWVxICdTdWNjZXNzJyl7CiAgCiAgdHJ5ewogICAgCiAgICAkQ2hhbmdlZFBhc3MgPSBTZXQtTXNvbFVzZXJQYXNzd29yZCAtVXNlclByaW5jaXBhbE5hbWUgJFVzZXJJRCAtTmV3UGFzc3dvcmQgJE5ld1Bhc3N3b3JkIC1Gb3JjZUNoYW5nZVBhc3N3b3JkT25seSAkZmFsc2UgLUZvcmNlQ2hhbmdlUGFzc3dvcmQgJGZhbHNlIC1FcnJvckFjdGlvbiBTdG9wCiAgICAkU3VjY2Vzc09iaiB8IEFkZC1NZW1iZXIgTm90ZXByb3BlcnR5IC1OYW1lIENoYW5nZWRQYXNzd29yZCAtdmFsdWUgJENoYW5nZWRQYXNzCiAgICAKCiAgICAkT2ZmaWNlUmVwYWlyU3VjY09iamVjdC5SZXN1bHQgPSAiQ2hhbmdlZCBwYXNzd29yZCBmb3I6JCgkVXNlcklEKSIKICAgICRPZmZpY2VSZXBhaXJTdWNjT2JqZWN0LnN0ZG91dCA9ICAkU3VjY2Vzc09iagogICAgJE9mZmljZVJlcGFpclN1Y2NPYmplY3QuZGF0YU9iamVjdCA9ICRTdWNjZXNzT2JqCiAgICAgICAgCiAgICByZXR1cm4gJE9mZmljZVJlcGFpclN1Y2NPYmplY3QKCiAgICB9Y2F0Y2h7CiAgICAgIAogICAgICAkU3RkT3V0QXJyICs9ICJNZXNzYWdlOiAkKCRfLkV4Y2VwdGlvbi5NZXNzYWdlKSIKCiAgICAgICRQYXNzUmVzZXRFcnJPYmplY3Quc3RkZXJyID0gICJNZXNzYWdlOiAkKCRfLkV4Y2VwdGlvbi5NZXNzYWdlKSIKICAgICAgJFBhc3NSZXNldEVyck9iamVjdC5SZXN1bHQgPSAiUGFzc3dvcmQgaXMgbm90IGNoYW5nZWQuUGxlYXNlIHRyeSBhZ2FpbiIKICAgICAgJFBhc3NSZXNldEVyck9iamVjdC5zdGRvdXQgPSAkU3RkT3V0QXJyCiAgICAgICAgCiAgICAgIHJldHVybiAkUGFzc1Jlc2V0RXJyT2JqZWN0CiAgICB9CiAgfQoKIH0KCiBpZigkUFNWZXJzaW9uVGFibGUuUFNWZXJzaW9uLk1ham9yIC1lcSAyKXsKCiAgICBQYXNzd29yZFJlc2V0IHwgIENvbnZlcnRUby1KU09OUDIKCn1lbHNlewoKICAgIFBhc3N3b3JkUmVzZXQgfCAgQ29udmVydFRvLUpzb24gLURlcHRoIDEwCn0K","jsonSchema":{"type":"object","properties":{"UserID":{"type":"string","title":"Enter user ID","minLength":1},"NewPassword":{"type":"String","title":"Enter new password","minLength":1},"AdminID":{"type":"string","title":"Enter admin ID","minLength":1},"AdminPassword":{"type":"String","title":"Enter admin password","minLength":1}},"required":["UserID","NewPassword","AdminID","AdminPassword"],"additionalProperties": false},"uiSchema":{"UserID":{"ui:autofocus":true,"classNames":"col-sm-12"},"NewPassword":{"ui:autofocus":true,"classNames":"col-sm-12"},"AdminID":{"ui:autofocus":true,"classNames":"col-sm-12"},"AdminPassword":{"ui:autofocus":true,"classNames":"col-sm-12"},"ui:order":["UserID", "NewPassword", "AdminID", "AdminPassword"]},"isHDScript":true}
