{"id":"90b92175-289b-11e9-b8ee-00155d130b01","partnerId":"00000000-0000-0000-0000-000000000000","category":["Maintenance"],"description":"Enables always show for icons and notifications","engine":"powershell","engineMaxVersion":5,"expectedExecutionTimeSec":300,"failureMessage":"Executed with errors","successMessage":"Excecution Success","internal":false,"name":"Enable Always Show for taskbar icons/notifications","tags":["Windows 7","Windows 10"],"sequence":true,"content":"PCMKICAuU2NyaXB0CiAgRW5hYmxlIGFsd2F5cyBzaG93IGZvciBpY29ucyBhbmQgbm90aWZpY2F0aW9uLgogIC5BdXRob3IKICBOaXJhdiBTYWNob3JhLgogIC5WZXJzaW9uCiAgMi4wIGFuZCBhYm92ZS4KICAuUmVxdWlyZW1lbnRzCiAgU2NyaXB0IHNob3VsZCBydW4gd2l0aCBoaWdoZXN0IHByaXZpbGVnZXMuCiM+CgokdXNlcnMgPSBAKCkKCkZ1bmN0aW9uIENyZWF0ZV9yZWdpc3RyeSgkcGF0aCkgICAgIyBGdW5jdGlvbiB3aWxsIHNldCByZWdpc3RyeSB2YWx1ZSBhbmQgaWYgaXRlbSBpcyBub3QgcHJlc2VudCB3aWxsIGNyZWF0ZSByZWdpc3RyeSBlbnRyeS4KewokRGV0YWlscyA9IEdldC1JdGVtUHJvcGVydHkgLVBhdGggJHBhdGgKaWYoJERldGFpbHMgLW5lICRudWxsKQogICAgCXsKICAgICREZXRhaWxzID0gR2V0LUl0ZW1Qcm9wZXJ0eSAtUGF0aCAkcGF0aCB8IGdtIHwgc2VsZWN0IC1FeHBhbmRQcm9wZXJ0eSBOYW1lCiAgICBpZigkRGV0YWlscyAtY29udGFpbnMgJ0VuYWJsZUF1dG9UcmF5JykKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBTZXQtSXRlbVByb3BlcnR5ICRwYXRoIC1OYW1lICdFbmFibGVBdXRvVHJheScgLVZhbHVlIDAKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgTmV3LUl0ZW1Qcm9wZXJ0eSAtUGF0aCAkcGF0aCAtTmFtZSAnRW5hYmxlQXV0b1RyYXknIC1Qcm9wZXJ0eVR5cGUgIkRXb3JkIiAtVmFsdWUgMCB8IE91dC1OdWxsCiAgICAgICAgICAgICAgICAgICAgICAgIH0KCQoJfSAjRW5kIGlmIHN0YXRlbWVudAplbHNlCgl7CglOZXctSXRlbVByb3BlcnR5IC1QYXRoICRwYXRoIC1OYW1lICdFbmFibGVBdXRvVHJheScgLVByb3BlcnR5VHlwZSAiRFdvcmQiIC1WYWx1ZSAwIHwgT3V0LU51bGwKCX0gICMgRW5kIGVsc2Ugc3RhdGVtZW50CgoJaWYoKEdldC1JdGVtUHJvcGVydHkgJHBhdGggLU5hbWUgJ0VuYWJsZUF1dG9UcmF5JyAgfCBTZWxlY3QgLUV4cGFuZFByb3BlcnR5IEVuYWJsZUF1dG9UcmF5KSAtZXEgMCl7cmV0dXJuICR0cnVlfSBlbHNlIHtyZXR1cm4gJGZhbHNlfQp9ICAjIEVuZCBGdW5jdGlvbiBDcmVhdGVfcmVnaXN0cnkKCiNyZWdpc3RyeSBlZGl0IGZvciBjdXJyZW50bHkgbG9nZ2VkIHVpbiB1c2Vycwp0cnkKewokcHJvZmlsZWxpc3QgPSBHZXQtSXRlbSAiUkVnaXN0cnk6OkhLVVxTLTEtNS0yMS0qIiB8IFdoZXJlLU9iamVjdCB7JF8uTmFtZSAtbm90bGlrZSAnKl9DbGFzc2VzJ30gfCBzZWxlY3QgLUV4cGFuZFByb3BlcnR5IG5hbWUKZm9yZWFjaCgkcHJvZmlsZSBpbiAkcHJvZmlsZWxpc3QpCiAgICB7CiAgICBpZihUZXN0LXBhdGggIlJlZ2lzdHJ5OjokcHJvZmlsZVxWb2xhdGlsZSBFbnZpcm9ubWVudCIpCiAgICB7CiAgICAkdXNlcm5hbWUgPSBHZXQtSXRlbVByb3BlcnR5IC1QYXRoICJSZWdpc3RyeTo6JHByb2ZpbGVcVm9sYXRpbGUgRW52aXJvbm1lbnQiIC1OYW1lIFVzZXJuYW1lIHwgU2VsZWN0IC1FeHBhbmRQcm9wZXJ0eSBVc2VybmFtZQoKICAgICR0ZXN0ID0gIlJlZ2lzdHJ5OjokcHJvZmlsZVxTb2Z0d2FyZVxNaWNyb3NvZnRcV2luZG93c1xDdXJyZW50VmVyc2lvblxFeHBsb3JlciIKICAgIGlmKCR0ZXN0KQogICAgICAgIHsKICAgICAgICAkY3UgPSBDcmVhdGVfcmVnaXN0cnkgLXBhdGggIlJlZ2lzdHJ5OjokcHJvZmlsZVxTb2Z0d2FyZVxNaWNyb3NvZnRcV2luZG93c1xDdXJyZW50VmVyc2lvblxFeHBsb3JlciIKICAgICAgICBpZigkY3UgLWVxICRmYWxzZSkKICAgICAgICAgICB7CiAgICAgICAgICAgV3JpdGUtRXJyb3IgIkVycm9yICRwcm9maWxlIgogICAgICAgICAgIH0KICAgICAgICBlbHNlCiAgICAgICAgICAgIHsKICAgICAgICAkVXNlcnMgKz0gJHVzZXJuYW1lCiAgICAgICAgfQogICAgICAgIH0KICAgIH0KICAgIGVsc2UKICAgIHsKICAgIENvbnRpbnVlCiAgICB9CiAgICB9Cn0KY2F0Y2gKewogICAgJF8uRXhjZXB0aW9uLk1lc3NhZ2UKfQoKIyBSZWdpc3RyeSBlZGl0IGZvciBkZWZhdWx0IHByb2ZpbGVzCiAgICAKICAgIFJFRyBMT0FEIEhLVVxURU1QICJDOlxVc2Vyc1xkZWZhdWx0XE5UVVNFUi5EQVQiIHwgT3V0LU51bGwKICAgIGlmKCQ/KQogICAgewogICAgICAgICRkZWZhdWx0cGF0aCA9ICJSZWdpc3RyeTo6SEtVXFRFTVBcU29mdHdhcmVcTWljcm9zb2Z0XFdpbmRvd3NcQ3VycmVudFZlcnNpb25cRXhwbG9yZXIiCiAgICAgICAgJGRlZmF1bHRyZXN1bHQgPSBDcmVhdGVfcmVnaXN0cnkgLXBhdGggJGRlZmF1bHRwYXRoCiAgICAgICAgICAgIGlmKCRkZWZhdWx0cmVzdWx0IC1lcSAkZmFsc2UpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIFdyaXRlLUVycm9yICJFcnJvciBEZWZhdWx0IgogICAgICAgICAgICB9ICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgUkVHIFVOTE9BRCBIS1VcVEVNUCB8IE91dC1OdWxsCiAgICB9CiAgICBlbHNlCiAgICB7CiAgICAgICAgV3JpdGUtRXJyb3IgIkZhaWxlZCB0byBsb2FkIHJlZ2lzdHJ5IGZvciBkZWZhdWx0IHByb2ZpbGUiCiAgICB9CgojUmVnaXN0cnkgZWRpdCBmb3IgY3VycmVudCBwcm9maWxlcwoKJHByb2ZpbGVzID0gZ2V0LWNoaWxkaXRlbSBDOlxVc2VycyB8IHNlbGVjdCAtRXhwYW5kUHJvcGVydHkgTmFtZQpmb3JlYWNoKCRwcm9maWxlIGluICRwcm9maWxlcykKewogICAgJG50dXNlciA9IFRlc3QtUGF0aCBDOlxVc2Vyc1wkcHJvZmlsZVxOVFVTRVIuREFUCiAgICBpZigkbnR1c2VyKQogICAgICAgIHsKICAgICAgICB0cnkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICRGaWxlU3RyZWFtID0gW1N5c3RlbS5JTy5GaWxlXTo6T3BlbigiQzpcVXNlcnNcJHByb2ZpbGVcTlRVU0VSLkRBVCIsJ09wZW4nLCdXcml0ZScpCiAgICAgICAgICAgICAgICAgICAgJEZpbGVTdHJlYW0uQ2xvc2UoKQogICAgICAgICAgICAgICAgICAgICRGaWxlU3RyZWFtLkRpc3Bvc2UoKQogICAgICAgICAgICAgICAgICAgIFJFRyBMT0FEIEhLVVxURU1QICJDOlxVc2Vyc1wkcHJvZmlsZVxOVFVTRVIuREFUIiB8IE91dC1OdWxsCiAgICAgICAgICAgICAgICAgICAgJHBhdGggPSAiUmVnaXN0cnk6OkhLVVxURU1QXFNvZnR3YXJlXE1pY3Jvc29mdFxXaW5kb3dzXEN1cnJlbnRWZXJzaW9uXEV4cGxvcmVyIgogICAgICAgICAgICAgICAgICAgICRyZWdpc3RyeSA9IFRlc3QtcGF0aCAkcGF0aAogICAgICAgICAgICAgICAgICAgIGlmKCRyZWdpc3RyeSkKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICRyZXN1bHQgPSBDcmVhdGVfcmVnaXN0cnkgLXBhdGggJHBhdGgKICAgICAgICAgICAgICAgICAgICAgICAgaWYoJHJlc3VsdCAtZXEgJGZhbHNlKQogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIFdyaXRlLU91dHB1dCAiRXJyb3IgJHByb2ZpbGUiCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICRVc2VycyArPSAkcHJvZmlsZQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSAjQ2xvc2luZyBJRiBMaW5lIDIzCgogICAgICAgICAgICAgICAgICAgIFJFRyBVTkxPQUQgSEtVXFRFTVAgfCBPdXQtTnVsbAogICAgICAgICAgICB9ICNDbG9zaW5nIFRyeQogICAgICAgIGNhdGNoCiAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIENvbnRpbnVlCiAgICAgICAgICAgfQogICAgICAgICAgICAKICAgICAgICB9ICNDbG9zaW5nIElGIFN0YXRlbWVudCBMaW5lIDEyICAKCn0gIyBDbG9zaW5nIEZvcmVhY2ggTG9vcApXcml0ZS1PdXRwdXQgIkFsd2F5cyBzaG93IGZvciBpY29ucyBhbmQgbm90aWZpY2F0aW9ucyBoYXMgYmVlbiBlbmFibGVkIGZvciBiZWxvdyB1c2VycyBvbiB0aGlzIHN5c3RlbWBuIgpXcml0ZS1PdXRwdXQgJFVzZXJzCldyaXRlLU91dHB1dCAiYG5QbGVhc2UgbG9nb2ZmIGFuZCBsb2dpbiwgaWYgY2hhbmdlcyBhcmUgbm90IHJlZmxlY3RlZC4iCg==","jsonSchema":"","uiSchema":"","isHDScript":false}
