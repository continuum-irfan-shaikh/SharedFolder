{"id":"f359daeb-e0d9-4cc4-a8e5-d9df5715c4d8","partnerId":"00000000-0000-0000-0000-000000000000","category":["Maintenance"],"description":"Download a file using HTTP protocol","engine":"powershell","engineMaxVersion":5,"expectedExecutionTimeSec":3600,"failureMessage":"Executed with errors","successMessage":"Download successfully finished","internal":false,"name":"HTTP download","tags":["Windows 7","Windows 10"],"sequence":true,"content":"aWYgKCRlbnY6UFJPQ0VTU09SX0FSQ0hJVEVXNjQzMiAtZXEgIkFNRDY0IikgewogICAgaWYgKCRteUludm9jYXRpb24uTGluZSkgewogICAgICAgICYiJGVudjpzeXN0ZW1yb290XHN5c25hdGl2ZVx3aW5kb3dzcG93ZXJzaGVsbFx2MS4wXHBvd2Vyc2hlbGwuZXhlIiAtTm9uSW50ZXJhY3RpdmUgLU5vUHJvZmlsZSAkbXlJbnZvY2F0aW9uLkxpbmUKICAgIH0KICAgIGVsc2UgewogICAgICAgICYiJGVudjpzeXN0ZW1yb290XHN5c25hdGl2ZVx3aW5kb3dzcG93ZXJzaGVsbFx2MS4wXHBvd2Vyc2hlbGwuZXhlIiAtTm9uSW50ZXJhY3RpdmUgLU5vUHJvZmlsZSAtZmlsZSAiJCgkbXlJbnZvY2F0aW9uLkludm9jYXRpb25OYW1lKSIgJGFyZ3MKICAgIH0KICAgIGV4aXQgJGxhc3RleGl0Y29kZQp9Cgokc3RhcnRfdGltZSA9IEdldC1EYXRlCiRQYXRoQXJyYXkgPSAkb3V0cHV0IC1zcGxpdCAiXFwiCiREaXJlY3RvcnlQYXRoID0gKCRQYXRoQXJyYXkgfCBXaGVyZS1PYmplY3QgeyAkXyAtbmUgJFBhdGhBcnJheVstMV0gfSkgLWpvaW4gIlwiCgoKaWYgKCRvbkVycm9yQ29udGludWUpIHsKICAgICRFcnJvckFjdGlvblByZWZlcmVuY2UgPSAnQ29udGludWUnCn0KZWxzZSB7CiAgICAkRXJyb3JBY3Rpb25QcmVmZXJlbmNlID0gJ1N0b3AnCn0KCmlmICgoLW5vdCAkb3ZlcndyaXRlKSAtYW5kIChUZXN0LVBhdGggJG91dHB1dCkpIHsKICAgIFdyaXRlLUVycm9yICJGaWxlIGV4aXN0cy4gRGVsZXRlIGV4aXN0aW5nIGZpbGUgb3IgY2hlY2sgb3ZlcndyaXRlIG9wdGlvbiIKICAgIEV4aXQKfQogCmlmICgoLW5vdCAkY3JlYXRlRGlyZWN0b3J5KSAtYW5kICgtbm90IChUZXN0LVBhdGggJERpcmVjdG9yeVBhdGgpKSkgewogICAgV3JpdGUtRXJyb3IgIk91dHB1dCBwYXRoIGlzIG5vdCB2YWxpZCwgZG93bmxvYWQgZGlyZWN0b3J5IGRvZXMgbm90IGV4aXN0LiBJbnB1dCB2YWxpZCBvdXRwdXQgcGF0aCBvciBjaGVjayBjcmVhdGVEaXJlY3Rvcnkgb3B0aW9uIgogICAgcmV0dXJuCn0gCgppZiAoJGNyZWF0ZURpcmVjdG9yeSAtYW5kICgtbm90IChUZXN0LVBhdGggJERpcmVjdG9yeVBhdGgpKSkgewogICAgTmV3LUl0ZW0gLVBhdGggJERpcmVjdG9yeVBhdGggLUl0ZW1UeXBlICJkaXJlY3RvcnkiIC1Gb3JjZSA+JG51bGwKfQoKCiRQb3dlcnNoZWxsX1ZlcnNpb24gPSAoJFBTVmVyc2lvblRhYmxlLlBzVmVyc2lvbikuTWFqb3IKCmlmICgkUG93ZXJzaGVsbF9WZXJzaW9uIC1lcSAyKSB7CgogICAgI2NhbGwgV2ViQ2xpZW50CiAgICAkY2xpZW50ID0gTmV3LU9iamVjdCBTeXN0ZW0uTmV0LldlYkNsaWVudAogICAgaWYgKCR1c2VybmFtZSAtYW5kICRwYXNzd29yZCkgewogICAgICAgICRwYWlyID0gIiR7dXNlcm5hbWV9OiR7cGFzc3dvcmR9IgogICAgICAgICRiYXNlNjQgPSBbU3lzdGVtLkNvbnZlcnRdOjpUb0Jhc2U2NFN0cmluZyhbU3lzdGVtLlRleHQuRW5jb2RpbmddOjpBU0NJSS5HZXRCeXRlcygkcGFpcikpCiAgICAgICAgJGNsaWVudC5IZWFkZXJzLmFkZCgnQXV0aG9yaXphdGlvbicsICJCYXNpYyAkYmFzZTY0IikKICAgIH0KICAgIHRyeSB7CiAgICAgICAgJEVycm9yQWN0aW9uUHJlZmVyZW5jZSA9ICdzdG9wJwogICAgICAgICRjbGllbnQuRG93bmxvYWRGaWxlKCR1cmwsICRvdXRwdXQpCiAgICAgICAgV3JpdGUtT3V0cHV0ICJEb3dubG9hZCBzdWNjZXNzZnVsLiBUaW1lIHRha2VuOiAkKChHZXQtRGF0ZSkuU3VidHJhY3QoJHN0YXJ0X3RpbWUpLlNlY29uZHMpIHNlY29uZChzKSIKICAgIH0KICAgIGNhdGNoIHsgV3JpdGUtRXJyb3IgIkRvd25sb2FkIGZhaWxlZCEgJF8uRXhjZXB0aW9uLk1lc3NhZ2UiIH0KCn0KZWxzZSB7CiAgICAjY2FsbCBpbnZva2Utd2VicmVxdWVzdAogICAgdHJ5IHsKICAgICAgICAkRXJyb3JBY3Rpb25QcmVmZXJlbmNlID0gJ1N0b3AnCiAgICAgICAgaWYgKCR1c2VybmFtZSAtYW5kICRwYXNzd29yZCkgewogICAgICAgICAgICAkcGFpciA9ICIke3VzZXJuYW1lfToke3Bhc3N3b3JkfSIKICAgICAgICAgICAgJGJ5dGVzID0gW1N5c3RlbS5UZXh0LkVuY29kaW5nXTo6QVNDSUkuR2V0Qnl0ZXMoJHBhaXIpCiAgICAgICAgICAgICRiYXNlNjQgPSBbU3lzdGVtLkNvbnZlcnRdOjpUb0Jhc2U2NFN0cmluZygkYnl0ZXMpCiAgICAgICAgICAgICRiYXNpY0F1dGhWYWx1ZSA9ICJCYXNpYyAkYmFzZTY0IgogICAgICAgICAgICAkaGVhZGVycyA9IEB7IEF1dGhvcml6YXRpb24gPSAkYmFzaWNBdXRoVmFsdWUgfQogICAgICAgICAgICBJbnZva2UtV2ViUmVxdWVzdCAtdXJpICIkdXJsIiAtSGVhZGVycyAkaGVhZGVycyAtT3V0RmlsZSAiJG91dHB1dCIKICAgICAgICAgICAgV3JpdGUtT3V0cHV0ICJEb3dubG9hZCBzdWNjZXNzZnVsLiBUaW1lIHRha2VuOiAkKChHZXQtRGF0ZSkuU3VidHJhY3QoJHN0YXJ0X3RpbWUpLlNlY29uZHMpIHNlY29uZChzKSIKICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIEludm9rZS1XZWJSZXF1ZXN0IC1VcmkgIiR1cmwiIC1PdXRGaWxlICIkb3V0cHV0IiAKICAgICAgICAgICAgV3JpdGUtT3V0cHV0ICJEb3dubG9hZCBzdWNjZXNzZnVsLiBUaW1lIHRha2VuOiAkKChHZXQtRGF0ZSkuU3VidHJhY3QoJHN0YXJ0X3RpbWUpLlNlY29uZHMpIHNlY29uZChzKSIKICAgICAgICB9CiAgICB9CiAgICBjYXRjaCB7IAogICAgICAgIFdyaXRlLUVycm9yICJEb3dubG9hZCBmYWlsZWQhICRfLkV4Y2VwdGlvbi5NZXNzYWdlIgogICAgfQogICAgCn0KCgppZiAoJG1kNSkgewogICAgJG1kNU9iaiA9IE5ldy1PYmplY3QgLVR5cGVOYW1lIFN5c3RlbS5TZWN1cml0eS5DcnlwdG9ncmFwaHkuTUQ1Q3J5cHRvU2VydmljZVByb3ZpZGVyCiAgICAkZmlsZW1kNSA9IFtTeXN0ZW0uQml0Q29udmVydGVyXTo6VG9TdHJpbmcoJG1kNU9iai5Db21wdXRlSGFzaChbU3lzdGVtLklPLkZpbGVdOjpSZWFkQWxsQnl0ZXMoJG91dHB1dCkpKQogICAgJGZpbGVtZDUgPSAkZmlsZW1kNSAtcmVwbGFjZSAiLSIsICIiCiAgICBpZiAoJGZpbGVtZDUgLW5lICRtZDUpIHsKICAgICAgICBSZW1vdmUtSXRlbSAtcGF0aCAkb3V0cHV0CiAgICAgICAgV3JpdGUtRXJyb3IgIm1kNSBtaXNtYXRjaCAoJG1kNSE9JGZpbGVtZDUpIGZvciBkb3dubG9hZGVkIGZpbGUsIGZpbGUgcmVtb3ZlZCIKICAgICAgICBFeGl0CiAgICB9CiAgICBFbHNlIHsgIk1ENSBjaGVja3N1bSB2ZXJpZmljYXRpb24gcGFzc2VkLiIgfQp9Cg==","jsonSchema":{"additionalProperties":false,"properties":{"createDirectory":{"title":"Create directory","type":"boolean"},"md5":{"title":"MD5 Hash","type":"string"},"onErrorContinue":{"title":"Continue on error","type":"boolean"},"output":{"title":"output","type":"string"},"overwrite":{"title":"Overwrite","type":"boolean"},"password":{"title":"Password","type":"string"},"url":{"title":"URL","type":"string"},"userName":{"title":"User name","type":"string"}},"required":["url","output"],"type":"object"},"uiSchema":{"createDirectory":{"classNames":"col-sm-4"},"md5":{"classNames":"col-sm-6 col-sm-offset-right-6"},"onErrorContinue":{"classNames":"col-sm-4"},"output":{"classNames":"col-sm-12","ui:help":"Full path","validationSchema":{"path":"output","type":"isValidWindowsFullPath"}},"overwrite":{"classNames":"col-sm-4"},"password":{"classNames":"col-sm-6","ui:widget":"password"},"ui:order":["url","output","userName","password","md5","overwrite","createDirectory","onErrorContinue"],"url":{"classNames":"col-sm-12","ui:autofocus":true,"validationSchema":{"type":"areValidURLsSeparatedByNewLine","urls":"url"}},"userName":{"classNames":"col-sm-6","validationSchema":{"notEmpty":"userName","required":["password"],"type":"requiredFieldsIfNotEmpty"}}},"isHDScript":false}