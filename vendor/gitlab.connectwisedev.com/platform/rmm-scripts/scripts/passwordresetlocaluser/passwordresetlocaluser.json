{"id":"b244ed7c-f095-45a5-af4a-8d7071b0018e","partnerId":"00000000-0000-0000-0000-000000000000","category":["HD Automation"],"description":"This script will reset the password of local user whose account is not locked or disabled","engine":"powershell","engineMaxVersion":5,"expectedExecutionTimeSec":300,"failureMessage":"Executed with errors","successMessage":"Password Reset for Local Account is Successful","internal":false,"name":"HD Password Reset for Local User","tags":["Windows 7","Windows 2008 R2"],"sequence":true,"content":"PCMKCS5TWU5PUFNJUwoJRGV2ZWxvcGVkIEJ5IDogR1JUIFtIRC1BdXRvbWF0aW9uXSAsIENvbnRpbnV1bQoJRmlsZSBWZXNpb24gOiAyLjAKCS5ERVNDUklQVElPTgoJVGhlIHNjcmlwdCBpcyBkZXNpZ25lZCB0byBjaGFuZ2UgdGhlIHBhc3N3b3JkIG9mIGxvY2FsIHVzZXIsIGlmIExvY2FsIFVzZXIgYWNjb3VudCBpcyBMb2NrZWQvRGlzYWJsZWQgb3IgYm90aCBpdCB3aWxsIG5vdCBkbyBhbnl0aGluZy4KCS5QQVJBTUVURVIgCglMb2NhbFVzZXJJRCBpcyB0aGUgdmFyaWFibGUgcmVxdWlyZWQgZm9yIGNoYW5naW5nIHRoZSBwYXNzd29yZC4KCS5QQVJBTUVURVIgCglDaGFuZ2VQYXNzd29yZCBpcyB0aGUgcGFzc3dvcmQgd2hpY2ggbmVlZHMgdG8gYmUgc2V0IGFzIHBhc3N3b3JkIGZvciB0aGUgdXNlciBhY2NvdW50LgoJLlBBUkFNRVRFUgoJQ2hhbmdlUHdkTmV4dExvZ29uIGlzIGEgYm9vbGVhbi4gVHJ1ZSBtZWFucyB0byBzZXQgQ2hhbmdlIFBhc3N3b3JkIG9uIG5leHQgbG9nb24uCgkuRXhhbXBsZSBmb3IgVGVzdAoJJExvY2FsVXNlcklEID0gImhkMSIKCSRDaGFuZ2VQYXNzd29yZCA9ICJFRDMlViIKCSRDaGFuZ2VQd2ROZXh0TG9nb249JHRydWUKIz4KPCMgQ29tcGF0aWJpbGl0eSBDaGVjayBpZiBmb3VuZCBpbmNvbXBhdGlibHQgd2l0aCBleGl0Iz4KdHJ5ewokT1NWZXJzaW9uPShbc3lzdGVtLmVudmlyb25tZW50XTo6T1NWZXJzaW9uLlZlcnNpb24pLk1ham9yCiRQU1ZlcnNpb24gPShHZXQtSG9zdCkudmVyc2lvbgppZigoJE9TVmVyc2lvbiAtbHQgNikgLW9yICgkUFNWZXJzaW9uLk1ham9yIC1sdCAyKSkKewpXcml0ZS1PdXRwdXQgIltNU0cgOiBJbmNvbXBhdGlibGUgU3lzdGVtIEVpdGhlciBPUyBpcyBiZWxvdyB3aW5kb3dzIDcvMjAwOFIyIG9yIHBvd2Vyc2hlbGwgdmVyc2lvbiBsZXNzIHRoYW4gMi4wXSIKRXhpdCAKfX1jYXRjaHsgV3JpdGUtT3V0cHV0ICJbTVNHOiAkXy5FeGNlcHRpb24ubWVzc2FnZV0ifQoKJE91dHB1dE1lc3NhZ2UgPSBAKCkgPCMgVmFyaWFibGUgdG8gY2FwdHVyZSBPdXRwdXQgZm9yIGRlYnVnZ2luZyBwdXJwb3NlLiM+CjwjIElmICREQyBpcyBlcXVhbGwgdG8gNChiYWNrdXAgREMpIG9yIDUocHJpbWFyeSBEQykgYXMgdGhlcmUgaXMgbm8gbG9jYWwgdXNlciBvbiBEb21haW4gQ29udHJvbGxlciAjPiAgIAp0cnl7ICREQyA9IChHZXQtV21pT2JqZWN0IFdpbjMyX0NvbXB1dGVyU3lzdGVtKS5kb21haW5yb2xlCn1jYXRjaHsgV3JpdGUtZXJyb3IgIlVuYWJsZSB0byBDaGVjayBpZiBtYWNoaW5lIGlzIERvbWFpbiBDb250cm9sbGVyICRfLkV4Y2VwdGlvbi5tZXNzYWdlIiB9CmlmKCREQyAtZXEgIjQiIC1vciAkREMgLWVxICI1IikKeyAKICAgICRPdXRwdXRNZXNzYWdlICs9ICJObyBMb2NhbCBVc2VyIG9uIERvbWFpbiBDb250cm9sbGVyLiIKICAgIFdyaXRlLU91dHB1dCAkT3V0cHV0TWVzc2FnZQogICAgRXhpdAp9CmVsc2UKewo8I0NoZWNrIGlmIFVzZXIgRXhpc3QjPgp0cnkgewogICAgICAgICRMb2NhbHVzZXIgPSAgR2V0LVdtaU9iamVjdCAtQ2xhc3MgV2luMzJfVXNlckFjY291bnQgLUZpbHRlciAiTG9jYWxBY2NvdW50PSdUcnVlJyBhbmQgTmFtZT0nJExvY2FsVXNlcklEJyIgfCBTZWxlY3QgUFNDb21wdXRlcm5hbWUsIExvY2FsQWNjb3VudCwgU3RhdHVzLERpc2FibGVkLCBBY2NvdW50VHlwZSwgTG9ja291dCwgUGFzc3dvcmRSZXF1aXJlZCwgUGFzc3dvcmRDaGFuZ2VhYmxlLCBQYXNzd29yZEV4cGlyZXMsIFNJRAogICAgfWNhdGNoeyBXcml0ZS1lcnJvciAiIFVuYWJsZSB0byByZXRyaWV2ZSBMb2NhbCB1c2VyIGluZm9ybWF0aW9uIiB9CiAgICBpZiAoJExvY2FsdXNlcikKICAgIHsKICAgICAgICBpZigoJExvY2FsdXNlci5EaXNhYmxlZCAtZXEgJEZhbHNlKSAtQW5kICgkTG9jYWx1c2VyLkxvY2tvdXQgLWVxICRGYWxzZSkpCiAgICAgICAgewogICAgICAgICAgICAkTWFjaGluZU5hbWUgPSAkZW52OkNPTVBVVEVSTkFNRQogICAgICAgICAgICA8IyByZXNldCB0aGUgcGFzc3dvcmQjPgogICAgICAgICAgICB0cnl7CiAgICAgICAgICAgICAgICAkVXNyQ29tbWFuZCA9W0FEU0ldICJXaW5OVDovLyRNYWNoaW5lTmFtZS8kTG9jYWxVc2VySUQsIHVzZXIiCiAgICAgICAgICAgICAgICAkVXNyQ29tbWFuZC5TZXRQYXNzd29yZCgkQ2hhbmdlUGFzc3dvcmQpIAogICAgICAgICAgICAgICAgaWYoJENoYW5nZVB3ZE5leHRMb2dvbiAtZXEgJHRydWUpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgaWYoKCRMb2NhbHVzZXIuUGFzc3dvcmRDaGFuZ2VhYmxlIC1lcSAkVHJ1ZSkgLUFuZCAoJExvY2FsdXNlci5QYXNzd29yZEV4cGlyZXMgLWVxICR0cnVlKSkKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgPCMgVXNlIHRvIGNoZWNrIGZvciBmb3JjZSBwd2QgY2hhbmdlIGF0IG5leHQgbG9nb24uIElmIFBhc3N3b3JkQ2hhbmdlYWJsZSBhbmQgUGFzc3dvcmRFeHBpcmVzIGlzIEZhbHNlIHRoZSBvcHRpb24gb3IgUGFzc3dvcmQgY2hhbmdlIGF0IG5leHQgbG9nb24gaXMgZ3JheWVkIG91dC4jPgogICAgICAgICAgICAgICAgICAgICAgICAkVXNyQ29tbWFuZC5QYXNzd29yZEV4cGlyZWQgPSAxICAKICAgICAgICAgICAgICAgICAgICAgICAgJFVzckNvbW1hbmQuU2V0aW5mbygpIAogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBFbHNlIAogICAgICAgICAgICAgICAgICAgIHsgICAkT3V0cHV0TWVzc2FnZSArPSAiUGFzc3dvcmQgaXMgRWl0aGVyIFNldCB0byBuZXZlciBFeHBpcmVkIG9yIENhbm5vdCBDaGFuZ2UgUGFzc3dvcmQuIiAgfQogICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgeyAgJE91dHB1dE1lc3NhZ2UgKz0gIk5leHQgTG9nb24gUGFzc3dvcmQgQ2hhbmdlIGlzIG5vdCBjb25maWdydWVkIGJ5IFRlY2huaWNpYW4uIiAgIH0KICAgICAgICAgICAgICAgICAkT3V0cHV0TWVzc2FnZSArPSAiUGFzc3dvcmQgQ2hhbmdlZCBTdWNjZXNzZnVsbHkuIgogICAgICAgICAgICAgICAgIH1jYXRjaCB7V3JpdGUtZXJyb3IgIiBVbmFibGUgdG8gY2hhbmdlIHBhc3N3b3JkICRfLkV4Y2VwdGlvbi5tZXNzYWdlIn0KICAgICAgICAgIH0KICAgICBlbHNlCiAgICAgICAgIHsgJE91dHB1dE1lc3NhZ2UgKz0iQWNjb3VudCBTdGF0dXMgTG9ja2VkIDogIiskTG9jYWx1c2VyLkxvY2tvdXQgCiAgICAgICAgICAgJE91dHB1dE1lc3NhZ2UgKz0iQWNjb3VudCBTdGF0dXMgRGlzYWJsZWQgOiIrJExvY2FsdXNlci5EaXNhYmxlZAogICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgdHJ5ewogICAgICAgICAgICAgICAgICAgICAgICAkTG9jYWx1c2VyID0gIEdldC1XbWlPYmplY3QgLUNsYXNzIFdpbjMyX1VzZXJBY2NvdW50IC1GaWx0ZXIgIkxvY2FsQWNjb3VudD0nVHJ1ZSciIHwgU2VsZWN0IE5hbWUsRGlzYWJsZWQsTG9ja291dAogICAgICAgICAgICAgICAgICAgICAgICBmb3IoJGk9MDsgJGkgLWx0ICRMb2NhbHVzZXIubGVuZ3RoIDsgJGkrKykKICAgICAgICAgICAgICAgICAgICAgICAgeyAgICRUZW1wVXNlcj0kTG9jYWx1c2VyWyRpXS5OYW1lCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkdXNlcmFjY291bnRleHBpcmF0aW9uID0gW2Fkc2ldIldpbk5UOi8vLi8kVGVtcFVzZXIsIHVzZXIiIHwgU2VsZWN0IEFjY291bnRFeHBpcmF0aW9uRGF0ZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgJE91dHB1dE1lc3NhZ2UgKz0gIk5hbWUgOiIrJExvY2FsdXNlclskaV0uTmFtZSAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRPdXRwdXRNZXNzYWdlICs9ICJEaXNhYmxlZCA6IiskTG9jYWx1c2VyWyRpXS5EaXNhYmxlZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgJE91dHB1dE1lc3NhZ2UgKz0gIkxvY2tvdXQgOiIrJExvY2FsdXNlclskaV0uTG9ja291dAogICAgICAgICAgICAgICAgICAgICAgICAgICAgJE91dHB1dE1lc3NhZ2UgKz0gIkFjY291bnRFeHBpcmF0aW9uRGF0ZSA6IiskdXNlcmFjY291bnRleHBpcmF0aW9uLkFjY291bnRFeHBpcmF0aW9uRGF0ZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgJE91dHB1dE1lc3NhZ2UgKz0gIiAiCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfWNhdGNoeyBXcml0ZS1lcnJvciAiVW5hYmxlIHRvIGdldCBsaXN0IG9mIExvY2FsIFVzZXIgQWNjb3VudC4iIH0KICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQpXcml0ZS1PdXRwdXQgJE91dHB1dE1lc3NhZ2UgfGZsCg==","jsonSchema":{"additionalProperties":false,"properties":{"ChangePassword":{"minLength":1,"title":"Password","type":"string"},"ChangePwdNextLogon":{"title":"Change password at next logon","type":"boolean"},"LocalUserID":{"minLength":1,"title":"User name","type":"string"}},"required":["LocalUserID","ChangePassword"],"type":"object"},"uiSchema":{"ChangePassword":{"classNames":"col-sm-6","ui:help":"Hint: Make it strong!","ui:widget":"password"},"ChangePwdNextLogon":{"classNames":"col-sm-6"},"LocalUserID":{"classNames":"col-sm-12","ui:autofocus":true},"ui:order":["LocalUserID","ChangePassword","ChangePwdNextLogon"]},"isHDScript":true}
