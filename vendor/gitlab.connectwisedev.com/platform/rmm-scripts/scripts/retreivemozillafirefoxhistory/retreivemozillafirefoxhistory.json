{"id":"36745eda-5f92-11e9-aca7-00155d130b01","partnerId":"00000000-0000-0000-0000-000000000000","category":["Data Collection"],"description":"Retrieves Mozilla Firefox browsing history","engine":"powershell","engineMaxVersion":5,"expectedExecutionTimeSec":300,"failureMessage":"Executed with errors","successMessage":"Excecuted successfully","internal":false,"name":"Retrieves Mozilla Firefox history","tags":["Windows 7","Windows 10"],"sequence":true,"content":"PCMKLlN5bm9wc2lzClNjcmlwdCB3aWxsIHJldHJlaXZlIE1vemlsbGEgZmlyZWZveCBoaXN0b3J5IGZvciBlYWNoIHVzZXIKLkF1dGhvcgpOaXJhdiBTYWNob3JhCi5SZXF1aXJlbWVudHMKU3FsaXRlMy5leGUgc2hvdWxkIHByZXNlbnQgaW4gc3lzdGVtLgojPgoKaWYgKCRlbnY6UFJPQ0VTU09SX0FSQ0hJVEVXNjQzMiAtZXEgIkFNRDY0IikgewogICAgaWYgKCRteUludm9jYXRpb24uTGluZSkgewogICAgICAgICYiJGVudjpzeXN0ZW1yb290XHN5c25hdGl2ZVx3aW5kb3dzcG93ZXJzaGVsbFx2MS4wXHBvd2Vyc2hlbGwuZXhlIiAtTm9uSW50ZXJhY3RpdmUgLU5vUHJvZmlsZSAkbXlJbnZvY2F0aW9uLkxpbmUKICAgIH0KICAgIGVsc2UgewogICAgICAgICYiJGVudjpzeXN0ZW1yb290XHN5c25hdGl2ZVx3aW5kb3dzcG93ZXJzaGVsbFx2MS4wXHBvd2Vyc2hlbGwuZXhlIiAtTm9uSW50ZXJhY3RpdmUgLU5vUHJvZmlsZSAtZmlsZSAiJCgkbXlJbnZvY2F0aW9uLkludm9jYXRpb25OYW1lKSIgJGFyZ3MKICAgIH0KICAgIGV4aXQgJGxhc3RleGl0Y29kZQp9CmlmKCEkZGF5cyl7CiRkYXlzID0gOTAKfQokZGF0ZSA9IChnZXQtZGF0ZSkuQWRkRGF5cygtJGRheXMpCiRkYXRlc3RyID0gJGRhdGUuVG9TdHJpbmcoInl5eXktTU0tZGQiKQoKJE9TQXJjaCA9IChHZXQtV21pT2JqZWN0IFdpbjMyX09wZXJhdGluZ1N5c3RlbSkuT1NBcmNoaXRlY3R1cmUKU3dpdGNoICgkT1NBcmNoKSB7CiAgICAiNjQtYml0IiB7ICRzcWxpdGUzID0gJHtFTlY6UHJvZ3JhbUZpbGVzKHg4Nil9ICsgIlxJVFNQbGF0Zm9ybVxwbHVnaW5cc2NyaXB0aW5nXHNxbGl0ZTMuZXhlIiB9ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAiMzItYml0IiB7ICRzcWxpdGUzID0gJHtFTlY6UHJvZ3JhbUZpbGVzfSArICJcSVRTUGxhdGZvcm1ccGx1Z2luXHNjcmlwdGluZ1xzcWxpdGUzLmV4ZSIgfSAgICAgICAgICAgICAgIAp9CgokbW96aWxsYWV4aXN0ID0gVGVzdC1QYXRoICJSZWdpc3RyeTo6SEtFWV9MT0NBTF9NQUNISU5FXFNPRlRXQVJFXE1pY3Jvc29mdFxXaW5kb3dzXEN1cnJlbnRWZXJzaW9uXFVuaW5zdGFsbFxNb3ppbGxhKiIKaWYgKCRtb3ppbGxhZXhpc3QgLWVxICRGYWxzZSkgewogICAgV3JpdGUtT3V0cHV0ICJNb3ppbGxhIGlzIG5vdCBpbnN0YWxsZWQgb24gdGhpcyBzeXN0ZW0iCiAgICBleGl0Owp9Cgokc3FsaXRlID0gVGVzdC1QYXRoICIkc3FsaXRlMyIKaWYgKCRzcWxpdGUpIHsKICAgIGlmICgkdXNlcnMgLWVxICJhbGx1c2VycyIpIHsKICAgICAgICAkcHJvZmlsZWRhdGEgPSBHZXQtQ2hpbGRJdGVtICdIS0xNOlxTb2Z0d2FyZVxNaWNyb3NvZnRcV2luZG93cyBOVFxDdXJyZW50VmVyc2lvblxQcm9maWxlTGlzdCcgfCBGb3JFYWNoLU9iamVjdCB7ICRfLkdldFZhbHVlKCdQcm9maWxlSW1hZ2VQYXRoJykgfSAjIERldGFpbHMgYWJvdXQgZWFjaCBVc2VyIHByb2ZpbGUgaW4gdGhlIHN5c3RlbQogICAgICAgICRwcm9maWxlcGF0aCA9IEAoKQogICAgICAgIGZvcmVhY2ggKCRpbnB1dCBpbiAkcHJvZmlsZWRhdGEpIHsKICAgICAgICAgICAgaWYgKCRpbnB1dCAtbGlrZSAiQzpcVXNlcnNcKiIpIHsKICAgICAgICAgICAgICAgICRwcm9maWxlcGF0aCArPSAiJGlucHV0IiArICJcQXBwRGF0YVxSb2FtaW5nXE1vemlsbGFcRmlyZWZveFxQcm9maWxlcyIKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KICAgIGVsc2UgewogICAgICAgICRwcm9maWxlcGF0aCA9IEAoKQogICAgICAgICRub3RleGlzdCA9IEAoKQogICAgICAgICR1c2VycHJvZmlsZXMgPSAkdXNlcm5hbWVzIC1zcGxpdCAiLCIKICAgICAgICBmb3JlYWNoICgkcHJvZmlsZTEgaW4gJHVzZXJwcm9maWxlcykgewogICAgICAgICAgICBpZiAoVGVzdC1QYXRoICJDOlxVc2Vyc1wkcHJvZmlsZTEiKSB7CiAgICAgICAgICAgICAgICAkcHJvZmlsZXBhdGggKz0gIkM6XFVzZXJzXCRwcm9maWxlMSIgKyAiXEFwcERhdGFcUm9hbWluZ1xNb3ppbGxhXEZpcmVmb3hcUHJvZmlsZXMiCiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAkbm90ZXhpc3QgKz0gJHByb2ZpbGUxCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CiAKICAgIGZvcmVhY2ggKCRwcm9maWxlIGluICRwcm9maWxlcGF0aCkgewogICAgICAgICRQcm9maWxlZXhpc3QgPSBUZXN0LVBhdGggJHByb2ZpbGUKICAgICAgICBpZiAoJFByb2ZpbGVleGlzdCkgewogICAgICAgICAgICAkZm9sZGVybmFtZSA9IEdldC1DaGlsZEl0ZW0gJHByb2ZpbGUgfCBXaGVyZS1PYmplY3QgeyAkXy5OYW1lIC1saWtlICIqLmRlZmF1bHQiIH0gfCBzZWxlY3QgLUV4cGFuZFByb3BlcnR5IE5hbWUKICAgICAgICAKICAgICAgICAgICAgJHVzZXJuYW1lID0gJHByb2ZpbGUgLXJlcGxhY2UgIlxcQXBwRGF0YVxcUm9hbWluZ1xcTW96aWxsYVxcRmlyZWZveFxcUHJvZmlsZXMiLCAiIjsgJHVzZXJuYW1lID0gJHVzZXJuYW1lIC1yZXBsYWNlICJDOlxcVXNlcnNcXCIsICIiCiAgICAgICAgICAgICRwcm9maWxlID0gJHByb2ZpbGUucmVwbGFjZSgiXCIsICJcXCIpCiAgICAgICAgICAgICNpZigkbmFtZSAtbmUgJG51bGwpCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgJHBhdGggPSAkcHJvZmlsZSArICJcXCIgKyAkZm9sZGVybmFtZSArICJcXHBsYWNlcy5zcWxpdGUiCiAgICAgICAgICBbc3RyaW5nXSRkYXRhID0gIi5vcGVuICRwYXRoCiAgICAgICAgICAgICAgICBTRUxFQ1QgZGF0ZXRpbWUobW96X2hpc3Rvcnl2aXNpdHMudmlzaXRfZGF0ZS8xMDAwMDAwLCd1bml4ZXBvY2gnKSwgbW96X3BsYWNlcy51cmwKICAgICAgICAgICAgICAgIEZST00gbW96X3BsYWNlcywgbW96X2hpc3Rvcnl2aXNpdHMgCiAgICAgICAgICAgICAgICBXSEVSRSBtb3pfcGxhY2VzLmlkID0gbW96X2hpc3Rvcnl2aXNpdHMucGxhY2VfaWQgYW5kIGRhdGUobW96X2hpc3Rvcnl2aXNpdHMudmlzaXRfZGF0ZS8xMDAwMDAwLCd1bml4ZXBvY2gnKSA+PSAkZGF0ZXN0cjsKICAgICAgICAgICAgICAgICIKICAgICAgICAgICAKICAgICAgICAgICAgJGhpc3RvcnkgPSAkZGF0YSB8ICYgJHNxbGl0ZTMKICAgICAgICAgICAgIyRoaXN0b3J5CiAgICAgICAgICAgIGZvcmVhY2ggKCRyZWNvcmQgaW4gJGhpc3RvcnkpIHsKICAgICAgICAgICAgICAgICRsYXN0ZGF0ZSA9IChHZXQtRGF0ZSkuQWRkRGF5cygtJGRheXMpCiAgICAgICAgICAgICAgICAkYSwgJGIgPSAkcmVjb3JkLnNwbGl0KCJ8IikKICAgICAgICAgICAgICAgICRjID0gW3VyaV0kYjsgJGMgPSAkYy5zY2hlbWUgKyAiOi8vIiArICRjLkhvc3QKICAgICAgICAgICAgICAgICRhID0gR2V0LURhdGUgJGEKICAgICAgICAgICAgICAgIGlmICgkYSAtZ3QgJGxhc3RkYXRlKSB7CiAgICAgICAgICAgICAgICAgICAgJG9iaiA9IE5ldy1PYmplY3QgcHNvYmplY3QgLVByb3BlcnR5IEB7CiAgICAgICAgICAgICAgICAgICAgICAgIFNpdGUgICAgID0gJGMKICAgICAgICAgICAgICAgICAgICAgICAgVXNlcm5hbWUgPSAkdXNlcm5hbWUKICAgICAgICAgICAgICAgICAgICAgICAgRGF0ZSAgICAgPSAkYQogICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICRvYmogfCBzZWxlY3QgVXNlcm5hbWUsIERhdGUsIFNpdGUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIAogICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAKICAgICAgICB9CiAgICB9Cn0KCmVsc2UgewogICAgV3JpdGUtRXJyb3IgIlNRTGl0ZSBEQiBjbGllbnQgbm90IGZvdW5kLiBVbmFibGUgdG8gY29ubmVjdCBoaXN0b3J5IGRhdGFiYXNlLiIKICAgIEV4aXQKfQoKaWYoJG5vdGV4aXN0Lmxlbmd0aCAtZ3QgMCl7CldyaXRlLU91dHB1dCAiYG5CZWxvdyBwcm9maWxlcyBkb2VzIG5vdCBleGlzdHMgb24gdGhlIHN5c3RlbS4gYG4kbm90ZXhpc3QiCiAgfSAK","jsonSchema":{"additionalproperties":false,"dependencies":{"users":{"oneOf":[{"properties":{"users":{"enum":["allusers"]}}},{"properties":{"usernames":{"title":"User names","type":"string"},"users":{"enum":["selectedusers"]}},"required":["usernames"]}]}},"patternproperties":{"^usernames$":{}},"properties":{"days":{"maximum":90,"title":"Retrive last(in days)","type":"number"},"users":{"enum":["allusers","selectedusers"],"enumNames":["All Users","Enter user names"],"title":"Retrive Chrome History","type":"string"}},"required":["users"],"type":"object"},"uiSchema":{"days":{"classNames":"col-sm-3","ui:autofocus":true},"ui:order":["users","usernames","days"],"usernames":{"classNames":"col-sm-8 col-sm-offset-right-4","ui:autofocus":true,"ui:help":"For multuple users seperate by (,)"},"users":{"classNames":"col-sm-6 col-sm-offset-right-6","ui:autofocus":true,"ui:options":{"inline":true},"ui:widget":"radio"}},"isHDScript":false}