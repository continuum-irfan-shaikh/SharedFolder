{"id":"2bce156e-4a72-11e9-b764-00155d130b01","partnerId":"00000000-0000-0000-0000-000000000000","category":["Application"],"description":"Uninstall vipre versions 5.xx","engine":"powershell","engineMaxVersion":5,"expectedExecutionTimeSec":600,"failureMessage":"Executed with errors","successMessage":"Excecution success","internal":false,"name":"Uninstall Ccleaner","tags":["Windows 7","Windows 10"],"sequence":true,"content":"PCMKICAgIC5TY3JpcHQKICAgIFVuaW5zdGFsbCBDQ2xlYW5lcgogICAgLkRlc2NyaXB0aW9uCiAgICBTY3JpcHQgd2lsbCBjaGVjayBmb3IgdGhlIHZlcnNpb24gcHJvdmlkZWQgdGhyb3VnaCBwb3J0YWwgYW5kIHVuaW5zdGFsbCBpZiBzYW1lIHZlcnNpb24gaXMgaW5zdGFsbGVkIG9uIHRoZSBzeXN0ZW0uCiAgICAuUmVxdWlyZW1lbnRzCiAgICBSdW4gc2NyaXB0IHdpdGggaGlnaGVzdCBwcml2aWxlZ2VzCiAgICAKIz4KCjwjIAokYWN0aW9uICAgICAgID09PT4gVHlwZTogRHJvcGRvd24gPT09PiBFTlVNOiAiU2VsZWN0IEFjdGlvbiIsICJVbmluc3RhbGwiID09PT4gIFRpdGxlIDogIkFjdGlvbiIKJHZlcnNpb24gICAgICA9PT0+IFR5cGU6IERyb3Bkb3duID09PT4gRU5VTTogIlNlbGVjdCBTdWJWZXJzaW9uIiwgIjUuMzAiLCAiNS4zMSIsICI1LjMyIiwgIjUuMzMiLCAiNS4zNCIsICI1LjM1IiwgIjUuMzYiLCAiNS4zNyIsICI1LjM4IiwgIjUuMzkiICA9PT0+IAojPgoKCmlmIChUZXN0LVBhdGggIlJlZ2lzdHJ5OjpIS0VZX0xPQ0FMX01BQ0hJTkVcU09GVFdBUkVcTWljcm9zb2Z0XFdpbmRvd3NcQ3VycmVudFZlcnNpb25cVW5pbnN0YWxsXENDbGVhbmVyIikgewogICAgJHJlZ2lzdHJ5dmFsdWUgPSBHZXQtSXRlbVByb3BlcnR5IC1QYXRoICJSZWdpc3RyeTo6SEtFWV9MT0NBTF9NQUNISU5FXFNPRlRXQVJFXE1pY3Jvc29mdFxXaW5kb3dzXEN1cnJlbnRWZXJzaW9uXFVuaW5zdGFsbFxDQ2xlYW5lciIgfCBTZWxlY3QgLUV4cGFuZFByb3BlcnR5IERpc3BsYXlWZXJzaW9uCiAgICBpZiAoJHZlcnNpb24gLW5lICRyZWdpc3RyeXZhbHVlKSB7CiAgICAgICAgV3JpdGUtT3V0cHV0ICJwcm92aWRlZCBWZXJzaW9uIG9mIENDbGVhbmVyIGlzIG5vdCBpbnN0YWxsZWQuIgogICAgICAgIEV4aXQ7CiAgICB9CiAgICBlbHNlIHsKICAgICAgICBGdW5jdGlvbiBFeGVjdXRlX3Byb2Nlc3MoJHBhdGgsICRiaXQpIHsKICAgICAgICAgICAgJHBpbmZvID0gTmV3LU9iamVjdCBTeXN0ZW0uRGlhZ25vc3RpY3MuUHJvY2Vzc1N0YXJ0SW5mbwogICAgICAgICAgICBpZiAoJGJpdCAtZXEgMzIgLWFuZCAodGVzdC1wYXRoICIkcGF0aFx1bmluc3QuZXhlIikpIHsKICAgICAgICAgICAgICAgICRwaW5mby5GaWxlTmFtZSA9ICIkcGF0aFx1bmluc3QuZXhlIgogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2VpZiAoJGJpdCAtZXEgNjQgLWFuZCAodGVzdC1wYXRoICIkcGF0aFx1bmluc3QuZXhlIikpIHsKICAgICAgICAgICAgICAgICRwaW5mby5GaWxlTmFtZSA9ICIkcGF0aFx1bmluc3QuZXhlIgogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgcmV0dXJuIC0xCiAgICAgICAgICAgIH0KICAgICAgICAgICAgJHBpbmZvLlJlZGlyZWN0U3RhbmRhcmRFcnJvciA9ICR0cnVlCiAgICAgICAgICAgICRwaW5mby5SZWRpcmVjdFN0YW5kYXJkT3V0cHV0ID0gJHRydWUKICAgICAgICAgICAgJHBpbmZvLlVzZVNoZWxsRXhlY3V0ZSA9ICRmYWxzZQogICAgICAgICAgICAkcGluZm8uQXJndW1lbnRzID0gIi9TIgogICAgICAgICAgICAkcCA9IE5ldy1PYmplY3QgU3lzdGVtLkRpYWdub3N0aWNzLlByb2Nlc3MKICAgICAgICAgICAgJHAuU3RhcnRJbmZvID0gJHBpbmZvCiAgICAgICAgICAgICRwLlN0YXJ0KCkgfCBPdXQtTnVsbAogICAgICAgICAgICAkcC5XYWl0Rm9yRXhpdCgpCiAgICAgICAgICAgIHJldHVybiAkcC5FeGl0Q29kZQogICAgICAgIH0KICAgICAgICAKICAgICAgICAKICAgICAgICAKICAgICAgICBpZiAoKFRlc3QtcGF0aCAiQzpcUHJvZ3JhbSBGaWxlc1xDQ2xlYW5lciIpIC1vciAoVGVzdC1QYXRoICJDOlxQcm9ncmFtIEZpbGVzICh4ODYpXENDbGVhbmVyIikpIHsKICAgICAgICAgICAgV3JpdGUtT3V0cHV0ICJDQ2xlYW5lciBleGVjdXRpb24gaXMgc3RhcnRlZCwgaXQgbWF5IHRha2UgdGltZSB0byBjb21wbGV0ZSB0aGUgZXhlY3V0aW9uIgogICAgICAgICAgICAkb3NhcmNoaXRlY3R1cmUgPSAoZ2V0LXdtaW9iamVjdCAtQ2xhc3Mgd2luMzJfb3BlcmF0aW5nc3lzdGVtKS5Pc2FyY2hpdGVjdHVyZQogICAgICAgICAgICBpZiAoJG9zYXJjaGl0ZWN0dXJlIC1lcSAiMzItYml0IikgewogICAgICAgICAgICAgICAgJHBhdGggPSBKb2luLVBhdGggIkM6XFByb2dyYW0gRmlsZXMiICJDY2xlYW5lciIKICAgICAgICAgICAgICAgIGlmICh0ZXN0LXBhdGggJHBhdGgpIHsKICAgICAgICAgICAgICAgICAgICAkc3VjY2VzcyA9IEV4ZWN1dGVfcHJvY2VzcyAtcGF0aCAkcGF0aCAtYml0IDMyCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAKICAgICAgICAgICAgZWxzZWlmICgkb3NhcmNoaXRlY3R1cmUgLWVxICI2NC1iaXQiKSB7CiAgICAgICAgICAgICAgICAkcGF0aDMyID0gSm9pbi1QYXRoICJDOlxQcm9ncmFtIEZpbGVzICh4ODYpIiAiQ2NsZWFuZXIiCiAgICAgICAgICAgICAgICAkcGF0aDY0ID0gSm9pbi1QYXRoICJDOlxQcm9ncmFtIEZpbGVzIiAiQ2NsZWFuZXIiCiAgICAgICAgICAgICAgICBpZiAoVGVzdC1QYXRoICRwYXRoNjQpIHsKICAgICAgICAgICAgICAgICAgICAkc3VjY2VzcyA9IEV4ZWN1dGVfcHJvY2VzcyAtcGF0aCAkcGF0aDY0IC1iaXQgNjQKICAgICAgICAgICAgICAgIH0gCiAgICAgICAgICAgICAgICBlbHNlaWYgKFRlc3QtUGF0aCAkcGF0aDMyKSB7CiAgICAgICAgICAgICAgICAgICAgJHN1Y2Nlc3MgPSBFeGVjdXRlX3Byb2Nlc3MgLXBhdGggJHBhdGgzMiAtYml0IDMyCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKCRzdWNjZXNzIC1lcSAwKSB7CiAgICAgICAgICAgICAgICBXcml0ZS1PdXRwdXQgIkNDbGVhbmVyIGhhcyBiZWVuIHJlbW92ZWQiCiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZWlmICgkc3VjY2VzcyAtZXEgLTEpIHsKICAgICAgICAgICAgICAgIFdyaXRlLUVycm9yICJ1bmluc3QuZXhlIGZpbGUgaXMgbWlzc2luZyBmcm9tIEM6XFByb2dyYW0gZmlsZXNcQ0NsZWFuZXIiCiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICBXcml0ZS1FcnJvciAiQWN0aW9uIENvdWxkIG5vdCBiZSBjb21wbGV0ZWQiCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9Cn0KZWxzZSB7CiAgICBXcml0ZS1PdXRwdXQgIkNDbGVhbmVyIGlzIG5vdCBpbnN0YWxsZWQgb24gdGhpcyBzeXN0ZW0iCiAgICBFeGl0Owp9Cg==","jsonSchema":{"type":"object","properties":{"version":{"type":"string","title":"Version","enum":["5.30","5.31","5.32","5.33","5.34","5.35","5.36","5.37","5.38","5.39"],"enumNames":["5.30","5.31","5.32","5.33","5.34","5.35","5.36","5.37","5.38","5.39"]}},"required":["version"],"additionalProperties":false},"uiSchema":{"version":{"classNames":"col-sm-3","ui:autofocus":true,"ui:placeholder":"Select version"}},"isHDScript":false}
