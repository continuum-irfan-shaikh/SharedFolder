{"id":"da9e3481-7d4d-11e9-a738-00155d130b89","partnerId":"00000000-0000-0000-0000-000000000000","category":["HD Automation"],"description":"Check For All Anti Virus Solutions","engine":"powershell","engineMaxVersion":5,"expectedExecutionTimeSec":300,"failureMessage":"Executed with errors","successMessage":"Successfully Executed","internal":false,"name":"CheckForAllAVSolutions","tags":["Windows 7","Windows 10"],"sequence":true,"content":"Q2xlYXItSG9zdA0KDQo8Iw0KY2F0IC0gQW50aS1NYWx3YXJlDQojPg0KDQpmdW5jdGlvbiBFc2NhcGUtSlNPTlN0cmluZygkc3RyKXsNCiAgICBpZiAoJHN0ciAtZXEgJG51bGwpIHtyZXR1cm4gIiJ9DQogICAgICAgICAkc3RyID0gJHN0ci5Ub1N0cmluZygpLlJlcGxhY2UoJyInLCdcIicpLlJlcGxhY2UoJ1wnLCdcXCcpLlJlcGxhY2UoImBuIiwnXG4nKS5SZXBsYWNlKCJgciIsJ1xyJykuUmVwbGFjZSgiYHQiLCdcdCcpDQogICAgcmV0dXJuICRzdHI7DQp9DQoNCg0KZnVuY3Rpb24gQ29udmVydFRvLUpTT05QMigkbWF4RGVwdGggPSAxMCwkZm9yY2VBcnJheSA9ICRmYWxzZSkgew0KYmVnaW4gew0KJGRhdGEgPSBAKCkNCn0NCnByb2Nlc3N7DQokZGF0YSArPSAkXw0KfQ0KZW5kew0KaWYgKCRkYXRhLmxlbmd0aCAtZXEgMSAtYW5kICRmb3JjZUFycmF5IC1lcSAkZmFsc2UpIHsNCiR2YWx1ZSA9ICRkYXRhWzBdDQp9IGVsc2UgeyANCiR2YWx1ZSA9ICRkYXRhDQp9DQoNCg0KaWYgKCR2YWx1ZSAtZXEgJG51bGwpIHsNCnJldHVybiAibnVsbCINCn0NCg0KDQoNCg0KJGRhdGFUeXBlID0gJHZhbHVlLkdldFR5cGUoKS5OYW1lDQpzd2l0Y2ggLXJlZ2V4ICgkZGF0YVR5cGUpIHsNCiAgICAgICAgICAgICdTdHJpbmcnICB7DQpyZXR1cm4gICJgInswfWAiIiAtZiAoRXNjYXBlLUpTT05TdHJpbmcgJHZhbHVlICkNCn0NCiAgICAgICAgICAgICcoU3lzdGVtXC4pP0RhdGVUaW1lJyAge3JldHVybiAgImAiezA6eXl5eS1NTS1kZH1UezA6SEg6bW06c3N9YCIiIC1mICR2YWx1ZX0NCiAgICAgICAgICAgICdJbnQzMnxEb3VibGUnIHtyZXR1cm4gICIkdmFsdWUifQ0KJ0Jvb2xlYW4nIHtyZXR1cm4gICIkdmFsdWUiLlRvTG93ZXIoKX0NCiAgICAgICAgICAgICcoU3lzdGVtXC4pP09iamVjdFxbXF0nIHsgIyBhcnJheQ0KaWYgKCRtYXhEZXB0aCAtbGUgMCl7cmV0dXJuICJgIiR2YWx1ZWAiIn0NCiRqc29uUmVzdWx0ID0gJycNCmZvcmVhY2goJGVsZW0gaW4gJHZhbHVlKXsNCiNpZiAoJGVsZW0gLWVxICRudWxsKSB7Y29udGludWV9DQppZiAoJGpzb25SZXN1bHQuTGVuZ3RoIC1ndCAwKSB7JGpzb25SZXN1bHQgKz0nLCAnfSANCiRqc29uUmVzdWx0ICs9ICgkZWxlbSB8IENvbnZlcnRUby1KU09OUDIgLW1heERlcHRoICgkbWF4RGVwdGggLTEpKQ0KfQ0KcmV0dXJuICJbIiArICRqc29uUmVzdWx0ICsgIl0iDQogICAgICAgICAgICB9DQonKFN5c3RlbVwuKT9IYXNodGFibGUnIHsgIyBoYXNodGFibGUNCiRqc29uUmVzdWx0ID0gJycNCmZvcmVhY2goJGtleSBpbiAkdmFsdWUuS2V5cyl7DQppZiAoJGpzb25SZXN1bHQuTGVuZ3RoIC1ndCAwKSB7JGpzb25SZXN1bHQgKz0nLCAnfQ0KJGpzb25SZXN1bHQgKz0gDQpAIg0KInswfSI6IHsxfQ0KIkAgLWYgJGtleSAsICgkdmFsdWVbJGtleV0gfCBDb252ZXJ0VG8tSlNPTlAyIC1tYXhEZXB0aCAoJG1heERlcHRoIC0xKSApDQp9DQpyZXR1cm4gInsiICsgJGpzb25SZXN1bHQgKyAifSINCn0NCiAgICAgICAgICAgIGRlZmF1bHQgeyAjb2JqZWN0DQppZiAoJG1heERlcHRoIC1sZSAwKXtyZXR1cm4gICJgInswfWAiIiAtZiAoRXNjYXBlLUpTT05TdHJpbmcgJHZhbHVlKX0NCnJldHVybiAieyIgKw0KKCgkdmFsdWUgfCBHZXQtTWVtYmVyIC1NZW1iZXJUeXBlICpwcm9wZXJ0eSB8ICUgeyANCkAiDQoiezB9IjogezF9DQoiQCAtZiAkXy5OYW1lICwgKCR2YWx1ZS4oJF8uTmFtZSkgfCBDb252ZXJ0VG8tSlNPTlAyIC1tYXhEZXB0aCAoJG1heERlcHRoIC0xKSApIA0KfSkgLWpvaW4gJywgJykgKyAifSINCiAgICB9DQp9DQp9DQp9DQoNCg0KRnVuY3Rpb24gQ2hlY2tBbnRpVmlydXNTdGF0dXMoW3N0cmluZ10gJFNlcnZpY2VOYW1lKQ0Kew0KICAgJEFWU3RhdHVzID0gR2V0LVdtaU9iamVjdCAtQ2xhc3MgV2luMzJfU2VydmljZSB8IFdoZXJlLU9iamVjdCB7JF8ubmFtZSAtZXEgJFNlcnZpY2VOYW1lIH0NCiAgIGlmKCRBVlN0YXR1cy5TdGF0dXMgLW5lICdPSycgLW9yICRBVlN0YXR1cy5TdGF0ZSAtbmUgJ1J1bm5pbmcnIC1vciAkQVZTdGF0dXMuU3RhcnRNb2RlIC1lcSAnRGlzYWJsZWQnKXtyZXR1cm4gMX0gICAgIA0KICAgcmV0dXJuIDAgDQp9DQoNCg0KZnVuY3Rpb24gR2V0QWxsSW5zdGFsbGVkQW50aXZpcnVzKCl7DQoNCiAgICRBVk9iamVjdCA9IE5ldy1PYmplY3QgLVR5cGVOYW1lIHBzb2JqZWN0DQogICAkQVZPYmplY3QgfCBBZGQtTWVtYmVyIC1NZW1iZXJUeXBlIE5vdGVQcm9wZXJ0eSAtTmFtZSBUYXNrTmFtZSAtVmFsdWUgIkNoZWNrIGZvciBhbGwgQVYgU29sdXRpb25zIg0KDQogICAkaG9zdFZlclNpb25NYWpvciA9ICgkUFNWZXJzaW9uVGFibGUuUFNWZXJzaW9uLk1ham9yKS5Ub1N0cmluZygpDQogICAkaG9zdFZlclNpb25NaW5vciA9ICgkUFNWZXJzaW9uVGFibGUuUFNWZXJzaW9uLk1pbm9yKS5Ub1N0cmluZygpDQogICAkaG9zdFZlcnNpb24gPSAkaG9zdFZlclNpb25NYWpvciArJy4nKyAkaG9zdFZlclNpb25NaW5vcg0KDQogICAkb3NWZXJzaW9uTWFqb3IgPSAoW1N5c3RlbS5FbnZpcm9ubWVudF06Ok9TVmVyc2lvbi5WZXJzaW9uLm1ham9yKS5Ub1N0cmluZygpDQogICAkb3NWZXJzaW9uTWlub3IgPSAoW1N5c3RlbS5FbnZpcm9ubWVudF06Ok9TVmVyc2lvbi5WZXJzaW9uLm1pbm9yKS5Ub1N0cmluZygpDQogICAkb3NWZXJzaW9uID0gJG9zVmVyc2lvbk1ham9yICsnLicrICRvc1ZlcnNpb25NaW5vcg0KDQogICBbYm9vbGVhbl0kaXNQc1ZlcnNpb25PayA9IChbdmVyc2lvbl0kaG9zdFZlcnNpb24gLWdlIFt2ZXJzaW9uXScyLjAnKQ0KICAgW2Jvb2xlYW5dJGlzT1NWZXJzaW9uT2sgPSAoW3ZlcnNpb25dJG9zVmVyc2lvbiAtZ2UgW3ZlcnNpb25dJzYuMCcpDQoNCiAgICAjLS0tLS0tLS0tLSBDaGVjayBmb3IgUG93ZXJzaGVsbCB2ZXJzaW9uIC0tLS0tLS0tLS0tLS0tLS0tLSAgICAgICAgIA0KICBpZigtbm90ICRpc1BzVmVyc2lvbk9rKXsNCiAgICAgICAgDQogICAgICAkU3RkRXJyQXJyID0gQCgpDQogICAgICAkc3RkT3V0QXJyID0gQCgpDQogICAgICAkU3RkRXJyID0gTmV3LU9iamVjdCBQU09iamVjdCAtUHJvcGVydHkgQHsJCSAgICAgICANCgkJICAgICAgICAgICAgICAgICAgaWQgPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZSA9ICAiUG93ZXJTaGVsbCB2ZXJzaW9uIGJlbG93IDIuMCBpcyBub3Qgc3VwcG9ydGVkIjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgZGV0YWlsID0gIlBvd2VyU2hlbGwgdmVyc2lvbiBiZWxvdyAyLjAgaXMgbm90IHN1cHBvcnRlZCI7DQoNCiAgICAgICAgICAgICAgIH0NCiAgICAgICAgIA0KICAgICAkU3RkRXJyQXJyICs9ICRTdGRFcnINCiAgICAgJHN0ZE91dEFyciArPSAoIlBvd2VyU2hlbGwgdmVyc2lvbiBiZWxvdyAyLjAgaXMgbm90IHN1cHBvcnRlZCIpDQogICAgDQogICAgICRBVk9iamVjdCB8IEFkZC1NZW1iZXIgLU1lbWJlclR5cGUgTm90ZVByb3BlcnR5IC1OYW1lIFN0YXR1cyAtVmFsdWUgImZhaWwiIA0KICAgICAkQVZPYmplY3QgfCBBZGQtTWVtYmVyIC1NZW1iZXJUeXBlIE5vdGVQcm9wZXJ0eSAtTmFtZSBDb2RlIC1WYWx1ZSAxDQogICAgICRBVk9iamVjdCB8IEFkZC1NZW1iZXIgLU1lbWJlclR5cGUgTm90ZVByb3BlcnR5IC1OYW1lIHN0ZGVyciAtVmFsdWUgJFN0ZEVyckFycg0KICAgICAkQVZPYmplY3QgfCBBZGQtTWVtYmVyIC1NZW1iZXJUeXBlIE5vdGVQcm9wZXJ0eSAtTmFtZSBSZXN1bHQgLVZhbHVlICJQb3dlclNoZWxsIHZlcnNpb24gYmVsb3cgMi4wIGlzIG5vdCBzdXBwb3J0ZWQiDQogICAgICRBVk9iamVjdCB8IEFkZC1NZW1iZXIgLU1lbWJlclR5cGUgTm90ZVByb3BlcnR5IC1OYW1lIHN0ZG91dCAtVmFsdWUgICRzdGRPdXRBcnIgICANCiAgICANCiAgICAgcmV0dXJuICRBVk9iamVjdCANCiAgICB9ICAgIA0KIA0KICAgIy0tLS0tLS0tLS0gQ2hlY2sgT1MgVmVyc2lvbiAtLS0tLS0tLS0tLS0tLS0tLS0NCiAgIGlmKC1ub3QgJGlzT1NWZXJzaW9uT2spew0KICAgICAgIA0KICAgICAgJFN0ZEVyckFyciA9IEAoKQ0KICAgICAgJHN0ZE91dEFyciA9IEAoKQ0KICAgICAgJFN0ZEVyciA9IE5ldy1PYmplY3QgUFNPYmplY3QgLVByb3BlcnR5IEB7CQkgICAgICAgDQoJCSAgICAgICAgICAgICAgICAgIGlkID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGUgPSAgIlBvd2VyU2hlbGwgU2NyaXB0IHN1cHBvcnRzIFdpbmRvdyA3LCBXaW5kb3cgMjAwOFIyIGFuZCBoaWdoZXIgdmVyc2lvbiBvcGVyYXRpbmcgc3lzdGVtIjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgZGV0YWlsID0gIlBvd2VyU2hlbGwgU2NyaXB0IHN1cHBvcnRzIFdpbmRvdyA3LCBXaW5kb3cgMjAwOFIyIGFuZCBoaWdoZXIgdmVyc2lvbiBvcGVyYXRpbmcgc3lzdGVtIjsNCg0KICAgICAgICAgICAgICAgfQ0KICAgICAgICAgDQogICAgICRTdGRFcnJBcnIgKz0gJFN0ZEVycg0KICAgICAkc3RkT3V0QXJyICs9ICgiUG93ZXJTaGVsbCBTY3JpcHQgc3VwcG9ydHMgV2luZG93IDcsIFdpbmRvdyAyMDA4UjIgYW5kIGhpZ2hlciB2ZXJzaW9uIG9wZXJhdGluZyBzeXN0ZW0iKQ0KICAgIA0KICAgICAkQWRwdE9iamVjdCB8IEFkZC1NZW1iZXIgLU1lbWJlclR5cGUgTm90ZVByb3BlcnR5IC1OYW1lIFN0YXR1cyAtVmFsdWUgImZhaWwiIA0KICAgICAkQWRwdE9iamVjdCB8IEFkZC1NZW1iZXIgLU1lbWJlclR5cGUgTm90ZVByb3BlcnR5IC1OYW1lIENvZGUgLVZhbHVlIDENCiAgICAgJEFkcHRPYmplY3QgfCBBZGQtTWVtYmVyIC1NZW1iZXJUeXBlIE5vdGVQcm9wZXJ0eSAtTmFtZSBzdGRlcnIgLVZhbHVlICRTdGRFcnJBcnINCiAgICAgJEFkcHRPYmplY3QgfCBBZGQtTWVtYmVyIC1NZW1iZXJUeXBlIE5vdGVQcm9wZXJ0eSAtTmFtZSBSZXN1bHQgLVZhbHVlICJQb3dlclNoZWxsIFNjcmlwdCBzdXBwb3J0cyBXaW5kb3cgNywgV2luZG93IDIwMDhSMiBhbmQgaGlnaGVyIHZlcnNpb24gb3BlcmF0aW5nIHN5c3RlbSINCiAgICAgJEFkcHRPYmplY3QgfCBBZGQtTWVtYmVyIC1NZW1iZXJUeXBlIE5vdGVQcm9wZXJ0eSAtTmFtZSBzdGRvdXQgLVZhbHVlICAkc3RkT3V0QXJyICAgDQogICAgIA0KICAgICByZXR1cm4gJEFWT2JqZWN0DQogICB9DQoNCiAgICAjICRhcnJheSAtbWF0Y2ggJ0RFRicNCg0KICAgICRmaWx0ZXJzID0gIlNlbnRpbmVsIEFnZW50IiwiV2Vicm9vdCBTZWN1cmVBbnl3aGVyZSIsIldpbmRvd3MgRGVmZW5kZXIiDQoNCiAgICAkQW50aVZpcnVzTGlzdCA9IEAoKQ0KDQogICAgJGhpdmUgPSBbTWljcm9zb2Z0LldpbjMyLlJlZ2lzdHJ5S2V5XTo6T3BlblJlbW90ZUJhc2VLZXkoW01pY3Jvc29mdC5XaW4zMi5SZWdpc3RyeUhpdmVdOjpMb2NhbE1hY2hpbmUsICRlbnY6Q09NUFVURVJOQU1FKQ0KICAgICRyZWdQYXRoTGlzdCA9ICJTT0ZUV0FSRVxXb3c2NDMyTm9kZVxNaWNyb3NvZnRcV2luZG93c1xDdXJyZW50VmVyc2lvblxVbmluc3RhbGwiLA0KICAgICAgICAgICAgICAgICAgICJTT0ZUV0FSRVxNaWNyb3NvZnRcV2luZG93c1xDdXJyZW50VmVyc2lvblxVbmluc3RhbGwiLA0KICAgICAgICAgICAgICAgICAgICJTT0ZUV0FSRVxNaWNyb3NvZnQiICAgICAgICAgICAgICAgICANCg0KICAgIGZvcmVhY2goJHJlZ1BhdGggaW4gJHJlZ1BhdGhMaXN0KSB7DQogICAgICAgIGlmKCRrZXkgPSAkaGl2ZS5PcGVuU3ViS2V5KCRyZWdQYXRoKSkgew0KICAgICAgICAgICAgaWYoJHN1YmtleU5hbWVzID0gJGtleS5HZXRTdWJLZXlOYW1lcygpKSB7DQogICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICBmb3JlYWNoKCRzdWJrZXlOYW1lIGluICRzdWJrZXlOYW1lcykgew0KICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAjIFdpbmRvdyBkZWZlbmRlciANCiAgICAgICAgICAgICAgICAgICBpZigkc3Via2V5TmFtZSAtZXEgIldpbmRvd3MgRGVmZW5kZXIiKSAgeyAgICAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgICAgJHByb2R1Y3RLZXkgPSAka2V5Lk9wZW5TdWJLZXkoJHN1YmtleU5hbWUpIA0KICAgICAgICAgICAgICAgICAgICAgICRwcm9kdWN0TmFtZSA9ICRzdWJrZXlOYW1lICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAgICRJbnN0YWxsTG9jYXRpb24gPSAkcHJvZHVjdEtleS5HZXRWYWx1ZSgiSW5zdGFsbExvY2F0aW9uIikgDQogICAgICAgICAgICAgICAgICAgICAgJFByb2R1Y3RTdGF0dXNWYWx1ZSA9ICAkcHJvZHVjdEtleS5HZXRWYWx1ZSgiUHJvZHVjdFN0YXR1cyIpIA0KICAgICAgICAgICAgICAgICAgICAgICRQcm9kdWN0U3RhdHVzID0gIkluYWN0aXZlIg0KICAgICAgICAgICAgICAgICAgICAgIGlmKCRQcm9kdWN0U3RhdHVzVmFsdWUgLWVxIDApeyRQcm9kdWN0U3RhdHVzID0gIkFjdGl2ZSJ9DQogICAgICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAgICRhbnRpVmlydXNPYmogPSBbUFNDdXN0b21PYmplY3RdQHsNCiAgICAgICAgICAgICAgICAgICAgICAgRGlzcGxheU5hbWUgPSAkcHJvZHVjdE5hbWUgICAgICAgICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAgICBJbnN0YWxsTG9jYXRpb24gPSAkSW5zdGFsbExvY2F0aW9uDQogICAgICAgICAgICAgICAgICAgICAgIFByb2R1Y3RTdGF0dXMgPSAkUHJvZHVjdFN0YXR1cw0KICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAkQW50aVZpcnVzTGlzdCArPSAkYW50aVZpcnVzT2JqDQogICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgfWVsc2V7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAkcHJvZHVjdEtleSA9ICRrZXkuT3BlblN1YktleSgkc3Via2V5TmFtZSkgICANCiAgICAgICAgICAgICAgICAgICAgJHByb2R1Y3ROYW1lID0gJHByb2R1Y3RLZXkuR2V0VmFsdWUoIkRpc3BsYXlOYW1lIikNCiAgICAgICAgICAgICAgICAgICAgJHByb2R1Y3RWZXJzaW9uID0gJHByb2R1Y3RLZXkuR2V0VmFsdWUoIkRpc3BsYXlWZXJzaW9uIikNCiAgICAgICAgICAgICAgICAgICAgJHByb2R1Y3RDb21tZW50cyA9ICRwcm9kdWN0S2V5LkdldFZhbHVlKCJDb21tZW50cyIpDQogICAgICAgICAgICAgICAgICAgICRVbmluc3RhbGxTdHJpbmcgPSAkcHJvZHVjdEtleS5HZXRWYWx1ZSgiVW5pbnN0YWxsU3RyaW5nIikNCiAgICAgICAgICAgICAgICAgICAgJEluc3RhbGxMb2NhdGlvbiA9ICRwcm9kdWN0S2V5LkdldFZhbHVlKCJJbnN0YWxsTG9jYXRpb24iKSANCiAgICAgICAgICAgICAgICAgICAgDQoNCiAgICAgICAgICAgICAgICAgICAgZm9yZWFjaCgkZmlsdGVyIGluICRmaWx0ZXJzKXsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCgkcHJvZHVjdE5hbWUgLW1hdGNoICRmaWx0ZXIpIC1vciAoJHByb2R1Y3RDb21tZW50cyAtbWF0Y2ggJGZpbHRlcikpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkUHJvZHVjdFN0YXR1c1ZhbHVlID0gJG51bGwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkUHJvZHVjdFN0YXR1cyA9ICJJbmFjdGl2ZSINCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkU2VydmljZU5hbWUgPSAkbnVsbA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoJHByb2R1Y3ROYW1lIC1tYXRjaCAiV2Vicm9vdCBTZWN1cmVBbnl3aGVyZSIpeyRTZXJ2aWNlTmFtZSA9ICdXUlNWQyd9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoJHByb2R1Y3ROYW1lIC1tYXRjaCAiU2VudGluZWwgQWdlbnQiKXskU2VydmljZU5hbWUgPSAnc2Vkc3ZjJ30gDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgJFByb2R1Y3RTdGF0dXNWYWx1ZSA9IENoZWNrQW50aVZpcnVzU3RhdHVzIC1TZXJ2aWNlTmFtZSAkU2VydmljZU5hbWUNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZigkUHJvZHVjdFN0YXR1c1ZhbHVlIC1lcSAwKXskUHJvZHVjdFN0YXR1cyA9ICJBY3RpdmUifQ0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgJGxhc3RJbmRleCA9ICRVbmluc3RhbGxTdHJpbmcuTGFzdEluZGV4T2YoJyAnKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICRVbmluc3RhbGxTdHJpbmcgPSAkVW5pbnN0YWxsU3RyaW5nLlN1YnN0cmluZygwLCRsYXN0SW5kZXgpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgJFVuaW5zdGFsbFN0cmluZyA9ICRVbmluc3RhbGxTdHJpbmcgLXJlcGxhY2UgJyInLCAiIg0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoKCRVbmluc3RhbGxTdHJpbmcgLWxpa2UgJypleGUqJykgLW9yICAoJFVuaW5zdGFsbFN0cmluZyAtbGlrZSAnKkVYRSonKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJGxhc3RJbmRleDEgPSAkVW5pbnN0YWxsU3RyaW5nLkxhc3RJbmRleE9mKCdcJykNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRVbmluc3RhbGxTdHJpbmcgPSAkVW5pbnN0YWxsU3RyaW5nLlN1YnN0cmluZygwLCRsYXN0SW5kZXgxKSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgJGFudGlWaXJ1c09iaiA9IFtQU0N1c3RvbU9iamVjdF1Aew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIERpc3BsYXlOYW1lID0gJHByb2R1Y3ROYW1lICAgICAgICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBJbnN0YWxsTG9jYXRpb24gPSAkVW5pbnN0YWxsU3RyaW5nDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUHJvZHVjdFN0YXR1cyA9ICRQcm9kdWN0U3RhdHVzDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICRBbnRpVmlydXNMaXN0ICs9ICRhbnRpVmlydXNPYmoNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgfQ0KDQoNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgaWYoJGtleSAtbmUgJG51bGwpew0KICAgICAgICAka2V5LkNsb3NlKCl9DQogICAgfQ0KDQoNCiAgICBpZigkQW50aVZpcnVzTGlzdC5Db3VudCAtZXEgMCl7DQogICAgICANCiAgICAgICRTdGRFcnJBcnIgPSBAKCkNCiAgICAgICRzdGRPdXRBcnIgPSBAKCkNCiAgICAgICRTdGRFcnIgPSBOZXctT2JqZWN0IFBTT2JqZWN0IC1Qcm9wZXJ0eSBAewkJICAgICAgIA0KCQkgICAgICAgICAgICAgICAgICBpZCA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlID0gICJBbnRpdmlydXMgaXMgbm90IGluc3RhbGxlZCBpbiB0aGUgc3lzdGVtIg0KICAgICAgICAgICAgICAgICAgICAgICAgICBkZXRhaWwgPSAiQW50aXZpcnVzIGlzIG5vdCBpbnN0YWxsZWQgaW4gdGhlIHN5c3RlbSINCg0KICAgICAgICAgICAgICAgfQ0KICAgICAgICAgDQogICAgICRTdGRFcnJBcnIgKz0gJFN0ZEVycg0KICAgICAkc3RkT3V0QXJyICs9ICgiQW50aXZpcnVzIGlzIG5vdCBpbnN0YWxsZWQgaW4gdGhlIHN5c3RlbSIpDQogICAgDQogICAgICRBVk9iamVjdCB8IEFkZC1NZW1iZXIgLU1lbWJlclR5cGUgTm90ZVByb3BlcnR5IC1OYW1lIFN0YXR1cyAtVmFsdWUgImZhaWwiIA0KICAgICAkQVZPYmplY3QgfCBBZGQtTWVtYmVyIC1NZW1iZXJUeXBlIE5vdGVQcm9wZXJ0eSAtTmFtZSBDb2RlIC1WYWx1ZSAxDQogICAgICRBVk9iamVjdCB8IEFkZC1NZW1iZXIgLU1lbWJlclR5cGUgTm90ZVByb3BlcnR5IC1OYW1lIHN0ZGVyciAtVmFsdWUgJFN0ZEVyckFycg0KICAgICAkQVZPYmplY3QgfCBBZGQtTWVtYmVyIC1NZW1iZXJUeXBlIE5vdGVQcm9wZXJ0eSAtTmFtZSBSZXN1bHQgLVZhbHVlICJBbnRpdmlydXMgaXMgbm90IGluc3RhbGxlZCBpbiB0aGUgc3lzdGVtIg0KICAgICAkQVZPYmplY3QgfCBBZGQtTWVtYmVyIC1NZW1iZXJUeXBlIE5vdGVQcm9wZXJ0eSAtTmFtZSBzdGRvdXQgLVZhbHVlICAkc3RkT3V0QXJyICANCiAgICAgDQogICAgICByZXR1cm4gJEFWT2JqZWN0DQogICAgfQ0KDQogICAgDQogICAgPCMNCiAgICAkQVZPYmplY3QgfCBBZGQtTWVtYmVyIC1NZW1iZXJUeXBlIE5vdGVQcm9wZXJ0eSAtTmFtZSBTdGF0dXMgLVZhbHVlIDANCiAgICAkQVZPYmplY3QgfCBBZGQtTWVtYmVyIC1NZW1iZXJUeXBlIE5vdGVQcm9wZXJ0eSAtTmFtZSBNZXNzYWdlIC1WYWx1ZSAiTGlzdCBvZiBhbnRpVmlydXMgaW5zdGFsbGVkIGluIHRoZSBzeXN0ZW0iDQogICAgIz4NCg0KICAgICRBVkFyciA9IEAoKQ0KICAgICRBVkFyclN0ciA9IEAoKQ0KICAgICRBVkFyckVyciA9IEAoKQ0KDQogICANCiAgICBmb3JlYWNoKCRBViBpbiAkQW50aVZpcnVzTGlzdCl7DQogICAgICAgIA0KICAgICAgICAkT2JqZWN0MSA9IE5ldy1PYmplY3QgUFNPYmplY3QgLVByb3BlcnR5IEB7CQkgICAgICAgDQoJCSAgICAgICAgICAgICAgIERpc3BsYXlOYW1lID0gJEFWLkRpc3BsYXlOYW1lOw0KICAgICAgICAgICAgICAgICAgICAgICBJbnN0YWxsTG9jYXRpb24gPSAkQVYuSW5zdGFsbExvY2F0aW9uOw0KICAgICAgICAgICAgICAgICAgICAgICBQcm9kdWN0U3RhdHVzID0gJEFWLlByb2R1Y3RTdGF0dXM7DQoNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICREaXNwbGF5TmFtZSA9ICRBVi5EaXNwbGF5TmFtZTsNCiAgICAgICAkSW5zdGFsbExvY2F0aW9uID0gJEFWLkluc3RhbGxMb2NhdGlvbjsNCiAgICAgICAkUHJvZHVjdFN0YXR1cyA9ICRBVi5Qcm9kdWN0U3RhdHVzOw0KICAgICAgICAgDQogICAgICAgJEFWQXJyICs9ICAkT2JqZWN0MQ0KICAgICAgICRBVkFyclN0ciArPSAiRGlzcGxheU5hbWUgOiAkRGlzcGxheU5hbWUsIEluc3RhbGxMb2NhdGlvbiA6ICRJbnN0YWxsTG9jYXRpb24sIEF1dG9NYXRpY01hdHJpYyA6ICRQcm9kdWN0U3RhdHVzIiANCg0KICAgIH0gICAgDQogICAgDQogICAkQVZPYmogPSAgTmV3LU9iamVjdCBwc29iamVjdA0KICAgJEFWT2JqIHwgQWRkLU1lbWJlciAtTWVtYmVyVHlwZSBOb3RlUHJvcGVydHkgLU5hbWUgQWRhcHRlciAtVmFsdWUgJEFWQXJyDQogICAgICAgICAgICAgIA0KICAgJEFWT2JqZWN0IHwgQWRkLU1lbWJlciAtTWVtYmVyVHlwZSBOb3RlUHJvcGVydHkgLU5hbWUgU3RhdHVzIC1WYWx1ZSAiU3VjY2VzcyIgDQogICAkQVZPYmplY3QgfCBBZGQtTWVtYmVyIC1NZW1iZXJUeXBlIE5vdGVQcm9wZXJ0eSAtTmFtZSBDb2RlIC1WYWx1ZSAwDQogICAkQVZPYmplY3QgfCBBZGQtTWVtYmVyIC1NZW1iZXJUeXBlIE5vdGVQcm9wZXJ0eSAtTmFtZSBSZXN1bHQgLVZhbHVlICJTdWNjZXNzIDogTGlzdCBvZiBhbnRpVmlydXMgaW5zdGFsbGVkIGluIHRoZSBzeXN0ZW0iDQogICAkQVZPYmplY3QgfCBBZGQtTWVtYmVyIC1NZW1iZXJUeXBlIE5vdGVQcm9wZXJ0eSAtTmFtZSBzdGRvdXQgLVZhbHVlICAkQVZBcnJTdHINCiAgICRBVk9iamVjdCB8IEFkZC1NZW1iZXIgLU1lbWJlclR5cGUgTm90ZVByb3BlcnR5IC1OYW1lIGRhdGFPYmplY3QgLVZhbHVlICRBVk9iaiAgDQogICAgICAgDQogIHJldHVybiAkQVZPYmplY3QNCn0NCg0KDQppZigkUFNWZXJzaW9uVGFibGUuUFNWZXJzaW9uLk1ham9yIC1lcSAyKXsNCg0KICAgR2V0QWxsSW5zdGFsbGVkQW50aXZpcnVzIHwgQ29udmVydFRvLUpTT05QMg0KDQp9ZWxzZXsNCg0KICAgIEdldEFsbEluc3RhbGxlZEFudGl2aXJ1cyB8IENvbnZlcnRUby1Kc29uIC1EZXB0aCAxMA0KfQ==","jsonSchema":"","uiSchema":"","isHDScript":true}
