{"id":"eb5086c3-65d6-11e9-bada-00155d130b17","partnerId":"00000000-0000-0000-0000-000000000000","category":["Application"],"description":"Install Defraggler","engine":"powershell","engineMaxVersion":5,"expectedExecutionTimeSec":300,"failureMessage":"Executed with errors","successMessage":"Task Executed Successfully","internal":false,"name":"Install Defraggler","tags":["Windows 7","Windows 10"],"sequence":true,"content":"PCMKICAgIC5TWU5PUFNJUwogICAgICAgIEluc3RhbGwgRGVmcmFnZ2xlcgogICAgLkRFU0NSSVBUSU9OCiAgICAgICAgSW5zdGFsbCBEZWZyYWdnbGVyCiAgICAuSGVscAogICAgICAgIAogICAgLkF1dGhvcgogICAgICAgIER1cmdlc2hrdW1hciBQYXRlbAogICAgLlZlcnNpb24KICAgICAgICAxLjAKIz4gCjwjCkpTT04gU2NoZW1hCiRhY3Rpb24gICAgICAgICAgIEV4YW1wbGU6LSAkYWN0aW9uID0gInVuaW5zdGFsbCIKJHZlcnNpb24KJHN1YnZlcnNpb24KClN1YlZlcnNpb24KMi4xOAoyLjE5CjIuMjAKMi4yMQoKT25seSBzdWJ2ZXJzaW9uIHZhcmlhYmxlIHdpbGwgYmUgdXNlZCBpbiBzY3JpcHQuIAojPgoKaWYgKCRlbnY6UFJPQ0VTU09SX0FSQ0hJVEVXNjQzMiAtZXEgIkFNRDY0IikgewogICAgaWYgKCRteUludm9jYXRpb24uTGluZSkgewogICAgICAgICYiJGVudjpzeXN0ZW1yb290XHN5c25hdGl2ZVx3aW5kb3dzcG93ZXJzaGVsbFx2MS4wXHBvd2Vyc2hlbGwuZXhlIiAtTm9uSW50ZXJhY3RpdmUgLU5vUHJvZmlsZSAkbXlJbnZvY2F0aW9uLkxpbmUKICAgIH0KICAgIGVsc2UgewogICAgICAgICYiJGVudjpzeXN0ZW1yb290XHN5c25hdGl2ZVx3aW5kb3dzcG93ZXJzaGVsbFx2MS4wXHBvd2Vyc2hlbGwuZXhlIiAtTm9uSW50ZXJhY3RpdmUgLU5vUHJvZmlsZSAtZmlsZSAiJCgkbXlJbnZvY2F0aW9uLkludm9jYXRpb25OYW1lKSIgJGFyZ3MKICAgIH0KICAgIGV4aXQgJGxhc3RleGl0Y29kZQp9CgokYWN0aW9uID0gIkluc3RhbGwiCgppZiAoJGFjdGlvbiAtZXEgImluc3RhbGwiKSB7CgogICAgJHN1YnZlcnNpb25wYXRoID0gQHsKICAgICAgICAnMi4xOCcgPSAiaHR0cDovL2RjbWR3bGQuaXRzdXBwb3J0MjQ3Lm5ldC9kZnNldHVwMjE4X3NsaW0uZXhlIgogICAgICAgICcyLjE5JyA9ICJodHRwOi8vZGNtZHdsZC5pdHN1cHBvcnQyNDcubmV0L2Rmc2V0dXAyMTlfc2xpbS5leGUiCiAgICAgICAgJzIuMjAnID0gImh0dHA6Ly9kY21kd2xkLml0c3VwcG9ydDI0Ny5uZXQvZGZzZXR1cDIyMF9zbGltLmV4ZSIKICAgICAgICAnMi4yMScgPSAiaHR0cDovL2RjbWR3bGQuaXRzdXBwb3J0MjQ3Lm5ldC9kZnNldHVwMjIxX3NsaW0uZXhlIgogICAgfQoKICAgIEZ1bmN0aW9uIFByb2RfSW5zdGFsbCB7CiAgICAKICAgICAgICAkdXJsID0gJHN1YnZlcnNpb25wYXRoWyIkdmVyc2lvbiJdCiAgICAgICAgIyR1cmwgPSAiaHR0cHM6Ly9kb3dubG9hZC5jY2xlYW5lci5jb20vZGZzZXR1cDIyMi5leGUiCiAgICAgICAgJGRvd25sb2FkcGF0aCA9ICJDOlxXaW5kb3dzXFRlbXBcZGZzZXR1cF9hYmNkLmV4ZSIKICAgICAgICAkd2MgPSBOZXctT2JqZWN0IFN5c3RlbS5OZXQuV2ViQ2xpZW50CiAgICAgICAgJHdjLkRvd25sb2FkRmlsZSgiJHVybCIsICIkZG93bmxvYWRwYXRoIikKICAgICAgICAkcHMgPSBOZXctT2JqZWN0IFN5c3RlbS5EaWFnbm9zdGljcy5Qcm9jZXNzCiAgICAgICAgJHBzLlN0YXJ0SW5mby5GaWxlbmFtZSA9ICRkb3dubG9hZHBhdGgKICAgICAgICAkcHMuU3RhcnRJbmZvLkFyZ3VtZW50cyA9ICIvUyIKICAgICAgICAkcHMuU3RhcnRJbmZvLlJlZGlyZWN0U3RhbmRhcmRPdXRwdXQgPSAkVHJ1ZQogICAgICAgICRwcy5TdGFydEluZm8uVXNlU2hlbGxFeGVjdXRlID0gJGZhbHNlCiAgICAgICAgJHBzLnN0YXJ0KCkKICAgICAgICAkcHMuV2FpdEZvckV4aXQoKQogICAgICAgIHJldHVybiAkcHMuRXhpdENvZGUKICAgIH0gCiAgICAKICAgIEZ1bmN0aW9uIENyZWF0ZV9yZWdpc3RyeSgkcGF0aCwgJE5hbWUsICRWYWx1ZSwgJHByb3BlcnR5dHlwZSkgewogICAgICAgICMgRnVuY3Rpb24gd2lsbCBzZXQgcmVnaXN0cnkgdmFsdWUgYW5kIGlmIGl0ZW0gaXMgbm90IHByZXNlbnQgd2lsbCBjcmVhdGUgcmVnaXN0cnkgZW50cnkuCiAgICAgICAgJERldGFpbHMgPSBHZXQtSXRlbVByb3BlcnR5IC1QYXRoICRwYXRoCiAgICAgICAgaWYgKCREZXRhaWxzIC1uZSAkbnVsbCkgewogICAgICAgICAgICAkRGV0YWlscyA9IEdldC1JdGVtUHJvcGVydHkgLVBhdGggJHBhdGggfCBnbSB8IHNlbGVjdCAtRXhwYW5kUHJvcGVydHkgTmFtZQogICAgICAgICAgICBpZiAoJERldGFpbHMgLWNvbnRhaW5zICROYW1lKSB7CiAgICAgICAgICAgICAgICBTZXQtSXRlbVByb3BlcnR5ICRwYXRoIC1OYW1lICROYW1lIC1WYWx1ZSAkVmFsdWUKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgIE5ldy1JdGVtUHJvcGVydHkgLVBhdGggJHBhdGggLU5hbWUgJE5hbWUgLVByb3BlcnR5VHlwZSAkcHJvcGVydHl0eXBlIC1WYWx1ZSAkVmFsdWUgfCBPdXQtTnVsbAogICAgICAgICAgICB9CiAgICAgICAgCiAgICAgICAgfSAjRW5kIGlmIHN0YXRlbWVudAogICAgICAgIGVsc2UgewogICAgICAgICAgICBOZXctSXRlbVByb3BlcnR5IC1QYXRoICRwYXRoIC1OYW1lICROYW1lIC1Qcm9wZXJ0eVR5cGUgJHByb3BlcnR5dHlwZSAtVmFsdWUgJFZhbHVlIHwgT3V0LU51bGwKICAgICAgICB9ICAjIEVuZCBlbHNlIHN0YXRlbWVudAogICAgCiAgICAgICAgaWYgKChHZXQtSXRlbVByb3BlcnR5ICRwYXRoIC1OYW1lICROYW1lIHwgc2VsZWN0IC1FeHBhbmRQcm9wZXJ0eSAkTmFtZSkgLWVxICRWYWx1ZSkgeyByZXR1cm4gJHRydWUgfSBlbHNlIHsgcmV0dXJuICRmYWxzZSB9CiAgICB9CgoKCiAkUmVnaXN0cnkgPSAnSEtMTTpcU09GVFdBUkVcV293NjQzMk5vZGVcTWljcm9zb2Z0XFdpbmRvd3NcQ3VycmVudFZlcnNpb25cVW5pbnN0YWxsJywgJ0hLTE06XFNPRlRXQVJFXE1pY3Jvc29mdFxXaW5kb3dzXEN1cnJlbnRWZXJzaW9uXFVuaW5zdGFsbCcKCiAgICAkUHJvZHVjdF9DaGVjayA9IEdldC1DaGlsZEl0ZW0gJFJlZ2lzdHJ5IC1FcnJvckFjdGlvbiAnU2lsZW50bHlDb250aW51ZScgfCBHZXQtSXRlbVByb3BlcnR5IHwgV2hlcmUtT2JqZWN0IHsgJF8uRGlzcGxheU5hbWUgLW1hdGNoICJEZWZyYWdnbGVyIiB9IHwgc2VsZWN0IC1GaXJzdCAxCgogICAgaWYgKCRQcm9kdWN0X0NoZWNrKSB7CiAgICAgICAgV3JpdGUtT3V0cHV0ICJgbiIKICAgICAgICBXcml0ZS1PdXRwdXQgIkRlZnJhZ2dsZXIgaXMgYWxyZWFkeSBpbnN0YWxsZWQgb24gc3lzdGVtICRFTlY6Q09NUFVURVJOQU1FIgogICAgICAgIEVYSVQ7CiAgICB9CgogICAgJE9TQXJjaCA9IChHZXQtV21pT2JqZWN0IFdpbjMyX09wZXJhdGluZ1N5c3RlbSkuT1NBcmNoaXRlY3R1cmUgCiAgICBTd2l0Y2ggKCRPU0FyY2gpIHsKICAgICAgICAiNjQtYml0IiB7ICRSZWdLZXkgPSAicmVnaXN0cnk6OkhLTE1cU09GVFdBUkVcV293NjQzMk5vZGUiIH0KICAgICAgICAiMzItYml0IiB7ICRSZWdLZXkgPSAicmVnaXN0cnk6OkhLTE1cU29mdHdhcmUiIH0KICAgICAgICB9IAogICAgCiAgICAkaXRlbXMgPSBAKCJHb29nbGUiLCAiTm8gQ2hyb21lIE9mZmVyIFVudGlsIikKICAgIAogICAgJEVycm9yQWN0aW9uUHJlZmVyZW5jZSA9ICJTaWxlbnRseUNvbnRpbnVlIgogICAgZm9yZWFjaCAoJGl0ZW0gaW4gJGl0ZW1zKSB7CiAgICAKICAgICAgICBOZXctSXRlbSAtcGF0aCAkUmVnS2V5IC1uYW1lICRpdGVtIC1Gb3JjZSB8IE91dC1OdWxsOyAkUmVnS2V5ID0gJFJlZ0tleSArICJcIiArICIkaXRlbSIKICAgICAgICAKICAgIH0KICAgICRFcnJvckFjdGlvblByZWZlcmVuY2UgPSAiQ29udGludWUiCiAgICAKICAgIGlmIChUZXN0LVBhdGggJFJlZ0tleSkgewogICAgCiAgICAgICAgJHJlc3VsdCA9IENyZWF0ZV9yZWdpc3RyeSAtcGF0aCAkUmVnS2V5IC1uYW1lICJQaXJpZm9ybSBMdGQiIC1WYWx1ZSAyMDk5MTIzMSAtcHJvcGVydHl0eXBlIERXT1JECiAgICAKICAgIH0KICAgICAKICAgIGlmICgkcmVzdWx0KSB7CiAgICAKICAgICAgICBpZiAoUHJvZF9JbnN0YWxsIC1lcSAwKSB7CiAgICAgICAgICAgIFdyaXRlLU91dHB1dCAiYG4iCiAgICAgICAgICAgIFdyaXRlLU91dHB1dCAiRGVmcmFnZ2xlciB2JHZlcnNpb24gaW5zdGFsbGVkIHN1Y2Nlc3NmdWxseSBvbiBzeXN0ZW0gJEVOVjpDT01QVVRFUk5BTUUiCiAgICAgICAgCiAgICAgICAgfQogICAgICAgIGVsc2UgewogICAgICAgICAgICBXcml0ZS1PdXRwdXQgImBuIgogICAgICAgICAgICBXcml0ZS1PdXRwdXQgIkZhaWxlZCB0byBpbnN0YWxsIERlZnJhZ2dsZXIgdiR2ZXJzaW9uIG9uIHN5c3RlbSAkRU5WOkNPTVBVVEVSTkFNRSIKICAgICAgICAgCiAgICAgICAgfSAgIAogICAgfQoKfQplbHNlIHsKICAgIFdyaXRlLU91dHB1dCAiYG5LaW5kbHkgc2VsZWN0ICdJbnN0YWxsJyBhcyBhbiBhY3Rpb24iCn0K","jsonSchema":{"type":"object","properties":{"version":{"title":"Select Install Version","type":"string","enum":["2.18","2.19","2.20","2.21"],"enumNames":["2.18","2.19","2.20","2.21"]}},"additionalproperties":false,"required":["version"]},"uiSchema":{"version":{"classNames":"col-sm-4 col-sm-offset-right-8","ui:autofocus":true,"ui:placeholder":"Select Version"}},"isHDScript":false}
