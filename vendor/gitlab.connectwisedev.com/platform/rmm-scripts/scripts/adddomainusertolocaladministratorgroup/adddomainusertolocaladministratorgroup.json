{"id":"681713d2-4f28-11e9-9f17-00155d130b01","partnerId":"00000000-0000-0000-0000-000000000000","category":["Setup"],"description":"Add domain user to local administrator group","engine":"powershell","engineMaxVersion":5,"expectedExecutionTimeSec":300,"failureMessage":"Executed with errors","successMessage":"Excecuted Successfully","internal":false,"name":"Add domain user to local administrator","tags":["Windows 7","Windows 10"],"sequence":true,"content":"PCMgIAouU1lOT1BTSVMgIAogICAgQWRkIERvbWFpbiBVc2VyIHRvIExvY2FsIEFkbWluaXN0cmF0b3JzIEdyb3VwCi5ERVNDUklQVElPTiAgCiAgICBBZGQgRG9tYWluIFVzZXIgdG8gTG9jYWwgQWRtaW5pc3RyYXRvcnMgR3JvdXAuIFNjcml0cCB3aWxsIGNoZWNrIGNvcnJlY3QgRG9tYWluIE5hbWUuIFNjcmlwdCB3aWxsIHZhbGlkYXRlIHRoZSBkb21haW4gdXNlciBhbmQgYWxzbyBjaGVjayBpZiBkb21haW4gdXNlciBhbHJlYWR5IGEgbWVtYmVyIG9mIGxvY2FsIGFkbWluaXN0cmF0b3JzIGdyb3VwLgouTk9URVMgIAogICAgRmlsZSBOYW1lICA6IEFkZERvbWFpblVzZXJUb0xvY2FsQWRtaW5pc3RhdG9yR3JvdXAucHMxCiAgICBBdXRob3IgICAgIDogRHVyZ2VzaGt1bWFyIFBhdGVsICAKICAgIFJlcXVpcmVzICAgOiBQb3dlclNoZWxsIFYyIG9yIGdyZWF0ZXIuICAgCi5QQVJBTUVURVJTCiAgICAKLkhFTFAKIz4KCjwjIFZhcmlhYmxlcyB0byBkZWZpbmUgaW4gSlNPTiBTY2hlbWEKJERvbWFpblVzZXIgICAgICAgICAgICAgIEV4YW1wbGUgInNtaXRoNyIgICMiU2FtQWNjb3VudE5hbWUiCiREb21haW5OYW1lICAgICAgICAgICAgICBFeGFtcGxlICAiU2NyaXB0ZGMzLkxPQ0FMIiAgICNGdWxsIERvbWFpbiBOYW1lCiM+CgppZiAoJGVudjpQUk9DRVNTT1JfQVJDSElURVc2NDMyIC1lcSAiQU1ENjQiKSB7CiAgICBpZiAoJG15SW52b2NhdGlvbi5MaW5lKSB7CiAgICAgICAgJiIkZW52OnN5c3RlbXJvb3Rcc3lzbmF0aXZlXHdpbmRvd3Nwb3dlcnNoZWxsXHYxLjBccG93ZXJzaGVsbC5leGUiIC1Ob25JbnRlcmFjdGl2ZSAtTm9Qcm9maWxlICRteUludm9jYXRpb24uTGluZQogICAgfQogICAgZWxzZSB7CiAgICAgICAgJiIkZW52OnN5c3RlbXJvb3Rcc3lzbmF0aXZlXHdpbmRvd3Nwb3dlcnNoZWxsXHYxLjBccG93ZXJzaGVsbC5leGUiIC1Ob25JbnRlcmFjdGl2ZSAtTm9Qcm9maWxlIC1maWxlICIkKCRteUludm9jYXRpb24uSW52b2NhdGlvbk5hbWUpIiAkYXJncwogICAgfQogICAgZXhpdCAkbGFzdGV4aXRjb2RlCn0KCgokQ29tcHV0ZXIgPSAkZW52OmNvbXB1dGVybmFtZQokTG9jYWxHcm91cCA9ICJBZG1pbmlzdHJhdG9ycyIKZnVuY3Rpb24gZG9tYWluY2hlY2sgewogICAgCiAgICBpZiAoISREb21haW5OYW1lKSB7CiAgICAgICAgV3JpdGUtT3V0cHV0ICJgbktpbmRseSBwcm92aWRlIHRoZSBEb21haW4gTmFtZS4gUHJvdmlkZWQgdmFsdWUgaXMgbnVsbCIKICAgICAgICBFeGl0OwogICAgfQogICAgZWxzZSB7CiAgICAgICAgaWYgKChHZXQtV21pT2JqZWN0IC1jbGFzcyBXaW4zMl9Db21wdXRlclN5c3RlbSkuZG9tYWluIC1lcSAkRG9tYWluTmFtZSkgewogICAgICAgICAgICByZXR1cm4gJHRydWUKICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIHJldHVybiAkZmFsc2UKICAgICAgICB9CiAgICB9Cn0KCgpmdW5jdGlvbiB2YWxpZGF0ZSB7CiAgICAKICAgICRFcnJvckFjdGlvblByZWZlcmVuY2UgPSAiU2lsZW50bHlDb250aW51ZSIKICAgIG5ldCB1c2VyICREb21haW5Vc2VyIC9kb21haW4gPiBudWxsIDI+JjEKICAgIGlmICgkPykgewogICAgICAgIHJldHVybiAkdHJ1ZQogICAgfQogICAgZWxzZSB7CiAgICAgICAgcmV0dXJuICRmYWxzZQogICAgfQp9CgpmdW5jdGlvbiBtZW1iZXIgewoKICAgICRtZW1iZXIgPSBuZXQgbG9jYWxncm91cCBhZG1pbmlzdHJhdG9ycyB8IFdoZXJlIHskXyAtZXEgJERvbWFpblVzZXJ9CiAgICBpZiAoJG1lbWJlciAtbmUgJG51bGwpIHsKICAgICAgICByZXR1cm4gJHRydWUKICAgIH0KICAgIGVsc2UgewogICAgICAgIHJldHVybiAkZmFsc2UKICAgIH0KfQoKaWYgKCEkRG9tYWluVXNlcikgewogICAgV3JpdGUtT3V0cHV0ICJgbktpbmRseSBwcm92aWRlIHRoZSBVc2VybmFtZS4gUHJvdmlkZWQgdmFsdWUgaXMgbnVsbCIKICAgIEV4aXQ7Cn0KCmlmICghKGRvbWFpbmNoZWNrKSkgewogICAgIlByb3ZpZGVkIERvbWFpbiBOYW1lICd7MH0nIGlzIG5vdCBjb3JyZWN0IiAtZiAkRG9tYWluTmFtZQogICAgRXhpdDsKfQoKdHJ5IHsKCiAgICBpZiAobWVtYmVyKSB7CiAgICAgICAgV3JpdGUtT3V0cHV0ICJgbiREb21haW5Vc2VyIGlzIGFscmVhZHkgYSBtZW1iZXIgb2YgTG9jYWwgQWRtaW5pc3RyYXRvcnMgR3JvdXAiCiAgICAgICAgRXhpdDsKICAgIH0KICAgIGVsc2UgewogICAgICAgIGlmICh2YWxpZGF0ZSkgewogICAgICAgICAgICAkdGFyZ2V0ID0gKFtBRFNJXSJXaW5OVDovLyRDb21wdXRlci8kTG9jYWxHcm91cCxncm91cCIpCiAgICAgICAgICAgICR0YXJnZXQucHNiYXNlLkludm9rZSgiQWRkIiwgKFtBRFNJXSJXaW5OVDovLyREb21haW5OYW1lLyREb21haW5Vc2VyIikucGF0aCkKICAgICAgICAgICAgaWYgKG1lbWJlcikgewogICAgICAgICAgICAgICAgV3JpdGUtT3V0cHV0ICJgbiREb21haW5Vc2VyIGFkZGVkIHRvIExvY2FsIEFkbWluaXN0cmF0b3JzIGdyb3VwIgogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgV3JpdGUtT3V0cHV0ICJgbiREb21haW5Vc2VyIG5vdCBhZGRlZCB0byBMb2NhbCBBZG1pbmlzdHJhdG9ycyBncm91cCIKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBlbHNlIHsKICAgICAgICAgICAgV3JpdGUtT3V0cHV0ICJgbiREb21haW5Vc2VyIGlzIG5vdCBhIGRvbWFpbiB1c2VyIgogICAgICAgIH0KICAgIH0KfQpjYXRjaCB7CiAgICBXcml0ZS1PdXRwdXQgImBuRmFpbGVkIHRvIGFkZCAkRG9tYWluVXNlciB0byBMb2NhbCBBZG1pbmlzdHJhdG9ycyBncm91cCIKICAgIFdyaXRlLU91dHB1dCAkXy5FeGNlcHRpb24uTWVzc2FnZQp9CgoK","jsonSchema":{"properties":{"domainName":{"title":"Domain Name","type":"string"},"domainUser":{"title":"Domain User Name","type":"string"}},"required":["domainName","domainUser"],"type":"object"},"uiSchema":{"domainName":{"classNames":"col-sm-6 col-sm-offset-right-6","ui:autofocus":true},"domainUser":{"classNames":"col-sm-6 col-sm-offset-right-6","ui:autofocus":true},"ui:order":["domainName","domainUser"]},"isHDScript":false}