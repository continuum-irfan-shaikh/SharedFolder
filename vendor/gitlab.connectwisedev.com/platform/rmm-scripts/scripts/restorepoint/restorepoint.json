{"id":"bdbb36cc-74c4-481b-b768-8f717a0e3b97","partnerId":"00000000-0000-0000-0000-000000000000","category":["Maintenance","Management"],"description":"Creates a system restore point","engine":"powershell","engineMaxVersion":5,"expectedExecutionTimeSec":86400,"failureMessage":"Executed with errors","successMessage":"System Restore Point was created","internal":false,"name":"Create system restore point","tags":["Windows 7","Windows 10"],"sequence":true,"content":"PCMKRXZlbnRUeXBlOgoKQkVHSU5fTkVTVEVEX1NZU1RFTV9DSEFOR0UgPSAxMDIKQkVHSU5fU1lTVEVNX0NIQU5HRSA9IDEwMApFTkRfTkVTVEVEX1NZU1RFTV9DSEFOR0UgPSAxMDMKRU5EX1NZU1RFTV9DSEFOR0UgPSAxMDEKClJlc3RvcmVQb2ludFR5cGU6CgpBUFBMSUNBVElPTl9JTlNUQUxMID0gMApBUFBMSUNBVElPTl9VTklOU1RBTEwgPSAxCkNBTkNFTExFRF9PUEVSQVRJT04gPSAxMwpERVZJQ0VfRFJJVkVSX0lOU1RBTEwgPSAxMApNT0RJRllfU0VUVElOR1MgPSAxMgojPgoKJE9TID0gKEdldC1XTUlPYmplY3QgLUNsYXNzIFdpbjMyX09wZXJhdGluZ1N5c3RlbSkuQ2FwdGlvbgoKSWYgKCRPUyAtbGlrZSAiKlNlcnZlcioiKSB7CiAgICAgICAgICAgV3JpdGUtRXJyb3IgIkN1cnJlbnQgT1MgOiAkT1MuIFRoaXMgZnVuY3Rpb25hbGl0eSBpcyBub3Qgc3VwcG9ydGVkIG9uIHRoaXMgb3BlcmF0aW5nIHN5c3RlbS4iCiAgICAgICAgICAgRXhpdAp9IEVsc2UgewogICAgIHRyeSB7ICAKICAgICAgICAgICBFbmFibGUtQ29tcHV0ZXJSZXN0b3JlIC1Ecml2ZSAoR2V0LVdtaU9iamVjdCBXaW4zMl9PcGVyYXRpbmdTeXN0ZW0pLlN5c3RlbURyaXZlCiAgICAgICAgICAgQ2hlY2twb2ludC1Db21wdXRlciAtRGVzY3JpcHRpb24gIlNjcmlwdGVkIHJlc3RvcmUiIC1SZXN0b3JlUG9pbnRUeXBlICRyZXN0b3JlVHlwZSAtV0Egc3RvcCAtRUEgU3RvcAogICAgICAgICAgICRyZXN0b3JlcG9pbnRzID0gR2V0LUNvbXB1dGVyUmVzdG9yZVBvaW50IC1FQSBzdG9wIHwgU29ydC1PYmplY3QgQ3JlYXRpb25UaW1lIC1EZXNjZW5kaW5nCiAgICAgfWNhdGNoewogICAgICAgICAgIFdyaXRlLUVycm9yICRfLkV4Y2VwdGlvbi5NZXNzYWdlCiAgICAgICAgICAgRXhpdAogICAgIH0KCn0KJHJlc3VsdCA9IEAoKQokbmV3X3Jlc3RvcmVfcG9pbnQgPSAoJHJlc3RvcmVwb2ludHNbMF0pLlNlcXVlbmNlTnVtYmVyCldyaXRlLU91dHB1dCAiU3lzdGVtIHJlc3RvcmUgcG9pbnQgKFNlcXVlbmNlTnVtYmVyID0gJG5ld19yZXN0b3JlX3BvaW50KSBzdWNjZXNzZnVsbHkgY3JlYXRlZC4iCgpmb3JlYWNoICgkaXRlbSBpbiAkcmVzdG9yZXBvaW50cykgewogICAgIGlmICgkaXRlbS5FdmVudFR5cGUgLWVxIDEwMiApIHsgJEV2ZW50VHlwZSA9ICJCRUdJTl9ORVNURURfU1lTVEVNX0NIQU5HRSIgfQogICAgICAgICBlbHNlaWYgKCRpdGVtLkV2ZW50VHlwZSAtZXEgMTAwICkgeyAkRXZlbnRUeXBlID0gIkJFR0lOX1NZU1RFTV9DSEFOR0UiIH0gICAgCiAgICAgICAgIGVsc2VpZiAoJGl0ZW0uRXZlbnRUeXBlIC1lcSAxMDMgKSB7ICRFdmVudFR5cGUgPSAiRU5EX05FU1RFRF9TWVNURU1fQ0hBTkdFIiB9CiAgICAgICAgIGVsc2VpZiAoJGl0ZW0uRXZlbnRUeXBlIC1lcSAxMDEgKSB7ICRFdmVudFR5cGUgPSAiRU5EX1NZU1RFTV9DSEFOR0UiIH0KICAgICBlbHNlIHsgJEV2ZW50VHlwZSA9ICRpdGVtLkV2ZW50VHlwZSB9CiAgICAgCiAgICAgaWYgKCRpdGVtLlJlc3RvcmVQb2ludFR5cGUgLWVxIDApIHsgJFJlc3RvcmVQb2ludFR5cGUgPSAiQVBQTElDQVRJT05fSU5TVEFMTCIgfQogICAgICAgICBlbHNlaWYgKCRpdGVtLlJlc3RvcmVQb2ludFR5cGUgLWVxIDEpIHsgJFJlc3RvcmVQb2ludFR5cGUgPSAiQVBQTElDQVRJT05fVU5JTlNUQUxMIiB9CiAgICAgICAgIGVsc2VpZiAoJGl0ZW0uUmVzdG9yZVBvaW50VHlwZSAtZXEgMTMpIHsgJFJlc3RvcmVQb2ludFR5cGUgPSAiQ0FOQ0VMTEVEX09QRVJBVElPTiIgfQogICAgICAgICBlbHNlaWYgKCRpdGVtLlJlc3RvcmVQb2ludFR5cGUgLWVxIDEwKSB7ICRSZXN0b3JlUG9pbnRUeXBlID0gIkRFVklDRV9EUklWRVJfSU5TVEFMTCIgfQogICAgICAgICBlbHNlaWYgKCRpdGVtLlJlc3RvcmVQb2ludFR5cGUgLWVxIDEyKSB7ICRSZXN0b3JlUG9pbnRUeXBlID0gIk1PRElGWV9TRVRUSU5HUyIgfQogICAgIGVsc2UgeyAkUmVzdG9yZVBvaW50VHlwZSA9ICRpdGVtLlJlc3RvcmVQb2ludFR5cGUgfQogICAgCiAgICAgJHJlc3VsdCArPSBOZXctT2JqZWN0IFBTT2JqZWN0IC1Qcm9wZXJ0eSBAewogICAgICAgICAgICAgICAgICAgICJDcmVhdGlvblRpbWUiID0gJGl0ZW0uQ29udmVydFRvRGF0ZVRpbWUoJGl0ZW0uQ3JlYXRpb25UaW1lKQogICAgICAgICAgICAgICAgICAgICJEZXNjcmlwdGlvbiIgPSAkaXRlbS5EZXNjcmlwdGlvbgogICAgICAgICAgICAgICAgICAgICJTZXF1ZW5jZU51bWJlciIgPSAkaXRlbS5TZXF1ZW5jZU51bWJlcgogICAgICAgICAgICAgICAgICAgICJFdmVudFR5cGUiID0gJEV2ZW50VHlwZQogICAgICAgICAgICAgICAgICAgICJSZXN0b3JlUG9pbnRUeXBlIiA9ICRSZXN0b3JlUG9pbnRUeXBlIAogICAgIH0KfQokcmVzdWx0IHwgRm9ybWF0LUxpc3QgQ3JlYXRpb25UaW1lLCBEZXNjcmlwdGlvbiwgU2VxdWVuY2VOdW1iZXIsIEV2ZW50VHlwZSwgUmVzdG9yZVBvaW50VHlwZQoK","jsonSchema":{"additionalProperties":false,"properties":{"restoreType":{"enum":["APPLICATION_UNINSTALL","DEVICE_DRIVER_INSTALL","MODIFY_SETTINGS","CANCELLED_OPERATION"],"enumNames":["APPLICATION_UNINSTALL","DEVICE_DRIVER_INSTALL","MODIFY_SETTINGS","CANCELLED_OPERATION"],"title":"Restore type","type":"string"}},"required":["restoreType"],"type":"object"},"uiSchema":{"restoreType":{"classNames":"col-sm-6","ui:autofocus":true,"ui:placeholder":"Select restore type"}},"isHDScript":false}