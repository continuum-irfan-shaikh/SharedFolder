{"id":"570f96ad-5d41-11e9-9085-00155d130b01","partnerId":"00000000-0000-0000-0000-000000000000","category":["Data Collection"],"description":"Retrieves google chrome history. The task allows to retrieve history for specific users or all users with history of last number of days.","engine":"powershell","engineMaxVersion":5,"expectedExecutionTimeSec":600,"failureMessage":"Executed with errors","successMessage":"Excecuted successfully","internal":false,"name":"Retrieve Google Chrome history","tags":["Windows 7","Windows 10"],"sequence":true,"content":"PCMKVGVtcGxhdGUgTmFtZTogUmV0cmlldmUgR29vZ2xlIENocm9tZSBoaXN0b3J5CgpEZXNjcmlwdGlvbjoKUmV0cmlldmVzIGdvb2dsZSBjaHJvbWUgaGlzdG9yeS4gU2NyaXB0IGFsbG93cyB0byByZXRyaXZlIGhpc3RvcnkgZm9yIHNsZWN0ZWQgdXNlcnMgb3IgYWxsIHVzZXJzLgojPgoKJE9TQXJjaCA9IChHZXQtV01JT2JqZWN0IFdpbjMyX09wZXJhdGluZ1N5c3RlbSkuT1NBcmNoaXRlY3R1cmUKU3dpdGNoKCRPU0FyY2gpewogICAiNjQtYml0IiB7ICAkc3FsaXRlMyA9ICR7RU5WOlByb2dyYW1GaWxlcyh4ODYpfSsiXElUU1BsYXRmb3JtXHBsdWdpblxzY3JpcHRpbmdcc3FsaXRlMy5leGUifSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAiMzItYml0IiB7ICAkc3FsaXRlMyA9ICR7RU5WOlByb2dyYW1GaWxlc30rIlxJVFNQbGF0Zm9ybVxwbHVnaW5cc2NyaXB0aW5nXHNxbGl0ZTMuZXhlIiB9ICAgICAgICAgICAgICAgCn0KaWYgKCEkZGF5cyl7ICRkYXlzID0gOTAgfSAKJFNxbHlRdWVyeSA9ICJTRUxFQ1QgZGF0ZXRpbWUobGFzdF92aXNpdF90aW1lIC8gMTAwMDAwMCArIChzdHJmdGltZSgnJXMnLCAnMTYwMS0wMS0wMScpKSwKICAgICAgICAgICAgICAndW5peGVwb2NoJywnbG9jYWx0aW1lJyApIGFzIHZpc2l0X3RpbWUsIHZpc2l0X2NvdW50LCAKICAgICAgICAgICAgICAgdXJsIEZST00gdXJscyBXSEVSRSB2aXNpdF90aW1lID4gKFNFTEVDVCBEQVRFVElNRSgnbm93JywgJy0kZGF5cyBkYXknKSkgT1JERVIgYnkgdmlzaXRfdGltZSBERVNDOyIKJHByb2ZpbGVEaXJzID0gQCgpCmlmKCR1c2VycyAtZXEgImFsbHVzZXJzIil7ICAgIAogICAgICAgIEdldC1DaGlsZEl0ZW0gLVBhdGggIkhLTE06XFNPRlRXQVJFXE1pY3Jvc29mdFxXaW5kb3dzIE5UXEN1cnJlbnRWZXJzaW9uXFByb2ZpbGVMaXN0IiB8IEZvckVhY2gtT2JqZWN0IHsKICAgICAgICAJJHVzZXJQcm9maWxlID0gKEdldC1JdGVtUHJvcGVydHkgLVBhdGggJF8uUFNQYXRoKS5Qcm9maWxlSW1hZ2VQYXRoCiAgICAgICAgCQogICAgICAgIAlpZiAoJHVzZXJwcm9maWxlLnN1YnN0cmluZygwLCAkKCRlbnY6d2luZGlyKS5sZW5ndGgpIC1lcSAkZW52OndpbmRpcikgewogICAgICAgIAkJIyBTa2lwcGluZyAtIFByb2ZpbGUgaW4gV2luZG93cyBGb2xkZXIKICAgICAgICAJfSBlbHNlaWYgKCEoR2V0LUNoaWxkSXRlbSAkdXNlclByb2ZpbGUgLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWUpKSB7CiAgICAgICAgCQkjIFNraXBwaW5nIC0gRm9sZGVyIGRvZXMgbm90IGV4aXN0IgogICAgICAgIAl9IGVsc2UgewogICAgICAgIAkJJHByb2ZpbGVEaXJzICs9ICR1c2VyUHJvZmlsZQogICAgICAgIAl9CiAgICAgICAgfQp9ZWxzZXsgJHByb2ZpbGVEaXJzID0gJHVzZXJuYW1lcyAtc3BsaXQoIiwiKSB8ICV7ImM6XHVzZXJzXCIgKyAkXyB9fQoKJFJlc3VsdCA9IEAoKQokRXJyb3JzID0gQCgpCmZvcmVhY2ggKCRwcm9maWxlRGlyIGluICRwcm9maWxlRGlycyl7CiAgICAgICAgJHVzZXIgPSAoJHByb2ZpbGVEaXIgLXNwbGl0ICgnXFwnKSlbMl0KICAgICAgICAkSGlzdG9yeURCID0gSm9pbi1QYXRoICRwcm9maWxlRGlyICJcQXBwRGF0YVxMb2NhbFxHb29nbGVcQ2hyb21lXFVzZXIgRGF0YVxEZWZhdWx0XEhpc3RvcnkiICMKICAgICAgICBpZiAoVGVzdC1QYXRoICRIaXN0b3J5REIgLUVBIFNpbGVudGx5Q29udGludWUgKSB7CiAgICAgICAgIAogICAgICAgICAgICBUcnkgewogICAgICAgICAgICAgICAgICBDb3B5LUl0ZW0gJEhpc3RvcnlEQiAkRU5WOlRFTVAgLUVycm9yQWN0aW9uIFN0b3AKICAgICAgICAgICAgICAgICAgc2xlZXAgMgogICAgICAgICAgICAgICAgICAkdGVtcEhpc3RvcnlEQiA9IEpvaW4tUGF0aCAkRU5WOlRFTVAgIlxIaXN0b3J5IiAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAkSGlzdG9yaWVzID0gJFNxbHlRdWVyeSB8ICYgJHNxbGl0ZTMgJHRlbXBIaXN0b3J5REIgMj4mMQogICAgICAgICAgICAgICAgICBpZiAoJExBU1RFWElUQ09ERSAtbmUgMCkgewogICAgICAgICAgICAgICAgICAgICAgJEVycm9ycyArPSAgIkZhaWxlZCB0byByZXRyaWV2ZSBoaXN0b3J5IGZvciB1c2VyIDogJHVzZXIiCiAgICAgICAgICAgICAgICAgICAgICAkSGlzdG9yaWVzID0gJG51bGwKICAgICAgICAgICAgICAgICAgfWVsc2V7ICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRIaXN0b3JpZXMgLW5lICRudWxsICkgewogICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JlYWNoICggJERhdGEgaW4gJEhpc3RvcmllcyApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkdXJpID0gW3VyaV0oJERhdGEgLXNwbGl0ICJcfCIpWzJdICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkb2JqICA9IE5ldy1PYmplY3QgUFNPYmplY3QgLVByb3BlcnR5IEB7IAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlVzZXIgTmFtZSIgPSAkdXNlcgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIkRhdGUiID0gKCREYXRhIC1zcGxpdCAiXHwiKVswXQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlNpdGUgTmFtZSIgPSAkdXJpLlNjaGVtZSArICI6Ly8iICsgJHVyaS5Ib3N0CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkUmVzdWx0ICs9ICRvYmogICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICB9IEVsc2UgeyAkRXJyb3JzICs9ICJIaXN0cm95IG5vdCBmb3VuZCBmb3IgdXNlciA6ICR1c2VyIiB9CiAgICAgICAgCiAgICAgICAgICAgICAgICAgIFJlbW92ZS1JdGVtICR0ZW1wSGlzdG9yeURCIC1FcnJvckFjdGlvbiBTaWxlbnRseUNvbnRpbnVlICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgfSAgICAgICAgICAgIAogICAgICAgICAgICB9IGNhdGNoIHsKICAgICAgICAgICAgICAgICAkRXJyb3JzICs9ICJGYWlsZWQgdG8gcmV0cmlldmUgaGlzdG9yeSBmb3IgdXNlciA6ICR1c2VyIgogICAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgIH1lbHNlIHsKICAgICAgICAgICAgICAgJEVycm9ycyArPSAgIkhpc3Ryb3kgbm90IGZvdW5kIGZvciB1c2VyIDogJHVzZXIiICAgICAgICAgICAgIAogICAgICAgICAgIH0gICAgICAgICAgICAgCiB9ICAgICAgICAgICAKJFJlc3VsdCB8IHNlbGVjdCAiVXNlciBOYW1lIiAsIkRhdGUiLCAiU2l0ZSBOYW1lIiB8IGZ0IC1BdXRvU2l6ZQokRXJyb3JzCg==","jsonSchema":{"type":"object","properties":{"users":{"type":"string","title":"Retrive Chrome History","enum":["allusers","selectedusers"],"enumNames":["All Users","Enter user names"]},"days":{"title":"Retrive last(in days)","type":"number","maximum":90}},"required":["users"],"additionalproperties":false,"patternproperties":{"^usernames$":{}},"dependencies":{"users":{"oneOf":[{"properties":{"users":{"enum":["allusers"]}}},{"properties":{"users":{"enum":["selectedusers"]},"usernames":{"title":"User names","type":"string"}},"required":["usernames"]}]}}},"uiSchema":{"users":{"classNames":"col-sm-6 col-sm-offset-right-6","ui:autofocus":true,"ui:widget":"radio","ui:options":{"inline":true}},"usernames":{"classNames":"col-sm-8 col-sm-offset-right-4","ui:autofocus":true,"ui:help":"For multuple users seperate by (,)"},"days":{"classNames":"col-sm-3","ui:autofocus":true},"ui:order":["users","usernames","days"]},"isHDScript":false}
