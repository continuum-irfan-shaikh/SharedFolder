{"id":"d404b160-464a-11e9-8198-00155d130b01","partnerId":"00000000-0000-0000-0000-000000000000","category":["Data Collection"],"description":"Retrieves list of users in the Remote Desktop User group","engine":"powershell","engineMaxVersion":5,"expectedExecutionTimeSec":300,"failureMessage":"Executed with errors","successMessage":"Excecution success","internal":false,"name":"Retrieve RDP Users group on workstations","tags":["Windows 7","Windows 10"],"sequence":true,"content":"JE5hbWUgPSAnUmVtb3RlIERlc2t0b3AgVXNlcnMnCgpGdW5jdGlvbiBHZXQtTG9jYWxHcm91cE1lbWJlcnMgKCROYW1lKSB7CiAgICB0cnkgewogICAgICAgICRzZXJ2ZXIgPSAkZW52OkNPTVBVVEVSTkFNRQogICAgICAgICMgZmluZCB0aGUgZ3JvdXAgbWVtYmVyc2hpcAogICAgICAgICRHcm91cCA9IFtBRFNJXSJXaW5OVDovLyRTZXJ2ZXIvJE5hbWUsZ3JvdXAiCiAgICAgICAgJE1lbWJlcnMgPSBGb3JlYWNoICgkSXRlbSBpbiAkR3JvdXAucHNiYXNlLkludm9rZSgiTWVtYmVycyIpKSB7CiAgICAgICAgICAgICRQcm9wZXJ0eSA9IHskSXRlbS5HZXRUeXBlKCkuSW52b2tlTWVtYmVyKCRhcmdzWzBdLCAnR2V0UHJvcGVydHknLCAkbnVsbCwgJEl0ZW0sICRudWxsKX0KICAgICAgICAgICAgKCRQcm9wZXJ0eS5pbnZva2UoJ0FEU1BhdGgnKSAtc3BsaXQgIi8iKVsyXSArICdcJyArICRQcm9wZXJ0eS5pbnZva2UoJ05hbWUnKSAgICAgICAgICAgIAogICAgICAgIH0KICAgICAgICAKICAgICAgICBJZiAoJE1lbWJlcnMpIHsKICAgICAgICAgICAgIyBpZiBhIGdyb3VwIGhhcyBtZW1iZXJzIHRoZW4gZGlzcGxheSBvbiB0aGUgY29uc29sZQogICAgICAgICAgICBXcml0ZS1PdXRwdXQgIlNlcnZlcjogJFNlcnZlcmBuIgogICAgICAgICAgICBXcml0ZS1PdXRwdXQgIkxpc3QgVXNlcnMgaW4gJ1JlbW90ZSBEZXNrdG9wIFVzZXJzJyBHcm91cDoiCiAgICAgICAgICAgIFdyaXRlLU91dHB1dCAkTWVtYmVycwogICAgICAgIH0KICAgICAgICAjIGVsc2UgeyAjIE5PVEU6IFRoaXMgc2VjdGlvbiBpcyBjb21tZW50ZWQgb3V0LCB3aGljaCBnZXRzIGV4ZWN1dGVkIHdoZW4gbm8gbWVtYmVyIGZvdW5kIGluIHRoZSBncm91cC4gSW5jYXNlIHdlIHdhbnQgdG8gbG9nIHRoZSBpbmZvcm1hdGlvbiBpbiBhIENTViBmaWxlLgogICAgICAgICMgICAgICRPdXRwdXRGaWxlID0gIiRlbnY6VEVNUFxOb01lbWJlci5jc3YiCiAgICAgICAgIyAgICAgIyBpZiBncm91cCBkb2Vzbid0IGhhdmUgYW55IG1lbWJlcnMgd3JpdGVcYXBwZW5kIHRvIGEgZmlsZQogICAgICAgICMgICAgICRvYmogPSBOZXctT2JqZWN0IC1UeXBlTmFtZSAgUFNPYmplY3QgLVByb3BlcnR5IEB7U2VydmVyID0gJFNlcnZlcjsgQ29tbWVudCA9ICJObyBNZW1iZXIgZm91bmQgaW4gYCckTmFtZWAnIEdyb3VwIG9uIHRoaXMgc2VydmVyIn0KICAgICAgICAjICAgICBpZiAoVGVzdC1QYXRoICRPdXRwdXRGaWxlKSB7CiAgICAgICAgIyAgICAgICAgICMgaWYgZmlsZSBhbHJlYWR5IGV4aXN0IHRoZW4gJ0FwcGVuZCcgdG8gdGhlIGZpbGUKICAgICAgICAjICAgICAgICAgJG9iaiB8IENvbnZlcnRUby1Dc3YgLU5vVHlwZUluZm9ybWF0aW9uIHxTZWxlY3QtT2JqZWN0IC1Ta2lwIDEgfCBPdXQtRmlsZSAkT3V0cHV0RmlsZSAtQXBwZW5kIC1FbmNvZGluZyBBU0NJSSAgICAKICAgICAgICAjICAgICB9CiAgICAgICAgIyAgICAgZWxzZSB7CiAgICAgICAgIyAgICAgICAgICMgaWYgZmlsZSBkb2Vzbid0IGV4aXN0ICdXcml0ZScgdG8gYSBuZXcgZmlsZQogICAgICAgICMgICAgICAgICAkb2JqIHwgRXhwb3J0LUNzdiAkT3V0cHV0RmlsZSAtTm9UeXBlSW5mb3JtYXRpb24KICAgICAgICAjICAgICB9CiAgICAgICAgIyB9IAogICAgfQogICAgY2F0Y2ggewogICAgICAgIFdyaXRlLUVycm9yICJTZXJ2ZXI6IGAiJGVudjpDT01QVVRFUk5BTUVgIiAtICQoJF8uRXhjZXB0aW9uLk1lc3NhZ2UpIiAtRXJyb3JBY3Rpb24gU3RvcAogICAgfQp9CgpHZXQtTG9jYWxHcm91cE1lbWJlcnMgJE5hbWUK","jsonSchema":"","uiSchema":"","isHDScript":false}