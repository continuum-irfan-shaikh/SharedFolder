{"id":"067d8809-3085-11ea-9ee5-00155d130b01","partnerId":"00000000-0000-0000-0000-000000000000","category":["Setup"],"description":"Create and configure a new local user account","engine":"powershell","engineMaxVersion":5,"expectedExecutionTimeSec":300,"failureMessage":"Executed with errors","successMessage":"Executed successfully","internal":false,"name":"Add Local User (new)","tags":["Windows 7","Windows 10"],"sequence":true,"content":"PCMKICAgIEFjdGlvbnMKICAgICAgICBBZGROZXdVc2VyCiAgICAgICAgQ2hhbmdlUGFzc3dvcmQKICAgICAgICBSZW1vdmVVc2VyCiAgICAgICAgTW9kaWZ5VXNlcgojPgoKCjwjCkRhdGUgOiAgMTMvMDEvMjAyMApWZXJzaW9uIDogMS4wCgokYWN0aW9uID0gIkFkZE5ld1VzZXIiCiR1c2VybmFtZSA9ICJuaXJhdjIiCiRmdWxsbmFtZSA9ICJOaXJhdiBTYWNob3JhIHVwZGF0ZWQiCiRkZXNjcmlwdGlvbiA9ICJ0aGlzIGlzIG15IHVwZGF0ZWQgYWNjb3VudCIKJHBhc3N3b3JkID0gInBhc3NAMTIzIgokdXNlcm11c3RjaGFuZ2VwYXNzd29yZGF0bmV4dGxvZ29uID0gJ1llcycKJHVzZXJjYW5ub3RjaGFuZ2VwYXNzd29yZCA9ICdZZXMnCiRwYXNzd29yZG5ldmVyZXhwaXJlcyA9ICdZZXMnCiRhZGR0aGV1c2VydG90aGVzZWdyb3VwcyA9ICJncm91cDEsZ3JvdXAyLGdyb3VwMyIKJHJlbW92ZXRoZXVzZXJmcm9tdGhlc2Vncm91cHMgPSAiZ3JvdXAxLGdyb3VwMixncm91cDMiCiRBY2NvdW50SXNEaXNhYmxlZCA9ICdObycKJHByb2ZpbGVwYXRoID0gJ0M6XFVTZXJzXG5pcmF2JwokbG9nb25zY3JpcHQgPSAnQzpccHJvZmlsZXMnCiRob21lZm9sZGVyID0gQ29uZWN0L0xvY2FsCiRkcml2ZWxldHRlcgokcGF0aAokSGlkZUFjY291bnRPblRoZVdlbGNvbWVTY3JlZW4gPSAkdHJ1ZQokT3ZlcndyaXRlSWZUaGVVc2VyQWxyZWFkeUV4aXN0cyA9ICR0cnVlCiM+CiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyNQcmVwYXJpbmcgaW5wdXRzIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwoKIyMjIyMjIyMjIyMjIyMjT1MgSU5GTyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCgppZiAoJGVudjpQUk9DRVNTT1JfQVJDSElURVc2NDMyIC1lcSAiQU1ENjQiKSB7CiAgICBpZiAoJG15SW52b2NhdGlvbi5MaW5lKSB7CiAgICAgICAgJiIkZW52OnN5c3RlbXJvb3Rcc3lzbmF0aXZlXHdpbmRvd3Nwb3dlcnNoZWxsXHYxLjBccG93ZXJzaGVsbC5leGUiIC1Ob25JbnRlcmFjdGl2ZSAtTm9Qcm9maWxlICRteUludm9jYXRpb24uTGluZQogICAgfQogICAgZWxzZSB7CiAgICAgICAgJiIkZW52OnN5c3RlbXJvb3Rcc3lzbmF0aXZlXHdpbmRvd3Nwb3dlcnNoZWxsXHYxLjBccG93ZXJzaGVsbC5leGUiIC1Ob25JbnRlcmFjdGl2ZSAtTm9Qcm9maWxlIC1maWxlICIkKCRteUludm9jYXRpb24uSW52b2NhdGlvbk5hbWUpIiAkYXJncwogICAgfQogICAgZXhpdCAkbGFzdGV4aXRjb2RlCn0KCiRPU0luZm8gPSAoR2V0LVdtaU9iamVjdCAtQ2xhc3MgV2luMzJfT3BlcmF0aW5nc3lzdGVtKS5Qcm9kdWN0VHlwZQoKaWYgKCRPU0luZm8gLWVxICRudWxsKSB7CgogICAgIltFUlJPUl06RmFpbGVkIHRvIGNoZWNrIFN5c3RlbSB0eXBlLCBzY3JpcHQgd2lsbCBub3cgZXhpdCIKICAgIEV4aXQKCn0KZWxzZWlmICgkT1NJbmZvIC1lcSAyKSB7CgogICAgIltNU0ddOlNjcmlwdCBjYW5ub3QgYmUgcnVuIGF0IERvbWFpbiBDb250cm9sbGVyIgogICAgRXhpdAoKfQoKCmlmICgkYWRkdGhldXNlcnRvdGhlc2Vncm91cHMpIHsKICAgICRhZGR0aGV1c2VydG90aGVzZWdyb3VwcyA9ICRhZGR0aGV1c2VydG90aGVzZWdyb3VwcyAtc3BsaXQgIiwiCiAgICAkZ3JsaXN0ID0gQCgpCiAgICAkZXJyb3JhY3Rpb25wcmVmZXJlbmNlID0gIlNpbGVudGx5Q29udGludWUiCiAgICBmb3JlYWNoICgkZ3JvdXAgaW4gJGFkZHRoZXVzZXJ0b3RoZXNlZ3JvdXBzKSB7CiAgICAgICAgJGV4aXN0ID0gTmV0IExvY2FsZ3JvdXAgJGdyb3VwIDI+JjEKICAgICAgICBpZiAoJGV4aXN0KSB7ICRncmxpc3QgKz0gJGdyb3VwIH1lbHNlIHsgIiRncm91cCBkb2VzIG5vdCBleGlzdCI7IENvbnRpbnVlOyB9CiAgICB9CiAgICAkYWRkdGhldXNlcnRvdGhlc2Vncm91cHMgPSAkZ3JsaXN0Cn0KaWYgKCRyZW1vdmV0aGV1c2VyZnJvbXRoZXNlZ3JvdXBzKSB7CiAgICAkcmVtb3ZldGhldXNlcmZyb210aGVzZWdyb3VwcyA9ICRyZW1vdmV0aGV1c2VyZnJvbXRoZXNlZ3JvdXBzIC1zcGxpdCAiLCIKICAgICRncmxpc3QgPSBAKCkKICAgIGZvcmVhY2ggKCRncm91cCBpbiAkcmVtb3ZldGhldXNlcmZyb210aGVzZWdyb3VwcykgewogICAgICAgICRleGlzdCA9IE5ldCBMb2NhbGdyb3VwICRncm91cCAyPiYxCiAgICAgICAgaWYgKCRleGlzdCkgeyAkZ3JsaXN0ICs9ICRncm91cCB9ZWxzZSB7ICIkZ3JvdXAgZG9lcyBub3QgZXhpc3QiOyBDb250aW51ZTsgfQogICAgfQogICAgJHJlbW92ZXRoZXVzZXJmcm9tdGhlc2Vncm91cHMgPSAkZ3JsaXN0Cn0KJGVycm9yYWN0aW9ucHJlZmVyZW5jZSA9ICJDb250aW51ZSIKCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKCmZ1bmN0aW9uIGNoYW5nZV9wYXNzd29yZCB7CgogICAgJEVycm9yQWN0aW9ucHJlZmVyZW5jZSA9ICJTaWxlbnRseUNvbnRpbnVlIgogICAgJGNoZWNrX2V4aXN0ID0gbmV0IHVzZXIgJHVzZXJuYW1lIDI+JjEKICAgIGlmICgkY2hlY2tfZXhpc3QpIHsKCiAgICAgICAgbmV0IHVzZXIgJHVzZXJuYW1lICRwYXNzd29yZCAyPiYxIHwgb3V0LW51bGwKICAgIH0KICAgIGVsc2UgewogICAgICAgICJbRVJST1JdOlVzZXIgaXMgbm90IHByZXNlbnQgaW4gdGhlIHN5c3RlbS4iCiAgICAgICAgRXhpdDsKICAgIH0KCiAgICBpZiAoJD8pIHsKICAgICAgICAiLSIqMzArImBuW01TR106UGFzc3dvcmQgdXBkYXRlZCBzdWNjZXNzZnVsbHkuYG4iKyItIiozMAoKICAgIH0KICAgIGVsc2UgewogICAgICAgICItIiozMCsiYG5bRVJST1JdOkZhaWxlZCB0byB1cGRhdGUgcGFzc3dvcmQuYG4iKyItIiozMAogICAgfQp9CgpmdW5jdGlvbiBjb21tb25fZnVuY3Rpb24gewogICAgaWYgKCRkZXNjcmlwdGlvbikgewogICAgICAgIG5ldCB1c2VyICR1c2VybmFtZSAvY29tbWVudDokZGVzY3JpcHRpb24gMj4mMSB8IG91dC1udWxsCiAgICAgICAgaWYgKCQ/KSB7ICR0cmFja2VyLkFkZCgiRGVzY3JpcHRpb24iLCAiU1VDQ0VTUyIpIH1lbHNlIHsgJHRyYWNrZXIuQWRkKCJEZXNjcmlwdGlvbiIsICJGQUlMRUQiKSB9CiAgICB9CiAgICBpZigkYWN0aW9uIC1lcSAiTW9kaWZ5dXNlciIgLWFuZCAoJHBhc3N3b3JkKSl7CiAgICAgICAgY2hhbmdlX3Bhc3N3b3JkICAgIAogICAgfQogICAgaWYgKCR1c2VybXVzdGNoYW5nZXBhc3N3b3JkYXRuZXh0bG9nb24gLW5lICdZZXMnKSB7CiAgICAgICAgaWYgKCR1c2VyY2Fubm90Y2hhbmdlcGFzc3dvcmQgLWVxICdZZXMnKSB7CiAgICAgICAgICAgIG5ldCB1c2VyICR1c2VybmFtZSAvcGFzc3dvcmRjaGc6bm8gMj4mMSB8IG91dC1udWxsCiAgICAgICAgICAgIGlmICgkPykgeyAkdHJhY2tlci5BZGQoIlBhc3N3b3JkIGNoYW5nZSBwZXJtaXNzaW9uIiwgIlNVQ0NFU1MiKSB9ZWxzZSB7ICR0cmFja2VyLkFkZCgiUGFzc3dvcmQgY2hhbmdlIHBlcm1pc3Npb24iLCAiRkFJTEVEIikgfQogICAgICAgIH0KICAgICAgICBlbHNlaWYgKCgkdXNlcmNhbm5vdGNoYW5nZXBhc3N3b3JkIC1lcSAnTm8nKSAtYW5kICgoJGFjdGlvbiAtZXEgIk1vZGlmeVVzZXIiKSAtb3IgKCRPdmVyd3JpdGVJZlRoZVVzZXJBbHJlYWR5RXhpc3RzIC1lcSAkdHJ1ZSkpKSB7CiAgICAgICAgICAgIG5ldCB1c2VyICR1c2VybmFtZSAvcGFzc3dvcmRjaGc6eWVzIDI+JjEgfCBvdXQtbnVsbAogICAgICAgICAgICBpZiAoJD8pIHsgJHRyYWNrZXIuQWRkKCJQYXNzd29yZCBjaGFuZ2UgcGVybWlzc2lvbiIsICJTVUNDRVNTIikgfWVsc2UgeyAkdHJhY2tlci5BZGQoIlBhc3N3b3JkIGNoYW5nZSBwZXJtaXNzaW9uIiwgIkZBSUxFRCIpIH0KICAgICAgICB9CiAgICAgICAgaWYgKCRwYXNzd29yZG5ldmVyZXhwaXJlcyAtZXEgJ1llcycpIHsKICAgICAgICAgICAgJHVzZXJkZXRhaWxzID0gbmV0IHVzZXIgJHVzZXJuYW1lIDI+JjEKICAgICAgICAgICAgaWYgKCR1c2VyZGV0YWlsc1s5XSAtbGlrZSAnKm5ldmVyKicpIHsgJHRyYWNrZXIuQWRkKCJQYXNzd29yZCBuZXZlciBleHBpcmUiLCAiU1VDQ0VTUyIpIH0KICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAkdXNlciA9IFthZHNpXSJXaW5OVDovLyRlbnY6Y29tcHV0ZXJuYW1lLyR1c2VybmFtZSIKICAgICAgICAgICAgICAgICR1c2VyLlVzZXJGbGFncy52YWx1ZSA9ICR1c2VyLlVzZXJGbGFncy52YWx1ZSAtYm9yIDB4MTAwMDAKICAgICAgICAgICAgICAgICR1c2VyLkNvbW1pdENoYW5nZXMoKQogICAgICAgICAgICAgICAgaWYgKCQ/KSB7ICR0cmFja2VyLkFkZCgiUGFzc3dvcmQgbmV2ZXIgZXhwaXJlIiwgIlNVQ0NFU1MiKSB9ZWxzZSB7ICR0cmFja2VyLkFkZCgiUGFzc3dvcmQgbmV2ZXIgZXhwaXJlIiwgIkZBSUxFRCIpIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBlbHNlaWYgKCgkcGFzc3dvcmRuZXZlcmV4cGlyZXMgLWVxICdObycpIC1hbmQgKCgkYWN0aW9uIC1lcSAiTW9kaWZ5VXNlciIpIC1vciAoJE92ZXJ3cml0ZUlmVGhlVXNlckFscmVhZHlFeGlzdHMgLWVxICR0cnVlKSkpIHsKICAgICAgICAgICAgJHVzZXJkZXRhaWxzID0gbmV0IHVzZXIgJHVzZXJuYW1lIDI+JjEKICAgICAgICAgICAgaWYgKCR1c2VyZGV0YWlsc1s5XSAtbGlrZSAnKm5ldmVyKicpIHsKICAgICAgICAgICAgICAgICR1c2VyID0gW2Fkc2ldIldpbk5UOi8vJGVudjpjb21wdXRlcm5hbWUvJHVzZXJuYW1lIgogICAgICAgICAgICAgICAgJEFEU19VRl9ET05UX0VYUElSRV9QQVNTV0QgPSAweDAwMDEwMDAwCiAgICAgICAgICAgICAgICAkYWRzaSA9IFtBRFNJXSJXaW5OVDovLyRlbnY6Q09NUFVURVJOQU1FIgogICAgICAgICAgICAgICAgJHVzZXIuVXNlckZsYWdzID0gJHVzZXIuVXNlckZsYWdzLlZhbHVlIC1ieG9yICRBRFNfVUZfRE9OVF9FWFBJUkVfUEFTU1dECiAgICAgICAgICAgICAgICAkdXNlci5TZXRJbmZvKCkKICAgICAgICAgICAgICAgIGlmICgkPykgeyAkdHJhY2tlci5BZGQoIlBhc3N3b3JkIG5ldmVyIGV4cGlyZSIsICJTVUNDRVNTIikgfWVsc2UgeyAkdHJhY2tlci5BZGQoIlBhc3N3b3JkIG5ldmVyIGV4cGlyZSIsICJGQUlMRUQiKSB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAkdHJhY2tlci5BZGQoIlBhc3N3b3JkIG5ldmVyIGV4cGlyZSIsICJTVUNDRVNTIikKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KICAgIGlmICgkdXNlcm11c3RjaGFuZ2VwYXNzd29yZGF0bmV4dGxvZ29uIC1lcSAnWWVzJykgewogICAgICAgIG5ldCB1c2VyICR1c2VybmFtZSAvcGFzc3dvcmRjaGc6IlllcyIgMj4mMSB8IG91dC1udWxsCiAgICAgICAgJGFjYyA9IEdldC1XbWlPYmplY3Qgd2luMzJfVVNFUkFDQ09VTlQgfCA/IHsgJF8uTkFNRSAtZXEgJHVzZXJuYW1lIH0KICAgICAgICAkYWNjLlBhc3N3b3JkRXhwaXJlcyA9ICRUcnVlCiAgICAgICAgJGFjYy5QdXQoKSB8IG91dC1udWxsCiAgICAgICAgCiAgICAgICAgJHN0ciA9ICRlbnY6Q09NUFVURVJOQU1FCiAgICAgICAgJHVzZXIgPSBbQURTSV0iV2luTlQ6Ly8kc3RyLyR1c2VybmFtZSx1c2VyIgogICAgICAgICR1c2VyLlB1dCgiUGFzc3dvcmRFeHBpcmVkIiwgMSkKICAgICAgICAkdXNlci5TZXRJbmZvKCkKICAgICAgICBpZiAoJD8pIHsgJHRyYWNrZXIuQWRkKCJVc2VyIG11c3QgY2hhbmdlIHBhc3N3b3JkIGF0IG5leHQgbG9nb24iLCAiU1VDQ0VTUyIpIH1lbHNlIHsgJHRyYWNrZXIuQWRkKCJVc2VyIG11c3QgY2hhbmdlIHBhc3N3b3JkIGF0IG5leHQgbG9nb24iLCAiRkFJTEVEIikgfQogICAgfQogICAgZWxzZWlmICgoJHVzZXJtdXN0Y2hhbmdlcGFzc3dvcmRhdG5leHRsb2dvbiAtZXEgJ05vJykgLWFuZCAoKCRhY3Rpb24gLWVxICJNb2RpZnlVc2VyIikgLW9yICgkT3ZlcndyaXRlSWZUaGVVc2VyQWxyZWFkeUV4aXN0cyAtZXEgJHRydWUpKSkgewogICAgICAgICRhY2MgPSBHZXQtV21pT2JqZWN0IHdpbjMyX1VTRVJBQ0NPVU5UIHwgPyB7ICRfLk5BTUUgLWVxICR1c2VybmFtZSB9CiAgICAgICAgJHN0ciA9ICRlbnY6Q09NUFVURVJOQU1FCiAgICAgICAgJHVzZXIgPSBbQURTSV0iV2luTlQ6Ly8kc3RyLyR1c2VybmFtZSx1c2VyIgogICAgICAgICR1c2VyLlB1dCgiUGFzc3dvcmRFeHBpcmVkIiwgMCkKICAgICAgICAkdXNlci5TZXRJbmZvKCkKICAgICAgICBpZiAoJD8pIHsgJHRyYWNrZXIuQWRkKCJVc2VyIG11c3QgY2hhbmdlIHBhc3N3b3JkIGF0IG5leHQgbG9nb24iLCAiU1VDQ0VTUyIpIH1lbHNlIHsgJHRyYWNrZXIuQWRkKCJVc2VyIG11c3QgY2hhbmdlIHBhc3N3b3JkIGF0IG5leHQgbG9nb24iLCAiRkFJTEVEIikgfQogICAgfQogICAgaWYgKCRhY3Rpb24gLWVxICJNb2RpZnlVc2VyIikgewogICAgICAgIGlmICgkQWNjb3VudElzRGlzYWJsZWQgLWVxICdObycpIHsKICAgICAgICAgICAgbmV0IHVzZXIgJHVzZXJuYW1lIC9hY3RpdmU6eWVzIDI+JjEgfCBvdXQtbnVsbAogICAgICAgICAgICBpZiAoJD8pIHsgJHRyYWNrZXIuQWRkKCJFbmFibGVkIiwgIlNVQ0NFU1MiKSB9ZWxzZSB7ICR0cmFja2VyLkFkZCgiRW5hYmxlZCIsICJGQUlMRUQiKSB9CiAgICAgICAgfQogICAgfQogICAgaWYgKCRBY2NvdW50SXNEaXNhYmxlZCAtZXEgJ1llcycpIHsKICAgICAgICBuZXQgdXNlciAkdXNlcm5hbWUgL2FjdGl2ZTpubyAyPiYxIHwgb3V0LW51bGwKICAgICAgICBpZiAoJD8pIHsgJHRyYWNrZXIuQWRkKCJEaXNhYmxlZCIsICJTVUNDRVNTIikgfWVsc2UgeyAkdHJhY2tlci5BZGQoIkRpc2FibGVkIiwgIkZBSUxFRCIpIH0KICAgIH0KICAgIGlmICgkcHJvZmlsZXBhdGgpIHsKICAgICAgICBuZXQgdXNlciAkdXNlcm5hbWUgL3Byb2ZpbGVwYXRoOiRwcm9maWxlcGF0aCAyPiYxIHwgb3V0LW51bGwKICAgICAgICBpZiAoJD8pIHsgJHRyYWNrZXIuQWRkKCJQcm9maWxlIFBhdGgiLCAiU1VDQ0VTUyIpIH1lbHNlIHsgJHRyYWNrZXIuQWRkKCJQcm9maWxlIFBhdGgiLCAiRkFJTEVEIikgfQogICAgfQogICAgaWYgKCRsb2dvbnNjcmlwdCkgewogICAgICAgIG5ldCB1c2VyICR1c2VybmFtZSAvc2NyaXB0cGF0aDokbG9nb25zY3JpcHQgMj4mMSB8IG91dC1udWxsCiAgICAgICAgaWYgKCQ/KSB7ICR0cmFja2VyLkFkZCgiTG9nb24gU2NyaXB0IiwgIlNVQ0NFU1MiKSB9ZWxzZSB7ICR0cmFja2VyLkFkZCgiTG9nb24gU2NyaXB0IiwgIkZBSUxFRC1JbnZhbGlkIGxvZ29uIHBhdGgiKSB9CiAgICB9CiAgICBpZiAoJHBhdGgpIHsKICAgICAgICBpZiAoISRkcml2ZWxldHRlciAtYW5kICRob21lZm9sZGVyIC1lcSAiTG9jYWwiKSB7CiAgICAgICAgICAgIG5ldCB1c2VyICR1c2VybmFtZSAvaG9tZWRpcjokcGF0aCAyPiYxIHwgb3V0LW51bGwKICAgICAgICAgICAgaWYgKCQ/KSB7ICR0cmFja2VyLkFkZCgiTG9nb24gUGF0aCIsICJTVUNDRVNTIikgfWVsc2UgeyAkdHJhY2tlci5BZGQoIkxvZ29uIFBhdGgiLCAiRkFJTEVEIikgfQogICAgICAgIH0KICAgICAgICBlbHNlIHsKICAgICAgICAgICAgaWYgKCEkZHJpdmVsZXR0ZXIpIHsKICAgICAgICAgICAgICAgICJQbGVhc2UgcHJvdmlkZSBkcml2ZSBsZXR0ZXIiCiAgICAgICAgICAgICAgICBFeGl0OwogICAgICAgICAgICB9CiAgICAgICAgICAgIG5ldCB1c2VyICR1c2VybmFtZSAvaG9tZWRpciAkZHJpdmVsZXR0ZXIgOiRwYXRoIDI+JjEgfCBvdXQtbnVsbAogICAgICAgICAgICBpZiAoJD8pIHsgJHRyYWNrZXIuQWRkKCJMb2dvbiBQYXRoIiwgIlNVQ0NFU1MiKSB9ZWxzZSB7ICR0cmFja2VyLkFkZCgiTG9nb24gUGF0aCIsICJGQUlMRUQiKSB9CiAgICAgICAgfQogICAgfQogICAgaWYgKCRhZGR0aGV1c2VydG90aGVzZWdyb3VwcykgewogICAgICAgICR1c2VyYWRkaXRpb24gPSBAeyB9CiAgICAgICAgZm9yZWFjaCAoJGkgaW4gJGFkZHRoZXVzZXJ0b3RoZXNlZ3JvdXBzKSB7CiAgICAgICAgICAgIG5ldCBsb2NhbGdyb3VwICRpICR1c2VybmFtZSAvYWRkICAyPiYxIHwgb3V0LW51bGwKICAgICAgICAgICAgaWYgKCQ/KSB7ICR1c2VyYWRkaXRpb24uQWRkKCIkaSIsICJBZGRlZCIpIH1lbHNlIHsgJHVzZXJhZGRpdGlvbi5BZGQoIiRpIiwgIkZhaWxlZCB0byBhZGQiKSB9CiAgICAgICAgfQogICAgICAgICR1c2VyYWRkaXRpb24uR2V0RW51bWVyYXRvcigpIHwgRm9yZWFjaC1vYmplY3QgewogICAgICAgICAgICBXcml0ZS1vdXRwdXQgIkFkZGluZyB1c2VyIHRvICQoJF8ua2V5KSIKICAgICAgICAgICAgV3JpdGUtb3V0cHV0ICIkKCRfLnZhbHVlKSIKICAgICAgICAgICAgIi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIgogICAgICAgIH0KICAgIH0KICAgIGlmICgkcmVtb3ZldGhldXNlcmZyb210aGVzZWdyb3VwcykgewogICAgICAgICR1c2VyZGVsZXRpb24gPSBAeyB9CiAgICAgICAgZm9yZWFjaCAoJGkgaW4gJHJlbW92ZXRoZXVzZXJmcm9tdGhlc2Vncm91cHMpIHsKICAgICAgICAgICAgbmV0IGxvY2FsZ3JvdXAgJGkgJHVzZXJuYW1lIC9kZWxldGUgMj4mMSB8IG91dC1udWxsCiAgICAgICAgICAgIGlmICgkPykgeyAkdXNlcmRlbGV0aW9uLkFkZCgiJGkiLCAiUmVtb3ZlZCIpIH1lbHNlIHsgJHVzZXJkZWxldGlvbi5BZGQoIiRpIiwgIkZhaWxlZCB0byByZW1vdmUiKSB9CiAgICAgICAgfQogICAgICAgICR1c2VyZGVsZXRpb24uR2V0RW51bWVyYXRvcigpIHwgRm9yZWFjaC1vYmplY3QgewogICAgICAgICAgICBXcml0ZS1vdXRwdXQgIlJlbW92aW5nIHVzZXIgZnJvbSAkKCRfLmtleSkiCiAgICAgICAgICAgIFdyaXRlLW91dHB1dCAiJCgkXy52YWx1ZSkiCiAgICAgICAgICAgICItLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSIKICAgICAgICB9CiAgICB9CiAgICBpZiAoJEhpZGVBY2NvdW50T25UaGVXZWxjb21lU2NyZWVuKSB7CiAgICAgICAgaWYgKCEoVGVzdC1QYXRoICJSZWdpc3RyeTo6SEtFWV9MT0NBTF9NQUNISU5FXFNPRlRXQVJFXE1pY3Jvc29mdFxXaW5kb3dzIE5UXEN1cnJlbnRWZXJzaW9uXFdpbmxvZ29uXFNwZWNpYWxBY2NvdW50cyIpKSB7CiAgICAgICAgICAgIE5ldy1JdGVtIC1QYXRoICJSZWdpc3RyeTo6SEtFWV9MT0NBTF9NQUNISU5FXFNPRlRXQVJFXE1pY3Jvc29mdFxXaW5kb3dzIE5UXEN1cnJlbnRWZXJzaW9uXFdpbmxvZ29uIiAtTmFtZSAiU3BlY2lhbEFjY291bnRzIiB8IG91dC1udWxsCiAgICAgICAgICAgIE5ldy1JdGVtIC1QYXRoICJSZWdpc3RyeTo6SEtFWV9MT0NBTF9NQUNISU5FXFNPRlRXQVJFXE1pY3Jvc29mdFxXaW5kb3dzIE5UXEN1cnJlbnRWZXJzaW9uXFdpbmxvZ29uXFNwZWNpYWxBY2NvdW50cyIgLU5hbWUgIlVzZXJMaXN0IiB8IG91dC1udWxsCiAgICAgICAgICAgIE5ldy1JdGVtUHJvcGVydHkgLVBhdGggIlJlZ2lzdHJ5OjpIS0VZX0xPQ0FMX01BQ0hJTkVcU09GVFdBUkVcTWljcm9zb2Z0XFdpbmRvd3MgTlRcQ3VycmVudFZlcnNpb25cV2lubG9nb25cU3BlY2lhbEFjY291bnRzXFVzZXJMaXN0IiAtTmFtZSAkdXNlcm5hbWUgLVByb3BlcnR5VHlwZSAiRHdvcmQiIHwgb3V0LW51bGwKICAgICAgICB9CiAgICAgICAgZWxzZWlmIChUZXN0LVBhdGggIlJlZ2lzdHJ5OjpIS0VZX0xPQ0FMX01BQ0hJTkVcU09GVFdBUkVcTWljcm9zb2Z0XFdpbmRvd3MgTlRcQ3VycmVudFZlcnNpb25cV2lubG9nb25cU3BlY2lhbEFjY291bnRzIikgewogICAgICAgICAgICBpZiAoIShUZXN0LXBhdGggIlJlZ2lzdHJ5OjpIS0VZX0xPQ0FMX01BQ0hJTkVcU09GVFdBUkVcTWljcm9zb2Z0XFdpbmRvd3MgTlRcQ3VycmVudFZlcnNpb25cV2lubG9nb25cU3BlY2lhbEFjY291bnRzXFVzZXJMaXN0IikpIHsKICAgICAgICAgICAgICAgIE5ldy1JdGVtIC1QYXRoICJSZWdpc3RyeTo6SEtFWV9MT0NBTF9NQUNISU5FXFNPRlRXQVJFXE1pY3Jvc29mdFxXaW5kb3dzIE5UXEN1cnJlbnRWZXJzaW9uXFdpbmxvZ29uXFNwZWNpYWxBY2NvdW50cyIgLU5hbWUgIlVzZXJMaXN0IiB8IG91dC1udWxsCiAgICAgICAgICAgICAgICBOZXctSXRlbVByb3BlcnR5IC1QYXRoICJSZWdpc3RyeTo6SEtFWV9MT0NBTF9NQUNISU5FXFNPRlRXQVJFXE1pY3Jvc29mdFxXaW5kb3dzIE5UXEN1cnJlbnRWZXJzaW9uXFdpbmxvZ29uXFNwZWNpYWxBY2NvdW50c1xVc2VyTGlzdCIgLU5hbWUgJHVzZXJuYW1lIC1Qcm9wZXJ0eVR5cGUgIkR3b3JkIiB8IG91dC1udWxsCiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZWlmICgoKChHZXQtaXRlbXByb3BlcnR5IC1wYXRoICJSZWdpc3RyeTo6SEtFWV9MT0NBTF9NQUNISU5FXFNPRlRXQVJFXE1pY3Jvc29mdFxXaW5kb3dzIE5UXEN1cnJlbnRWZXJzaW9uXFdpbmxvZ29uXFNwZWNpYWxBY2NvdW50c1xVc2VyTGlzdCIpLiR1c2VybmFtZSkgLWVxIDApIC1lcSAkZmFsc2UpIHsKICAgICAgICAgICAgICAgIE5ldy1JdGVtUHJvcGVydHkgLVBhdGggIlJlZ2lzdHJ5OjpIS0VZX0xPQ0FMX01BQ0hJTkVcU09GVFdBUkVcTWljcm9zb2Z0XFdpbmRvd3MgTlRcQ3VycmVudFZlcnNpb25cV2lubG9nb25cU3BlY2lhbEFjY291bnRzXFVzZXJMaXN0IiAtTmFtZSAkdXNlcm5hbWUgLVByb3BlcnR5VHlwZSAiRHdvcmQiIHwgb3V0LW51bGwKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBpZiAoKEdldC1pdGVtcHJvcGVydHkgLXBhdGggIlJlZ2lzdHJ5OjpIS0VZX0xPQ0FMX01BQ0hJTkVcU09GVFdBUkVcTWljcm9zb2Z0XFdpbmRvd3MgTlRcQ3VycmVudFZlcnNpb25cV2lubG9nb25cU3BlY2lhbEFjY291bnRzXFVzZXJMaXN0IikuJHVzZXJuYW1lIC1lcSAwKSB7CiAgICAgICAgICAgICR0cmFja2VyLkFkZCgiSGlkZGVuIEZyb20gV2VsY29tZSBTY3JlZW4iLCAiU1VDQ0VTU2BuYG5bTm90ZV06VGhpcyB1c2VyIGlzIGhpZGRlbiBmcm9tIHdlbGNvbWUgc2NyZWVuIikKICAgICAgICB9CiAgICAgICAgZWxzZSB7ICR0cmFja2VyLkFkZCgiSGlkZGVuIGZyb20gV2VsY29tZSBzY3JlZW4iLCAiRkFJTEVEIikgfQogICAgfQogICAgc3dpdGNoICgkYWN0aW9uKSB7CiAgICAgICAgIkFkZE5ld1VzZXIiIHsgIi0iICogNDAgKyAiYG5Qcm9wZXJ0eSB1cGRhdGUgc3RhdHVzIGZvciAkdXNlcm5hbWVgbmBuTm90ZTogSWYgbm8gcHJvcGVydGllcyBhcmUgcHJvdmlkZWQsIG91dHB1dCB3aWxsIGJlIGJsYW5rYG4iICsgIi0iICogNDAgfQogICAgICAgICJNb2RpZnlVc2VyIiB7ICItIiAqIDQwICsgImBuUHJvcGVydHkgdXBkYXRlIHN0YXR1cyBmb3IgJHVzZXJuYW1lYG5gbk5vdGU6IElmIG5vIHByb3BlcnRpZXMgYXJlIHByb3ZpZGVkLCBvdXRwdXQgd2lsbCBiZSBibGFua2BuIiArICItIiAqIDQwIH0KICAgIH0KICAgICR0cmFja2VyLkdldEVudW1lcmF0b3IoKSB8IEZvcmVhY2gtb2JqZWN0IHsKICAgICAgICBXcml0ZS1vdXRwdXQgIlVwZGF0aW5nLi4kKCRfLmtleSkiCiAgICAgICAgV3JpdGUtb3V0cHV0ICIkKCRfLnZhbHVlKSIKICAgICAgICAiLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0iCiAgICB9Cn0KCmZ1bmN0aW9uIG1vZGlmeV91c2VyIHsKICAgICR0cmFja2VyID0gQHsgfQogICAgJEVycm9yQWN0aW9ucHJlZmVyZW5jZSA9ICJTaWxlbnRseUNvbnRpbnVlIgogICAgJGNoZWNrX2V4aXN0ID0gbmV0IHVzZXIgJHVzZXJuYW1lIDI+JjEKICAgIGlmICghJGNoZWNrX2V4aXN0KSB7CiAgICAgICAgIltFUlJPUl06VXNlciBpcyBub3QgcHJlc2VudCBpbiB0aGUgc3lzdGVtIgogICAgICAgIEV4aXQ7CiAgICB9CiAgICBpZiAoJGZ1bGxuYW1lKSB7CiAgICAgICAgbmV0IHVzZXIgJHVzZXJuYW1lIC9mdWxsbmFtZTokZnVsbG5hbWUgMj4mMSB8IG91dC1udWxsCiAgICAgICAgaWYgKCQ/KSB7ICR0cmFja2VyLkFkZCgiRGlzcGxheSBOYW1lIiwgIlNVQ0NFU1MiKSB9ZWxzZSB7ICR0cmFja2VyLkFkZCgiRGlzcGxheSBOYW1lIiwgIkZBSUxFRCIpIH0KICAgIH0KICAgIGNvbW1vbl9mdW5jdGlvbgp9CgpmdW5jdGlvbiBhZGR1c2VyIHsKICAgICR0cmFja2VyID0gQHsgfQogICAgJEVycm9yQWN0aW9ucHJlZmVyZW5jZSA9ICJTaWxlbnRseUNvbnRpbnVlIgogICAgJGNoZWNrX2V4aXN0ID0gbmV0IHVzZXIgJHVzZXJuYW1lIDI+JjEKICAgIGlmICghJGNoZWNrX2V4aXN0KSB7CiAgICAgICAgbmV0IHVzZXIgJHVzZXJuYW1lICRwYXNzd29yZCAvYWRkIC9mdWxsbmFtZTokZnVsbG5hbWUgIDI+JjEgfCBvdXQtbnVsbAogICAgICAgIGlmICghJD8pIHsKICAgICAgICAgICAgIltFUlJPUl06VXNlciBjcmVhdGlvbiBmYWlsZWQiCiAgICAgICAgICAgIEV4aXQ7CiAgICAgICAgfQogICAgICAgIGVsc2UgewogICAgICAgICAgICAiLSIgKiAzNSArICJgbltNU0ddOlVzZXIgJHVzZXJuYW1lIGNyZWF0ZWQgc3VjY2Vzc2Z1bGx5YG5gbkNoZWNraW5nIGZvciBwcm9wZXJ0aWVzIHRvIHVwZGF0ZS4uYG4iICsgIi0iICogMzUKICAgICAgICB9CiAgICB9CiAgICBlbHNlaWYgKCRjaGVja19leGlzdCAtYW5kICgkT3ZlcndyaXRlSWZUaGVVc2VyQWxyZWFkeUV4aXN0cyAtZXEgJHRydWUpKSB7CiAgICAgICAgbW9kaWZ5X3VzZXIKICAgICAgICByZXR1cm4KICAgIH0KICAgIGVsc2UgewogICAgICAgICJbRVJST1JdOlVzZXIgYWxyZWFkeSBwcmVzZW50IGluIHRoZSBzeXN0ZW0uIgogICAgICAgIEV4aXQ7CiAgICB9CiAgICBjb21tb25fZnVuY3Rpb24KfQoKZnVuY3Rpb24gcmVtb3ZlX3VzZXIgewogICAgJEVycm9yQWN0aW9ucHJlZmVyZW5jZSA9ICJTaWxlbnRseUNvbnRpbnVlIgogICAgJGNoZWNrX2V4aXN0ID0gbmV0IHVzZXIgJHVzZXJuYW1lIDI+JjEKICAgIGlmICgkY2hlY2tfZXhpc3QpIHsKCiAgICAgICAgbmV0IHVzZXIgJHVzZXJuYW1lIC9kZWxldGUgMj4mMSB8IG91dC1udWxsCiAgICB9CiAgICBlbHNlIHsKICAgICAgICAiW0VSUk9SXTpVc2VyIGlzIG5vdCBwcmVzZW50IGluIHRoZSBzeXN0ZW0iCiAgICAgICAgRXhpdDsKICAgIH0KICAgIGlmICgkPykgewogICAgICAgICJbTVNHXTpVc2VyIGRlbGV0ZWQgc3VjY2Vzc2Z1bGx5LiIKCiAgICB9CiAgICBlbHNlIHsKICAgICAgICAiW0VSUk9SXTpGYWlsZWQgdG8gZGVsZXRlIHVzZXIuIgogICAgfQp9CgoKCnN3aXRjaCAoJGFjdGlvbikgewogICAgIkFkZE5ld1VzZXIiIHsgYWRkdXNlciB9CiAgICAiQ2hhbmdlUGFzc3dvcmQiIHsgY2hhbmdlX3Bhc3N3b3JkIH0KICAgICJSZW1vdmVVc2VyIiB7IHJlbW92ZV91c2VyIH0KICAgICJNb2RpZnlVc2VyIiB7IG1vZGlmeV91c2VyIH0KfQoKCg==","jsonSchema":{"additionalproperties":false,"dependencies":{"Action":{"oneOf":[{"dependencies":{"homeFolder":{"oneOf":[{"properties":{"Path":{"title":"Local path","type":"string"},"homeFolder":{"enum":["Local"]}}},{"properties":{"DriveLetter":{"enum":["A","B","C","D","E","F","G","H","I","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],"title":"Driver Letter","type":"string"},"Path":{"title":"To","type":"string"},"homeFolder":{"enum":["Connect"]}}}]}},"properties":{"AccountIsDisabled":{"default":"No","enum":["Yes","No","No Change"],"title":"Account is disabled","type":"string"},"Action":{"enum":["AddNewUser"]},"AddTheUserToTheseGroups":{"title":"Add the user to these groups","type":"string"},"ConfirmPassword":{"title":"Confirm Password","type":"string"},"Description":{"title":"User Description","type":"string"},"FullName":{"title":"Full Name","type":"string"},"HideAccountOnTheWelcomeScreen":{"title":"Hide account on the welcome screen","type":"boolean"},"LogonScript":{"title":"Logon Script","type":"string"},"OverwriteIfTheUserAlreadyExists":{"title":"Overwrite if the user already exists","type":"boolean"},"Password":{"title":"Password","type":"string"},"PasswordNeverExpires":{"default":"No","enum":["Yes","No","No Change"],"title":"Password never expires","type":"string"},"ProfilePath":{"title":"Profile path","type":"string"},"RemoveTheUserFromTheseGroups":{"title":"Remove the user from these groups","type":"string"},"UserCannotChangePassword":{"default":"No","enum":["Yes","No","No Change"],"title":"User cannot change password","type":"string"},"UserMustChangePasswordAtNextLogon":{"default":"No","enum":["Yes","No","No Change"],"title":"User must change password at next logon","type":"string"},"UserName":{"title":"User Name","type":"string"},"homeFolder":{"default":"Local","enum":["Local","Connect"],"title":"Home Folder","type":"string"}},"required":["UserName"]},{"properties":{"Action":{"enum":["ChangePassword"]},"ConfirmPassword":{"title":"Confirm Password","type":"string"},"Password":{"title":"Password","type":"string"},"UserName":{"title":"User Name","type":"string"}}},{"properties":{"Action":{"enum":["RemoveUser"]},"UserName":{"title":"User Name","type":"string"}}},{"dependencies":{"homeFolder":{"oneOf":[{"properties":{"Path":{"title":"Local path","type":"string"},"homeFolder":{"enum":["Local"]}}},{"properties":{"DriveLetter":{"enum":["A","B","C","D","E","F","G","H","I","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],"title":"Driver Letter","type":"string"},"Path":{"title":"To","type":"string"},"homeFolder":{"enum":["Connect"]}}}]}},"properties":{"AccountIsDisabled":{"default":"No","enum":["Yes","No","No Change"],"title":"Account is disabled","type":"string"},"Action":{"enum":["ModifyUser"]},"AddTheUserToTheseGroups":{"title":"Add the user to these groups","type":"string"},"ConfirmPassword":{"title":"Confirm Password","type":"string"},"Description":{"title":"User Description","type":"string"},"FullName":{"title":"Full Name","type":"string"},"HideAccountOnTheWelcomeScreen":{"title":"Hide account on the welcome screen","type":"boolean"},"LogonScript":{"title":"Logon Script","type":"string"},"Password":{"title":"Password","type":"string"},"PasswordNeverExpires":{"default":"No","enum":["Yes","No","No Change"],"title":"Password never expires","type":"string"},"ProfilePath":{"title":"Profile path","type":"string"},"RemoveTheUserFromTheseGroups":{"title":"Remove the user from these groups","type":"string"},"UserCannotChangePassword":{"default":"No","enum":["Yes","No","No Change"],"title":"User cannot change password","type":"string"},"UserMustChangePasswordAtNextLogon":{"default":"No","enum":["Yes","No","No Change"],"title":"User must change password at next logon","type":"string"},"UserName":{"title":"User Name","type":"string"},"homeFolder":{"default":"Local","enum":["Local","Connect"],"title":"Home Folder","type":"string"}},"required":["UserName"]}]}},"patternProperties":{"^AccountIsDisabled":{},"^AddTheUserToTheseGroups$":{},"^ConfirmPassword$":{},"^Description$":{},"^DriveLetter$":{},"^HideAccountOnTheWelcomeScreen$":{},"^LogonScript$":{},"^OverwriteIfTheUserAlreadyExists$":{},"^Password$":{},"^PasswordNeverExpires$":{},"^Path$":{},"^ProfilePath$":{},"^RemoveTheUserFromTheseGroups$":{},"^UserCannotChangePassword$":{},"^UserMustChangePasswordAtNextLogon$":{},"^homeFolder$":{}},"properties":{"Action":{"default":"AddNewUser","enum":["AddNewUser","ChangePassword","RemoveUser","ModifyUser"],"enumNames":["Add New User","Change Password","Remove User","Modify User"],"title":"Action","type":"string"}},"type":"object"},"uiSchema":{"AccountIsDisabled":{"classNames":"col-sm-6","ui:autofocus":true},"Action":{"classNames":"col-sm-6 col-sm-offset-right-6","ui:placeholder":"Select"},"AddTheUserToTheseGroups":{"classNames":"col-sm-6","ui:autofocus":true,"ui:help":"Member of(Use commas to separate group names)"},"ConfirmPassword":{"classNames":"col-sm-6","includeInResult":false,"ui:help":"Input password one more time","ui:widget":"password"},"Description":{"classNames":"col-sm-6 col-sm-offset-right-6","ui:autofocus":true,"ui:widget":"textarea"},"DriveLetter":{"classNames":"col-sm-4","ui:autofocus":true,"ui:placeholder":"Select Drive Letter"},"FullName":{"classNames":"col-sm-6","ui:autofocus":true},"HideAccountOnTheWelcomeScreen":{"classNames":"col-sm-12","ui:autofocus":true,"ui:help":"Selecting this option will cause the working of LogMeIn 1-click."},"LogonScript":{"classNames":"col-sm-6","ui:autofocus":true},"OverwriteIfTheUserAlreadyExists":{"classNames":"col-sm-12","ui:autofocus":true},"Password":{"classNames":"col-sm-6","ui:help":"Hint: Make it strong!","ui:widget":"password","validationSchema":{"fields":["Password","ConfirmPassword"],"type":"shouldBeEqual"}},"PasswordNeverExpires":{"classNames":"col-sm-6","ui:autofocus":true},"Path":{"classNames":"col-sm-4","ui:autofocus":true},"ProfilePath":{"classNames":"col-sm-6","ui:autofocus":true},"RemoveTheUserFromTheseGroups":{"classNames":"col-sm-6","ui:autofocus":true,"ui:help":"Member of(Use commas to separate group names)"},"UserCannotChangePassword":{"classNames":"col-sm-6","ui:autofocus":true},"UserMustChangePasswordAtNextLogon":{"classNames":"col-sm-6","ui:autofocus":true},"UserName":{"classNames":"col-sm-6","ui:autofocus":true},"homeFolder":{"classNames":"col-sm-12","ui:options":{"inline":true},"ui:widget":"radio"},"ui:order":["Action","UserName","FullName","Description","Password","ConfirmPassword","UserMustChangePasswordAtNextLogon","UserCannotChangePassword","PasswordNeverExpires","AccountIsDisabled","OverwriteIfTheUserAlreadyExists","HideAccountOnTheWelcomeScreen","AddTheUserToTheseGroups","RemoveTheUserFromTheseGroups","LogonScript","ProfilePath","homeFolder","DriveLetter","Path"]},"isHDScript":false}
