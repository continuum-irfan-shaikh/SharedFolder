{"id":"f8581975-5c93-43b8-b508-61cf609b4d7f","partnerId":"00000000-0000-0000-0000-000000000000","category":["Maintenance","Management"],"description":"Start, Stop or Restart a service","engine":"powershell","engineMaxVersion":5,"expectedExecutionTimeSec":300,"failureMessage":"Executed with errors","successMessage":"The operation with Windows Service was completed successfully","internal":false,"name":"Start/restart service","tags":["Windows 7","Windows 10"],"sequence":true,"content":"aWYgKCRlbnY6UFJPQ0VTU09SX0FSQ0hJVEVXNjQzMiAtZXEgIkFNRDY0IikgewogICAgaWYgKCRteUludm9jYXRpb24uTGluZSkgewogICAgICAgICYiJGVudjpzeXN0ZW1yb290XHN5c25hdGl2ZVx3aW5kb3dzcG93ZXJzaGVsbFx2MS4wXHBvd2Vyc2hlbGwuZXhlIiAtTm9uSW50ZXJhY3RpdmUgLU5vUHJvZmlsZSAkbXlJbnZvY2F0aW9uLkxpbmUKICAgIH1lbHNlewogICAgICAgICYiJGVudjpzeXN0ZW1yb290XHN5c25hdGl2ZVx3aW5kb3dzcG93ZXJzaGVsbFx2MS4wXHBvd2Vyc2hlbGwuZXhlIiAtTm9uSW50ZXJhY3RpdmUgLU5vUHJvZmlsZSAtZmlsZSAiJCgkbXlJbnZvY2F0aW9uLkludm9jYXRpb25OYW1lKSIgJGFyZ3MKICAgIH0KZXhpdCAkbGFzdGV4aXRjb2RlCn0KCmlmICggJG1vZGUgLWVxICJkZWxheWVkLWF1dG8iKSB7CiAgICAkbW9kZW5hbWUgPSAiQXV0b21hdGljKERlbGF5ZWQgU3RhcnQpIgp9CmlmICggJG1vZGUgLWVxICJBdXRvIikgewogICAgJG1vZGVuYW1lID0gIkF1dG9tYXRpYyIKfQppZiAoICRtb2RlIC1lcSAiZGVtYW5kIikgewogICAgJG1vZGVuYW1lID0gIk1hbnVhbCIKfQppZiAoICRtb2RlIC1lcSAiZGlzYWJsZWQiKSB7CiAgICAkbW9kZW5hbWUgPSAiRGlzYWJsZWQiCn0KCmlmICggKChHZXQtV21pT2JqZWN0IHdpbjMyX3NlcnZpY2UgLUZpbHRlciAibmFtZT0nJHNlcnZpY2UnIikuU3RhcnRNb2RlIC1lcSAiRGlzYWJsZWQiICkgLWFuZCAoJGFjdGlvbiAtbGlrZSAiKnN0YXJ0KiIpIC1hbmQgKCRtb2RlIC1ub3RtYXRjaCAiYXV0b2B8ZGVtYW5kYHxkZWxheWVkLWF1dG8iKSkgewogICAgICAgIFdyaXRlLU91dHB1dCAiVGhlIHNwZWNpZmllZCBzZXJ2aWNlIGlzIGRpc2FibGVkIGFuZCBjYW5ub3QgYmUgc3RhcnRlZC9yZXN0YXJlZC4iCiAgICAgICAgRXhpdAp9CgppZiAoJG1vZGUpIHsKICAgICRyZXN1bHQgPSBzYy5leGUgY29uZmlnICRzZXJ2aWNlIHN0YXJ0PSAkbW9kZQogICAgaWYgKCRyZXN1bHQgLWxpa2UgIipTVUNDRVNTKiIpIHsKICAgICAgICAiU2VydmljZSBzdGFydCBtb2RlIGNoYW5nZWQgdG8gJG1vZGVuYW1lLiIKICAgICAgICBpZiAoJG1vZGUgLWVxICJkaXNhYmxlZCIgLWFuZCAkYWN0aW9uIC1saWtlICIqc3RhcnQqIikgewogICAgICAgICAgICBXcml0ZS1PdXRwdXQgIlRoZSBzcGVjaWZpZWQgc2VydmljZSBpcyBkaXNhYmxlZCBhbmQgY2Fubm90IGJlIHN0YXJ0ZWQvcmVzdGFydGVkLiIKICAgICAgICAgICAgRXhpdCAgCiAgICAgICAgfQogICAgfQogICAgZWxzZSB7CiAgICAgICAgIkVSUk9SOiBGYWlsZWQgdG8gY2hhbmdlIHNlcnZpY2UgbW9kZSB0byAkbW9kZW5hbWUuYG4kcmVzdWx0IgogICAgfQp9CgoKdHJ5IHsKICAgICRzdGF0dXMgPSAoZ2V0LXNlcnZpY2UgJHNlcnZpY2UpLlN0YXR1cwogICAgc3dpdGNoICgkYWN0aW9uKSB7CiAgICAgICAgInN0YXJ0IiB7CiAgICAgICAgICAgIGlmICgkc3RhdHVzIC1uZSAiUnVubmluZyIpIHsKICAgICAgICAgICAgICAgIFN0YXJ0LVNlcnZpY2UgJHNlcnZpY2UgLUVycm9yQWN0aW9uIFN0b3AKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgIFdyaXRlLU91dHB1dCAiU2VydmljZSBpcyBhbHJlYWR5IHJ1bm5pbmcuIgogICAgICAgICAgICAgICAgR2V0LVdtaU9iamVjdCB3aW4zMl9zZXJ2aWNlIC1GaWx0ZXIgIm5hbWU9JyRzZXJ2aWNlJyIgfCBzZWxlY3QgTmFtZSwgU3RhdHVzLCBTdGF0ZSwgU3RhcnRNb2RlIHwgZmwKICAgICAgICAgICAgICAgIFJldHVybgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgICJyZXN0YXJ0IiB7CiAgICAgICAgICAgIFJlc3RhcnQtU2VydmljZSAkc2VydmljZSAtRXJyb3JBY3Rpb24gU3RvcAogICAgICAgIH0KICAgICAgICAic3RvcCIgewogICAgICAgICAgICBpZiAoJHN0YXR1cyAtbmUgIlN0b3BwZWQiKSB7CiAgICAgICAgICAgICAgICBTdG9wLVNlcnZpY2UgJHNlcnZpY2UgLUVycm9yQWN0aW9uIFN0b3AKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgIFdyaXRlLU91dHB1dCAiU2VydmljZSBpcyBhbHJlYWR5IHN0b3BwZWQuIgogICAgICAgICAgICAgICAgR2V0LVdtaU9iamVjdCB3aW4zMl9zZXJ2aWNlIC1GaWx0ZXIgIm5hbWU9JyRzZXJ2aWNlJyIgfCBzZWxlY3QgTmFtZSwgU3RhdHVzLCBTdGF0ZSwgU3RhcnRNb2RlIHwgZmwKICAgICAgICAgICAgICAgIFJldHVybgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIERlZmF1bHQgeyAKICAgICAgICAgICAgV3JpdGUtT3V0cHV0ICJJbnZhbGlkIEFjdGlvbjogJGFjdGlvbi4gU2hvdWxkIGJlIG9uZSBvZjogU3RhcnQsIFN0b3AsIFJlc3RhcnQiCiAgICAgICAgfQogICAgfQogICAgaWYgKCQ/KSB7CiAgICAgICAgJHJlcyA9IEdldC1XbWlPYmplY3Qgd2luMzJfc2VydmljZSAtRmlsdGVyICJuYW1lPSckc2VydmljZSciIHwgc2VsZWN0IE5hbWUsIFN0YXR1cywgU3RhdGUsIFN0YXJ0TW9kZSB8IGZsCiAgICAgICAgaWYgKCRhY3Rpb24gLWVxICJzdG9wIikgewogICAgICAgICAgICBXcml0ZS1PdXRwdXQgIlNlcnZpY2Ugc3RvcHBlZCBzdWNjZXNzZnVsbHkuIgogICAgICAgICAgICAkcmVzCiAgICAgICAgfQogICAgICAgIGVsc2UgewogICAgICAgICAgICBXcml0ZS1PdXRwdXQgIlNlcnZpY2UgJGFjdGlvbmBlZCBzdWNjZXNzZnVsbHkuIgogICAgICAgICAgICAkcmVzCiAgICAgICAgfQogICAgfQp9CmNhdGNoIHsKCiAgICBpZiAoICQoJF8uRXhjZXB0aW9uLm1lc3NhZ2UpICAtbGlrZSAiKml0IGhhcyBkZXBlbmRlbnQgc2VydmljZXMqIiApIHsKICAgICBXcml0ZS1PdXRwdXQgIlRoZSBzcGVjaWZpZWQgc2VydmljZSBjYW5ub3QgYmUgc3RvcHBlZCwgaXQgaGFzIGZvbGxvd2luZyBkZXBlbmRlbnQgc2VydmljZXMuIiAKICAgICAkZGVwID0gR2V0LVNlcnZpY2UgJHNlcnZpY2UgLURlcGVuZGVudFNlcnZpY2VzIHwgc2VsZWN0IEB7TiA9ICJEZXBlbmRlbnQgc2VydmljZXM6IjsgRSA9IHsgJF8uRGlzcGxheU5hbWUgfX0gfCBmdAogICAgICRyZXMgPSBHZXQtV21pT2JqZWN0IHdpbjMyX3NlcnZpY2UgLUZpbHRlciAibmFtZT0nJHNlcnZpY2UnIiB8IHNlbGVjdCBOYW1lLCBTdGF0dXMsIFN0YXRlLCBTdGFydE1vZGUgfCBmbAogICAgIFdyaXRlLU91dHB1dCAkZGVwLCRyZXMKICAgIAogICAgfWVsc2UgeyBXcml0ZS1PdXRwdXQgIkVSUk9SOiAkXy5FeGNlcHRpb24ubWVzc2FnZSIgfQoKfQo=","jsonSchema":{"additionalProperties":false,"properties":{"action":{"enum":["start","stop","restart"],"enumNames":["Start","Stop","Restart"],"title":"Action","type":"string"},"mode":{"enum":["auto","delayed-auto","demand","disabled"],"enumNames":["Automatic","Automatic(Delayed Start)","Manual","Disable"],"title":"Mode","type":"string"},"service":{"title":"Service name","type":"string"}},"required":["action","service"],"type":"object"},"uiSchema":{"action":{"classNames":"col-sm-6","ui:autofocus":true,"ui:placeholder":"Select Action"},"mode":{"classNames":"col-sm-6","ui:placeholder":"Select mode"},"service":{"classNames":"col-sm-6"},"ui:order":["service","action","mode"]},"isHDScript":false}