{"id":"35ba753f-312f-11e9-98d5-00155d130b17","partnerId":"00000000-0000-0000-0000-000000000000","category":["Data Collection"],"description":"Script retrieve username and domain details","engine":"powershell","engineMaxVersion":5,"expectedExecutionTimeSec":300,"failureMessage":"Executed with errors","successMessage":"Script executed successfully","internal":false,"name":"Retrieve UserName and Domain","tags":["Windows 7","Windows 10"],"sequence":true,"content":"PCMKICAgIC5TeW5vcHNpcwogICAgIFJldHJpdmUgVXNlck5hbWUgYW5kIERvbWFpbiAgCiAgICAuRGVzY3JpcHRpb24gCiAgICAgVG8gZ2V0IHRoZSBkZXRhaWxzIG9mIHRoZSB1c2VycyB3aG8gYXJlIGxvZ2dlZCBpbiB0byB0aGUgc2VydmVyIGFsb25nIHdpdGggdGhlaXIgZG9tYWluIG5hbWUgYW5kIHByb2ZpbGUgdHlwZQogICAgLkhlbHAKICAgICBUbyBnZXQgbW9yZSBpbmZvcm1hdGlvbiBhYm91dCB0aGUgdXNlcmRldGFpbHMsIHBsZWFzZSByZWZlciBiZWxvdyBkZXRhaWxzCiAgICAgR2V0LVdtaU9iamVjdCAtQ2xhc3MgV2luMzJfVXNlclByb2ZpbGUKICAgIC5BdXRob3IKICAgICBzdXNobWEueWVyYXNpQGNvbnRpbnV1bS5uZXQKICAgIC5OYW1lIAogICAgIFJldHJpdmUgVXNlck5hbWUgYW5kIERvbWFpbiAKIz4KCiRFeGVjdXRpb25Mb2c9QCgpCltkb3VibGVdJE9TVmVyc2lvbj1bRW52aXJvbm1lbnRdOjpPU1ZlcnNpb24uVmVyc2lvbi5Ub1N0cmluZygyKQojIE9TIFZlcnNpb24gYW5kIFBvd2Vyc2hlbGwgY29tcGFyaXNvbi4KaWYgKCgkb3N2ZXJzaW9uIC1sdCAnNi4xJykgLW9yICgkUFNWZXJzaW9uVGFibGUuUFNWZXJzaW9uLk1ham9yIC1sdCAnMicpKQogICAgICAgIHsKICAgICAgICAgICAgJGV4ZWN1dGlvbmxvZyArPSAnUHJlcmVxdWlzaXRlcyB0byBydW4gdGhlIHNjcmlwdCBpcyBub3QgdmFsaWQsIEhlbmNlIFNjcmlwdCBFeGNldXRpb24gc3RvcHBlZCcgIydTY3JpcHQgaXMgZGVzaWduIGZvciB3aW5kb3dzIDcgYW5kIEFib3ZlIE1lbWJlcnMgb25seSwgU2NyaXB0IEV4ZWN1dGlvbiBTdG9wcGVkLicKICAgICAgICAgICAgV3JpdGUtT3V0cHV0ICRleGVjdXRpb25sb2cKICAgICAgICAgICAgZXhpdDsKICAgICAgICB9IAoKI1RvIGNoZWNrIHRoZSByb2xlIG9mIHRoZSBjb21wdXRlcgp0cnkgewoKICAgICRDb21wPWdldC13bWlvYmplY3Qgd2luMzJfY29tcHV0ZXJzeXN0ZW0KICAgICRjb21wdXRlciA9ICRjb21wLm5hbWUgOyAkRG9tYWluTmFtZWUgPSAkY29tcC5kb21haW4KICAgICRFeGVjdXRpb25Mb2cgKz0gIkNvbXB1dGVyTmFtZSA6ICRjb21wdXRlciIKICAgICRFeGVjdXRpb25Mb2cgKz0gIkRvbWFpbi9Xb3JrZ3JvdXAgOiAkRG9tYWluTmFtZWUiCiAgICAkRXhlY3V0aW9uTG9nICs9ICJDdXJyZW50bHkgTG9nZ2VkaW4gdXNlciBuYW1lcyBhcmUgbWVudGlvbmVkIGJlbG93IiAgICAKICAgICRBbGxVc2VycyA9IHF1ZXJ5IHVzZXIgL3NlcnZlcjokY29tcHV0ZXIgMj4mMQogICAgJFVzZXJzID0gJEFsbFVzZXJzIHwgRm9yRWFjaC1PYmplY3QgeygoJF8udHJpbSgpIC1yZXBsYWNlICI+IiAtcmVwbGFjZSAiKD9tKV4oW0EtWmEtejAtOV17Myx9KVxzKyhcZHsxLDJ9XHMrXHcrKSIsICckMSAgbm9uZSAgJDInIC1yZXBsYWNlICJcc3syLH0iLCAiLCIgLXJlcGxhY2UgIm5vbmUiLCAkbnVsbCkpfSB8IENvbnZlcnRGcm9tLUNzdgogICAgJEN1cnJlbnRVc2VycyA9IEAoKQogICAgRm9yRWFjaCAoJFVzZXIgaW4gJFVzZXJzKQogICAgewogICAgJENVc2VyID0gKCR1c2VyIHwgP3skXy5zdGF0ZSAtbmUgJ0Rpc2MnfSB8IFNlbGVjdC1PYmplY3QgdXNlcm5hbWUpLnVzZXJuYW1lCiAgICAkQ3VycmVudFVzZXJzKz0gJENVc2VyCiAgICB9CiAgICAKICAgICRFeGVjdXRpb25Mb2cgKz0gIiRDdXJyZW50VXNlcnMiCiMgQ29tbWFuZHMgdG8gY2hlY2sgdGhlIExvY2FsIFVzZXIgUHJvZmlsZXMKCiAgJFByb2ZpbGVzID0gR2V0LVdtaU9iamVjdCAtQ2xhc3MgV2luMzJfVXNlclByb2ZpbGUgLUNvbXB1dGVyICRDb21wdXRlciAtZWEgMAogICRFeGVjdXRpb25Mb2cgKz0gIkFsbCB1c2VyIHByb2ZpbGVzIGFyZSBtZW50aW9uZWQgYmVsb3ciIAogIGZvcmVhY2ggKCRwcm9maWxlIGluICRwcm9maWxlcykgewogIHRyeSB7CiAgICAgICRvYmpTSUQgPSBOZXctT2JqZWN0IFN5c3RlbS5TZWN1cml0eS5QcmluY2lwYWwuU2VjdXJpdHlJZGVudGlmaWVyKCRwcm9maWxlLnNpZCkKICAgICAgJG9ianVzZXIgPSAkb2Jqc2lkLlRyYW5zbGF0ZShbU3lzdGVtLlNlY3VyaXR5LlByaW5jaXBhbC5OVEFjY291bnRdKQogICAgICAkb2JqdXNlcm5hbWUgPSAkb2JqdXNlci52YWx1ZQogIH0gY2F0Y2ggewogICAgICAgICRvYmp1c2VybmFtZSA9ICRwcm9maWxlLnNpZAogIH0KICBzd2l0Y2goJHByb2ZpbGUuc3RhdHVzKXsKICAgMSB7ICRwcm9maWxlVHlwZT0iVGVtcG9yYXJ5IiB9CiAgIDIgeyAkcHJvZmlsZVR5cGU9IlJvYW1pbmciIH0KICAgNCB7ICRwcm9maWxlVHlwZT0iTWFuZGF0b3J5IiB9CiAgIDggeyAkcHJvZmlsZVR5cGU9IkNvcnJ1cHRlZCIgfQogICBkZWZhdWx0IHsgJHByb2ZpbGVUeXBlID0gIkxPQ0FMIiB9CiAgfQogICRVc2VyID0gJG9ialVzZXIuVmFsdWUgfCA/eyRfIC1ub3RsaWtlICIqQWxsKiIgLWFuZCAkXyAtbm90bGlrZSAiKkRlZmF1bHQqIiAtYW5kICRfIC1ub3RsaWtlICIqcHVibGljKiIgLWFuZCAkXyAtbm90bGlrZSAiKkNsYXNzaWMqIn0gICAKICBpZiAoKCRVc2VyIC1ub3RsaWtlICcqTlQgQXV0aG9yaXR5KicpIC1hbmQgKCRVc2VyIC1ub3RsaWtlICRudWxsKSkgeyAKICAkRXhlY3V0aW9uTG9nICs9ICIgVXNlck5hbWU6ICR1c2VyIgogICRFeGVjdXRpb25Mb2cgKz0gIiBQcm9maWxlVHlwZTogJFByb2ZpbGVUeXBlIgogICB9CiB9ICAKICAgV3JpdGUtT3V0cHV0ICRleGVjdXRpb25sb2cKICAgICAgICAgICAgICBleGl0Owp9CkNhdGNoIHsgCgkkRXhlY3V0aW9uTG9nICs9ICJOb3QgYWJsZSB0byByZWFjaCB0aGUgY29tcHV0ZXIgcmVtb3RlbHQgdGhyb3VnaCBXTUkiCglXcml0ZS1PdXRwdXQgJGV4ZWN1dGlvbmxvZwogICAgICAgICAgICAgIGV4aXQ7CiB9Cg==","jsonSchema":"","uiSchema":"","isHDScript":false}
