{"id":"bc3738c4-4732-11ea-866b-00155d130b01","partnerId":"00000000-0000-0000-0000-000000000000","category":["Maintenance"],"description":"Creates a system restore point for desktop operating system.","engine":"powershell","engineMaxVersion":5,"expectedExecutionTimeSec":600,"failureMessage":"Executed with errors","successMessage":"Executed successfully","internal":false,"name":"Create system restore point (new)","tags":["Windows 7","Windows 10"],"sequence":true,"content":"PCMKCgkuU2NyaXB0TmFtZQoJTmlyYXYgU2FjaG9yYQoJLkRlc2NyaXB0aW9uCglTY3JpcHQgd2lsbCBjcmVhdGUgcmVzdG9yZSBwb2ludC4KCUF1dGhvcgoJTmlyYXYgU2FjaG9yYQoJLlJlcXVpcmVtZW50cwoJU2NyaXB0IHNob3VsZCBydW4gd2l0aCBoaWdoZXN0IHByaXZpbGVnZXMuCgkKIz4KCjwjCgokUmVzdG9yZVBvaW50VHlwZSA9ICJBcHBsaWNhdGlvbiBJbnN0YWxsIgokRXZlbnRUeXBlID0gIkJlZ2luIFN5c3RlbSBDaGFuZ2UiCgojPgoKJG5hbWUgPSAiUmVzdG9yZXBvaW50IiArIChHZXQtRGF0ZSAtRm9ybWF0ICJkZE1NeXl5eUhIbW0iKQoKaWYgKCRlbnY6UFJPQ0VTU09SX0FSQ0hJVEVXNjQzMiAtZXEgIkFNRDY0IikgewogICAgaWYgKCRteUludm9jYXRpb24uTGluZSkgewogICAgICAgICYiJGVudjpzeXN0ZW1yb290XHN5c25hdGl2ZVx3aW5kb3dzcG93ZXJzaGVsbFx2MS4wXHBvd2Vyc2hlbGwuZXhlIiAtTm9uSW50ZXJhY3RpdmUgLU5vUHJvZmlsZSAkbXlJbnZvY2F0aW9uLkxpbmUKICAgIH0KICAgIGVsc2UgewogICAgICAgICYiJGVudjpzeXN0ZW1yb290XHN5c25hdGl2ZVx3aW5kb3dzcG93ZXJzaGVsbFx2MS4wXHBvd2Vyc2hlbGwuZXhlIiAtTm9uSW50ZXJhY3RpdmUgLU5vUHJvZmlsZSAtZmlsZSAiJCgkbXlJbnZvY2F0aW9uLkludm9jYXRpb25OYW1lKSIgJGFyZ3MKICAgIH0KICAgIGV4aXQgJGxhc3RleGl0Y29kZQp9CgppZigoR2V0LVdNSU9iamVjdCB3aW4zMl9vcGVyYXRpbmdzeXN0ZW0pLkNhcHRpb24gLWxpa2UgIipzZXJ2ZXIqIil7CiAgICBXcml0ZS1FcnJvciAiU2NyaXB0IGlzIG5vdCBzdXBwb3J0ZWQgb24gU2VydmVyIG9wZXJhdGluZyBzeXN0ZW0uIgogICAgRXhpdDsKfQoKc3dpdGNoKCRSZXN0b3JlUG9pbnRUeXBlKXsKICAgICJBcHBsaWNhdGlvbiBJbnN0YWxsInskUmVzdG9yZVBvaW50VHlwZSA9IDA7QnJlYWs7fQogICAgIkFwcGxpY2F0aW9uIFVuaW5zdGFsbCJ7JFJlc3RvcmVQb2ludFR5cGUgPSAxO0JyZWFrfQogICAgIkRldmljZSBEcml2ZXIgSW5zdGFsbCJ7JFJlc3RvcmVQb2ludFR5cGUgPSAxMDtCcmVha30KICAgICJNb2RpZnkgU2V0dGluZ3MieyRSZXN0b3JlUG9pbnRUeXBlID0gMTI7QnJlYWt9CiAgICAiQ2FuY2VsbGVkIE9wZXJhdGlvbiJ7JFJlc3RvcmVQb2ludFR5cGUgPSAxMztCcmVha30KfQoKc3dpdGNoKCRFdmVudFR5cGUpewogICAgIkJlZ2luIFN5c3RlbSBDaGFuZ2UieyRFdmVudFR5cGUgPSAxMDA7QnJlYWs7fQogICAgIkVuZCBTeXN0ZW0gQ2hhbmdlInskRXZlbnRUeXBlID0gMTAxO0JyZWFrfQogICAgIkJlZ2luIE5lc3RlZCBTeXN0ZW0gQ2hhbmdlInskRXZlbnRUeXBlID0gMTAyO0JyZWFrfQogICAgIkVuZCBOZXN0ZWQgU3lzdGVtIENoYW5nZSJ7JEV2ZW50VHlwZSA9IDEwMztCcmVha30KfQoKJGNvbW1hbmQgPSAiV21pYy5leGUgL05hbWVzcGFjZTpcXHJvb3RcZGVmYXVsdCBQYXRoIFN5c3RlbVJlc3RvcmUgQ2FsbCBDcmVhdGVSZXN0b3JlUG9pbnQgJG5hbWUsICRFdmVudFR5cGUsICRSZXN0b3JlUG9pbnRUeXBlIgojJEVycm9yQWN0aW9ucHJlZmVyZW5jZSA9ICJTaWxlbnRseUNvbnRpbnVlIgokcmVzdWx0ID0gJntjbWQuZXhlIC9jICIkY29tbWFuZCIgMj4mMX0KCgogICAgaWYgKCRyZXN1bHQgLWxpa2UgIipSZXR1cm5WYWx1ZSA9IDA7KiIpIHsKICAgICAgICAiUmVzdG9yZSBwb2ludCBjcmVhdGVkIHN1Y2Nlc3NmdWxseS5gblJlc3RvcmUgUG9pbnQgTmFtZSA6ICRuYW1lIiAgICAKICAgIH0KICAgIGVsc2V7CiAgICAgICAgV3JpdGUtRXJyb3IgIkZhaWxlZCB0byBjcmVhdGUgcmVzdG9yZSBwb2ludC4iIAogICAgICAgIEV4aXQ7CiAgICB9Cg==","jsonSchema":{"properties":{"EventType":{"default":"Begin System Change","enum":["Begin System Change","End System Change","Begin Nested System Change","End Nested System Change"],"title":"Event Type","type":"string"},"RestorePointType":{"default":"Application Install","enum":["Application Install","Application Uninstall","Device Driver Install","Modify Settings","Cancelled Operation"],"title":"Restore Point Type","type":"string"}},"type":"object"},"uiSchema":{"EventType":{"classNames":"col-sm-6"},"RestorePointType":{"classNames":"col-sm-6 col-sm-offset-right-6"},"ui:order":["RestorePointType","EventType"]},"isHDScript":false}