# $Location = 'C:\Prateek\' # String
# $Applications = 'Firefox','Chrome', 'Flash (IE)', 'TeamViewer' # String Array

if ($env:PROCESSOR_ARCHITEW6432 -eq "AMD64") {
    if ($myInvocation.Line) {
        &"$env:systemroot\sysnative\windowspowershell\v1.0\powershell.exe" -NonInteractive -NoProfile $myInvocation.Line
    }
    else {
        &"$env:systemroot\sysnative\windowspowershell\v1.0\powershell.exe" -NonInteractive -NoProfile -file "$($myInvocation.InvocationName)" $args
    }
    exit $lastexitcode
}

$Hashtable = @{
    ".NET"                         = """.NET"""
    ".NET 4"                       = """.NET 4"""
    ".NET 3.5"                     = """.NET 3.5"""
    ".NET 4.5"                     = """.NET 4.5"""
    ".NET 4.5.1"                   = """.NET 4.5.1"""
    ".NET 4.5.2"                   = """.NET 4.5.2"""
    ".NET 4.6"                     = """.NET 4.6"""
    ".NET 4.6.1"                   = """.NET 4.6.1"""
    ".NET 4.6.2"                   = """.NET 4.6.2"""
    ".NET 4.7"                     = """.NET 4.7"""
    ".NET 4.7.1"                   = """.NET 4.7.1"""
    ".NET 4.7.2"                   = """.NET 4.7.2"""
    "7-Zip"                        = """7-Zip"""
    "Acrobat"                      = "Acrobat"
    "Ad-Aware"                     = """Ad-Aware"""
    "AIM"                          = "AIM"
    "AIMP"                         = "AIMP"
    "Air"                          = "Air"
    "Audacity"                     = "Audacity"
    "Auslogics"                    = "Auslogics"
    "Avast"                        = "Avast"
    "AVG"                          = "AVG"
    "Avira"                        = "Avira"
    "BitTorrent Sync"              = """BitTorrent Sync"""
    "Blender"                      = "Blender"
    "CCCP"                         = "CCCP"
    "CDBurnerXP"                   = "CDBurnerXP"
    "Chrome"                       = "Chrome"
    "Citrix Receiver"              = """Citrix Receiver"""
    "Citrix Workspace"             = """Citrix Workspace"""
    "Classic Start"                = """Classic Start"""
    "CutePDF"                      = "CutePDF"
    "Digsby"                       = "Digsby"
    "Discord"                      = "Discord"
    "Dropbox"                      = "Dropbox"
    "Eclipse"                      = "Eclipse"
    "eMule"                        = "eMule"
    "Essentials"                   = "Essentials"
    "Evernote"                     = "Evernote"
    "Everything"                   = "Everything"
    "FastStone"                    = "FastStone"
    "FileZilla"                    = "FileZilla"
    "Firefox"                      = "Firefox"
    "Firefox ESR"                  = """Firefox ESR"""
    "Firefox ESR 10"               = """Firefox ESR 10"""
    "Firefox ESR 17"               = """Firefox ESR 17"""
    "Firefox ESR 24"               = """Firefox ESR 24"""
    "Firefox ESR 31"               = """Firefox ESR 31"""
    "Firefox ESR 38"               = """Firefox ESR 38"""
    "Firefox ESR 45"               = """Firefox ESR 45"""
    "Firefox ESR 52"               = """Firefox ESR 52"""
    "Firefox ESR 60"               = """Firefox ESR 60"""
    "Flash"                        = "Flash"
    "Flash (IE)"                   = """Flash (IE)"""
    "Flash (PPAPI)"                = """Flash (PPAPI)"""
    "foobar2000"                   = "foobar2000"
    "Foxit Reader"                 = """Foxit Reader"""
    "GIMP"                         = "GIMP"
    "Glary"                        = "Glary"
    "GOM"                          = "GOM"
    "Google Backup and Sync"       = """Google Backup and Sync"""
    "Google Drive"                 = """Google Drive"""
    "Google Drive File Stream"     = """Google Drive File Stream"""
    "Google Earth"                 = """Google Earth"""
    "Google Talk"                  = """Google Talk"""
    "GoToMeeting"                  = "GoToMeeting"
    "Greenshot"                    = "Greenshot"
    "HandBrake"                    = "HandBrake"
    "Hulu"                         = "Hulu"
    "ImgBurn"                      = "ImgBurn"
    "InfraRecorder"                = "InfraRecorder"
    "Inkscape"                     = "Inkscape"
    "IrfanView"                    = "IrfanView"
    "iTunes"                       = "iTunes"
    "Java"                         = "Java"
    "Java 6"                       = """Java 6"""
    "Java 7"                       = """Java 7"""
    "Java 8"                       = """Java 8"""
    "Java (AdoptOpenJDK)"          = """Java (AdoptOpenJDK)"""
    "Java (AdoptOpenJDK) 8"        = """Java (AdoptOpenJDK) 8"""
    "Java (AdoptOpenJDK) x64"      = """Java (AdoptOpenJDK) x64"""
    "Java (AdoptOpenJDK) x64 8"    = """Java (AdoptOpenJDK) x64 8"""
    "Java (AdoptOpenJDK) x64 11"   = """Java (AdoptOpenJDK) x64 11"""
    "Java x64"                     = """Java x64"""
    "Java x64 7"                   = """Java x64 7"""
    "Java x64 6"                   = """Java x64 6"""
    "Java x64 8"                   = """Java x64 8"""
    "Java x64 9"                   = """Java x64 9"""
    "Java x64 10"                  = """Java x64 10"""
    "JDK"                          = "JDK"
    "JDK 6"                        = """JDK 6"""
    "JDK 7"                        = """JDK 7"""
    "JDK 8"                        = """JDK 8"""
    "JDK (AdoptOpenJDK)"           = """JDK (AdoptOpenJDK)"""
    "JDK (AdoptOpenJDK) 8"         = """JDK (AdoptOpenJDK) 8"""
    "JDK (AdoptOpenJDK) x64"       = """JDK (AdoptOpenJDK) x64"""
    "JDK (AdoptOpenJDK) x64 8"     = """JDK (AdoptOpenJDK) x64 8"""
    "JDK (AdoptOpenJDK) x64 11"    = """JDK (AdoptOpenJDK) x64 11"""
    "JDK (Amazon Corretto)"        = """JDK (Amazon Corretto)"""
    "JDK (Amazon Corretto) 8"      = """JDK (Amazon Corretto) 8"""
    "JDK (Amazon Corretto) x64"    = """JDK (Amazon Corretto) x64"""
    "JDK (Amazon Corretto) x64 8"  = """JDK (Amazon Corretto) x64 8"""
    "JDK (Amazon Corretto) x64 11" = """JDK (Amazon Corretto) x64 11"""
    "JDK x64"                      = """JDK x64"""
    "JDK x64 7"                    = """JDK x64 7"""
    "JDK x64 8"                    = """JDK x64 8"""
    "JDK x64 11"                   = """JDK x64 11"""
    "K-Lite Codecs"                = """K-Lite Codecs"""
    "K-Lite Codecs x64"            = """K-Lite Codecs x64"""
    "KeePass"                      = "KeePass"
    "KeePass 2"                    = """KeePass 2"""
    "KeePass 1"                    = """KeePass 1"""
    "KMPlayer"                     = "KMPlayer"
    "Krita"                        = "Krita"
    "Launchy"                      = "Launchy"
    "LibreOffice"                  = "LibreOffice"
    "LogMeIn"                      = "LogMeIn"
    "Malwarebytes"                 = "Malwarebytes"
    "MediaMonkey"                  = "MediaMonkey"
    "Messenger"                    = "Messenger"
    "Mozy"                         = "Mozy"
    "MusicBee"                     = "MusicBee"
    "Notepad++"                    = """Notepad++"""
    "NVDA"                         = "NVDA"
    "Office"                       = "Office"
    "OneDrive"                     = "OneDrive"
    "OpenOffice"                   = "OpenOffice"
    "Opera"                        = "Opera"
    "Opera Chromium"               = """Opera Chromium"""
    "Opera 12"                     = """Opera 12"""
    "Paint.NET"                    = """Paint.NET"""
    "PDFCreator"                   = "PDFCreator"
    "PeaZip"                       = "PeaZip"
    "Picasa"                       = "Picasa"
    "Pidgin"                       = "Pidgin"
    "PuTTY"                        = "PuTTY"
    "Python"                       = "Python"
    "qBittorrent"                  = "qBittorrent"
    "QuickTime"                    = "QuickTime"
    "Reader"                       = "Reader"
    "Reader 9"                     = """Reader 9"""
    "Reader 10"                    = """Reader 10"""
    "Reader 11"                    = """Reader 11"""
    "Reader DC"                    = """Reader DC"""
    "Reader Classic"               = """Reader Classic"""
    "Reader Classic 2015"          = """Reader Classic 2015"""
    "Reader Classic 2017"          = """Reader Classic 2017"""
    "RealVNC"                      = "RealVNC"
    "Revo"                         = "Revo"
    "Safari"                       = "Safari"
    "ShareX"                       = "ShareX"
    "Shockwave"                    = "Shockwave"
    "Silverlight"                  = "Silverlight"
    "SkyDrive"                     = "SkyDrive"
    "Skype"                        = "Skype"
    "Songbird"                     = "Songbird"
    "Spotify"                      = "Spotify"
    "Spybot"                       = "Spybot"
    "Spybot 2"                     = """Spybot 2"""
    "Spybot 1"                     = """Spybot 1"""
    "Steam"                        = "Steam"
    "SugarSync"                    = "SugarSync"
    "SumatraPDF"                   = "SumatraPDF"
    "Super"                        = "Super"
    "TeamViewer"                   = "TeamViewer"
    "TeamViewer 7"                 = """TeamViewer 7"""
    "TeamViewer 8"                 = """TeamViewer 8"""
    "TeamViewer 9"                 = """TeamViewer 9"""
    "TeamViewer 10"                = """TeamViewer 10"""
    "TeamViewer 11"                = """TeamViewer 11"""
    "TeamViewer 12"                = """TeamViewer 12"""
    "TeamViewer 13"                = """TeamViewer 13"""
    "TeamViewer 14"                = """TeamViewer 14"""
    "TeraCopy"                     = "TeraCopy"
    "Thunderbird"                  = "Thunderbird"
    "Thunderbird ESR"              = """Thunderbird ESR"""
    "Thunderbird ESR 17"           = """Thunderbird ESR 17"""
    "Trillian"                     = "Trillian"
    "TrueCrypt"                    = "TrueCrypt"
    "TweetDeck"                    = "TweetDeck"
    "uTorrent"                     = "uTorrent"
    "Visual Studio Code"           = """Visual Studio Code"""
    "VLC"                          = "VLC"
    "WebEx"                        = "WebEx"
    "Winamp"                       = "Winamp"
    "WinDirStat"                   = "WinDirStat"
    "WinMerge"                     = "WinMerge"
    "WinRAR"                       = "WinRAR"
    "WinSCP"                       = "WinSCP"
    "XnView"                       = "XnView"
    "Yahoo!"                       = """Yahoo!"""
}

try {
    $Exe = Join-Path $Location 'NinitePro.exe'
    $Report = Join-Path $Location "NiniteReport.txt"
    
    if(Test-Path $Exe){
        $ApplicationString = ''
        Foreach($Item in $Applications){
            $ApplicationString = $ApplicationString, $Hashtable[$Item] -join ' '
        }
        
        $Process = Start-Process $Exe -ArgumentList "/select $ApplicationString /updateonly /silent $Report" -Wait -PassThru
        if ($process.exitcode -eq 0) {
            Write-Output "`nSuccessful"
        }
        else {
            Write-Error "`nFailed. Please refer the log file for more details: `'$Report`'"
        }
    }
    else{
        Write-Error "`nCouldn't find 'NinitePro.exe' at Location: `'$Location`', please check the path and try again."
    }
}
catch {
    Write-Error $_.exception.message
}
