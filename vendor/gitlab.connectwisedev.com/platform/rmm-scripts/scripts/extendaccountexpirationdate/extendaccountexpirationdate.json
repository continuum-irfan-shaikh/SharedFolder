{"id":"7544d615-ef09-11e8-a3a6-00155d130b17","partnerId":"00000000-0000-0000-0000-000000000000","category":["HD Automation"],"description":"Script will extend the account expiration date","engine":"powershell","engineMaxVersion":5,"expectedExecutionTimeSec":300,"failureMessage":"Executed with errors","successMessage":"Task Executed Successfully","internal":false,"name":"HD-Extend Account Expiration Date","tags":["Windows 7","Windows 10"],"sequence":true,"content":"PCMKCS5TWU5PUFNJUwoJRGV2ZWxvcGVkIEJ5IDogR1JUIFtIRC1BdXRvbWF0aW9uXSwgQ29udGludXVtCglGaWxlIFZlcnNpb24gOiAzLjAKCS5ERVNDUklQVElPTgoJVGhlIHNjcmlwdCBpcyBkZXNpZ25lZCB0byBjaGFuZ2UgdGhlIGV4cGlyYXRpb24gZGF0YSBsb2NhbCBvciBkb21haW4gdXNlci4KCS5QQVJBTUVURVIKCVVzZXJJRCBpcyB0aGUgdmFyaWFibGUgcmVxdWlyZWQgZm9yIGNoYW5naW5nIHRoZSBleHBpcmF0aW9uIGRhdGEuCgkuUEFSQU1FVEVSCglJc0RvbWFpbiBpcyBhIGJvb2xlYW4gdmFsdWUgd2l0aCBUUlVFIGFzIHVzZXIgY29uY2lkZXJlZCBhcyBEb21haW4gVXNlciBlbHNlIGxvY2NhbCB1c2VyLgoJLlBBUkFNRVRFUgoJRXhwaXJlIGlzIHZhcmlhYmxlIHRvIGdldCB0aGUgZGF0YSB2YWx1ZSBvbiB3aGljaCBhY2NvdW50IHdpbGwgZ2V0cyBkZWFjdGl2YXRlZC4gRXhhbXBsZSA6IElmIHlvdSBoYXZlIHNlbGVjdGVkIDIwdGggT2N0IDIwMTkgYXMgZXhwaXJlIGRhdGUgdGhlbiB0aGUgYWNjb3VudCB3aWxsIGJlIGFjdGl2ZSB0aWxsIDE5dGggT2N0IDIwMTguCgoJJFVzZXJJRCA9ICJoZCIKCSRJc0RvbWFpbiA9ICR0cnVlCgkkZXhwaXJlID0gIChHZXQtRGF0ZSkuQWRkRGF5cygxMDgpCiM+CjwjIEFyY2hpdGVjdHVyZSBDaGVjayAjPgppZiAoJGVudjpQUk9DRVNTT1JfQVJDSElURVc2NDMyIC1lcSAiQU1ENjQiKSB7CiAgICB3cml0ZS13YXJuaW5nICJFeGNlY3V0aW5nIHRoZSBzY3JpcHQgdW5kZXIgNjQgYml0IHBvd2Vyc2hlbGwiCiAgICBpZiAoJG15SW52b2NhdGlvbi5MaW5lKSB7CiAgICAgICAgJiIkZW52OnN5c3RlbXJvb3Rcc3lzbmF0aXZlXHdpbmRvd3Nwb3dlcnNoZWxsXHYxLjBccG93ZXJzaGVsbC5leGUiIC1Ob25JbnRlcmFjdGl2ZSAtTm9Qcm9maWxlICRteUludm9jYXRpb24uTGluZQogICAgfWVsc2V7CiAgICAgICAgJiIkZW52OnN5c3RlbXJvb3Rcc3lzbmF0aXZlXHdpbmRvd3Nwb3dlcnNoZWxsXHYxLjBccG93ZXJzaGVsbC5leGUiIC1Ob25JbnRlcmFjdGl2ZSAtTm9Qcm9maWxlIC1maWxlICIkKCRteUludm9jYXRpb24uSW52b2NhdGlvbk5hbWUpIiAkYXJncwogICAgfQpleGl0ICRsYXN0ZXhpdGNvZGUKfQoKW2RhdGV0aW1lXSRleHBpcmVpbnB1dCA9ICRleHBpcmUKJE91dHB1dE1lc3NhZ2UgPSBAKCkgPCMgVmFyaWFibGUgdG8gY2FwdHVyZSBvdXRwdXQgZm9yIGRlYnVnZ2luZyBwdXJwb3NlLiAjPgo8IyBDb21wYXRpYmlsaXR5IGNoZWNrIGlmIGZvdW5kIGluY29tcGF0aWJsZSB3aWxsIGV4aXQgIz4KdHJ5ewoJJE9TVmVyc2lvbiA9IChbc3lzdGVtLmVudmlyb25tZW50XTo6T1NWZXJzaW9uLlZlcnNpb24pLk1ham9yCgkkUFNWZXJzaW9uID0gKEdldC1Ib3N0KS5WZXJzaW9uCglpZigoJE9TVmVyc2lvbiAtbHQgNikgLW9yICgkUFNWZXJzaW9uLk1ham9yIC1sdCAyKSkKCXsKCQlXcml0ZS1PdXRwdXQgIltNU0c6IFN5c3RlbSBpcyBub3QgY29tcGF0aWJsZSB3aXRoIHRoZSByZXF1aXJlbWVudC4gRWl0aGVyIG1hY2hpbmUgaXMgYmVsb3cgV2luZG93cyA3IC8gV2luZG93cyAyMDA4UjIgb3IgUG93ZXJzaGVsbCB2ZXJzaW9uIGlzIGxvd2VyIHRoYW4gMi4wIgoJCUV4aXQKCX0KfWNhdGNoIHsgV3JpdGUtT3V0cHV0ICJbTVNHOiBFUlJPUiA6ICRfLkV4Y2VwdGlvbi5tZXNzYWdlXSJ9CjwjIENvbXBhdGliaWxpdHkgY2hlY2sgZW5kcyAjPgpJZigkSXNEb21haW4pCnsKCXRyeXsKCQkJJHN5c2luZm8gPSBHZXQtV21pT2JqZWN0IC1DbGFzcyBXaW4zMl9Db21wdXRlclN5c3RlbQoJfWNhdGNoeyBXcml0ZS1FcnJvciAiVW5hYmxlIHRvIGNoZWNrIGlmIG1hY2hpbmUgaXMgaW4gRG9tYWluLiAgJF8uRXhjZXB0aW9uLm1lc3NhZ2UifQoJaWYoJHN5c2luZm8uZG9tYWluIC1lcSAiV09SS0dST1VQIikKCXsKCQkkT3V0cHV0TWVzc2FnZSArPSAiTWFjaGluZSBDb25uZWN0ZWQgaXMgbm90IGluIERvbWFpbiBFbnZpcm9ubWVudC4iCgkJV3JpdGUtT3V0cHV0ICRPdXRwdXRNZXNzYWdlCgkJZXhpdAoJfQoJZWxzZQoJewoJCSROYW1lU3RhdHVzID0gJFVzZXJJRC5Db250YWlucygiQCIpCgkJaWYoJE5hbWVTdGF0dXMgLWVxICR0cnVlKQoJCXsKCQkJJFByb3ZpZGVkTmFtZSwkUHJvdmlkZWREb21haW5OYW1lID0gJFVzZXJJRC5zcGxpdCgnQCcpCgkJCWlmKCRQcm92aWRlZERvbWFpbk5hbWUgLWVxICRzeXNpbmZvLkRvbWFpbikKCQkJewoJCQkJJFVzZXJJRCA9ICRQcm92aWRlZE5hbWUKCQkJfQoJCQllbHNlCgkJCXsKCQkJCSRPdXRwdXRNZXNzYWdlICs9ICJbTVNHOiBVc2VyIGFuZCBNYWNoaW5lIGJlbG9uZ3MgdG8gZGlmZmVyZW50IERvbWFpbi9TdWItRG9tYWluICwgVHJ5IFVzZXJJRCBvbmx5IHdpdGhvdXQgZG9tYWluIG5hbWVdIgoJCQkJV3JpdGUtT3V0cHV0ICRPdXRwdXRNZXNzYWdlCgkJCQlleGl0CgkJCX0KCQl9CgkJdHJ5eyAkREMgPSAoR2V0LVdtaU9iamVjdCBXaW4zMl9Db21wdXRlclN5c3RlbSkuZG9tYWlucm9sZQoJCX1jYXRjaHsgV3JpdGUtRXJyb3IgIlVuYWJsZSB0byBjaGVjayBpZiBtYWNoaW5lIGlzIERvbWFpbiBDb250cm9sbGVyLiAkXy5FeGNlcHRpb24ubWVzc2FnZSJ9CgkJaWYoJERDIC1lcSAiNCIgLW9yICREQyAtZXEgIjUiKQoJCXsKCQkJdHJ5eyBJbXBvcnQtTW9kdWxlIEFjdGl2ZURpcmVjdG9yeSAtRXJyb3JBY3Rpb24gU3RvcAoJCQl9Y2F0Y2h7IFdyaXRlLUVycm9yICJFcnJvciB3aGlsZSBpbXBvcnRpbmcgQUQgUG93ZXJzaGVsbCBtb2R1bGUuIENvbm5lY3QgdG8gb3RoZXIgREMuICRfLkV4Y2VwdGlvbi5tZXNzYWdlIn0KCQkJdHJ5ewkkQUR1c2VyID0gJG51bGwKCQkJCQkkQUR1c2VyID0gR2V0LUFEdXNlciAtaWRlbnRpdHkgJFVzZXJJRCAtcHJvcGVydGllcyBOYW1lLEFjY291bnRFeHBpcmF0aW9uRGF0ZSB8IFNlbGVjdCBOYW1lLEFjY291bnRFeHBpcmF0aW9uRGF0ZSAtRXJyb3JBY3Rpb24gU3RvcAoJCQl9Y2F0Y2ggW01pY3Jvc29mdC5BY3RpdmVEaXJlY3RvcnkuTWFuYWdlbWVudC5BRElkZW50aXR5Tm90Rm91bmRFeGNlcHRpb25dIHsgJE91dHB1dE1lc3NhZ2UgKz0gIltNU0c6IFVzZXIgRG9lc25vdCBleGlzdF0gRkFJTEVEIiB9CgkJCWNhdGNoeyBXcml0ZS1FcnJvciAiJF8uRXhjZXB0aW9uLm1lc3NhZ2UifQoJCQlpZigkQUR1c2VyKQoJCQl7CgkJCQl0cnl7CgkJCQkJU2V0LUFEdXNlciAtSWRlbnRpdHkgJFVzZXJJRCAtQWNjb3VudEV4cGlyYXRpb25EYXRlICRleHBpcmVpbnB1dAoJCQkJCSRBRHVzZXIgPSBHZXQtQUR1c2VyIC1pZGVudGl0eSAkVXNlcklEIC1wcm9wZXJ0aWVzIE5hbWUsU2FtQWNjb3VudE5hbWUsQWNjb3VudEV4cGlyYXRpb25EYXRlIHwgc2VsZWN0IE5hbWUsU2FtQWNjb3VudE5hbWUsQWNjb3VudEV4cGlyYXRpb25EYXRlIC1FcnJvckFjdGlvbiBTdG9wCgkJCQkJJE91dHB1dE1lc3NhZ2UgKz0gIkFjY291bnQgRXhwaXJhdGlvbiBEYXRlIGlzIGNvbmZpZ3VyZWQuIgoJCQkJCSRPdXRwdXRNZXNzYWdlICs9ICRBRHVzZXIgfGZsCgkJCQl9Y2F0Y2h7IFdyaXRlLUVycm9yICIkXy5FeGNlcHRpb24ubWVzc2FnZSJ9CgkJCX0KCQkJZWxzZQoJCQl7CgkJCQl0cnl7CgkJCQkJPCMgVXNlciBkb2Vzbm90IG1hdGNoLCBnZXQgdGhlIGxpc3Qgb2YgdXNlciBiYXNlZCBvbiBmaXJzdCBsZXR0ZXIgIz4KCQkJCQkkQUR1c2VyID0gJFVzZXJJRC5TdWJzdHJpbmcoMCwxKSsiKiIKCQkJCQkkRmlsdGVyU3RyaW5nRG9tYWluID0gIk5hbWUgLWxpa2UgJyRBRHVzZXInIgoJCQkJCSRBRFVzZXJMaXN0U2ltaWxhclR5cGUgPSBHZXQtQUR1c2VyIC1maWx0ZXIgJEZpbHRlclN0cmluZ0RvbWFpbiB8IFNlbGVjdCBOYW1lLFNhbUFjY291bnROYW1lLEVuYWJsZWQsQWNjb3VudEV4cGlyYXRpb25EYXRlLExvY2tlZE91dCxQYXNzd29yZEV4cGlyZWQgfGZsCgkJCQkJJE91dHB1dE1lc3NhZ2UgKz0gIkJlbG93IGFyZSB0aGUgbGlzdG9mIHVzZXJzIHN0YXJ0aW5nIHdpdGggTGV0dGVyIDoiKyRVc2VySUQuU3Vic3RyaW5nKDAsMSkKCQkJCQkkT3V0cHV0TWVzc2FnZSArPSAkQURVc2VyTGlzdFNpbWlsYXJUeXBlCgkJCQl9Y2F0Y2ggeyBXcml0ZS1FcnJvciAiVW5hYmxlIHRvIHB1bGwgdGhlIGxpc3Qgb2YgdXNlcnMgb2Ygc2ltaWxhciBuYW1lLiAkXy5FeGNlcHRpb24ubWVzc2FnZSJ9CQoJCQl9CQoJCX0KCQllbHNlCgkJewoJCQl0cnl7IDwjIENvbGxlY3QgbGlzdCBvZiBEQyBpbiB0aGUgZW52aXJvbm1lbnQgIz4KCQkJCSRDb21tYW5kID0gIm5sdGVzdCAvRFNHRVREQzoiKyAkc3lzaW5mby5kb21haW4KCQkJCSREQ0xpc3QgPSBJbnZva2UtZXhwcmVzc2lvbiAkQ29tbWFuZAoJCQkJaWYoJERDTGlzdCkKCQkJCXsKCQkJCQkkT3V0cHV0TWVzc2FnZSArPSAiTWFjaGluZSBpcyBlaXRoZXIgbm90IGNvbm5lY3RlZCB0byBEQyBvciBoYXZlIG5ldHdvcmsgaXNzdWUuIFBsZWFzZSBjb25uZWN0IHRvIHRoZSBtZW50aW9uZWQgTGlzdCIKCQkJCQkkT3V0cHV0TWVzc2FnZSArPSAkRENMaXN0IHxmbAoJCQkJfQoJCQkJZWxzZQoJCQkJewoJCQkJCSRPdXRwdXRNZXNzYWdlICs9ICJNYWNoaW5lIGlzIGVpdGhlciBub3QgY29ubmVjdGVkIHRvIERDIG9yIGhhdmUgbmV0d29yayBpc3N1ZS4gUGxlYXNlIGNvbm5lY3QgYWRtaW4gb3IgZXNjYWxhdGUuIgoJCQkJfQoJCQl9Y2F0Y2h7IFdyaXRlLUVycm9yICJVbmFibGUgdG8gcHVsbCB0aGUgbGlzdCBvZiBEb21haW4gQ29udHJvbGxlci4gJF8uRXhjZXB0aW9uLm1lc3NhZ2UifQoJCX0KCX0KfQplbHNlIDwjIElmIHByb3ZpZGVkIHVzZXIgaXMgYSBsb2NhbCB1c2VyICM+CnsKCTwjIElmICREQyBpcyA0IG1lYW5zIEJEQyBvciA1IG1lYW5zIFBEQyBhcyB0aGVyZSBpcyBubyBsb2NhbCB1c2VyIG9uIERvbWFpbiBDb250cm9sbGVyICM+Cgl0cnl7ICREQyA9IChHZXQtV21pT2JqZWN0IFdpbjMyX0NvbXB1dGVyU3lzdGVtKS5kb21haW5yb2xlCgl9Y2F0Y2h7IFdyaXRlLUVycm9yICJVbmFibGUgdG8gY2hlY2sgaWYgbWFjaGluZSBpcyBEb21haW4gQ29udHJvbGxlci4gJF8uRXhjZXB0aW9uLm1lc3NhZ2UiIH0KCWlmKCREQyAtZXEgIjQiIC1vciAkREMgLWVxICI1IikKCXsKCQkkT3V0cHV0TWVzc2FnZSArPSAiTm8gTG9jYWwgVXNlciBvbiBEb21haW4gQ29udHJvbGxlci4iCgl9CgllbHNlCgl7CgkJPCMgQ2hlY2sgaWYgVXNlciBFeGlzdCAjPgoJCXRyeXsKCQkJCSRGaWx0ZXJTdHJpbmdMb2NhbCA9ICJMb2NhbEFjY291bnQ9J1RydWUnIGFuZCBOYW1lID0gJyRVc2VySUQnIgoJCQkJJExvY2FsdXNlciA9IEdldC1XbWlPYmplY3QgLUNsYXNzIFdpbjMyX1VzZXJBY2NvdW50IC1GaWx0ZXIgJEZpbHRlclN0cmluZ0xvY2FsIHwgU2VsZWN0IE5hbWUsIFBTQ29tcHV0ZXJuYW1lLCBMb2NhbEFjY291bnQsIFN0YXR1cywgRGlzYWJsZWQsQWNjb3VudFR5cGUsIExvY2tvdXQsIFBhc3N3b3JkUmVxdWlyZWQsIFBhc3N3b3JkQ2hhbmdlYWJsZSxQYXNzd29yZEV4cGlyZXMsIFNJRAoJCX1jYXRjaHsgV3JpdGUtRXJyb3IgIlVuYWJsZSB0byBjaGVjayBMb2NhbCBVc2VyIGluZm9tcmF0aW9uLiAkXy5FeGNlcHRpb24ubWVzc2FnZSJ9CgkJaWYoJExvY2FsdXNlcikKCQl7CgkJCSR1c2VyYWNjb3VudGNvbm5lY3Rpb24gPSBbYWRzaV0iV2luTlQ6Ly8uLyRVc2VySUQsIHVzZXIiCgkJCSR1c2VyYWNjb3VudGNvbm5lY3Rpb24uUHV0KCJBY2NvdW50RXhwaXJhdGlvbkRhdGUiLCRleHBpcmVpbnB1dCkKCQkJJHVzZXJhY2NvdW50Y29ubmVjdGlvbi5TZXRJbmZvKCkKCQkJJHVzZXJhY2NvdW50Y29ubmVjdGlvbi5SZWZyZXNoQ2FjaGUoKQoJCQkkT3V0cHV0TWVzc2FnZSArPSAiVXBkYXRlZCBBY2NvdW50IEV4cGlyYXRpb24gRGF0ZSBpcyAiICsgJHVzZXJhY2NvdW50Y29ubmVjdGlvbi5BY2NvdW50RXhwaXJhdGlvbkRhdGUKCQl9CgkJZWxzZQoJCXsKCQkJdHJ5ewoJCQkJJEZpbHRlclN0cmluZ0xpc3QgPSAiTG9jYWxBY2NvdW50PSdUcnVlJyIKCQkJCSRMb2NhbHVzZXIgPSBHZXQtV21pT2JqZWN0IC1DbGFzcyBXaW4zMl9Vc2VyQWNjb3VudCAtRmlsdGVyICRGaWx0ZXJTdHJpbmdMaXN0IHwgU2VsZWN0IE5hbWUsRGlzYWJsZWQsTG9ja291dAoJCQkJJE91dHB1dE1lc3NhZ2UgKz0gIltNU0c6IFVzZXIgRG9lc25vdCBFeGlzdF0gRkFJTEVELCBCZWxvdyBhcmUgdGhlIGxpc3Qgb2YgdXNlcnMiCgkJCQlmb3IoJGk9MDskaSAtbHQgJExvY2FsdXNlci5sZW5ndGg7ICRpKyspCgkJCQl7CgkJCQkJJFRlbXBVc2VyID0gJExvY2FsdXNlclskaV0uTmFtZQoJCQkJCSR1c2VyYWNjb3VudGV4cGlyYXRpb24gPSBbYWRzaV0iV2luTlQ6Ly8uLyRUZW1wVXNlciwgdXNlciIgfCBTZWxlY3QgQWNjb3VudEV4cGlyYXRpb25EYXRlCgkJCQkJJE91dHB1dE1lc3NhZ2UgKz0gIk5hbWUgOiAiKyAkTG9jYWx1c2VyWyRpXS5OYW1lCgkJCQkJJE91dHB1dE1lc3NhZ2UgKz0gIkRpc2FibGVkOiAiKyAkTG9jYWx1c2VyWyRpXS5EaXNhYmxlZAoJCQkJCSRPdXRwdXRNZXNzYWdlICs9ICJMb2Nrb3V0IDogIisgJExvY2FsdXNlclskaV0uTG9ja291dAoJCQkJCSRPdXRwdXRNZXNzYWdlICs9ICJBY2NvdW50RXhwaXJhdGlvbkRhdGUgOiAiKyAkdXNlcmFjY291bnRleHBpcmF0aW9uLkFjY291bnRFeHBpcmF0aW9uRGF0ZQoJCQkJCSRPdXRwdXRNZXNzYWdlICs9ICIgIgoJCQkJfQoJCQl9Y2F0Y2h7V3JpdGUtRXJyb3IgIlVuYWJsZSB0byBnZXQgbGlzdCBvZiBsb2NhbCB1c2VyIGFjY291bnQuICRfLkV4cGlyYXRpb24ubWVzc2FnZSJ9CgkJfQoJfQp9CldyaXRlLU91dHB1dCAkT3V0cHV0TWVzc2FnZSB8ZmwK","jsonSchema":{"additionalProperties":false,"properties":{"IsDomain":{"title":"User belongs to Domain Account","type":"boolean"},"UserID":{"title":"User name","type":"string"},"expire":{"id":"expire","title":"Expires On","type":"string"}},"required":["UserID","expire"],"type":"object"},"uiSchema":{"IsDomain":{"classNames":"col-sm-6"},"UserID":{"classNames":"col-sm-12","ui:autofocus":true},"expire":{"classNames":"col-sm-6","ui:widget":"customDate","validationSchema":{"date":"expire","type":"dateShouldBeInFuture"}},"ui:order":["UserID","expire","IsDomain"]},"isHDScript":true}