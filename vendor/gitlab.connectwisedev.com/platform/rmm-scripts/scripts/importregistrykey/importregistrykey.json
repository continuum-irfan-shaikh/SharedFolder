{"id":"b12fa82c-44b5-11e9-b798-00155d130b01","partnerId":"00000000-0000-0000-0000-000000000000","category":["Maintenance"],"description":"Imports registry files","engine":"powershell","engineMaxVersion":5,"expectedExecutionTimeSec":300,"failureMessage":"Executed with errors","successMessage":"Success","internal":false,"name":"Import registry key","tags":["Windows 7","Windows 10"],"sequence":true,"content":"IyAkU291cmNldHlwZSA9ICdOZXR3b3JrJwojICRGaWxlcGF0aCA9ICJcXFNDUklQVC1XSU4ySzhSMlxQcmF0ZWVrXHByYXRlZWsucmVnLFxcU0NSSVBULVdJTjJLOFIyXFByYXRlZWtcUHJhdGVlay5yZWciCiMgJFVzZXJOYW1lID0gJ1ByYXRlZWsnCiMgJFBhc3N3b3JkID0gJ3Rlc3RAMTIzJwoKJEVycm9yQWN0aW9uUHJlZmVyZW5jZSA9ICdTdG9wJwokRmlsZXBhdGggPSAkRmlsZXBhdGggLXNwbGl0ICIsIiB8IGZvcmVhY2ggeyAkXy50cmltKCkgfQoKRm9yRWFjaCAoJEZpbGUgaW4gJEZpbGVwYXRoKSB7CiAgICB0cnkgewogICAgICAgICRQYXRoID0gJycKICAgICAgICBpZiAoJEZpbGUgLW5vdGxpa2UgIioucmVnIikgewogICAgICAgICAgICBXcml0ZS1FcnJvciAiRmlsZSBwcm92aWRlZDpgJyRGaWxlYCcgZG9lc24ndCBoYXZlICcucmVnJyBleHRlbnNpb24uIFBsZWFzZSB2ZXJpZnkgaXQgaXMgdmFsaWQgcmVnaXN0cnkgZmlsZSBuYW1lLiIKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgaWYgKCRTb3VyY2V0eXBlIC1lcSAnTmV0d29yaycgLWFuZCAhKFt1cmldJGZpbGUpLklzVW5jKSB7CiAgICAgICAgICAgIFdyaXRlLUVycm9yICJTb3VyY2UgVHlwZTogYCckU291cmNlVHlwZWAnIGJ1dCBgJyRGaWxlYCcgaXMgYSAnbG9jYWwnIHBhdGguIFBsZWFzZSBwcm92aWRlIGAnJFNvdXJjZVR5cGUnYCBwYXRocyBvbmx5LiIgLUVycm9yQWN0aW9uIFN0b3AKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgaWYgKCRTb3VyY2V0eXBlIC1lcSAnTG9jYWwnIC1hbmQgKFt1cmldJGZpbGUpLklzVW5jKSB7CiAgICAgICAgICAgIFdyaXRlLUVycm9yICJTb3VyY2UgVHlwZTogYCckU291cmNlVHlwZWAnIGJ1dCBgJyRGaWxlYCcgaXMgYSAnTmV0d29yaycgUGF0aC4gUGxlYXNlIHByb3ZpZGUgYCckU291cmNlVHlwZSdgIHBhdGhzIG9ubHkuIiAtRXJyb3JBY3Rpb24gU3RvcAogICAgICAgIH0KCiAgICAgICAgU3dpdGNoICgoW3VyaV0kRmlsZSkuSXNVbmMpIHsKICAgICAgICAgICAgJGZhbHNlIHsgCiAgICAgICAgICAgICAgICAkUGF0aCA9ICRGaWxlIAogICAgICAgICAgICAgICAgaWYgKFRlc3QtUGF0aCAkUGF0aCkgewogICAgICAgICAgICAgICAgICAgICRQcm9jZXNzID0gU3RhcnQtUHJvY2VzcyAtRmlsZVBhdGggIiRFbnY6U3lzdGVtUm9vdFxSRUdFRElULmV4ZSIgLUFyZ3VtZW50TGlzdCAnL3MnLCAkUGF0aCAtVmVyYiAnUnVuQXMnIC1QYXNzVGhydSAtV2FpdAogICAgICAgICAgICAgICAgICAgIElmICgkUHJvY2Vzcy5FeGl0Q29kZSAtZXEgMCkgeyBXcml0ZS1PdXRwdXQgIlJlZ2lzdHJ5IGltcG9ydCBzdWNjZXNzZnVsLiBGaWxlIFBhdGg6ICRGaWxlIiB9CiAgICAgICAgICAgICAgICAgICAgRWxzZSB7IFdyaXRlLU91dHB1dCAiWyRGaWxlXSBSZWdpc3RyeSBpbXBvcnQgZmFpbGVkIHdpdGggRXhpdCBjb2RlOiAkKCRQcm9jZXNzLkV4aXRDb2RlKS4gU291cmNlIFBhdGg6JEZpbGUiIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgIFdyaXRlLU91dHB1dCAiRmlsZTogJFBhdGggZG9lc24ndCBleGlzdC4iCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBCcmVhazsKICAgICAgICAgICAgfQogICAgICAgICAgICAkVHJ1ZSB7CiAgICAgICAgICAgICAgICAkRGlyZWN0b3J5ID0gW1N5c3RlbS5JTy5QYXRoXTo6R2V0RGlyZWN0b3J5TmFtZSgkRmlsZSkKICAgICAgICAgICAgICAgICRMZWFmID0gW1N5c3RlbS5JTy5QYXRoXTo6R2V0RmlsZU5hbWUoJEZpbGUpCiAgICAgICAgICAgICAgICAkUGF0aCA9ICIkZW52OlRFTVBccmVnaXN0cnkucmVnIgogICAgICAgICAgICAgICAgJERyaXZlTGV0dGVyID0gR2V0LUNoaWxkSXRlbSBmdW5jdGlvbjpbZy16XTogLW4gfCBXaGVyZS1PYmplY3QgeyAhKHRlc3QtcGF0aCAkXykgfSB8IHJhbmRvbQogICAgICAgICAgICAgICAgJE5ldCA9IE5ldy1PYmplY3QgLUNvbU9iamVjdCBXU2NyaXB0Lk5ldHdvcmsKICAgICAgICAgICAgICAgICROZXQuTWFwTmV0d29ya0RyaXZlKCREcml2ZUxldHRlciwgIiREaXJlY3RvcnkiLCAkZmFsc2UsICRVc2VyTmFtZSwgJFBhc3N3b3JkKSAKICAgICAgICAgICAgICAgIFN0YXJ0LVNsZWVwIC1zIDQKICAgICAgICAgICAgICAgIElmIChUZXN0LVBhdGggIiREcml2ZUxldHRlclwiKSB7CiAgICAgICAgICAgICAgICAgICAgQ29weS1JdGVtICIkRHJpdmVMZXR0ZXJcJExlYWYiICRQYXRoCiAgICAgICAgICAgICAgICAgICAgaWYgKFRlc3QtUGF0aCAkUGF0aCkgewogICAgICAgICAgICAgICAgICAgICAgICAkUHJvY2VzcyA9IFN0YXJ0LVByb2Nlc3MgLUZpbGVQYXRoICIkRW52OlN5c3RlbVJvb3RcUkVHRURJVC5leGUiIC1Bcmd1bWVudExpc3QgJy9zJywgJFBhdGggLVZlcmIgJ1J1bkFzJyAtUGFzc1RocnUgLVdhaXQKICAgICAgICAgICAgICAgICAgICAgICAgSWYgKCRQcm9jZXNzLkV4aXRDb2RlIC1lcSAwKSB7IFdyaXRlLU91dHB1dCAiUmVnaXN0cnkgaW1wb3J0IHN1Y2Nlc3NmdWwuIEZpbGUgUGF0aDogJEZpbGUiIH0KICAgICAgICAgICAgICAgICAgICAgICAgRWxzZSB7IFdyaXRlLU91dHB1dCAiWyRGaWxlXSBSZWdpc3RyeSBpbXBvcnQgZmFpbGVkIHdpdGggRXhpdCBjb2RlOiAkKCRQcm9jZXNzLkV4aXRDb2RlKS4gRmlsZSBQYXRoOiAkRmlsZSIgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgV3JpdGUtT3V0cHV0ICJVbmFibGUgdG8gY29weSBmaWxlOiAkRmlsZSB0byBsb2NhbCBzeXN0ZW0uIgogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgIFdyaXRlLU91dHB1dCAiVW5hYmxlIHRvIG1hcCBuZXR3b3JrIGxvY2F0aW9uOiAkRmlsZSB0byBsb2NhbCBzeXN0ZW0uIgogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgQnJlYWs7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICRudWxsIHsKICAgICAgICAgICAgICAgIFdyaXRlLUVycm9yICJgJyRGaWxlYCcgaXMgbm90IGEgdmFsaWQgUGF0aCIKICAgICAgICAgICAgICAgIEJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQogICAgY2F0Y2ggewogICAgICAgIFdyaXRlLUVycm9yICRfCiAgICB9Cn0K","jsonSchema":{"type":"object","properties":{"sourceType":{"type":"string","title":"File Source","enum":["local","network"],"enumNames":["Local","Network"]},"filePath":{"type":"string","title":"Registry file path"}},"patternProperties":{"^userName$":{},"^password$":{}},"additionalProperties":false,"required":["sourceType","filePath"],"dependencies":{"sourceType":{"oneOf":[{"properties":{"sourceType":{"enum":["network"]},"userName":{"type":"string","title":"User Name"},"password":{"type":"string","title":"Password"}},"required":["userName","password"]},{"properties":{"sourceType":{"enum":["local"]}}}]}}},"uiSchema":{"sourceType":{"classNames":"col-sm-6","ui:autofocus":true,"ui:placeholder":"Select source type"},"filePath":{"classNames":"col-sm-6","ui:help":"Input file path local or network. For multiple path separate by comma(,)."},"userName":{"classNames":"col-sm-6","validationSchema":{"type":"requiredFieldsIfNotEmpty","notEmpty":"userName","required":["password"]}},"password":{"classNames":"col-sm-6","ui:widget":"password"},"ui:order":["sourceType","filePath","userName","password"]},"isHDScript":false}
