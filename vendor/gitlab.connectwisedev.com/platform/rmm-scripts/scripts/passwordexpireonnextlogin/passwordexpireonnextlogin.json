{"id":"db5b588f-a7b9-11e9-8bb0-00155d130b01","partnerId":"00000000-0000-0000-0000-000000000000","category":["Management"],"description":"Expires user password upon next login. The task will not expire password for disabled user accounts.","engine":"powershell","engineMaxVersion":5,"expectedExecutionTimeSec":300,"failureMessage":"Executed with errors","successMessage":"Executed successfully","internal":false,"name":"Expire user password upon next login","tags":["Windows 7","Windows 10"],"sequence":true,"content":"IyAkVGFyZ2V0ID0gJ2RvbWFpbicgIyBTVFJJTkcKIyAkVXNlcnMgPSBAIiAjIE1VTFRJTElORSBTVFJJTkcKIyB0ZXN0MTAwCiMgIHRlc3QyMDAwc2QKIyB0ZXN0MzAwc2QKIyB0ZXN0NDAwCiMgIkAKCiMgJFRhcmdldCA9ICdsb2NhbCcKIyAkVXNlcnMgPSBAIgojIHRlc3QxMDAKIyAgdGVzdDIwMAojIHRlc3QzMDAKIyB0ZXN0NDAwCiMgIkAKCgppZiAoJGVudjpQUk9DRVNTT1JfQVJDSElURVc2NDMyIC1lcSAiQU1ENjQiKSB7CiAgICBpZiAoJG15SW52b2NhdGlvbi5MaW5lKSB7CiAgICAgICAgJiIkZW52OnN5c3RlbXJvb3Rcc3lzbmF0aXZlXHdpbmRvd3Nwb3dlcnNoZWxsXHYxLjBccG93ZXJzaGVsbC5leGUiIC1Ob25JbnRlcmFjdGl2ZSAtTm9Qcm9maWxlICRteUludm9jYXRpb24uTGluZQogICAgfQogICAgZWxzZSB7CiAgICAgICAgJiIkZW52OnN5c3RlbXJvb3Rcc3lzbmF0aXZlXHdpbmRvd3Nwb3dlcnNoZWxsXHYxLjBccG93ZXJzaGVsbC5leGUiIC1Ob25JbnRlcmFjdGl2ZSAtTm9Qcm9maWxlIC1maWxlICIkKCRteUludm9jYXRpb24uSW52b2NhdGlvbk5hbWUpIiAkYXJncwogICAgfQogICAgZXhpdCAkbGFzdGV4aXRjb2RlCn0KCiRFcnJvckFjdGlvblByZWZlcmVuY2UgPSAnU3RvcCcKdHJ5IHsKCiAgICAkVXNlcnMgPSAkVXNlcnMgLXNwbGl0ICJgbiIgfCBXaGVyZS1PYmplY3QgeyAhW3N0cmluZ106OklzTnVsbE9yV2hpdGVTcGFjZSgkXy50cmltKCkpfQogICAgJFN5c3RlbVJvbGUgPSAoR2V0LVdtaU9iamVjdCAtQ2xhc3MgV2luMzJfQ29tcHV0ZXJTeXN0ZW0pLkRvbWFpblJvbGUKICAgIAogICAgc3dpdGNoICgkVGFyZ2V0KSB7CiAgICAgICAgJ2xvY2FsJyB7CiAgICAgICAgICAgIGlmICg0LCA1IC1jb250YWlucyAkU3lzdGVtUm9sZSkgewogICAgICAgICAgICAgICAgV3JpdGUtT3V0cHV0ICJTY3JpcHQgY2FuIG5vdCBydW4gb24gYSBEb21haW4gQ29udHJvbGxlci4gUGxlYXNlIGNob29zZSBhIExvY2FsIG1hY2hpbmUgYW5kIHJldHJ5LiIKICAgICAgICAgICAgICAgIEJyZWFrCiAgICAgICAgICAgIH0KICAgICAgICAgICAgCiAgICAgICAgICAgIEZvckVhY2ggKCRVc2VyIGluICRVc2VycykgewogICAgICAgICAgICAgICAgJE9iaiA9IEdldC1XbWlPYmplY3QgLUNsYXNzIFdpbjMyX1VzZXJBY2NvdW50IC1GaWx0ZXIgIkxvY2FsQWNjb3VudD0nVHJ1ZScgQU5EIE5hbWU9JyRVc2VyJyIKICAgICAgICAgICAgICAgIGlmICgkT2JqKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKCEkb2JqLmRpc2FibGVkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkT2JqLlBhc3N3b3JkRXhwaXJlcyAtZXEgJGZhbHNlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkT2JqLlBhc3N3b3JkRXhwaXJlcyA9ICR0cnVlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkT2JqLlB1dCgpIHwgT3V0LU51bGwKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAkRXJyb3JBY3Rpb25QcmVmZXJlbmNlID0gJ1NpbGVudGx5Q29udGludWUnCiAgICAgICAgICAgICAgICAgICAgICAgICRyZXN1bHQgPSBuZXQgdXNlciAkVXNlciAvbG9nb25wYXNzd29yZGNoZzp5ZXMgMj4mMQogICAgICAgICAgICAgICAgICAgICAgICAkRXJyb3JBY3Rpb25QcmVmZXJlbmNlID0gJ1N0b3AnCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkcmVzdWx0IC1saWtlICIqU3VjY2VzcyoiKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBXcml0ZS1PdXRwdXQgIiRVc2VyIDogUGFzc3dvcmQgZXhwaXJlZCBzdWNjZXNmdWxseS4iCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBXcml0ZS1PdXRwdXQgIiRVc2VyIDogRmFpbGVkIHRvIGV4cGlyZSB0aGUgcGFzc3dvcmQuIiAgIAogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICBXcml0ZS1PdXRwdXQgIiRVc2VyIDogVXNlciBpcyBkaXNhYmxlZC4iIAogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgIFdyaXRlLU91dHB1dCAiJFVzZXIgOiBUaGUgdXNlciBuYW1lIGNvdWxkIG5vdCBiZSBmb3VuZC4iICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIAogICAgICAgICdkb21haW4nIHsKICAgICAgICAgICAgaWYgKDAuLjMgLWNvbnRhaW5zICRTeXN0ZW1Sb2xlKSB7CiAgICAgICAgICAgICAgICBXcml0ZS1PdXRwdXQgIlNjcmlwdCBjYW4gbm90IHJ1biBvbiBhIExvY2FsIE1hY2hpbmUuIFBsZWFzZSBjaG9vc2UgYSBEb21haW4gY29udHJvbGxlciBhbmQgcmV0cnkuIgogICAgICAgICAgICAgICAgQnJlYWsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgSW1wb3J0LU1vZHVsZSBBY3RpdmVEaXJlY3RvcnkKCiAgICAgICAgICAgIEZvcmVhY2ggKCRVc2VyIGluICRVc2VycykgewogICAgICAgICAgICAgICAgJE9iaiA9IEdldC1BRFVzZXIgLUZpbHRlciB7IG5hbWUgLWVxICRVc2VyIH0gLVByb3BlcnRpZXMgUGFzc3dvcmRFeHBpcmVkIC1lcnJvcmFjdGlvbiBzaWxlbnRseWNvbnRpbnVlCiAgICAgICAgICAgICAgICBpZiAoJG9iaikgewogICAgICAgICAgICAgICAgICAgIGlmICgkb2JqLkVuYWJsZWQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgU2V0LUFEVXNlciAkT2JqIC1DaGFuZ2VQYXNzd29yZEF0TG9nb24gJHRydWUgLVBhc3N3b3JkTmV2ZXJFeHBpcmVzICRmYWxzZSAtRXJyb3JBY3Rpb24gU2lsZW50bHljb250aW51ZQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoKEdldC1BRFVzZXIgJE9iaiAtUHJvcGVydGllcyBQYXNzd29yZEV4cGlyZWQpLlBhc3N3b3JkRXhwaXJlZCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgV3JpdGUtT3V0cHV0ICIkVXNlciA6IFBhc3N3b3JkIGV4cGlyZWQgc3VjY2VzZnVsbHkuIiAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBXcml0ZS1PdXRwdXQgIiRVc2VyIDogRmFpbGVkIHRvIGV4cGlyZSB0aGUgcGFzc3dvcmQuIiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgV3JpdGUtT3V0cHV0ICIkVXNlciA6IFVzZXIgaXMgZGlzYWJsZWQuIiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBXcml0ZS1PdXRwdXQgIiRVc2VyIDogVGhlIHVzZXIgbmFtZSBjb3VsZCBub3QgYmUgZm91bmQuIiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICB9Cn0KY2F0Y2ggewogICAgV3JpdGUtRXJyb3IgJCgkXy5leGNlcHRpb24ubWVzc2FnZSkKfQo=","jsonSchema":{"additionalproperties":false,"properties":{"Target":{"enum":["Local","Domain"],"title":"User Account Type","type":"string"},"Users":{"title":"User Accounts","type":"string"}},"required":["Target","Users"],"type":"object"},"uiSchema":{"Target":{"classNames":"col-sm-12","ui:autofocus":true,"ui:options":{"inline":true},"ui:widget":"radio"},"Users":{"classNames":"col-sm-6","convertToCommaSeparated":true,"ui:autofocus":true,"ui:help":"Enter User(s) name separated by new line.","ui:options":{"rows":5},"ui:widget":"textarea"},"ui:order":["Target","Users"]},"isHDScript":false}