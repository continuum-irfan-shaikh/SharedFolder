{"id":"621fe53c-4124-11ea-9d48-00155d130b01","partnerId":"00000000-0000-0000-0000-000000000000","category":["Green Computing"],"description":"Configure parameters and perform On Demand Shutdown.","engine":"powershell","engineMaxVersion":5,"expectedExecutionTimeSec":3600,"failureMessage":"Executed with errors","successMessage":"Executed successfully","internal":false,"name":"Configure on-demand shutdown (new)","tags":["Windows 7","Windows 10"],"sequence":true,"content":"PCMKCiAgICAuTmFtZQogICAgQ29uZmlndXJlIE9uIGRlbWFuZCBzaHV0ZG93bgogICAgCiAgICAuRGVzY3JpcHRpb24KICAgICAgICAxKVNjcmlwdCB3aWxsIEFzay9Ob3RpZnkgbG9nZ2VkSW4gdXNlciBmb3IgaW5pdGlhdGluZyBzaHV0ZG93bi4KICAgICAgICAyKVVzZXIgY2FuIHNldCBjcml0ZXJpYSB0byBzaHV0ZG93biB0aGUgbWFjaGluZSAKICAgICAgICAzKVVzZXIgY2FuIFBhc3MgQ29tbWFuZCBvciBQcm9jZXNzIHRvIGV4ZWN1dGUgYmVmb3JlIGluaXRpYXRpbmcgc2h1dGRvd24gaWYgY3JpdGVyaWEgZG9lc24ndCBtZXQuCiAgICAgICAgNClVc2VyIGNhbiBEZW55IHNodXRkb3duIGlmIENyaXRlcmEgZG9lc24ndCBtZXQuCiAgICAKICAgIC5SZXF1aXJlbWVudHMKICAgICAgICAxKVNjcmlwdCBzaG91bGQgcnVuIGluIHVzZXIgY29udGV4dC4KICAgICAgICAyKVNjcmlwdCB3aWxsIHJ1biBvbmx5IHdoZW4gdXNlciBpcyBsb2dnZWRJbiB0byB0aGUgc3lzdGVtLgogICAgICAgIDMpTG9nZ2VkSW4gdXNlciBzaG91bGQgaGF2ZSBwZXJtaXNzaW9uIHRvIHNodXRkb3duIHRoZSBNYWNoaW5lLgoKICAgIC5BdXRob3IKICAgICAgICBOaXJhdiBTYWNob3JhCgoKIz4KCjwjCgokSWZVc2VySXNMb2dnZWRPbgokQWRkUHJvY2VzcwokcHJvY2Vzc25hbWUKJGFjdGlvbgokQWRkQ21kUHJvY2VzcwokY29tbWFuZAojJHByb2Nlc3MKIyRwYXJhbWV0ZXIKJGRpc3BsYXltc2cKJFNodXRkb3duVGltZW91dAojJEFsbG93CgojPgoKaWYgKCRlbnY6UFJPQ0VTU09SX0FSQ0hJVEVXNjQzMiAtZXEgIkFNRDY0IikgewogICAgaWYgKCRteUludm9jYXRpb24uTGluZSkgewogICAgICAgICYiJGVudjpzeXN0ZW1yb290XHN5c25hdGl2ZVx3aW5kb3dzcG93ZXJzaGVsbFx2MS4wXHBvd2Vyc2hlbGwuZXhlIiAtTm9uSW50ZXJhY3RpdmUgLU5vUHJvZmlsZSAkbXlJbnZvY2F0aW9uLkxpbmUKICAgIH0KICAgIGVsc2UgewogICAgICAgICYiJGVudjpzeXN0ZW1yb290XHN5c25hdGl2ZVx3aW5kb3dzcG93ZXJzaGVsbFx2MS4wXHBvd2Vyc2hlbGwuZXhlIiAtTm9uSW50ZXJhY3RpdmUgLU5vUHJvZmlsZSAtZmlsZSAiJCgkbXlJbnZvY2F0aW9uLkludm9jYXRpb25OYW1lKSIgJGFyZ3MKICAgIH0KICAgIGV4aXQgJGxhc3RleGl0Y29kZQp9CgpGdW5jdGlvbiBNYWluIHsKICAgIEFkZC1UeXBlIC1Bc3NlbWJseU5hbWUgU3lzdGVtLldpbmRvd3MuRm9ybXMKICAgIEFkZC1UeXBlIC1Bc3NlbWJseU5hbWUgU3lzdGVtLkRyYXdpbmcKICAgICMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyAgCiAgICBpZiAoJElmVXNlcklzTG9nZ2VkT24gLWVxICJBc2sgdGhlIHVzZXIgZm9yIGNvbmZpcm1hdGlvbiBiZWZvcmUgaW5pdGlhdGluZyBTaHV0ZG93biIpIHsKICAgICAgICBBZGQtVHlwZSAtQXNzZW1ibHlOYW1lIFN5c3RlbS5XaW5kb3dzLkZvcm1zCiAgICAgICAgW1N5c3RlbS5XaW5kb3dzLkZvcm1zLkFwcGxpY2F0aW9uXTo6RW5hYmxlVmlzdWFsU3R5bGVzKCkKCiAgICAgICAgRnVuY3Rpb24gQXV0b19DbG9zZSB7CiAgICAgICAgICAgICRUaW1lci5TdG9wKCk7IAogICAgICAgICAgICAkRm9ybS5DbG9zZSgpOyAKICAgICAgICAgICAgJEZvcm0uRGlzcG9zZSgpOwogICAgICAgICAgICAkVGltZXIuRGlzcG9zZSgpOwogICAgICAgICAgICAme3NodXRkb3duIC9zIC9mIC90IDE1fQogICAgICAgIH0KCiAgICAgICAgRnVuY3Rpb24gVGltZXJfVGljayB7CiAgICAgICAgICAgICRMYWJlbDMuVGV4dCA9ICJDb25maXJtIFNodXRkb3duIGluICRTY3JpcHQ6Q291bnREb3duIHNlY29uZHMiCiAgICAgICAgICAgIC0tJFNjcmlwdDpDb3VudERvd24KICAgICAgICAgICAgaWYgKCRTY3JpcHQ6Q291bnREb3duIC1sdCAwKSB7CiAgICAgICAgICAgICAgICBBdXRvX0Nsb3NlCiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgICRmb3JtID0gTmV3LU9iamVjdCBzeXN0ZW0uV2luZG93cy5Gb3Jtcy5Gb3JtCiAgICAgICAgJGZvcm0uQ2xpZW50U2l6ZSA9ICc1NDYsMjM3JwogICAgICAgICRmb3JtLnRleHQgPSAiU2h1dGRvd24gTWFuYWdlciIKICAgICAgICAkZm9ybS5Ub3BNb3N0ID0gJGZhbHNlCiAgICAgICAgJGZvcm0uU3RhcnRQb3NpdGlvbiA9ICJDZW50ZXJTY3JlZW4iCgogICAgICAgICRCdXR0b24xID0gTmV3LU9iamVjdCBzeXN0ZW0uV2luZG93cy5Gb3Jtcy5CdXR0b24KICAgICAgICAkQnV0dG9uMS5CYWNrQ29sb3IgPSAiIzliOWI5YiIKICAgICAgICAkQnV0dG9uMS50ZXh0ID0gIlNodXRkb3duIExhdGVyIgogICAgICAgICRCdXR0b24xLndpZHRoID0gMTMxCiAgICAgICAgJEJ1dHRvbjEuaGVpZ2h0ID0gMzkKICAgICAgICAkQnV0dG9uMS5sb2NhdGlvbiA9IE5ldy1PYmplY3QgU3lzdGVtLkRyYXdpbmcuUG9pbnQoMzU1LCA4NSkKICAgICAgICAkQnV0dG9uMS5Gb250ID0gJ01pY3Jvc29mdCBTYW5zIFNlcmlmLDEwJwogICAgICAgICRCdXR0b24xLkRpYWxvZ1Jlc3VsdCA9IDEKCiAgICAgICAgJEJ1dHRvbjIgPSBOZXctT2JqZWN0IHN5c3RlbS5XaW5kb3dzLkZvcm1zLkJ1dHRvbgogICAgICAgICRCdXR0b24yLkJhY2tDb2xvciA9ICIjOWI5YjliIgogICAgICAgICRCdXR0b24yLnRleHQgPSAiU2h1dGRvd24gTm93IgogICAgICAgICRCdXR0b24yLndpZHRoID0gMTIzCiAgICAgICAgJEJ1dHRvbjIuaGVpZ2h0ID0gNDAKICAgICAgICAkQnV0dG9uMi5sb2NhdGlvbiA9IE5ldy1PYmplY3QgU3lzdGVtLkRyYXdpbmcuUG9pbnQoMjQxLCAxNzMpCiAgICAgICAgJEJ1dHRvbjIuRm9udCA9ICdNaWNyb3NvZnQgU2FucyBTZXJpZiwxMCcKICAgICAgICAkQnV0dG9uMi5EaWFsb2dSZXN1bHQgPSA2CgogICAgICAgICRCdXR0b24zID0gTmV3LU9iamVjdCBzeXN0ZW0uV2luZG93cy5Gb3Jtcy5CdXR0b24KICAgICAgICAkQnV0dG9uMy5CYWNrQ29sb3IgPSAiIzliOWI5YiIKICAgICAgICAkQnV0dG9uMy50ZXh0ID0gIkFib3J0IgogICAgICAgICRCdXR0b24zLndpZHRoID0gMTIxCiAgICAgICAgJEJ1dHRvbjMuaGVpZ2h0ID0gMzkKICAgICAgICAkQnV0dG9uMy5sb2NhdGlvbiA9IE5ldy1PYmplY3QgU3lzdGVtLkRyYXdpbmcuUG9pbnQoMzkzLCAxNzMpCiAgICAgICAgJEJ1dHRvbjMuRm9udCA9ICdNaWNyb3NvZnQgU2FucyBTZXJpZiwxMCcKICAgICAgICAkQnV0dG9uMy5EaWFsb2dSZXN1bHQgPSA3CgogICAgICAgICRMYWJlbDEgPSBOZXctT2JqZWN0IHN5c3RlbS5XaW5kb3dzLkZvcm1zLkxhYmVsCiAgICAgICAgJExhYmVsMS50ZXh0ID0gIlNlbGVjdCBQb3N0cG9uZSBmb3IiCiAgICAgICAgJExhYmVsMS5BdXRvU2l6ZSA9ICR0cnVlCiAgICAgICAgJExhYmVsMS53aWR0aCA9IDI1CiAgICAgICAgJExhYmVsMS5oZWlnaHQgPSAxMAogICAgICAgICRMYWJlbDEubG9jYXRpb24gPSBOZXctT2JqZWN0IFN5c3RlbS5EcmF3aW5nLlBvaW50KDI2LCA5MCkKICAgICAgICAkTGFiZWwxLkZvbnQgPSAnTWljcm9zb2Z0IFNhbnMgU2VyaWYsMTAnCgogICAgICAgICRMYWJlbDIgPSBOZXctT2JqZWN0IHN5c3RlbS5XaW5kb3dzLkZvcm1zLkxhYmVsCiAgICAgICAgJExhYmVsMi5BdXRvU2l6ZSA9ICR0cnVlCiAgICAgICAgJExhYmVsMi53aWR0aCA9IDI1CiAgICAgICAgJExhYmVsMi5oZWlnaHQgPSAxMAogICAgICAgICRMYWJlbDIubG9jYXRpb24gPSBOZXctT2JqZWN0IFN5c3RlbS5EcmF3aW5nLlBvaW50KDEwLCAyMCkKICAgICAgICAkTGFiZWwyLkZvbnQgPSAnTWljcm9zb2Z0IFNhbnMgU2VyaWYsMTAnCgogICAgICAgICRMYWJlbDMgPSBOZXctT2JqZWN0IHN5c3RlbS5XaW5kb3dzLkZvcm1zLkxhYmVsCiAgICAgICAgJExhYmVsMy50ZXh0ID0gIkNvbmZpcm0gc2h1dGRvd24gaW4gIgogICAgICAgICRMYWJlbDMuQXV0b1NpemUgPSAkdHJ1ZQogICAgICAgICRMYWJlbDMud2lkdGggPSAyNQogICAgICAgICRMYWJlbDMuaGVpZ2h0ID0gMTAKICAgICAgICAkTGFiZWwzLmxvY2F0aW9uID0gTmV3LU9iamVjdCBTeXN0ZW0uRHJhd2luZy5Qb2ludCgyMSwgMjEpCiAgICAgICAgJExhYmVsMy5Gb250ID0gJ01pY3Jvc29mdCBTYW5zIFNlcmlmLDEwJwoKICAgICAgICAkTGFiZWw0ID0gTmV3LU9iamVjdCBzeXN0ZW0uV2luZG93cy5Gb3Jtcy5MYWJlbAogICAgICAgICRMYWJlbDQuQXV0b1NpemUgPSAkdHJ1ZQogICAgICAgICRMYWJlbDQud2lkdGggPSAyNQogICAgICAgICRMYWJlbDQuaGVpZ2h0ID0gMTAKICAgICAgICAkTGFiZWw0LmxvY2F0aW9uID0gTmV3LU9iamVjdCBTeXN0ZW0uRHJhd2luZy5Qb2ludCgyMTMsIDIwKQogICAgICAgICRMYWJlbDQuRm9udCA9ICdNaWNyb3NvZnQgU2FucyBTZXJpZiwxMCcKICAgICAgICAKICAgICAgICAkTGFiZWw1ID0gTmV3LU9iamVjdCBzeXN0ZW0uV2luZG93cy5Gb3Jtcy5MYWJlbAogICAgICAgICRMYWJlbDUuQXV0b1NpemUgPSAkdHJ1ZQogICAgICAgICRMYWJlbDUud2lkdGggPSA1MDAKICAgICAgICAkTGFiZWw1LmhlaWdodCA9IDEwCiAgICAgICAgJExhYmVsNS5UZXh0ID0gJGRpc3BsYXltc2cKICAgICAgICAkTGFiZWw1LmxvY2F0aW9uID0gTmV3LU9iamVjdCBTeXN0ZW0uRHJhd2luZy5Qb2ludCgyMSwgNDUpCiAgICAgICAgJExhYmVsNS5Gb250ID0gJ01pY3Jvc29mdCBTYW5zIFNlcmlmLDEwJwoKICAgICAgICAkU2VsZWN0T25lID0gTmV3LU9iamVjdCBzeXN0ZW0uV2luZG93cy5Gb3Jtcy5Db21ib0JveAogICAgICAgICRTZWxlY3RPbmUudGV4dCA9ICJTZWxlY3QgT25lIgogICAgICAgICRTZWxlY3RPbmUud2lkdGggPSAxMDUKICAgICAgICAkU2VsZWN0T25lLmhlaWdodCA9IDIyCiAgICAgICAgQCgnMTUgTWludXRlcycsICczMCBNaW51dGVzJywgJzYwIE1pbnV0ZXMnKSB8IEZvckVhY2gtT2JqZWN0IHsgW3ZvaWRdICRTZWxlY3RPbmUuSXRlbXMuQWRkKCRfKSB9CiAgICAgICAgJFNlbGVjdE9uZS5sb2NhdGlvbiA9IE5ldy1PYmplY3QgU3lzdGVtLkRyYXdpbmcuUG9pbnQoMTU4LCA4OSkKICAgICAgICAkU2VsZWN0T25lLkZvbnQgPSAnTWljcm9zb2Z0IFNhbnMgU2VyaWYsMTAnCgogICAgICAgICRTY3JpcHQ6Y291bnRkb3duID0gJFNodXRkb3duVGltZW91dAogICAgICAgICRGb3JtLmNvbnRyb2xzLkFkZFJhbmdlKEAoJEJ1dHRvbjEsICRCdXR0b24yLCAkQnV0dG9uMywgJExhYmVsMSwgJExhYmVsMiwgJExhYmVsMywgJExhYmVsNCwgJFNlbGVjdE9uZSwkTGFiZWw1KSkKICAgICAgICAKICAgICAgICAkVGltZXIgPSBOZXctT2JqZWN0IFN5c3RlbS5XaW5kb3dzLkZvcm1zLlRpbWVyCiAgICAgICAgJFRpbWVyLkludGVydmFsID0gMTAwMAogICAgICAgICRCdXR0b24xLkFkZF9DbGljayggewogICAgICAgICAgICAgICAgJEdsb2JhbDpEZWxheXRpbWUgPSAwCiAgICAgICAgICAgICAgICBzd2l0Y2ggKCRTZWxlY3RPbmUudGV4dCkgewogICAgICAgICAgICAgICAgICAgICIxNSBNaW51dGVzIiB7c2h1dGRvd24gL3MgL2YgL3QgOTAwOyRHbG9iYWw6RGVsYXl0aW1lID0gMTV9CiAgICAgICAgICAgICAgICAgICAgIjMwIE1pbnV0ZXMiIHtzaHV0ZG93biAvcyAvZiAvdCAxODAwOyRHbG9iYWw6RGVsYXl0aW1lID0gMzB9CiAgICAgICAgICAgICAgICAgICAgIjYwIE1pbnV0ZXMiIHtzaHV0ZG93biAvcyAvZiAvdCAzNjAwOyRHbG9iYWw6RGVsYXl0aW1lID0gNjB9CiAgICAgICAgICAgICAgICAgICAgRGVmYXVsdCB7IFtTeXN0ZW0uV2luZG93cy5NZXNzYWdlQm94XTo6U2hvdygnUGxlYXNlIHNlbGVjdCBhbiBvcHRpb24gdG8gcG9zdHBvbmUgc2h1dGRvd24uJykgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KQogICAgICAgICAgICAKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAKICAgICAgICAkQnV0dG9uMi5BZGRfQ2xpY2soeyZ7c2h1dGRvd24gL3MgL2YgL3QgMTV9fSkKICAgICAgICAkQnV0dG9uMy5BZGRfQ2xpY2soIHsgJGZvcm0uQ2xvc2UoKSB9KQogICAgICAgICRUaW1lci5BZGRfVGljayggeyBUaW1lcl9UaWNrIH0pCiAgICAgICAgJFRpbWVyLlN0YXJ0KCkKICAgICAgICAkT3V0cHV0ID0gJGZvcm0uU2hvd0RpYWxvZygpCiAgICAgICAgU3dpdGNoKCRPdXRwdXQpewogICAgICAgICJZZXMieyJTaHV0ZG93biBJbml0aWF0ZWQuIn0KICAgICAgICAiT0sieyJTaHV0ZG93biBTY2hlZHVsZWQgYWZ0ZXIgJEdsb2JhbDpEZWxheXRpbWUgTWludXRlcy4ifQogICAgICAgICJObyJ7IlVzZXIgRGVuaWVkIHRvIHNodXRkb3duLiJ9CiAgICAgICAgIkNhbmNlbCJ7IlNodXRkb3duIEluaXRpYXRlZCJ9CiAgICAgICAgfQogICAgfQoKICAgICMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwoKICAgICMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwogICAgaWYgKCRJZlVzZXJJc0xvZ2dlZE9uIC1lcSAiTm90aWZ5IHRoZSB1c2VyIHRoYXQgdGhlIG1hY2hpbmUgd2lsbCBTaHV0ZG93biIpIHsKICAgICAgICBBZGQtVHlwZSAtQXNzZW1ibHlOYW1lIFN5c3RlbS5XaW5kb3dzLkZvcm1zCiAgICAgICAgW1N5c3RlbS5XaW5kb3dzLkZvcm1zLkFwcGxpY2F0aW9uXTo6RW5hYmxlVmlzdWFsU3R5bGVzKCkKCiAgICAgICAgRnVuY3Rpb24gQXV0b19DbG9zZSB7CiAgICAgICAgICAgICRUaW1lci5TdG9wKCk7IAogICAgICAgICAgICAkRm9ybS5DbG9zZSgpOyAKICAgICAgICAgICAgJEZvcm0uRGlzcG9zZSgpOwogICAgICAgICAgICAkVGltZXIuRGlzcG9zZSgpOwogICAgICAgICAgICAme3NodXRkb3duIC9zIC9mIC90IDE1fQogICAgICAgIH0KCiAgICAgICAgRnVuY3Rpb24gVGltZXJfVGljayB7CiAgICAgICAgICAgICRMYWJlbDEuVGV4dCA9ICJUaGlzIERldmljZSB3aWxsIHNodXRkb3duLiRTY3JpcHQ6Q291bnREb3duIHNlY29uZHMiCiAgICAgICAgICAgIC0tJFNjcmlwdDpDb3VudERvd24KICAgICAgICAgICAgaWYgKCRTY3JpcHQ6Q291bnREb3duIC1sdCAwKSB7CiAgICAgICAgICAgICAgICBBdXRvX0Nsb3NlCiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgICRGb3JtID0gTmV3LU9iamVjdCBzeXN0ZW0uV2luZG93cy5Gb3Jtcy5Gb3JtCiAgICAgICAgJEZvcm0uQ2xpZW50U2l6ZSA9ICc0ODgsMjM0JwogICAgICAgICRGb3JtLnRleHQgPSAiU2h1dGRvd24gTWFuYWdlciIKICAgICAgICAkRm9ybS5Ub3BNb3N0ID0gJGZhbHNlCiAgICAgICAgJGZvcm0uU3RhcnRQb3NpdGlvbiA9ICJDZW50ZXJTY3JlZW4iCgogICAgICAgICRMYWJlbDEgPSBOZXctT2JqZWN0IHN5c3RlbS5XaW5kb3dzLkZvcm1zLkxhYmVsCiAgICAgICAgJExhYmVsMS5BdXRvU2l6ZSA9ICR0cnVlCiAgICAgICAgJExhYmVsMS53aWR0aCA9IDUwMAogICAgICAgICRMYWJlbDEuaGVpZ2h0ID0gMTAKICAgICAgICAkTGFiZWwxLmxvY2F0aW9uID0gTmV3LU9iamVjdCBTeXN0ZW0uRHJhd2luZy5Qb2ludCgyMCwgMTYpCiAgICAgICAgJExhYmVsMS5Gb250ID0gJ01pY3Jvc29mdCBTYW5zIFNlcmlmLDEwJwoKICAgICAgICAkTGFiZWwyID0gTmV3LU9iamVjdCBzeXN0ZW0uV2luZG93cy5Gb3Jtcy5MYWJlbAogICAgICAgICRMYWJlbDIuQXV0b1NpemUgPSAkdHJ1ZQogICAgICAgICRMYWJlbDIud2lkdGggPSA1MDAKICAgICAgICAkTGFiZWwyLmhlaWdodCA9IDEwCiAgICAgICAgJExhYmVsMi5sb2NhdGlvbiA9IE5ldy1PYmplY3QgU3lzdGVtLkRyYXdpbmcuUG9pbnQoMjAsIDM1KQogICAgICAgICRMYWJlbDIuRm9udCA9ICdNaWNyb3NvZnQgU2FucyBTZXJpZiwxMCcKCiAgICAgICAgJEJ1dHRvbjEgPSBOZXctT2JqZWN0IHN5c3RlbS5XaW5kb3dzLkZvcm1zLkJ1dHRvbgogICAgICAgICRCdXR0b24xLnRleHQgPSAiT0siCiAgICAgICAgJEJ1dHRvbjEud2lkdGggPSAxMzgKICAgICAgICAkQnV0dG9uMS5oZWlnaHQgPSA0NwogICAgICAgICRCdXR0b24xLmxvY2F0aW9uID0gTmV3LU9iamVjdCBTeXN0ZW0uRHJhd2luZy5Qb2ludCgxNzAsIDE3MCkKICAgICAgICAkQnV0dG9uMS5Gb250ID0gJ01pY3Jvc29mdCBTYW5zIFNlcmlmLDEwJwogICAgICAgICRCdXR0b24xLkRpYWxvZ1Jlc3VsdCA9IDEKCiAgICAgICAgJFNjcmlwdDpjb3VudGRvd24gPSAkU2h1dGRvd25UaW1lb3V0CiAgICAgICAgJExhYmVsMi5UZXh0ID0gJGRpc3BsYXltc2cKICAgICAgICAkTGFiZWwxLlRleHQgPSAiVGhpcyBEZXZpY2Ugd2lsbCBzaHV0ZG93biBpbiAiCiAgICAgICAgJEZvcm0uY29udHJvbHMuQWRkUmFuZ2UoQCgkTGFiZWwxLCAkTGFiZWwyLCAkQnV0dG9uMSkpCiAgICAgICAgJFRpbWVyID0gTmV3LU9iamVjdCBTeXN0ZW0uV2luZG93cy5Gb3Jtcy5UaW1lcgogICAgICAgICRUaW1lci5JbnRlcnZhbCA9IDEwMDAKCiAgICAgICAgJEJ1dHRvbjEuQWRkX0NsaWNrKHsme3NodXRkb3duIC9zIC9mIC90IDE1fX0pCiAgICAgICAgJFRpbWVyLkFkZF9UaWNrKCB7IFRpbWVyX1RpY2sgfSkKICAgICAgICAkVGltZXIuU3RhcnQoKQogICAgICAgICRyZXN1bHQgPSAkZm9ybS5TaG93RGlhbG9nKCkKICAgICAgICBzd2l0Y2goJHJlc3VsdCl7CiAgICAgICAgICAgICJPayJ7IlNodXRkb3duIEluaXRpYXRlZCJ9CiAgICAgICAgICAgICJDYW5jZWwiewogICAgICAgICAgICAgICAgIlNodXRkb3duIEluaXRpYXRlZCIKICAgICAgICAgICAgICAgICRUaW1lci5TdG9wKCkKICAgICAgICAgICAgICAgICRUaW1lci5EaXNwb3NlKCkKCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CiAgICAjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKfQoKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCgppZiAoJEFkZFByb2Nlc3MpIHsgIAogICAgJHByb2Nlc3NkZXRhaWxzID0gR2V0LVByb2Nlc3MgLU5hbWUgJHByb2Nlc3NuYW1lIC1FcnJvckFjdGlvbiAiU2lsZW50bHlDb250aW51ZSIKICAgIGlmICgkcHJvY2Vzc2RldGFpbHMgLW5lICRudWxsKSB7CiAgICAgICAgaWYgKCRhY3Rpb24gLWVxICJEbyBub3QgaW5pdGlhdGUgU2h1dGRvd24iKSB7CiAgICAgICAgICAgIFdyaXRlLU91dHB1dCAiJHByb2Nlc3NuYW1lIGlzIHJ1bm5pbmcgaW4gdGhlIG1lbW9yeWBuYG5XaW5kb3dzIGNhbm5vdCBiZSBzaHV0ZG93bi4iCiAgICAgICAgICAgIEV4aXQ7CiAgICAgICAgfQogICAgICAgIGVsc2VpZiAoJGFjdGlvbiAtZXEgIkV4ZWN1dGUgdGhlIGZvbGxvd2luZyBjb21tYW5kcyBhbmQgcHJvY2VzcyB0aGUgU2h1dGRvd24iKSB7CiAgICAgICAgICAgIGlmICgkQWRkQ21kUHJvY2VzcyAtZXEgIkNvbW1hbmQiKSB7CiAgICAgICAgICAgICAgICAkQ29tbWFuZHRvZXhlY3V0ZSA9ICIkY29tbWFuZCIKICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgJEVycm9yYWN0aW9ucHJlZmVyZW5jZSA9ICJTdG9wIgogICAgICAgICAgICAgICAgICAgIEludm9rZS1Db21tYW5kIC1TY3JpcHRCbG9jayB7ICYgeyBjbWQuZXhlIC9jICRDb21tYW5kdG9leGVjdXRlIH0gfSB8IE91dC1OdWxsCiAgICAgICAgICAgICAgICAgICAgaWYgKCQ/KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIE1haW4KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgRWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIFdyaXRlLUVycm9yICJDb21tYW5kIEZhaWxlZCB0byBFeGVjdXRlIgogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGNhdGNoIHsKICAgICAgICAgICAgICAgICAgICAkXy5FeGNlcHRpb24uTWVzc2FnZQogICAgICAgICAgICAgICAgICAgIEV4aXQ7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKCRBZGRDbWRQcm9jZXNzIC1lcSAiUHJvY2VzcyIpIHsKICAgICAgICAgICAgICAgICRwaW5mbyA9IE5ldy1PYmplY3QgU3lzdGVtLkRpYWdub3N0aWNzLlByb2Nlc3NTdGFydEluZm8KICAgICAgICAgICAgICAgICRwaW5mby5GaWxlTmFtZSA9ICIkcHJvY2VzcyIKICAgICAgICAgICAgICAgICRwaW5mby5SZWRpcmVjdFN0YW5kYXJkRXJyb3IgPSAkdHJ1ZQogICAgICAgICAgICAgICAgJHBpbmZvLlJlZGlyZWN0U3RhbmRhcmRPdXRwdXQgPSAkdHJ1ZQogICAgICAgICAgICAgICAgJHBpbmZvLlVzZVNoZWxsRXhlY3V0ZSA9ICRmYWxzZQogICAgICAgICAgICAgICAgaWYgKCRwYXJhbWV0ZXIpIHsKICAgICAgICAgICAgICAgICAgICAkcGluZm8uQXJndW1lbnRzID0gIiRwYXJhbWV0ZXIiCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAkcCA9IE5ldy1PYmplY3QgU3lzdGVtLkRpYWdub3N0aWNzLlByb2Nlc3MKICAgICAgICAgICAgICAgICRwLlN0YXJ0SW5mbyA9ICRwaW5mbwogICAgICAgICAgICAgICAgJEVycm9yQWN0aW9uUHJlZmVyZW5jZSA9ICJTdG9wIgogICAgICAgICAgICAgICAgJHAuU3RhcnQoKSB8IE91dC1OdWxsCiAgICAgICAgICAgICAgICAkRXJyb3JBY3Rpb25QcmVmZXJlbmNlID0gIkNvbnRpbnVlIgogICAgICAgICAgICAgICAgaWYgKCEkQWxsb3cpIHsgJGV4aXRzdGF0dXMgPSAkcC5XYWl0Rm9yRXhpdCgpIH0KICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgICRleGl0dGltZSA9ICRBbGxvdyAqIDYwMDAwCiAgICAgICAgICAgICAgICAgICAgJGV4aXRzdGF0dXMgPSAkcC5XYWl0Rm9yRXhpdCgkZXhpdHRpbWUpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAoJGV4aXRzdGF0dXMpIHsgTWFpbiB9CiAgICAgICAgICAgICAgICBlbHNlIHsgJHAuS2lsbCgpOyBXcml0ZS1FcnJvciAiUHJvY2VzcyBjb3VsZCBub3QgYmUgZXhlY3V0ZWQgaW4gZ2l2ZW4gdGltZS4iIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KICAgIGVsc2V7TWFpbn0KfQplbHNle01haW59Cg==","jsonSchema":{"additionalproperties":false,"definitions":{"message_box":{"title":"Display this Message","type":"string"}},"dependencies":{"AddProcess":{"oneOf":[{"dependencies":{"Action":{"oneOf":[{"properties":{"Action":{"enum":["Do not initiate Shutdown"]}}},{"dependencies":{"AddCmdProcess":{"oneOf":[{"properties":{"AddCmdProcess":{"enum":["Command"]},"command":{"title":"Command","type":"string"}},"required":["command"]},{"properties":{"AddCmdProcess":{"enum":["Process"]},"Allow":{"title":"Allow","type":"integer"},"parameter":{"title":"Parameter","type":"string"},"process":{"title":"Process","type":"string"}},"required":["process"]}]}},"properties":{"Action":{"enum":["Execute the following commands and process the Shutdown"]},"AddCmdProcess":{"default":"Add a Command","enum":["Command","Process"],"enumNames":["Add a Command","Add a Process"],"title":" ","type":"string"}}}]}},"properties":{"Action":{"default":"Do not initiate Shutdown","enum":["Do not initiate Shutdown","Execute the following commands and process the Shutdown"],"title":" ","type":"string"},"AddProcess":{"enum":[true]},"ProcessName":{"title":"If the process is running in memory","type":"string"}},"required":["ProcessName"]},{"properties":{"AddProcess":{"enum":[false]}}}]},"IfUserIsLoggedOn":{"oneOf":[{"properties":{"DisplayMsg":{"$ref":"#/definitions/message_box"},"IfUserIsLoggedOn":{"enum":["Ask the user for confirmation before initiating Shutdown"]},"ShutdownTimeout":{"title":"Shutdown Timeout","type":"integer"}}},{"properties":{"DisplayMsg":{"$ref":"#/definitions/message_box"},"IfUserIsLoggedOn":{"enum":["Notify the user that the machine will Shutdown"]},"ShutdownTimeout":{"title":"Shutdown Timeout","type":"integer"}}}]}},"properties":{"AddProcess":{"title":"Add A Process","type":"boolean"},"IfUserIsLoggedOn":{"default":"Ask the user for confirmation before initiating Shutdown","enum":["Ask the user for confirmation before initiating Shutdown","Notify the user that the machine will Shutdown"],"title":"If a user is logged on","type":"string"}},"type":"object"},"uiSchema":{"Action":{"classNames":"col-sm-12","ui:widget":"radio"},"AddCmdProcess":{"classNames":"col-sm-12","ui:options":{"inline":true},"ui:widget":"radio"},"AddProcess":{"classNames":"col-sm-12"},"Allow":{"classNames":"col-sm-4","ui:help":"Minutes for the process to execute"},"DisplayMsg":{"classNames":"col-sm-7","ui:widget":"textarea"},"IfUserIsLoggedOn":{"classNames":"col-sm-12","ui:widget":"radio"},"ProcessName":{"classNames":"col-sm-6"},"ShutdownTimeout":{"classNames":"col-sm-6","ui:help":"Shutdown the machine xxx seconds after the message is displayed."},"command":{"classNames":"col-sm-6"},"parameter":{"classNames":"col-sm-4"},"process":{"classNames":"col-sm-4"},"ui:order":["IfUserIsLoggedOn","DisplayMsg","ShutdownTimeout","AddProcess","ProcessName","Action","AddCmdProcess","command","process","parameter","Allow"]},"isHDScript":false}