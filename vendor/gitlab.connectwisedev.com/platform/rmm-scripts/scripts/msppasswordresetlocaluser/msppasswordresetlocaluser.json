{"id":"3ce10460-9141-11e9-9768-00155d130b01","partnerId":"00000000-0000-0000-0000-000000000000","category":["Maintenance"],"description":"This script will reset the password of local user whose account is not locked or disabled","engine":"powershell","engineMaxVersion":5,"expectedExecutionTimeSec":300,"failureMessage":"Executed with errors","successMessage":"Password Reset for Local Account is Successful","internal":false,"name":"Password Reset for Local User","tags":["Windows 7","Windows 10"],"sequence":true,"content":"PCMKCS5TWU5PUFNJUwoJRGV2ZWxvcGVkIEJ5IDogR1JUIFtIRC1BdXRvbWF0aW9uXSAsIENvbnRpbnV1bQoJRmlsZSBWZXNpb24gOiAyLjAKCS5ERVNDUklQVElPTgoJVGhlIHNjcmlwdCBpcyBkZXNpZ25lZCB0byBjaGFuZ2UgdGhlIHBhc3N3b3JkIG9mIGxvY2FsIHVzZXIsIGlmIExvY2FsIFVzZXIgYWNjb3VudCBpcyBMb2NrZWQvRGlzYWJsZWQgb3IgYm90aCBpdCB3aWxsIG5vdCBkbyBhbnl0aGluZy4KCS5QQVJBTUVURVIgCglMb2NhbFVzZXJJRCBpcyB0aGUgdmFyaWFibGUgcmVxdWlyZWQgZm9yIGNoYW5naW5nIHRoZSBwYXNzd29yZC4KCS5QQVJBTUVURVIgCglDaGFuZ2VQYXNzd29yZCBpcyB0aGUgcGFzc3dvcmQgd2hpY2ggbmVlZHMgdG8gYmUgc2V0IGFzIHBhc3N3b3JkIGZvciB0aGUgdXNlciBhY2NvdW50LgoJLlBBUkFNRVRFUgoJQ2hhbmdlUHdkTmV4dExvZ29uIGlzIGEgYm9vbGVhbi4gVHJ1ZSBtZWFucyB0byBzZXQgQ2hhbmdlIFBhc3N3b3JkIG9uIG5leHQgbG9nb24uCgkuRXhhbXBsZSBmb3IgVGVzdAoJJExvY2FsVXNlcklEID0gImhkMSIKCSRDaGFuZ2VQYXNzd29yZCA9ICJFRDMlViIKCSRDaGFuZ2VQd2ROZXh0TG9nb249JHRydWUKIz4KPCMgQ29tcGF0aWJpbGl0eSBDaGVjayBpZiBmb3VuZCBpbmNvbXBhdGlibHQgd2l0aCBleGl0Iz4KdHJ5ewogICAgJE9TVmVyc2lvbj0oW3N5c3RlbS5lbnZpcm9ubWVudF06Ok9TVmVyc2lvbi5WZXJzaW9uKS5NYWpvcgogICAgJFBTVmVyc2lvbiA9KEdldC1Ib3N0KS52ZXJzaW9uCiAgICBpZigoJE9TVmVyc2lvbiAtbHQgNikgLW9yICgkUFNWZXJzaW9uLk1ham9yIC1sdCAyKSkKICAgIHsKICAgIFdyaXRlLU91dHB1dCAiW01TRyA6IEluY29tcGF0aWJsZSBTeXN0ZW0gRWl0aGVyIE9TIGlzIGJlbG93IHdpbmRvd3MgNy8yMDA4UjIgb3IgcG93ZXJzaGVsbCB2ZXJzaW9uIGxlc3MgdGhhbiAyLjBdIgogICAgRXhpdCAKICAgIH19Y2F0Y2h7IFdyaXRlLU91dHB1dCAiW01TRzogJF8uRXhjZXB0aW9uLm1lc3NhZ2VdIn0KICAgIAogICAgJE91dHB1dE1lc3NhZ2UgPSBAKCkgPCMgVmFyaWFibGUgdG8gY2FwdHVyZSBPdXRwdXQgZm9yIGRlYnVnZ2luZyBwdXJwb3NlLiM+CiAgICA8IyBJZiAkREMgaXMgZXF1YWxsIHRvIDQoYmFja3VwIERDKSBvciA1KHByaW1hcnkgREMpIGFzIHRoZXJlIGlzIG5vIGxvY2FsIHVzZXIgb24gRG9tYWluIENvbnRyb2xsZXIgIz4gICAKICAgIHRyeXsgJERDID0gKEdldC1XbWlPYmplY3QgV2luMzJfQ29tcHV0ZXJTeXN0ZW0pLmRvbWFpbnJvbGUKICAgIH1jYXRjaHsgV3JpdGUtZXJyb3IgIlVuYWJsZSB0byBDaGVjayBpZiBtYWNoaW5lIGlzIERvbWFpbiBDb250cm9sbGVyICRfLkV4Y2VwdGlvbi5tZXNzYWdlIiB9CiAgICBpZigkREMgLWVxICI0IiAtb3IgJERDIC1lcSAiNSIpCiAgICB7IAogICAgICAgICRPdXRwdXRNZXNzYWdlICs9ICJObyBMb2NhbCBVc2VyIG9uIERvbWFpbiBDb250cm9sbGVyLiIKICAgICAgICBXcml0ZS1PdXRwdXQgJE91dHB1dE1lc3NhZ2UKICAgICAgICBFeGl0CiAgICB9CiAgICBlbHNlCiAgICB7CiAgICA8I0NoZWNrIGlmIFVzZXIgRXhpc3QjPgogICAgdHJ5IHsKICAgICAgICAgICAgJExvY2FsdXNlciA9ICBHZXQtV21pT2JqZWN0IC1DbGFzcyBXaW4zMl9Vc2VyQWNjb3VudCAtRmlsdGVyICJMb2NhbEFjY291bnQ9J1RydWUnIGFuZCBOYW1lPSckTG9jYWxVc2VySUQnIiB8IFNlbGVjdCBQU0NvbXB1dGVybmFtZSwgTG9jYWxBY2NvdW50LCBTdGF0dXMsRGlzYWJsZWQsIEFjY291bnRUeXBlLCBMb2Nrb3V0LCBQYXNzd29yZFJlcXVpcmVkLCBQYXNzd29yZENoYW5nZWFibGUsIFBhc3N3b3JkRXhwaXJlcywgU0lECiAgICAgICAgfWNhdGNoeyBXcml0ZS1lcnJvciAiIFVuYWJsZSB0byByZXRyaWV2ZSBMb2NhbCB1c2VyIGluZm9ybWF0aW9uIiB9CiAgICAgICAgaWYgKCRMb2NhbHVzZXIpCiAgICAgICAgewogICAgICAgICAgICBpZigoJExvY2FsdXNlci5EaXNhYmxlZCAtZXEgJEZhbHNlKSAtQW5kICgkTG9jYWx1c2VyLkxvY2tvdXQgLWVxICRGYWxzZSkpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICRNYWNoaW5lTmFtZSA9ICRlbnY6Q09NUFVURVJOQU1FCiAgICAgICAgICAgICAgICA8IyByZXNldCB0aGUgcGFzc3dvcmQjPgogICAgICAgICAgICAgICAgdHJ5ewogICAgICAgICAgICAgICAgICAgICRVc3JDb21tYW5kID1bQURTSV0gIldpbk5UOi8vJE1hY2hpbmVOYW1lLyRMb2NhbFVzZXJJRCwgdXNlciIKICAgICAgICAgICAgICAgICAgICAkVXNyQ29tbWFuZC5TZXRQYXNzd29yZCgkQ2hhbmdlUGFzc3dvcmQpIAogICAgICAgICAgICAgICAgICAgIGlmKCRDaGFuZ2VQd2ROZXh0TG9nb24gLWVxICR0cnVlKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoKCRMb2NhbHVzZXIuUGFzc3dvcmRDaGFuZ2VhYmxlIC1lcSAkVHJ1ZSkgLUFuZCAoJExvY2FsdXNlci5QYXNzd29yZEV4cGlyZXMgLWVxICR0cnVlKSkKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICA8IyBVc2UgdG8gY2hlY2sgZm9yIGZvcmNlIHB3ZCBjaGFuZ2UgYXQgbmV4dCBsb2dvbi4gSWYgUGFzc3dvcmRDaGFuZ2VhYmxlIGFuZCBQYXNzd29yZEV4cGlyZXMgaXMgRmFsc2UgdGhlIG9wdGlvbiBvciBQYXNzd29yZCBjaGFuZ2UgYXQgbmV4dCBsb2dvbiBpcyBncmF5ZWQgb3V0LiM+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkVXNyQ29tbWFuZC5QYXNzd29yZEV4cGlyZWQgPSAxICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRVc3JDb21tYW5kLlNldGluZm8oKSAKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBFbHNlIAogICAgICAgICAgICAgICAgICAgICAgICB7ICAgJE91dHB1dE1lc3NhZ2UgKz0gIlBhc3N3b3JkIGlzIEVpdGhlciBTZXQgdG8gbmV2ZXIgRXhwaXJlZCBvciBDYW5ub3QgQ2hhbmdlIFBhc3N3b3JkLiIgIH0KICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgIHsgICRPdXRwdXRNZXNzYWdlICs9ICJOZXh0IExvZ29uIFBhc3N3b3JkIENoYW5nZSBpcyBub3QgY29uZmlncnVlZCBieSBUZWNobmljaWFuLiIgICB9CiAgICAgICAgICAgICAgICAgICAgICRPdXRwdXRNZXNzYWdlICs9ICJQYXNzd29yZCBDaGFuZ2VkIFN1Y2Nlc3NmdWxseS4iCiAgICAgICAgICAgICAgICAgICAgIH1jYXRjaCB7V3JpdGUtZXJyb3IgIiBVbmFibGUgdG8gY2hhbmdlIHBhc3N3b3JkICRfLkV4Y2VwdGlvbi5tZXNzYWdlIn0KICAgICAgICAgICAgICB9CiAgICAgICAgIGVsc2UKICAgICAgICAgICAgIHsgJE91dHB1dE1lc3NhZ2UgKz0iQWNjb3VudCBTdGF0dXMgTG9ja2VkIDogIiskTG9jYWx1c2VyLkxvY2tvdXQgCiAgICAgICAgICAgICAgICRPdXRwdXRNZXNzYWdlICs9IkFjY291bnQgU3RhdHVzIERpc2FibGVkIDoiKyRMb2NhbHVzZXIuRGlzYWJsZWQKICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5ewogICAgICAgICAgICAgICAgICAgICAgICAgICAgJExvY2FsdXNlciA9ICBHZXQtV21pT2JqZWN0IC1DbGFzcyBXaW4zMl9Vc2VyQWNjb3VudCAtRmlsdGVyICJMb2NhbEFjY291bnQ9J1RydWUnIiB8IFNlbGVjdCBOYW1lLERpc2FibGVkLExvY2tvdXQKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcigkaT0wOyAkaSAtbHQgJExvY2FsdXNlci5sZW5ndGggOyAkaSsrKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgeyAgICRUZW1wVXNlcj0kTG9jYWx1c2VyWyRpXS5OYW1lCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHVzZXJhY2NvdW50ZXhwaXJhdGlvbiA9IFthZHNpXSJXaW5OVDovLy4vJFRlbXBVc2VyLCB1c2VyIiB8IFNlbGVjdCBBY2NvdW50RXhwaXJhdGlvbkRhdGUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkT3V0cHV0TWVzc2FnZSArPSAiTmFtZSA6IiskTG9jYWx1c2VyWyRpXS5OYW1lIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRPdXRwdXRNZXNzYWdlICs9ICJEaXNhYmxlZCA6IiskTG9jYWx1c2VyWyRpXS5EaXNhYmxlZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRPdXRwdXRNZXNzYWdlICs9ICJMb2Nrb3V0IDoiKyRMb2NhbHVzZXJbJGldLkxvY2tvdXQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkT3V0cHV0TWVzc2FnZSArPSAiQWNjb3VudEV4cGlyYXRpb25EYXRlIDoiKyR1c2VyYWNjb3VudGV4cGlyYXRpb24uQWNjb3VudEV4cGlyYXRpb25EYXRlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJE91dHB1dE1lc3NhZ2UgKz0gIiAiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9Y2F0Y2h7IFdyaXRlLWVycm9yICJVbmFibGUgdG8gZ2V0IGxpc3Qgb2YgTG9jYWwgVXNlciBBY2NvdW50LiIgfQogICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgIFdyaXRlLU91dHB1dCAkT3V0cHV0TWVzc2FnZSB8ZmwK","jsonSchema":{"additionalProperties":false,"properties":{"ChangePassword":{"minLength":1,"title":"Password","type":"string"},"ChangePwdNextLogon":{"title":"Change password at next logon","type":"boolean"},"LocalUserID":{"minLength":1,"title":"User name","type":"string"}},"required":["LocalUserID","ChangePassword"],"type":"object"},"uiSchema":{"ChangePassword":{"classNames":"col-sm-6","ui:help":"Hint: Make it strong!","ui:widget":"password"},"ChangePwdNextLogon":{"classNames":"col-sm-6"},"LocalUserID":{"classNames":"col-sm-12","ui:autofocus":true},"ui:order":["LocalUserID","ChangePassword","ChangePwdNextLogon"]},"isHDScript":false}
