{"id":"336d8eb1-6058-11e9-a7f5-00155d130b01","partnerId":"00000000-0000-0000-0000-000000000000","category":["Security"],"description":"Defines Internet Explorer preferences such as Home page, Download Directory, Proxy server, etc.","engine":"powershell","engineMaxVersion":5,"expectedExecutionTimeSec":300,"failureMessage":"Executed with errors","successMessage":"Excecuted successfully","internal":false,"name":"Configure Internet Explorer preferences","tags":["Windows 7","Windows 10"],"sequence":true,"content":"PCMkaG9tZXBhZ2VibGFuayA9ICR0cnVlICAgICAgICAgICAgI0Jvb2xlYW4KJGhvbWVwYWdlID0gJG51bGwgICAgICAgICAgICAgICAgICNTdHJpbmcKJGRvd25sb2FkZGlyID0gIkQ6XFRlc3QxIiAgICAgICAgICNTdHJpbmcKJGF1dG9zY3JpcHQgPSAiYWJjZC5jb20iICAgICAgICAgICAgICAgICAgI1N0cmluZwokcHJveHllbmFibGUgPSAkZmFsc2UgICAgICAgICAgICAgI0Jvb2xlYW4KJHByb3h5YWRkcmVzcyA9ICJtbWtuZC5jb3JwLmNvbSIgICNTdHJpbmcKJHByb3h5cG9ydCA9ICI4MCIgICAgICAgICAgICAgICAgICNpbnQKJGJ5cGFzc2ZvcmxvY2FsYWRkcmVzcyA9ICR0cnVlICAgICNCb29sZWFuCiRleGNlcHRpb25zID0gImNvbnRpbnV1bS5uZXQiICAgICAjU3RyaW5nIFByb3h5IGV4Y2VwdGlvbnMKIz4KCiRvcyA9IChHZXQtV21pT2JqZWN0IC1DbGFzcyB3aW4zMl9vcGVyYXRpbmdzeXN0ZW0pLk5hbWUKaWYoJG9zIC1saWtlICIqU2VydmVyKiIpewpXcml0ZS1vdXRwdXQgIlNjcmlwdCBjYW5ub3QgYmUgZXhlY3V0ZWQgb24gc2VydmVyIgpFeGl0Owp9CgpGdW5jdGlvbiBDcmVhdGVfcmVnaXN0cnkoJHBhdGgsICROYW1lLCAkVmFsdWUsICRwcm9wZXJ0eXR5cGUpIHsKICAgICMgRnVuY3Rpb24gd2lsbCBzZXQgcmVnaXN0cnkgdmFsdWUgYW5kIGlmIGl0ZW0gaXMgbm90IHByZXNlbnQgd2lsbCBjcmVhdGUgcmVnaXN0cnkgZW50cnkuCiAgICAkRGV0YWlscyA9IEdldC1JdGVtUHJvcGVydHkgLVBhdGggJHBhdGgKICAgIGlmICgkRGV0YWlscyAtbmUgJG51bGwpIHsKICAgICAgICAkRGV0YWlscyA9IEdldC1JdGVtUHJvcGVydHkgLVBhdGggJHBhdGggfCBnbSB8IHNlbGVjdCAtRXhwYW5kUHJvcGVydHkgTmFtZQogICAgICAgIGlmICgkRGV0YWlscyAtY29udGFpbnMgJE5hbWUpIHsKICAgICAgICAgICAgU2V0LUl0ZW1Qcm9wZXJ0eSAkcGF0aCAtTmFtZSAkTmFtZSAtVmFsdWUgJFZhbHVlCiAgICAgICAgfQogICAgICAgIGVsc2UgewogICAgICAgICAgICBOZXctSXRlbVByb3BlcnR5IC1QYXRoICRwYXRoIC1OYW1lICROYW1lIC1Qcm9wZXJ0eVR5cGUgJHByb3BlcnR5dHlwZSAtVmFsdWUgJFZhbHVlIHwgT3V0LU51bGwKICAgICAgICB9CgkKICAgIH0gI0VuZCBpZiBzdGF0ZW1lbnQKICAgIGVsc2UgewogICAgICAgIE5ldy1JdGVtUHJvcGVydHkgLVBhdGggJHBhdGggLU5hbWUgJE5hbWUgLVByb3BlcnR5VHlwZSAkcHJvcGVydHl0eXBlIC1WYWx1ZSAkVmFsdWUgfCBPdXQtTnVsbAogICAgfSAgIyBFbmQgZWxzZSBzdGF0ZW1lbnQKCiAgICBpZiAoKEdldC1JdGVtUHJvcGVydHkgJHBhdGggLU5hbWUgJE5hbWUgfCBzZWxlY3QgLUV4cGFuZFByb3BlcnR5ICROYW1lKSAtZXEgJFZhbHVlKSB7IHJldHVybiAkdHJ1ZSB9IGVsc2UgeyByZXR1cm4gJGZhbHNlIH0KfQoKCiRwcm9maWxlbGlzdCA9IEdldC1JdGVtICJSRWdpc3RyeTo6SEtVXFMtMS01LTIxLSoiIHwgV2hlcmUtT2JqZWN0IHskXy5OYW1lIC1ub3RsaWtlICcqX0NsYXNzZXMnfSB8IHNlbGVjdCAtRXhwYW5kUHJvcGVydHkgbmFtZQogICAgV3JpdGUtT3V0cHV0ICJgbk1ha2luZyBjaGFuZ2VzIGZvciBsb2dnZWQgaW4gdXNlcnMiCiAgICBmb3JlYWNoICgkcHJvZmlsZSBpbiAkcHJvZmlsZWxpc3QpIHsKICAgICAgICBpZiAoVGVzdC1wYXRoICJSZWdpc3RyeTo6JHByb2ZpbGVcVm9sYXRpbGUgRW52aXJvbm1lbnQiKSB7CiAgICAgICAgICAgICR1c2VybmFtZSA9IEdldC1JdGVtUHJvcGVydHkgLVBhdGggIlJlZ2lzdHJ5OjokcHJvZmlsZVxWb2xhdGlsZSBFbnZpcm9ubWVudCIgLU5hbWUgVXNlcm5hbWUgfCBTZWxlY3QgLUV4cGFuZFByb3BlcnR5IFVzZXJuYW1lCgogICAgICAgICAgIGlmKFRlc3QtcGF0aCAiUmVnaXN0cnk6OkhLVVxURU1QXFNvZnR3YXJlXE1pY3Jvc29mdFxJbnRlcm5ldCBFeHBsb3JlclxNYWluIil7CiAgICAgICAgICAgICAgIGlmKCRob21lcGFnZWJsYW5rIC1lcSAkdHJ1ZSl7CiAgICAgICAgICAgICAgICAkcmVzdWx0ID0gQ3JlYXRlX3JlZ2lzdHJ5IC1wYXRoICJSZWdpc3RyeTo6JHByb2ZpbGVcU29mdHdhcmVcTWljcm9zb2Z0XEludGVybmV0IEV4cGxvcmVyXE1haW4iIC1OYW1lICJTdGFydCBQYWdlIiAtVmFsdWUgIiIgLXByb3BlcnR5dHlwZSAiU3RyaW5nIgogICAgICAgICAgICAgICAgaWYgKCRyZXN1bHQpIHsKICAgICAgICAgICAgICAgICAgICBXcml0ZS1PdXRwdXQgIkhvbWVwYWdlIGhhcyBiZWVuIHJlbW92ZWQgZm9yICR1c2VybmFtZSIKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICBpZiAoJGhvbWVwYWdlIC1uZSAkbnVsbCkgewogICAgICAgICAgICAgICAgJHJlc3VsdCA9IENyZWF0ZV9yZWdpc3RyeSAtcGF0aCAiUmVnaXN0cnk6OiRwcm9maWxlXFNvZnR3YXJlXE1pY3Jvc29mdFxJbnRlcm5ldCBFeHBsb3JlclxNYWluIiAtTmFtZSAiU3RhcnQgUGFnZSIgLVZhbHVlICRob21lcGFnZSAtcHJvcGVydHl0eXBlICJTdHJpbmciCiAgICAgICAgICAgICAgICBpZiAoJHJlc3VsdCkgewogICAgICAgICAgICAgICAgICAgIFdyaXRlLU91dHB1dCAiSG9tZXBhZ2UgaGFzIGJlZW4gc2V0IGZvciAkdXNlcm5hbWUiCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKCRkb3dubG9hZGRpciAtbmUgJG51bGwpIHsKICAgICAgICAgICAgICAgICRyZXN1bHQgPSBDcmVhdGVfcmVnaXN0cnkgLXBhdGggIlJlZ2lzdHJ5OjokcHJvZmlsZVxTb2Z0d2FyZVxNaWNyb3NvZnRcSW50ZXJuZXQgRXhwbG9yZXJcTWFpbiIgLU5hbWUgIkRlZmF1bHQgRG93bmxvYWQgRGlyZWN0b3J5IiAtVmFsdWUgJGRvd25sb2FkZGlyCiAgICAgICAgICAgICAgICBpZiAoJHJlc3VsdCkgewogICAgICAgICAgICAgICAgICAgIFdyaXRlLU91dHB1dCAiRG93bmxvYWQgZGlyZWN0b3J5IGhhcyBiZWVuIHNldCBmb3IgJHVzZXJuYW1lLiIKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfX1lbHNle1dyaXRlLU91dHB1dCAiUGF0aCBub3QgZm91bmQgZm9yIGhvbWVwYWdlIGFuZCBkb3dubG9hZGRpciJ9CiAgICAgICAgICAgIGlmKFRlc3QtcGF0aCAiUmVnaXN0cnk6OkhLVVxURU1QXFNvZnR3YXJlXE1pY3Jvc29mdFxXaW5kb3dzXEN1cnJlbnRWZXJzaW9uXEludGVybmV0IFNldHRpbmdzIil7CiAgICAgICAgICAgIGlmICgkcHJveHllbmFibGUgLWVxICR0cnVlKSB7CiAgICAgICAgICAgICAgICAkcmVzdWx0ID0gQ3JlYXRlX3JlZ2lzdHJ5IC1wYXRoICJSZWdpc3RyeTo6JHByb2ZpbGVcU29mdHdhcmVcTWljcm9zb2Z0XFdpbmRvd3NcQ3VycmVudFZlcnNpb25cSW50ZXJuZXQgU2V0dGluZ3MiIC1OYW1lICJQcm94eUVuYWJsZSIgLVZhbHVlIDEKICAgICAgICAgICAgICAgIGlmICgkcmVzdWx0KSB7CiAgICAgICAgICAgICAgICAgICAgV3JpdGUtT3V0cHV0ICJQcm94eSBoYXMgYmVlbiBlbmFibGVkIGZvciAkdXNlcm5hbWUiCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZWlmKCRwcm94eWVuYWJsZSAtZXEgJGZhbHNlKXsKICAgICAgICAgICAgICAgICRyZXN1bHQgPSBDcmVhdGVfcmVnaXN0cnkgLXBhdGggIlJlZ2lzdHJ5OjpIS1VcVEVNUFxTb2Z0d2FyZVxNaWNyb3NvZnRcV2luZG93c1xDdXJyZW50VmVyc2lvblxJbnRlcm5ldCBTZXR0aW5ncyIgLU5hbWUgIlByb3h5RW5hYmxlIiAtVmFsdWUgMAogICAgICAgICAgICAgICAgaWYgKCRyZXN1bHQpIHsKICAgICAgICAgICAgICAgICAgICBXcml0ZS1PdXRwdXQgIlByb3h5IGhhcyBiZWVuIGRpc2FibGVkIGZvciAkdXNlcm5hbWUiCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKCRhdXRvc2NyaXB0IC1uZSAkbnVsbCkgewogICAgICAgICAgICAkcmVzdWx0ID0gQ3JlYXRlX3JlZ2lzdHJ5IC1wYXRoICJSZWdpc3RyeTo6SEtVXFRFTVBcU29mdHdhcmVcTWljcm9zb2Z0XFdpbmRvd3NcQ3VycmVudFZlcnNpb25cSW50ZXJuZXQgU2V0dGluZ3MiIC1OYW1lICJBdXRvQ29uZmlnVVJMIiAtVmFsdWUgJGF1dG9zY3JpcHQgLXByb3BlcnR5dHlwZSAiU3RyaW5nIgogICAgICAgICAgICBpZiAoJHJlc3VsdCkgewogICAgICAgICAgICBXcml0ZS1PdXRwdXQgIkF1dG9tYXRpYyBjb25maWd1cmF0aW9uIHNjcmlwdCBoYXMgYmVlbiBlbmFibGVkLiIKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoJHByb3h5YWRkcmVzcyAtbmUgJG51bGwpIHsKICAgICAgICAgICAgICAgICR2YWx1ZSA9ICIkcHJveHlhZGRyZXNzIiArICI6IiArICIkcHJveHlwb3J0IgogICAgICAgICAgICAgICAgJHJlc3VsdCA9IENyZWF0ZV9yZWdpc3RyeSAtcGF0aCAiUmVnaXN0cnk6OiRwcm9maWxlXFNvZnR3YXJlXE1pY3Jvc29mdFxXaW5kb3dzXEN1cnJlbnRWZXJzaW9uXEludGVybmV0IFNldHRpbmdzIiAtTmFtZSAiUHJveHlTZXJ2ZXIiIC1WYWx1ZSAkdmFsdWUgLXByb3BlcnR5dHlwZSAiU3RyaW5nIgogICAgICAgICAgICAgICAgaWYgKCRyZXN1bHQpIHsKICAgICAgICAgICAgICAgICAgICBXcml0ZS1PdXRwdXQgIlByb3h5YWRkcmVzcyBoYXMgYmVlbiBlbmFibGVkIGZvciAkdXNlcm5hbWUiCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKCgkYnlwYXNzZm9ybG9jYWxhZGRyZXNzIC1lcSAkdHJ1ZSkgLWFuZCAoJGV4Y2VwdGlvbnMgLWVxICRudWxsKSkgewogICAgICAgICAgICAgICAgJHJlc3VsdCA9IENyZWF0ZV9yZWdpc3RyeSAtcGF0aCAiUmVnaXN0cnk6OiRwcm9maWxlXFNvZnR3YXJlXE1pY3Jvc29mdFxXaW5kb3dzXEN1cnJlbnRWZXJzaW9uXEludGVybmV0IFNldHRpbmdzIiAtTmFtZSAiUHJveHlPdmVycmlkZSIgLVZhbHVlICI8bG9jYWw+IiAtcHJvcGVydHl0eXBlICJTdHJpbmciCiAgICAgICAgICAgICAgICBpZiAoJHJlc3VsdCkgewogICAgICAgICAgICAgICAgICAgIFdyaXRlLU91dHB1dCAiQnlwYXNzIHdpdGhvdXQgZXhjZXB0aW9ucyBoYXMgYmVlbiBzZXQgZm9yICR1c2VybmFtZS4iCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZWlmICgoJGJ5cGFzc2ZvcmxvY2FsYWRkcmVzcyAtZXEgJHRydWUpIC1hbmQgKCRleGNlcHRpb25zIC1uZSAkbnVsbCkpIHsKICAgICAgICAgICAgICAgICR2YWx1ZSA9ICIkZXhjZXB0aW9ucyIgKyAiOyIgKyAiPGxvY2FsPiIKICAgICAgICAgICAgICAgICRyZXN1bHQgPSBDcmVhdGVfcmVnaXN0cnkgLXBhdGggIlJlZ2lzdHJ5OjokcHJvZmlsZVxTb2Z0d2FyZVxNaWNyb3NvZnRcV2luZG93c1xDdXJyZW50VmVyc2lvblxJbnRlcm5ldCBTZXR0aW5ncyIgLU5hbWUgIlByb3h5T3ZlcnJpZGUiIC1WYWx1ZSAiJHZhbHVlIiAtcHJvcGVydHl0eXBlICJTdHJpbmciCiAgICAgICAgICAgICAgICBpZiAoJHJlc3VsdCkgewogICAgICAgICAgICAgICAgICAgIFdyaXRlLU91dHB1dCAiQnlwYXNzIHdpdGggZXhjZXB0aW9ucyBoYXMgYmVlbiBzZXQgZm9yICR1c2VybmFtZS4iCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICB9IGVsc2V7V3JpdGUtT3V0cHV0ICJGYWlsZWQgdG8gdXBkYXRlIHByb3h5IHN0YXR1cyxwcm94eWFkZHJlc3MgYW5kIGV4Y2VwdGlvbnMifQogICAgICAgIH0KICAgICAgICBlbHNlIHsKICAgICAgICAgICAgQ29udGludWUKICAgICAgICB9CiAgICB9CgoKJHByb2ZpbGVzID0gR2V0LUNoaWxkSXRlbSBDOlxVc2VycyB8IHNlbGVjdCAtRXhwYW5kUHJvcGVydHkgTmFtZQpXcml0ZS1PdXRwdXQgImBuTWFraW5nIGNoYW5nZXMgZm9yIHVzZXIgcHJvZmlsZXMiCmZvcmVhY2ggKCRwcm9maWxlIGluICRwcm9maWxlcykgewogICAgCiAgICAkbnR1c2VyID0gVGVzdC1QYXRoIEM6XFVzZXJzXCRwcm9maWxlXE5UVVNFUi5EQVQKICAgIGlmICgkbnR1c2VyKSB7CiAgICAgICAgdHJ5ewogICAgICAgICAgICAkRmlsZVN0cmVhbSA9IFtTeXN0ZW0uSU8uRmlsZV06Ok9wZW4oIkM6XFVzZXJzXCRwcm9maWxlXE5UVVNFUi5EQVQiLCAnT3BlbicsICdXcml0ZScpCiAgICAgICAgICAgICRGaWxlU3RyZWFtLkNsb3NlKCkKICAgICAgICAgICAgJEZpbGVTdHJlYW0uRGlzcG9zZSgpCiAgICAgICAgICAgIHJlZy5leGUgTE9BRCBIS1VcVEVNUCAiQzpcVXNlcnNcJHByb2ZpbGVcTlRVU0VSLkRBVCIgfCBPdXQtTnVsbAogICAgICAgICAgICBpZih0ZXN0LXBhdGggIlJlZ2lzdHJ5OjpIS1VcVEVNUFxTb2Z0d2FyZVxNaWNyb3NvZnRcSW50ZXJuZXQgRXhwbG9yZXJcTWFpbiIpewogICAgICAgICAgICAgICAgaWYoJGhvbWVwYWdlYmxhbmsgLWVxICR0cnVlKXsKICAgICAgICAgICAgICAgICAgICAkcmVzdWx0ID0gQ3JlYXRlX3JlZ2lzdHJ5IC1wYXRoICJSZWdpc3RyeTo6SEtVXFRFTVBcU29mdHdhcmVcTWljcm9zb2Z0XEludGVybmV0IEV4cGxvcmVyXE1haW4iIC1OYW1lICJTdGFydCBQYWdlIiAtVmFsdWUgIiIgLXByb3BlcnR5dHlwZSAiU3RyaW5nIgogICAgICAgICAgICAgICAgICAgIGlmICgkcmVzdWx0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIFdyaXRlLU91dHB1dCAiSG9tZXBhZ2UgaGFzIGJlZW4gcmVtb3ZlZCBmb3IgJHByb2ZpbGUiCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoJGhvbWVwYWdlIC1uZSAkbnVsbCkgewogICAgICAgICAgICAgICAgJHJlc3VsdCA9IENyZWF0ZV9yZWdpc3RyeSAtcGF0aCAiUmVnaXN0cnk6OkhLVVxURU1QXFNvZnR3YXJlXE1pY3Jvc29mdFxJbnRlcm5ldCBFeHBsb3JlclxNYWluIiAtTmFtZSAiU3RhcnQgUGFnZSIgLVZhbHVlICRob21lcGFnZSAtcHJvcGVydHl0eXBlICJTdHJpbmciCiAgICAgICAgICAgICAgICBpZiAoJHJlc3VsdCkgewogICAgICAgICAgICAgICAgICAgIFdyaXRlLU91dHB1dCAiSG9tZXBhZ2UgaGFzIGJlZW4gc2V0IGZvciAkcHJvZmlsZSIKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoJGRvd25sb2FkZGlyIC1uZSAkbnVsbCkgewogICAgICAgICAgICAgICAgJHJlc3VsdCA9IENyZWF0ZV9yZWdpc3RyeSAtcGF0aCAiUmVnaXN0cnk6OkhLVVxURU1QXFNvZnR3YXJlXE1pY3Jvc29mdFxJbnRlcm5ldCBFeHBsb3JlclxNYWluIiAtTmFtZSAiRGVmYXVsdCBEb3dubG9hZCBEaXJlY3RvcnkiIC1WYWx1ZSAkZG93bmxvYWRkaXIKICAgICAgICAgICAgICAgIGlmICgkcmVzdWx0KSB7CiAgICAgICAgICAgICAgICAgICAgV3JpdGUtT3V0cHV0ICJEb3dubG9hZCBkaXJlY3RvcnkgaGFzIGJlZW4gc2V0IGZvciAkcHJvZmlsZS4iCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH19ZWxzZXtXcml0ZS1PdXRwdXQgIkZhaWxlZCB0byB1cGRhdGUgSG9tZXBhZ2UgYW5kIERvd25sb2FkIGRpcmVjdG9yeSJ9CiAgICAgICAgICAgIGlmKFRlc3QtcGF0aCAiUmVnaXN0cnk6OkhLVVxURU1QXFNvZnR3YXJlXE1pY3Jvc29mdFxXaW5kb3dzXEN1cnJlbnRWZXJzaW9uXEludGVybmV0IFNldHRpbmdzIil7CiAgICAgICAgICAgIGlmICgkcHJveHllbmFibGUgLWVxICR0cnVlKSB7CiAgICAgICAgICAgICAgICAkcmVzdWx0ID0gQ3JlYXRlX3JlZ2lzdHJ5IC1wYXRoICJSZWdpc3RyeTo6SEtVXFRFTVBcU29mdHdhcmVcTWljcm9zb2Z0XFdpbmRvd3NcQ3VycmVudFZlcnNpb25cSW50ZXJuZXQgU2V0dGluZ3MiIC1OYW1lICJQcm94eUVuYWJsZSIgLVZhbHVlIDEKICAgICAgICAgICAgICAgIGlmICgkcmVzdWx0KSB7CiAgICAgICAgICAgICAgICAgICAgV3JpdGUtT3V0cHV0ICJQcm94eSBoYXMgYmVlbiBlbmFibGVkIGZvciAkcHJvZmlsZSIKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlaWYoJHByb3h5ZW5hYmxlIC1lcSAkZmFsc2UpewogICAgICAgICAgICAgICAgJHJlc3VsdCA9IENyZWF0ZV9yZWdpc3RyeSAtcGF0aCAiUmVnaXN0cnk6OkhLVVxURU1QXFNvZnR3YXJlXE1pY3Jvc29mdFxXaW5kb3dzXEN1cnJlbnRWZXJzaW9uXEludGVybmV0IFNldHRpbmdzIiAtTmFtZSAiUHJveHlFbmFibGUiIC1WYWx1ZSAwCiAgICAgICAgICAgICAgICBpZiAoJHJlc3VsdCkgewogICAgICAgICAgICAgICAgICAgIFdyaXRlLU91dHB1dCAiUHJveHkgaGFzIGJlZW4gZGlzYWJsZWQgZm9yICRwcm9maWxlIgogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmICgkYXV0b3NjcmlwdCAtbmUgJG51bGwpIHsKICAgICAgICAgICAgJHJlc3VsdCA9IENyZWF0ZV9yZWdpc3RyeSAtcGF0aCAiUmVnaXN0cnk6OkhLVVxURU1QXFNvZnR3YXJlXE1pY3Jvc29mdFxXaW5kb3dzXEN1cnJlbnRWZXJzaW9uXEludGVybmV0IFNldHRpbmdzIiAtTmFtZSAiQXV0b0NvbmZpZ1VSTCIgLVZhbHVlICRhdXRvc2NyaXB0IC1wcm9wZXJ0eXR5cGUgIlN0cmluZyIKICAgICAgICAgICAgaWYgKCRyZXN1bHQpIHsKICAgICAgICAgICAgV3JpdGUtT3V0cHV0ICJBdXRvbWF0aWMgY29uZmlndXJhdGlvbiBzY3JpcHQgaGFzIGJlZW4gZW5hYmxlZC4iCiAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKCRwcm94eWFkZHJlc3MgLW5lICRudWxsKSB7CiAgICAgICAgICAgICAgICAkdmFsdWUgPSAiJHByb3h5YWRkcmVzcyIgKyAiOiIgKyAiJHByb3h5cG9ydCIKICAgICAgICAgICAgICAgICRyZXN1bHQgPSBDcmVhdGVfcmVnaXN0cnkgLXBhdGggIlJlZ2lzdHJ5OjpIS1VcVEVNUFxTb2Z0d2FyZVxNaWNyb3NvZnRcV2luZG93c1xDdXJyZW50VmVyc2lvblxJbnRlcm5ldCBTZXR0aW5ncyIgLU5hbWUgIlByb3h5U2VydmVyIiAtVmFsdWUgJHZhbHVlIC1wcm9wZXJ0eXR5cGUgIlN0cmluZyIKICAgICAgICAgICAgICAgIGlmICgkcmVzdWx0KSB7CiAgICAgICAgICAgICAgICAgICAgV3JpdGUtT3V0cHV0ICJQcm94eWFkZHJlc3MgaGFzIGJlZW4gZW5hYmxlZCBmb3IgJHByb2ZpbGUiCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKCgkYnlwYXNzZm9ybG9jYWxhZGRyZXNzIC1lcSAkdHJ1ZSkgLWFuZCAoJGV4Y2VwdGlvbnMgLWVxICRudWxsKSkgewogICAgICAgICAgICAgICAgJHJlc3VsdCA9IENyZWF0ZV9yZWdpc3RyeSAtcGF0aCAiUmVnaXN0cnk6OkhLVVxURU1QXFNvZnR3YXJlXE1pY3Jvc29mdFxXaW5kb3dzXEN1cnJlbnRWZXJzaW9uXEludGVybmV0IFNldHRpbmdzIiAtTmFtZSAiUHJveHlPdmVycmlkZSIgLVZhbHVlICI8bG9jYWw+IiAtcHJvcGVydHl0eXBlICJTdHJpbmciCiAgICAgICAgICAgICAgICBpZiAoJHJlc3VsdCkgewogICAgICAgICAgICAgICAgICAgIFdyaXRlLU91dHB1dCAiQnlwYXNzIHdpdGhvdXQgZXhjZXB0aW9ucyBoYXMgYmVlbiBzZXQgZm9yJHByb2ZpbGUgLiIKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlaWYgKCgkYnlwYXNzZm9ybG9jYWxhZGRyZXNzIC1lcSAkdHJ1ZSkgLWFuZCAoJGV4Y2VwdGlvbnMgLW5lICRudWxsKSkgewogICAgICAgICAgICAgICAgJHZhbHVlID0gIiRleGNlcHRpb25zIiArICI7IiArICI8bG9jYWw+IgogICAgICAgICAgICAgICAgJHJlc3VsdCA9IENyZWF0ZV9yZWdpc3RyeSAtcGF0aCAiUmVnaXN0cnk6OkhLVVxURU1QXFNvZnR3YXJlXE1pY3Jvc29mdFxXaW5kb3dzXEN1cnJlbnRWZXJzaW9uXEludGVybmV0IFNldHRpbmdzIiAtTmFtZSAiUHJveHlPdmVycmlkZSIgLVZhbHVlICIkdmFsdWUiIC1wcm9wZXJ0eXR5cGUgIlN0cmluZyIKICAgICAgICAgICAgICAgIGlmICgkcmVzdWx0KSB7CiAgICAgICAgICAgICAgICAgICAgV3JpdGUtT3V0cHV0ICJCeXBhc3Mgd2l0aCBleGNlcHRpb25zIGhhcyBiZWVuIHNldCBmb3IgJHByb2ZpbGUuIgogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9fWVsc2V7V3JpdGUtT3V0cHV0ICJGYWlsZWQgdG8gdXBkYXRlIHByb3h5IHN0YXR1cyxwcm94eWFkZHJlc3MgYW5kIGV4Y2VwdGlvbnMifQogICAgICAgICAgICBTdGFydC1TbGVlcCAtU2Vjb25kcyAxMAogICAgICAgICAgICBbZ2NdOjpjb2xsZWN0KCkKICAgICAgICAgICAgcmVnLmV4ZSBVTkxPQUQgSEtVXFRFTVAgfCBPdXQtTnVsbCAgICAgICAgICAgCiAgICB9IAogICAgY2F0Y2h7CkNvbnRpbnVlCn0gIAp9Cgp9CgogICAgJG91dHB1dCA9IFJFRyBMT0FEIEhLVVxURU1QICJDOlxVc2Vyc1xkZWZhdWx0XE5UVVNFUi5EQVQiCmlmICgkPykgewogICAgV3JpdGUtT3V0cHV0ICJgbk1ha2luZyBjaGFuZ2VzIGZvciBkZWZhdWx0IHVzZXJzIgogICAgaWYoVGVzdC1wYXRoICJSZWdpc3RyeTo6SEtVXFRFTVBcU29mdHdhcmVcTWljcm9zb2Z0XEludGVybmV0IEV4cGxvcmVyXE1haW4iKXsKICAgICAgICBpZigkaG9tZXBhZ2VibGFuayAtZXEgJHRydWUpewogICAgICAgICAgICAkcmVzdWx0ID0gQ3JlYXRlX3JlZ2lzdHJ5IC1wYXRoICJSZWdpc3RyeTo6SEtVXFRFTVBcU29mdHdhcmVcTWljcm9zb2Z0XEludGVybmV0IEV4cGxvcmVyXE1haW4iIC1OYW1lICJTdGFydCBQYWdlIiAtVmFsdWUgIiIgLXByb3BlcnR5dHlwZSAiU3RyaW5nIgogICAgICAgICAgICBpZiAoJHJlc3VsdCkgewogICAgICAgICAgICAgICAgV3JpdGUtT3V0cHV0ICJIb21lcGFnZSBoYXMgYmVlbiByZW1vdmVkIGZvciBkZWZhdWx0IHByb2ZpbGVzIgogICAgICAgICAgICB9CiAgICAgICAgICAgfQogICAgaWYgKCRob21lcGFnZSAtbmUgJG51bGwpIHsKICAgICAgICAkcmVzdWx0ID0gQ3JlYXRlX3JlZ2lzdHJ5IC1wYXRoICJSZWdpc3RyeTo6SEtVXFRFTVBcU29mdHdhcmVcTWljcm9zb2Z0XEludGVybmV0IEV4cGxvcmVyXE1haW4iIC1OYW1lICJTdGFydCBQYWdlIiAtVmFsdWUgJGhvbWVwYWdlIC1wcm9wZXJ0eXR5cGUgIlN0cmluZyIKICAgICAgICBpZiAoJHJlc3VsdCkgewogICAgICAgICAgICBXcml0ZS1PdXRwdXQgIkhvbWVwYWdlIGhhcyBiZWVuIHNldCBmb3IgZGVmYXVsdCBwcm9maWxlcy4iCiAgICAgICAgfQogICAgfQogICAgaWYgKCRkb3dubG9hZGRpciAtbmUgJG51bGwpIHsKICAgICAgICAkcmVzdWx0ID0gQ3JlYXRlX3JlZ2lzdHJ5IC1wYXRoICJSZWdpc3RyeTo6SEtVXFRFTVBcU29mdHdhcmVcTWljcm9zb2Z0XEludGVybmV0IEV4cGxvcmVyXE1haW4iIC1OYW1lICJEZWZhdWx0IERvd25sb2FkIERpcmVjdG9yeSIgLVZhbHVlICRkb3dubG9hZGRpcgogICAgICAgIGlmICgkcmVzdWx0KSB7CiAgICAgICAgICAgIFdyaXRlLU91dHB1dCAiRG93bmxvYWQgZGlyZWN0b3J5IGhhcyBiZWVuIHNldCBmb3IgZGVmYXVsdCBwcm9maWxlcy4iCiAgICAgICAgfQogICAgfX1lbHNle1dyaXRlLU91dHB1dCAiUGF0aCBub3QgZm91bmQgZm9yIGhvbWVwYWdlIGFuZCBkb3dubG9hZGRpciJ9CiAgICBpZihUZXN0LXBhdGggIlJlZ2lzdHJ5OjpIS1VcVEVNUFxTb2Z0d2FyZVxNaWNyb3NvZnRcV2luZG93c1xDdXJyZW50VmVyc2lvblxJbnRlcm5ldCBTZXR0aW5ncyIpewogICAgaWYgKCRwcm94eWVuYWJsZSAtZXEgJHRydWUpIHsKICAgICAgICAkcmVzdWx0ID0gQ3JlYXRlX3JlZ2lzdHJ5IC1wYXRoICJSZWdpc3RyeTo6SEtVXFRFTVBcU29mdHdhcmVcTWljcm9zb2Z0XFdpbmRvd3NcQ3VycmVudFZlcnNpb25cSW50ZXJuZXQgU2V0dGluZ3MiIC1OYW1lICJQcm94eUVuYWJsZSIgLVZhbHVlIDEKICAgICAgICBpZiAoJHJlc3VsdCkgewogICAgICAgICAgICBXcml0ZS1PdXRwdXQgIlByb3h5IGhhcyBiZWVuIGVuYWJsZWQgZm9yIGRlZmF1bHQgcHJvZmlsZXMuIgogICAgICAgIH0KICAgIH0KICAgIGVsc2VpZigkcHJveHllbmFibGUgLWVxICRmYWxzZSl7CiAgICAgICAgICAgICAgICAkcmVzdWx0ID0gQ3JlYXRlX3JlZ2lzdHJ5IC1wYXRoICJSZWdpc3RyeTo6SEtVXFRFTVBcU29mdHdhcmVcTWljcm9zb2Z0XFdpbmRvd3NcQ3VycmVudFZlcnNpb25cSW50ZXJuZXQgU2V0dGluZ3MiIC1OYW1lICJQcm94eUVuYWJsZSIgLVZhbHVlIDAKICAgICAgICAgICAgICAgIGlmICgkcmVzdWx0KSB7CiAgICAgICAgICAgICAgICAgICAgV3JpdGUtT3V0cHV0ICJQcm94eSBoYXMgYmVlbiBkaXNhYmxlZCBmb3IgZGVmYXVsdCBwcm9maWxlcy4iCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgIGlmICgkYXV0b3NjcmlwdCAtbmUgJG51bGwpIHsKICAgICAgICAkcmVzdWx0ID0gQ3JlYXRlX3JlZ2lzdHJ5IC1wYXRoICJSZWdpc3RyeTo6SEtVXFRFTVBcU29mdHdhcmVcTWljcm9zb2Z0XFdpbmRvd3NcQ3VycmVudFZlcnNpb25cSW50ZXJuZXQgU2V0dGluZ3MiIC1OYW1lICJBdXRvQ29uZmlnVVJMIiAtVmFsdWUgJGF1dG9zY3JpcHQgLXByb3BlcnR5dHlwZSAiU3RyaW5nIgogICAgICAgIGlmICgkcmVzdWx0KSB7CiAgICAgICAgICAgIFdyaXRlLU91dHB1dCAiQXV0b21hdGljIGNvbmZpZ3VyYXRpb24gc2NyaXB0IGhhcyBiZWVuIGVuYWJsZWQuIgogICAgICAgIH0KICAgIH0KICAgIGlmICgkcHJveHlhZGRyZXNzIC1uZSAkbnVsbCkgewogICAgICAgICR2YWx1ZSA9ICIkcHJveHlhZGRyZXNzIiArICI6IiArICIkcHJveHlwb3J0IgogICAgICAgICRyZXN1bHQgPSBDcmVhdGVfcmVnaXN0cnkgLXBhdGggIlJlZ2lzdHJ5OjpIS1VcVEVNUFxTb2Z0d2FyZVxNaWNyb3NvZnRcV2luZG93c1xDdXJyZW50VmVyc2lvblxJbnRlcm5ldCBTZXR0aW5ncyIgLU5hbWUgIlByb3h5U2VydmVyIiAtVmFsdWUgJHZhbHVlIC1wcm9wZXJ0eXR5cGUgIlN0cmluZyIKICAgICAgICBpZiAoJHJlc3VsdCkgewogICAgICAgICAgICBXcml0ZS1PdXRwdXQgIlByb3h5YWRkcmVzcyBoYXMgYmVlbiBlbmFibGVkIGZvciBkZWZhdWx0IHByb2ZpbGVzLiIKICAgICAgICB9CiAgICB9CiAgICBpZiAoKCRieXBhc3Nmb3Jsb2NhbGFkZHJlc3MgLWVxICR0cnVlKSAtYW5kICgkZXhjZXB0aW9ucyAtZXEgJG51bGwpKSB7CiAgICAgICAgJHJlc3VsdCA9IENyZWF0ZV9yZWdpc3RyeSAtcGF0aCAiUmVnaXN0cnk6OkhLVVxURU1QXFNvZnR3YXJlXE1pY3Jvc29mdFxXaW5kb3dzXEN1cnJlbnRWZXJzaW9uXEludGVybmV0IFNldHRpbmdzIiAtTmFtZSAiUHJveHlPdmVycmlkZSIgLVZhbHVlICI8bG9jYWw+IiAtcHJvcGVydHl0eXBlICJTdHJpbmciCiAgICAgICAgaWYgKCRyZXN1bHQpIHsKICAgICAgICAgICAgV3JpdGUtT3V0cHV0ICJCeXBhc3Mgd2l0aG91dCBleGNlcHRpb25zIGhhcyBiZWVuIHNldCBmb3IgZGVmYXVsdCBwcm9maWxlcy4iCiAgICAgICAgfQogICAgfQogICAgZWxzZWlmICgoJGJ5cGFzc2ZvcmxvY2FsYWRkcmVzcyAtZXEgJHRydWUpIC1hbmQgKCRleGNlcHRpb25zIC1uZSAkbnVsbCkpIHsKICAgICAgICAkdmFsdWUgPSAiJGV4Y2VwdGlvbnMiICsgIjsiICsgIjxsb2NhbD4iCiAgICAgICAgJHJlc3VsdCA9IENyZWF0ZV9yZWdpc3RyeSAtcGF0aCAiUmVnaXN0cnk6OkhLVVxURU1QXFNvZnR3YXJlXE1pY3Jvc29mdFxXaW5kb3dzXEN1cnJlbnRWZXJzaW9uXEludGVybmV0IFNldHRpbmdzIiAtTmFtZSAiUHJveHlPdmVycmlkZSIgLVZhbHVlICIkdmFsdWUiIC1wcm9wZXJ0eXR5cGUgIlN0cmluZyIKICAgICAgICBpZiAoJHJlc3VsdCkgewogICAgICAgICAgICBXcml0ZS1PdXRwdXQgIkJ5cGFzcyB3aXRoIGV4Y2VwdGlvbnMgaGFzIGJlZW4gc2V0IGZvciBkZWZhdWx0IHByb2ZpbGVzLiIKICAgICAgICB9CiAgICB9fWVsc2V7V3JpdGUtT3V0cHV0ICJGYWlsZWQgdG8gc2V0IHByb3h5YWRkcmVzcyJ9ICAgICAgICAgICAgICAgICAgICAKICAgIAp9CmVsc2UgewogICAgV3JpdGUtRXJyb3IgIkZhaWxlZCB0byBsb2FkIHJlZ2lzdHJ5IGZvciBkZWZhdWx0IHByb2ZpbGUiCn0Kc3RhcnQtc2xlZXAgLVNlY29uZHMgMTAKW2djXTo6Y29sbGVjdCgpClJFRyBVTkxPQUQgSEtVXFRFTVAKCiMkb3V0cHV0ID0gUkVHIFVOTE9BRCBIS1VcVEVNUCAyPiYxCgoKCg==","jsonSchema":{"type":"object","properties":{"homepageblank":{"type":"boolean","title":"Set blank home page","default":false},"downloaddir":{"type":"string","title":"Download Dir"},"autoscript":{"type":"string","title":"Automatic Configuration Script:"},"proxyenable":{"type":"boolean","title":"Proxy Server:"},"exceptions":{"type":"string","title":"Do Not Use Proxy Server for Addresses Beginning With:"}},"additionalproperties":false,"patternproperties":{"^homepage$":{},"^proxyaddress$":{},"^proxyport$":{},"^bypassforlocaladdress$":{}},"dependencies":{"homepageblank":{"oneOf":[{"properties":{"homepageblank":{"enum":[false]},"homepage":{"type":"string","title":"Home Page"}},"required":["homepage"]}]},"proxyenable":{"oneOf":[{"properties":{"proxyenable":{"enum":[true]},"proxyaddress":{"type":"string","title":"Address"},"proxyport":{"type":"integer","title":"Port"},"bypassforlocaladdress":{"type":"boolean","title":"Bypass for local addresses:"}},"required":["proxyaddress","proxyport"]}]}}},"uiSchema":{"homepageblank":{"classNames":"col-sm-3","ui:autofocus":true},"homepage":{"classNames":"col-sm-9","ui:autofocus":true},"downloaddir":{"classNames":"col-sm-8 col-sm-offset-right-4","ui:autofocus":true},"autoscript":{"classNames":"col-sm-8 col-sm-offset-right-4","ui:autofocus":true},"proxyenable":{"classNames":"col-sm-4 col-sm-offset-right-8","ui:autofocus":true},"exceptions":{"classNames":"col-sm-12","ui:autofocus":true,"ui:help":"Use semicolon(;) to separate entries"},"proxyaddress":{"classNames":"col-sm-9","ui:autofocus":true},"proxyport":{"classNames":"col-sm-3","ui:autofocus":true},"bypassforlocaladdress":{"classNames":"col-sm-9","ui:autofocus":true},"ui:order":["homepageblank","homepage","downloaddir","autoscript","proxyenable","proxyaddress","proxyport","bypassforlocaladdress","exceptions"]},"isHDScript":false}
