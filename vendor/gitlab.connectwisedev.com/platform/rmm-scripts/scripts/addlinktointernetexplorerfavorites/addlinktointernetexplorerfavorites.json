{"id":"028bba6f-4a2e-11e9-a745-00155d130b01","partnerId":"00000000-0000-0000-0000-000000000000","category":["Management"],"description":"Adds url to IE favorites","engine":"powershell","engineMaxVersion":5,"expectedExecutionTimeSec":300,"failureMessage":"Executed with errors","successMessage":"Successfully added to favorites","internal":false,"name":"Add link to Internet Explorer favorites","tags":["Windows 7","Windows 10"],"sequence":true,"content":"IyAkRGlzcGxheU5hbWUgPSAnVGVjaG5ldCcgIyB1c2VyaW5wdXQKIyAkVVJMID0gJ2h0dHBzOi8vbWljcm9zb2Z0LmNvbScgIyB1c2VyaW5wdXQKCmlmICgkZW52OlBST0NFU1NPUl9BUkNISVRFVzY0MzIgLWVxICJBTUQ2NCIpIHsKICAgIGlmICgkbXlJbnZvY2F0aW9uLkxpbmUpIHsKICAgICAgICAmIiRlbnY6c3lzdGVtcm9vdFxzeXNuYXRpdmVcd2luZG93c3Bvd2Vyc2hlbGxcdjEuMFxwb3dlcnNoZWxsLmV4ZSIgLU5vbkludGVyYWN0aXZlIC1Ob1Byb2ZpbGUgJG15SW52b2NhdGlvbi5MaW5lCiAgICB9CiAgICBlbHNlIHsKICAgICAgICAmIiRlbnY6c3lzdGVtcm9vdFxzeXNuYXRpdmVcd2luZG93c3Bvd2Vyc2hlbGxcdjEuMFxwb3dlcnNoZWxsLmV4ZSIgLU5vbkludGVyYWN0aXZlIC1Ob1Byb2ZpbGUgLWZpbGUgIiQoJG15SW52b2NhdGlvbi5JbnZvY2F0aW9uTmFtZSkiICRhcmdzCiAgICB9CiAgICBleGl0ICRsYXN0ZXhpdGNvZGUKfQoKRnVuY3Rpb24gQ3JlYXRlLUlFRmF2b3JpdGUgKCREaXNwbGF5TmFtZSwgJFVSTCkgewogICAgaWYoJGVudjpQUk9DRVNTT1JfQVJDSElURVc2NDMyIC1lcSAiQU1ENjQiIC1hbmQgJGVudjpQUk9DRVNTT1JfQVJDSElURUNUVVJFIC1lcSAneDg2JykgeyRRdWVyeSA9ICdjOlx3aW5kb3dzXHN5c25hdGl2ZVxxdWVyeS5leGUnfWVsc2V7JFF1ZXJ5ID0gJ2M6XHdpbmRvd3NcU3lzdGVtMzJccXVlcnkuZXhlJ30KICAgICRMb2dnZWRPblVzZXJzID0gaWYoKCRVc2VycyA9ICgmICRRdWVyeSB1c2VyKSkpewogICAgICAgICRVc2VycyB8IEZvckVhY2gtT2JqZWN0IHsoKCRfLnRyaW0oKSAtcmVwbGFjZSAiPiIgLXJlcGxhY2UgIig/bSleKFtBLVphLXowLTldezMsfSlccysoXGR7MSwyfVxzK1x3KykiLCAnJDEgIG5vbmUgICQyJyAtcmVwbGFjZSAiXHN7Mix9IiwgIiwiIC1yZXBsYWNlICJub25lIiwgJG51bGwpKX0gfAogICAgICAgICAgICAgICAgIENvbnZlcnRGcm9tLUNzdiB8CiAgICAgICAgICAgICAgICAgV2hlcmUtT2JqZWN0IHskXy5zdGF0ZSAtbmUgJ0Rpc2MnfSB8CiAgICAgICAgICAgICAgICAgU2VsZWN0LU9iamVjdCAtZXhwYW5kcHJvcGVydHkgdXNlcm5hbWUKICAgIH0KCiAgICBpZiAoJExvZ2dlZE9uVXNlcnMpIHsKICAgICAgICBmb3JlYWNoKCRJdGVtIGluICRMb2dnZWRPblVzZXJzKXsKICAgICAgICAgICAgJExvZ2dlZE9uVXNlclByb2ZpbGVQYXRoID0gR2V0LVdtaU9iamVjdCB3aW4zMl91c2VycHJvZmlsZSB8IFdoZXJlLW9iamVjdCB7JF8uU0lEIC1saWtlICJTLTEtNS0yMSoiIC1hbmQgJF8ubG9jYWxwYXRoIC1saWtlICIqXCRJdGVtIiB9IHwgU2VsZWN0LU9iamVjdCAtRXhwYW5kUHJvcGVydHkgbG9jYWxwYXRoCiAgICAgICAgICAgICRJRUZhdm91cml0ZVBhdGggPSAiJExvZ2dlZE9uVXNlclByb2ZpbGVQYXRoXEZhdm9yaXRlcyIKICAgICAgICAgICAgaWYgKFRlc3QtUGF0aCAgJElFRmF2b3VyaXRlUGF0aCkgewogICAgICAgICAgICAgICAgJFNoZWxsID0gTmV3LU9iamVjdCAtQ29tT2JqZWN0IFdTY3JpcHQuU2hlbGwKICAgICAgICAgICAgICAgICRGdWxsUGF0aCA9IEpvaW4tUGF0aCAtUGF0aCAkSUVGYXZvdXJpdGVQYXRoIC1DaGlsZFBhdGggIiQoJERpc3BsYXlOYW1lKS51cmwiCiAgICAgICAgICAgICAgICAkU2hvcnRjdXQgPSAkU2hlbGwuQ3JlYXRlU2hvcnRjdXQoJEZ1bGxQYXRoKQogICAgICAgICAgICAgICAgJFNob3J0Y3V0LlRhcmdldFBhdGggPSAkVXJsCiAgICAgICAgICAgICAgICAkU2hvcnRjdXQuU2F2ZSgpCiAgICAgICAgICAgICAgICAkQ29udGVudENoZWNrID0gR2V0LUNvbnRlbnQgJEZ1bGxQYXRoIHwgV2hlcmUtT2JqZWN0IHskXyAtbGlrZSAiVVJMPSoifQogICAgICAgICAgICAgICAgaWYgKChUZXN0LVBhdGggJEZ1bGxQYXRoKSAtYW5kICgkQ29udGVudENoZWNrIC1saWtlICIqVVJMPSRVUkwqIikpIHsKICAgICAgICAgICAgICAgICAgICBXcml0ZS1PdXRwdXQgIlN1Y2Nlc3NmdWx5IGFkZGVkIExpbms6YCckVVJMYCcgd2l0aCBOYW1lOmAnJERpc3BsYXlOYW1lYCcgZm9yIFVzZXI6IGAnJEl0ZW1gJyIKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgIFdyaXRlLU91dHB1dCAiRmFpbGVkIHRvIGFkZCBsaW5rOmAnJFVSTGAnIHdpdGggTmFtZTpgJyREaXNwbGF5TmFtZWAnIGZvciBVc2VyOiBgJyRJdGVtYCciCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICBXcml0ZS1FcnJvciAiUGF0aDogYCckSUVGYXZvdXJpdGVQYXRoYCcgZG9lc24ndCBleGlzdC4gRmFpbGVkIHRvIGFkZCBsaW5rLiBmb3IgVXNlcjogYCckSXRlbWAnIgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQogICAgZWxzZSB7IFdyaXRlLU91dHB1dCAnTm8gdXNlcnMgbG9nZ2VkLW9uIHRoZSBtYWNoaW5lLiBObyBhY3Rpb24gd2lsbCBiZSBwZXJmb3JtZWQuJzsgZXhpdDsgfQp9CiAgICAKJEVycm9yQWN0aW9uUHJlZmVyZW5jZSA9ICdzdG9wJwp0cnkgewogICAgQ3JlYXRlLUlFRmF2b3JpdGUgLURpc3BsYXlOYW1lICREaXNwbGF5TmFtZSAtVVJMICRVUkwKfQpjYXRjaCB7CiAgICBXcml0ZS1FcnJvciAkXwp9Cg==","jsonSchema":{"additionalproperties":false,"properties":{"displayname":{"title":"Display Name","type":"string"},"url":{"title":"URL","type":"string"}},"required":["displayname","url"],"type":"object"},"uiSchema":{"displayname":{"classNames":"col-sm-6","ui:autofocus":true},"url":{"classNames":"col-sm-6","ui:autofocus":true}},"isHDScript":false}