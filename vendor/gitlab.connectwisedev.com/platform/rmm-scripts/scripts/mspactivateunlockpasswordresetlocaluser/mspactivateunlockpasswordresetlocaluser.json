{"id":"70262c99-913f-11e9-af7f-00155d130b01","partnerId":"00000000-0000-0000-0000-000000000000","category":["Maintenance"],"description":"This script will reset the password of locked or disable local user","engine":"powershell","engineMaxVersion":5,"expectedExecutionTimeSec":300,"failureMessage":"Executed with errors","successMessage":"Password Reset of Locked or disabled local account Successful","internal":false,"name":"Password Reset for Local Locked Or Disabled User","tags":["Windows 7","Windows 10"],"sequence":true,"content":"PCMKLlNZTk9QU0lTCkRldmVsb3BlZCBCeSA6IEdSVCBbSEQtQXV0b21hdGlvbl0gLCBDb250aW51dW0KRmlsZSBWZXNpb24gOiAyLjAKLkRFU0NSSVBUSU9OClRoZSBzY3JpcHQgaXMgZGVzaWduZWQgdG8gY2hhbmdlIHRoZSBwYXNzd29yZCBvZiBsb2NhbCB1c2VyIHdob3NlIGFjY291bnQgaXMgbG9ja2VkL2Rpc2FibGVkIG9yIGJvdGggYWxzbyBjaGFuZ2UgaXQgdG8gRW5hYmxlIGFuZCBVbmxvY2sgaWYgTG9jYWwgVXNlciBhY2NvdW50IGlzIExvY2tlZC9EaXNhYmxlZCBvciBib3RoLgouUEFSQU1FVEVSIApMb2NhbFVzZXJJRCBpcyB0aGUgdmFyaWFibGUgcmVxdWlyZWQgZm9yIGNoYW5naW5nIHRoZSBwYXNzd29yZC4KLlBBUkFNRVRFUiAKQ2hhbmdlUGFzc3dvcmQgaXMgdGhlIHBhc3N3b3JkIHdoaWNoIG5lZWRzIHRvIGJlIHNldCBhcyBwYXNzd29yZCBmb3IgdGhlIHVzZXIgYWNjb3VudC4KLlBBUkFNRVRFUgpDaGFuZ2VQd2ROZXh0TG9nb24gaXMgYSBib29sZWFuLiBUcnVlIG1lYW5zIHRvIHNldCBDaGFuZ2UgUGFzc3dvcmQgb24gbmV4dCBsb2dvbi4KLkV4YW1wbGUKJExvY2FsVXNlcklEID0gImhkMSIKJENoYW5nZVBhc3N3b3JkID0gIkVEMyVWIgokQ2hhbmdlUHdkTmV4dExvZ29uPSRmYWxzZQojPgo8IyBDb21wYXRpYmlsaXR5IENoZWNrIGlmIGZvdW5kIGluY29tcGF0aWJsZSB3aWxsIGV4aXQjPgp0cnl7CiAgICAkT1NWZXJzaW9uPShbc3lzdGVtLmVudmlyb25tZW50XTo6T1NWZXJzaW9uLlZlcnNpb24pLk1ham9yCiAgICAkUFNWZXJzaW9uID0oR2V0LUhvc3QpLnZlcnNpb24KICAgIGlmKCgkT1NWZXJzaW9uIC1sdCA2KSAtb3IgKCRQU1ZlcnNpb24uTWFqb3IgLWx0IDIpKQogICAgewogICAgV3JpdGUtT3V0cHV0ICJbTVNHIDogSW5jb21wYXRpYmxlIFN5c3RlbSBFaXRoZXIgT1MgaXMgYmVsb3cgd2luZG93cyA3LzIwMDhSMiBvciBwb3dlcnNoZWxsIHZlcnNpb24gbGVzcyB0aGFuIDIuMF0iCiAgICBFeGl0IAogICAgfQogICAgPCMgZWxzZXtXcml0ZS1vdXRwdXQgIltNU0c6IEdvb2QgdG8gR29dIn0gIz4KICAgIH1jYXRjaHsgV3JpdGUtT3V0cHV0ICJbTVNHOiAkXy5FeGNlcHRpb24ubWVzc2FnZV0ifQogICAgJE91dHB1dE1lc3NhZ2UgPSBAKCkgPCMgVmFyaWFibGUgdG8gY2FwdHVyZSBPdXRwdXQgZm9yIGRlYnVnZ2luZyBwdXJwb3NlLiM+CiAgICAgPCMgSWYgJERDIGlzIGVxdWFsbCB0byA0KGJhY2t1cCBEQykgb3IgNShwcmltYXJ5IERDKSBhcyB0aGVyZSBpcyBubyBsb2NhbCB1c2VyIG9uIERvbWFpbiBDb250cm9sbGVyICM+ICAgCiAgICAgICAgICAgIHRyeXsKICAgICAgICAgICAgICAgICAkREMgPSAoR2V0LVdtaU9iamVjdCBXaW4zMl9Db21wdXRlclN5c3RlbSkuZG9tYWlucm9sZQogICAgICAgICAgICAgICAgfWNhdGNoeyBXcml0ZS1lcnJvciAiIFVuYWJsZSB0byBDaGVjayBpZiBtYWNoaW5lIGlzIERvbWFpbiBDb250cm9sbGVyICRfLkV4Y2VwdGlvbi5tZXNzYWdlIiB9CiAgICAgICAgICAgIGlmKCREQyAtZXEgIjQiIC1vciAkREMgLWVxICI1IikKICAgICAgICAgICAgICAgIHsgICAKICAgICAgICAgICAgICAgICAgICAkT3V0cHV0TWVzc2FnZSArPSAiTm8gTG9jYWwgVXNlciBvbiBEb21haW4gQ29udHJvbGxlci4iICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgPCNDaGVjayBpZiBVc2VyIEV4aXN0Iz4KICAgICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgJExvY2FsdXNlciA9ICBHZXQtV21pT2JqZWN0IC1DbGFzcyBXaW4zMl9Vc2VyQWNjb3VudCAtRmlsdGVyICJMb2NhbEFjY291bnQ9J1RydWUnIGFuZCBOYW1lPSckTG9jYWxVc2VySUQnIiB8IFNlbGVjdCBQU0NvbXB1dGVybmFtZSwgTG9jYWxBY2NvdW50LCBTdGF0dXMsRGlzYWJsZWQsIEFjY291bnRUeXBlLCBMb2Nrb3V0LCBQYXNzd29yZFJlcXVpcmVkLCBQYXNzd29yZENoYW5nZWFibGUsIFBhc3N3b3JkRXhwaXJlcywgU0lECiAgICAgICAgICAgICAgICAgICAgIH1jYXRjaHsgV3JpdGUtZXJyb3IgIiBVbmFibGUgdG8gY2hlY2sgZ2V0IExvY2FsIHVzZXIgaW5mb3JtYXRpb24gJF8uRXhjZXB0aW9uLm1lc3NhZ2UiIH0KICAgICAgICAgICAgICAgICAgICBpZiAoJExvY2FsdXNlcikKICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICB0cnl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJE1hY2hpbmVOYW1lID0gJGVudjpDT01QVVRFUk5BTUUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkVXNyQ29tbWFuZCA9W0FEU0ldICJXaW5OVDovLyRNYWNoaW5lTmFtZS8kTG9jYWxVc2VySUQsIHVzZXIiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPCMgSWYgYWNjb3VudCBpcyBMb2NrZWRvdXQjPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCRMb2NhbHVzZXIuTG9ja291dCAtZXEgJFRydWUpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkVXNyQ29tbWFuZC5Jc0FjY291bnRMb2NrZWQgPSAkRmFsc2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJFVzckNvbW1hbmQuU2V0aW5mbygpIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8IyBJZiBhY2NvdW50IGlzIERpc2FibGVkIz4gICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoJExvY2FsdXNlci5EaXNhYmxlZCAtZXEgJFRydWUpIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJFVzZXJBY2NvdW50UHJvcGVydGllcyA9IEdldC1XbWlPYmplY3QgLUNsYXNzIFdpbjMyX1VzZXJBY2NvdW50IC1GaWx0ZXIgIkxvY2FsQWNjb3VudD0nVHJ1ZScgYW5kIE5hbWU9JyRMb2NhbFVzZXJJRCciICN8ICV7JF8uZGlzYWJsZWQ9JGZhbHNlOyRfLnB1dCgpfSB8IG91dC1udWxsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRVc2VyQWNjb3VudFByb3BlcnRpZXMuRGlzYWJsZWQgPSAkZmFsc2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJFVzZXJBY2NvdW50UHJvcGVydGllcy5QdXQoKSB8IG91dC1udWxsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8IyByZXNldCB0aGUgcGFzc3dvcmQjPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRVc3JDb21tYW5kLlNldFBhc3N3b3JkKCRDaGFuZ2VQYXNzd29yZCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkVXNyQ29tbWFuZC5TZXRpbmZvKCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkT3V0cHV0TWVzc2FnZSArPSAiUGFzc3dvcmQgQ2hhbmdlZCBTdWNjZXNzZnVsbHkuIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwjIElmIFVzZXIgbmVlZHMgdG8gY2hhbmdlIGF0IG5leHQgbG9nb24jPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCRDaGFuZ2VQd2ROZXh0TG9nb24gLWVxICR0cnVlKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoKCRMb2NhbHVzZXIuUGFzc3dvcmRDaGFuZ2VhYmxlIC1lcSAkVHJ1ZSkgLUFuZCAoJExvY2FsdXNlci5QYXNzd29yZEV4cGlyZXMgLWVxICR0cnVlKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8IyBVc2UgdG8gY2hlY2sgZm9yIGZvcmNlIHB3ZCBjaGFuZ2UgYXQgbmV4dCBsb2dvbi4gSWYgUGFzc3dvcmRDaGFuZ2VhYmxlIGFuZCBQYXNzd29yZEV4cGlyZXMgaXMgRmFsc2UgdGhlIG9wdGlvbiBvciBQYXNzd29yZCBjaGFuZ2UgYXQgbmV4dCBsb2dvbiBpcyBncmF5ZWQgb3V0LiM+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkVXNyQ29tbWFuZC5QYXNzd29yZEV4cGlyZWQgPSAxICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRVc3JDb21tYW5kLlNldGluZm8oKSAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBFbHNlIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJE91dHB1dE1lc3NhZ2UgKz0gIlVzZXIgQ2FuJ3QgQ2hhbmdlIHBhc3N3b3JkIGF0IG5leHQgbG9nb24gYmVjYXVzZSBFaXRoZXIgaXQgaXMgU2V0IHRvIG5ldmVyIEV4cGlyZWQgb3IgQ2Fubm90IENoYW5nZSBQYXNzd29yZC4iCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9ICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRPdXRwdXRNZXNzYWdlICs9ICJOZXh0IExvZ29uIFBhc3N3b3JkIENoYW5nZSBpcyBub3QgY29uZmlncnVlZCBieSBUZWNobmljaWFuLiIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1jYXRjaCB7V3JpdGUtZXJyb3IgIiBVbmFibGUgdG8gY2hhbmdlIHBhc3N3b3JkICRfLkV4Y2VwdGlvbi5tZXNzYWdlIn0KICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5ewogICAgICAgICAgICAgICAgICAgICAgICAgICAgJExvY2FsdXNlciA9ICBHZXQtV21pT2JqZWN0IC1DbGFzcyBXaW4zMl9Vc2VyQWNjb3VudCAtRmlsdGVyICJMb2NhbEFjY291bnQ9J1RydWUnIiB8IFNlbGVjdCBOYW1lLERpc2FibGVkLExvY2tvdXQKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcigkaT0wOyAkaSAtbHQgJExvY2FsdXNlci5sZW5ndGggOyAkaSsrKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgeyAgICRUZW1wVXNlcj0kTG9jYWx1c2VyWyRpXS5OYW1lCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHVzZXJhY2NvdW50ZXhwaXJhdGlvbiA9IFthZHNpXSJXaW5OVDovLy4vJFRlbXBVc2VyLCB1c2VyIiB8IFNlbGVjdCBBY2NvdW50RXhwaXJhdGlvbkRhdGUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkT3V0cHV0TWVzc2FnZSArPSAiTmFtZSA6IiskTG9jYWx1c2VyWyRpXS5OYW1lIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRPdXRwdXRNZXNzYWdlICs9ICJEaXNhYmxlZCA6IiskTG9jYWx1c2VyWyRpXS5EaXNhYmxlZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRPdXRwdXRNZXNzYWdlICs9ICJMb2Nrb3V0IDoiKyRMb2NhbHVzZXJbJGldLkxvY2tvdXQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkT3V0cHV0TWVzc2FnZSArPSAiQWNjb3VudEV4cGlyYXRpb25EYXRlIDoiKyR1c2VyYWNjb3VudGV4cGlyYXRpb24uQWNjb3VudEV4cGlyYXRpb25EYXRlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJE91dHB1dE1lc3NhZ2UgKz0gIiAiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9Y2F0Y2h7IFdyaXRlLWVycm9yICIgVW5hYmxlIHRvIGdldCBsaXN0IG9mIExvY2FsIFVzZXIgQWNjb3VudCAiIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgV3JpdGUtT3V0cHV0ICRPdXRwdXRNZXNzYWdlCg==","jsonSchema":{"additionalProperties":false,"properties":{"ChangePassword":{"minLength":1,"title":"Password","type":"string"},"ChangePwdNextLogon":{"title":"Change password at next logon","type":"boolean"},"LocalUserID":{"minLength":1,"title":"User name","type":"string"}},"required":["LocalUserID","ChangePassword"],"type":"object"},"uiSchema":{"ChangePassword":{"classNames":"col-sm-6","ui:help":"Hint: Make it strong!","ui:widget":"password"},"ChangePwdNextLogon":{"classNames":"col-sm-6"},"LocalUserID":{"classNames":"col-sm-12","ui:autofocus":true},"ui:order":["LocalUserID","ChangePassword","ChangePwdNextLogon"]},"isHDScript":false}
