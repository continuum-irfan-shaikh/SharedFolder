{"id":"e9c6222f-6b64-11e9-8059-00155d130b01","partnerId":"00000000-0000-0000-0000-000000000000","category":["Setup"],"description":"Configure Windows Explorer","engine":"powershell","engineMaxVersion":5,"expectedExecutionTimeSec":300,"failureMessage":"Executed with errors","successMessage":"Excecuted successfully","internal":false,"name":"Configure Windows Explorer","tags":["Windows 7","Windows 10"],"sequence":true,"content":"PCMKICAuU2NyaXB0CiAgQ29uZmlndXJlIHdpbmRvd3MgZXhwbG9yZXIuCiAgLkF1dGhvcgogIE5pcmF2IFNhY2hvcmEuCiAgLlZlcnNpb24KICAyLjAgYW5kIGFib3ZlLgogIC5SZXF1aXJlbWVudHMKICBTY3JpcHQgc2hvdWxkIHJ1biB3aXRoIGhpZ2hlc3QgcHJpdmlsZWdlcy4KIz4KCjwjJHJlbW92ZWZvbGRlcm9wdGlvbnMKJHJlbW92ZWZpbGVtZW51CiRkaXNjb25uZWN0bmV0d29ya2RyaXZlCiRyZW1vdmVjb250ZXh0bWVudSM+CgppZiAoJGVudjpQUk9DRVNTT1JfQVJDSElURVc2NDMyIC1lcSAiQU1ENjQiKSB7CiAgICBpZiAoJG15SW52b2NhdGlvbi5MaW5lKSB7CiAgICAgICAgJiIkZW52OnN5c3RlbXJvb3Rcc3lzbmF0aXZlXHdpbmRvd3Nwb3dlcnNoZWxsXHYxLjBccG93ZXJzaGVsbC5leGUiIC1Ob25JbnRlcmFjdGl2ZSAtTm9Qcm9maWxlICRteUludm9jYXRpb24uTGluZQogICAgfQogICAgZWxzZSB7CiAgICAgICAgJiIkZW52OnN5c3RlbXJvb3Rcc3lzbmF0aXZlXHdpbmRvd3Nwb3dlcnNoZWxsXHYxLjBccG93ZXJzaGVsbC5leGUiIC1Ob25JbnRlcmFjdGl2ZSAtTm9Qcm9maWxlIC1maWxlICIkKCRteUludm9jYXRpb24uSW52b2NhdGlvbk5hbWUpIiAkYXJncwogICAgfQogICAgZXhpdCAkbGFzdGV4aXRjb2RlCn0KCgpGdW5jdGlvbiBDcmVhdGVfcmVnaXN0cnkoJHBhdGgsICROYW1lLCAkVmFsdWUsICRwcm9wZXJ0eXR5cGUpIHsKICAgICMgRnVuY3Rpb24gd2lsbCBzZXQgcmVnaXN0cnkgdmFsdWUgYW5kIGlmIGl0ZW0gaXMgbm90IHByZXNlbnQgd2lsbCBjcmVhdGUgcmVnaXN0cnkgZW50cnkuCiAgICAkRGV0YWlscyA9IEdldC1JdGVtUHJvcGVydHkgLVBhdGggJHBhdGgKICAgIGlmICgkRGV0YWlscyAtbmUgJG51bGwpIHsKICAgICAgICAkRGV0YWlscyA9IEdldC1JdGVtUHJvcGVydHkgLVBhdGggJHBhdGggfCBnbSB8IHNlbGVjdCAtRXhwYW5kUHJvcGVydHkgTmFtZQogICAgICAgIGlmICgkRGV0YWlscyAtY29udGFpbnMgJE5hbWUpIHsKICAgICAgICAgICAgU2V0LUl0ZW1Qcm9wZXJ0eSAkcGF0aCAtTmFtZSAkTmFtZSAtVmFsdWUgJFZhbHVlCiAgICAgICAgfQogICAgICAgIGVsc2UgewogICAgICAgICAgICBOZXctSXRlbVByb3BlcnR5IC1QYXRoICRwYXRoIC1OYW1lICROYW1lIC1Qcm9wZXJ0eVR5cGUgJHByb3BlcnR5dHlwZSAtVmFsdWUgJFZhbHVlIHwgT3V0LU51bGwKICAgICAgICB9CgkKICAgIH0gI0VuZCBpZiBzdGF0ZW1lbnQKICAgIGVsc2UgewogICAgICAgIE5ldy1JdGVtUHJvcGVydHkgLVBhdGggJHBhdGggLU5hbWUgJE5hbWUgLVByb3BlcnR5VHlwZSAkcHJvcGVydHl0eXBlIC1WYWx1ZSAkVmFsdWUgfCBPdXQtTnVsbAogICAgfSAgIyBFbmQgZWxzZSBzdGF0ZW1lbnQKCiAgICBpZiAoKEdldC1JdGVtUHJvcGVydHkgJHBhdGggLU5hbWUgJE5hbWUgfCBzZWxlY3QgLUV4cGFuZFByb3BlcnR5ICROYW1lKSAtZXEgJFZhbHVlKSB7IHJldHVybiAkdHJ1ZSB9IGVsc2UgeyByZXR1cm4gJGZhbHNlIH0KfQoKaWYoJHJlbW92ZWZvbGRlcm9wdGlvbnMgLWVxICJFbmFibGUiKXsKICAgIGlmKENyZWF0ZV9yZWdpc3RyeSAtcGF0aCAiUmVnaXN0cnk6OkhLRVlfTE9DQUxfTUFDSElORVxTT0ZUV0FSRVxNaWNyb3NvZnRcV2luZG93c1xDdXJyZW50VmVyc2lvblxwb2xpY2llc1xFeHBsb3JlciIgLU5hbWUgIk5vRm9sZGVyT3B0aW9ucyIgLVZhbHVlIDAgLXByb3BlcnR5dHlwZSAiRFdvcmQiKXsKICAgICAgICBXcml0ZS1PdXRwdXQgIkZvbGRlciBvcHRpb25zIGhhcyBiZWVuIGVuYWJsZWQuIgogICAgfQp9CmVsc2VpZigkcmVtb3ZlZm9sZGVyb3B0aW9ucyAtZXEgIkRpc2FibGUiKXsKICAgIGlmKENyZWF0ZV9yZWdpc3RyeSAtcGF0aCAiUmVnaXN0cnk6OkhLRVlfTE9DQUxfTUFDSElORVxTT0ZUV0FSRVxNaWNyb3NvZnRcV2luZG93c1xDdXJyZW50VmVyc2lvblxwb2xpY2llc1xFeHBsb3JlciIgLU5hbWUgIk5vRm9sZGVyT3B0aW9ucyIgLVZhbHVlIDEgLXByb3BlcnR5dHlwZSAiRFdvcmQiKXsKICAgICAgICBXcml0ZS1PdXRwdXQgIkZvbGRlciBvcHRpb25zIGhhcyBiZWVuIGRpc2FibGVkLiIKICAgIH0KfQoKaWYoJHJlbW92ZWZpbGVtZW51IC1lcSAiRW5hYmxlIil7CiAgICBpZihDcmVhdGVfcmVnaXN0cnkgLXBhdGggIlJlZ2lzdHJ5OjpIS0VZX0xPQ0FMX01BQ0hJTkVcU09GVFdBUkVcTWljcm9zb2Z0XFdpbmRvd3NcQ3VycmVudFZlcnNpb25ccG9saWNpZXNcRXhwbG9yZXIiIC1OYW1lICJOb0ZpbGVNZW51IiAtVmFsdWUgMCAtcHJvcGVydHl0eXBlICJEV29yZCIpewogICAgICAgIFdyaXRlLU91dHB1dCAiRmlsZSBtZW51IGhhcyBiZWVuIGVuYWJsZWQuIgogICAgfQp9CmVsc2VpZigkcmVtb3ZlZmlsZW1lbnUgLWVxICJEaXNhYmxlIil7CiAgICBpZihDcmVhdGVfcmVnaXN0cnkgLXBhdGggIlJlZ2lzdHJ5OjpIS0VZX0xPQ0FMX01BQ0hJTkVcU09GVFdBUkVcTWljcm9zb2Z0XFdpbmRvd3NcQ3VycmVudFZlcnNpb25ccG9saWNpZXNcRXhwbG9yZXIiIC1OYW1lICJOb0ZpbGVNZW51IiAtVmFsdWUgMSAtcHJvcGVydHl0eXBlICJEV29yZCIpewogICAgICAgIFdyaXRlLU91dHB1dCAiRmlsZSBtZW51IGhhcyBiZWVuIGRpc2FibGVkLiIKICAgIH0KfQoKaWYoJGRpc2Nvbm5lY3RuZXR3b3JrZHJpdmUgLWVxICJFbmFibGUiKXsKICAgIGlmKENyZWF0ZV9yZWdpc3RyeSAtcGF0aCAiUmVnaXN0cnk6OkhLRVlfTE9DQUxfTUFDSElORVxTT0ZUV0FSRVxNaWNyb3NvZnRcV2luZG93c1xDdXJyZW50VmVyc2lvblxwb2xpY2llc1xFeHBsb3JlciIgLU5hbWUgIk5vTmV0Q29ubmVjdERpc2Nvbm5lY3QiIC1WYWx1ZSAwIC1wcm9wZXJ0eXR5cGUgIkRXb3JkIil7CiAgICAgICAgV3JpdGUtT3V0cHV0ICJuZXR3b3JrIGRyaXZlIGhhcyBiZWVuIGVuYWJsZWQuIgogICAgfQp9CmVsc2VpZigkZGlzY29ubmVjdG5ldHdvcmtkcml2ZSAtZXEgIkRpc2FibGUiKXsKICAgIGlmKENyZWF0ZV9yZWdpc3RyeSAtcGF0aCAiUmVnaXN0cnk6OkhLRVlfTE9DQUxfTUFDSElORVxTT0ZUV0FSRVxNaWNyb3NvZnRcV2luZG93c1xDdXJyZW50VmVyc2lvblxwb2xpY2llc1xFeHBsb3JlciIgLU5hbWUgIk5vTmV0Q29ubmVjdERpc2Nvbm5lY3QiIC1WYWx1ZSAxIC1wcm9wZXJ0eXR5cGUgIkRXb3JkIil7CiAgICAgICAgV3JpdGUtT3V0cHV0ICJuZXR3b3JrIGRyaXZlIGhhcyBiZWVuIGRpc2FibGVkLiIKICAgIH0KfQoKaWYoJHJlbW92ZWNvbnRleHRtZW51IC1lcSAiRW5hYmxlIil7CiAgICBpZihDcmVhdGVfcmVnaXN0cnkgLXBhdGggIlJlZ2lzdHJ5OjpIS0VZX0xPQ0FMX01BQ0hJTkVcU09GVFdBUkVcTWljcm9zb2Z0XFdpbmRvd3NcQ3VycmVudFZlcnNpb25ccG9saWNpZXNcRXhwbG9yZXIiIC1OYW1lICJOb1ZpZXdDb250ZXh0TWVudSIgLVZhbHVlIDAgLXByb3BlcnR5dHlwZSAiRFdvcmQiKXsKICAgICAgICBXcml0ZS1PdXRwdXQgIkNvbnRleHQgbWVudSBoYXMgYmVlbiBlbmFibGVkLiIKICAgIH0KfQplbHNlaWYoJHJlbW92ZWNvbnRleHRtZW51IC1lcSAiRGlzYWJsZSIpewogICAgaWYoQ3JlYXRlX3JlZ2lzdHJ5IC1wYXRoICJSZWdpc3RyeTo6SEtFWV9MT0NBTF9NQUNISU5FXFNPRlRXQVJFXE1pY3Jvc29mdFxXaW5kb3dzXEN1cnJlbnRWZXJzaW9uXHBvbGljaWVzXEV4cGxvcmVyIiAtTmFtZSAiTm9WaWV3Q29udGV4dE1lbnUiIC1WYWx1ZSAxIC1wcm9wZXJ0eXR5cGUgIkRXb3JkIil7CiAgICAgICAgV3JpdGUtT3V0cHV0ICJjb250ZXh0IG1lbnUgaGFzIGJlZW4gZGlzYWJsZWQuIgogICAgfQp9CgoKCgo=","jsonSchema":{"type":"object","properties":{"removefolderoptions":{"type":"string","title":"Remove folder options menu item from the tools menu","enum":["Enable","Disable"]},"removefilemenu":{"type":"string","title":"Remove File menu from Explorer","enum":["Enable","Disable"]},"disconnectnetworkdrive":{"type":"string","title":"Remove 'Map network drive' and 'Disconnect network drive","enum":["Enable","Disable"]},"removecontextmenu":{"type":"string","title":"Remove Context Menu in Shell folders","enum":["Enable","Disable"]}},"additionalproperties":false},"uiSchema":{"removefolderoptions":{"classNames":"col-sm-7","ui:autofocus":true,"ui:placeholder":"No Change"},"removefilemenu":{"classNames":"col-sm-7","ui:autofocus":true,"ui:placeholder":"No Change"},"disconnectnetworkdrive":{"classNames":"col-sm-7","ui:autofocus":true,"ui:placeholder":"No Change"},"removecontextmenu":{"classNames":"col-sm-7","ui:autofocus":true,"ui:placeholder":"No Change"},"ui:order":["removefolderoptions","removefilemenu","disconnectnetworkdrive","removecontextmenu"]},"isHDScript":false}
