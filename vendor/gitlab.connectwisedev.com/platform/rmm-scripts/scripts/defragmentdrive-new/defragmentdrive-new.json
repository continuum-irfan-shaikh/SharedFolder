{"id":"d0b0ae84-41b5-11ea-8f80-00155d130b01","partnerId":"00000000-0000-0000-0000-000000000000","category":["Maintenance"],"description":"Defragment selected drives on desktops and servers.","engine":"powershell","engineMaxVersion":5,"expectedExecutionTimeSec":43200,"failureMessage":"Executed with errors","successMessage":"Executed successfully","internal":false,"name":"Defragment drive (new)","tags":["Windows 7","Windows 10"],"sequence":true,"content":"PCMKCS5TY3JpcHQgbmFtZQoJRHJpdmUgRGVmcmFnbWVudGF0aW9uCgkuQXV0aG9yCglOaXJhdiBTYWNob3JhCgkuVmVyc2lvbgoJMS4wCgkuVmFyaWFibGUgTGlzdAoJCSREZWZyYWdEcml2ZSA9ICJBbGwgRHJpdmVzIiwiV2luZG93cyBEcml2ZXMiLCJTcGVjaWZ5IERyaXZlcyIKCQkkQSAgIHRvICAgICRaCgkuTGFzdCB1cGRhdGVkIGRhdGUKCTE0LTEtMjAyMAojPgo8IwokRGVmcmFnRHJpdmUgPSAiQWxsIERyaXZlcyIKCiRjID0gInRydWUiCiM+CmlmICgkZW52OlBST0NFU1NPUl9BUkNISVRFVzY0MzIgLWVxICJBTUQ2NCIpIHsKICAgIGlmICgkbXlJbnZvY2F0aW9uLkxpbmUpIHsKICAgICAgICAmIiRlbnY6c3lzdGVtcm9vdFxzeXNuYXRpdmVcd2luZG93c3Bvd2Vyc2hlbGxcdjEuMFxwb3dlcnNoZWxsLmV4ZSIgLU5vbkludGVyYWN0aXZlIC1Ob1Byb2ZpbGUgJG15SW52b2NhdGlvbi5MaW5lCiAgICB9CiAgICBlbHNlIHsKICAgICAgICAmIiRlbnY6c3lzdGVtcm9vdFxzeXNuYXRpdmVcd2luZG93c3Bvd2Vyc2hlbGxcdjEuMFxwb3dlcnNoZWxsLmV4ZSIgLU5vbkludGVyYWN0aXZlIC1Ob1Byb2ZpbGUgLWZpbGUgIiQoJG15SW52b2NhdGlvbi5JbnZvY2F0aW9uTmFtZSkiICRhcmdzCiAgICB9CiAgICBleGl0ICRsYXN0ZXhpdGNvZGUKfQoKZnVuY3Rpb24gUmV0dXJudmFsdWVfZ2VuZXJhdG9yKCR2YWx1ZSkgewoKICAgIHN3aXRjaCAoJHZhbHVlKSB7CiAgICAgICAgMCB7ICRyZXN1bHRNc2cgPSAnU3VjY2Vzcyc7IGJyZWFrIH0KICAgICAgICAxIHsgJHJlc3VsdE1zZyA9ICdBY2Nlc3MgRGVuaWVkJzsgYnJlYWsgfQogICAgICAgIDIgeyAkcmVzdWx0TXNnID0gJ05vdCBTdXBwb3J0ZWQnOyBicmVhayB9CiAgICAgICAgMyB7ICRyZXN1bHRNc2cgPSAnVm9sdW1lIERpcnR5IEJpdCBTZXQnOyBicmVhayB9CiAgICAgICAgNCB7ICRyZXN1bHRNc2cgPSAnTm90IEVub3VnaCBGcmVlIFNwYWNlJzsgYnJlYWsgfQogICAgICAgIDUgeyAkcmVzdWx0TXNnID0gJ0NvcnJ1cHQgTUZUIERldGVjdGVkJzsgYnJlYWsgfQogICAgICAgIDYgeyAkcmVzdWx0TXNnID0gJ0NhbGwgQ2FuY2VsbGVkJzsgYnJlYWsgfQogICAgICAgIDcgeyAkcmVzdWx0TXNnID0gJ0NhbmNlbGxhdGlvbiBSZXF1ZXN0IFJlcXVlc3RlZCBUb28gTGF0ZSc7IGJyZWFrIH0KICAgICAgICA4IHsgJHJlc3VsdE1zZyA9ICdEZWZyYWcgSW4gUHJvZ3Jlc3MnOyBicmVhayB9CiAgICAgICAgOSB7ICRyZXN1bHRNc2cgPSAnRGVmcmFnIEVuZ2luZSBVbmF2YWlsYWJsZSc7IGJyZWFrIH0KICAgICAgICAxMCB7ICRyZXN1bHRNc2cgPSAnRGVmcmFnIEVuZ2luZSBFcnJvcic7IGJyZWFrIH0KICAgICAgICBkZWZhdWx0IHsgJHJlc3VsdE1zZyA9ICdVbmtub3duIEVycm9yJyB9CiAgICB9CiAgICByZXR1cm4gJHJlc3VsdE1zZwp9CgoKZnVuY3Rpb24gZGVmcmFnX2RyaXZlKCRkcml2ZW5hbWUpIHsKICAgIGlmKCREZWZyYWdEcml2ZSAtZXEgIlNwZWNpZnkgRHJpdmVzIil7CiAgICAgICAgJGFsbGRyaXZlbmFtZXMgPSBHZXQtV21pT2JqZWN0IHdpbjMyX3ZvbHVtZSAtRmlsdGVyICJkcml2ZXR5cGUgPSAzIiB8IFdoZXJlLU9iamVjdCB7ICRfLkRyaXZlTGV0dGVyIC1uZSAkbnVsbCB9IHwgU2VsZWN0LU9iamVjdCAtRXhwYW5kUHJvcGVydHkgRHJpdmVMZXR0ZXIKICAgICAgICBpZighKCRhbGxkcml2ZW5hbWVzIC1jb250YWlucyAkZHJpdmVuYW1lKSl7CiAgICAgICAgICAgICItIiozMCsiYG5bTm90IEZvdW5kXWAiJGRyaXZlbmFtZWAiIGRyaXZlIGlzIG5vdCBwcmVzZW50IGluIHRoZSBzeXN0ZW0uYG4iKyItIiozMAogICAgICAgICAgICByZXR1cm4KICAgICAgICB9ICAKICAgIH0KICAgIHRyeSB7CiAgICAgICAgJEVycm9yQWN0aW9uUHJlZmVyZW5jZSA9ICJTdG9wIgogICAgICAgICRyZXN1bHQgPSBHZXQtV21pT2JqZWN0IHdpbjMyX3ZvbHVtZSAtZmlsdGVyICJkcml2ZWxldHRlcj0nJGRyaXZlJyIgfCBJbnZva2UtV21pTWV0aG9kIC1OYW1lIERlZnJhZyB8IFNlbGVjdC1PYmplY3QgLUV4cGFuZFByb3BlcnR5IFJldHVyblZhbHVlCiAgICB9CiAgICBjYXRjaCB7CiAgICAgICAgJEVycm9yQWN0aW9uUHJlZmVyZW5jZSA9ICJDb250aW51ZSIKICAgICAgICAiW0VSUk9SXTpVbmtub3duIGVycm9yIG9jY3VyZWQiICAjY2FuIGJlIGNoYW5nZWQsIHJhdGhlciB0aGF0IGV4aXQsIHJldHVybiBmcm9tIGZ1bmN0aW9uCiAgICAgICAgRXhpdDsKICAgIH0KCiAgICAkcmVzdWx0TXNnID0gUmV0dXJudmFsdWVfZ2VuZXJhdG9yIC12YWx1ZSAkcmVzdWx0CgogICAgaWYgKCRyZXN1bHQgLWVxIDApIHsKICAgICAgICAiLSIqMzArImBuW01TR106RGVmcmFnbWVudGF0aW9uIGNvbXBsZXRlZCBmb3IgJGRyaXZlYG4iKyItIiozMAogICAgfQogICAgZWxzZSB7CiAgICAgICAgIltFUlJPUl0kcmVzdWx0TXNnIG9uICRkcml2ZSIKICAgIH0KfQoKZnVuY3Rpb24gYWxsZHJpdmVzIHsKCiAgICAkYWxsZHJpdmVuYW1lcyA9IEdldC1XbWlPYmplY3Qgd2luMzJfdm9sdW1lIC1GaWx0ZXIgImRyaXZldHlwZSA9IDMiIHwgV2hlcmUtT2JqZWN0IHsgJF8uRHJpdmVMZXR0ZXIgLW5lICRudWxsIH0gfCBTZWxlY3QtT2JqZWN0IC1FeHBhbmRQcm9wZXJ0eSBEcml2ZUxldHRlcgoKICAgIGlmICghJGFsbGRyaXZlbmFtZXMpIHsKICAgICAgICAiW0VSUk9SXTpVbmtub3duIEVycm9yIG9jY3VyZWQsIFNjcmlwdCB3aWxsIG5vdyBleGl0IgogICAgICAgIEV4aXQ7CiAgICB9CiAgICBmb3JlYWNoICgkZHJpdmUgaW4gJGFsbGRyaXZlbmFtZXMpIHsKICAgICAgIGRlZnJhZ19kcml2ZSAtZHJpdmVuYW1lICRkcml2ZQogICAgfQp9CgpmdW5jdGlvbiBXaW5kb3dzZHJpdmUgewogICAgJGRyaXZlID0gKFNwbGl0LVBhdGggKCRlbnY6d2luZGlyKSAtUGFyZW50KSAtcmVwbGFjZSAiXFwiLCAiIgogICAgZGVmcmFnX2RyaXZlIC1kcml2ZW5hbWUgJGRyaXZlCn0KCmZ1bmN0aW9uIHNlbGVjdGVkZHJpdmVzIHsKICAgICRhbGxkcml2ZW9wdGlvbnMgPSAnYScsJ2InLCdjJywnZCcsJ2UnLCdmJywnZycsJ2gnLCdpJywnaicsJ2snLCdsJywnbScsJ24nLCdvJywncCcsJ3EnLCdyJywncycsJ3QnLCd1JywndicsJ3cnLCd4JywneScsJ3onCiAgICAkTnVPZmRyaXZlcyA9IDAKICAgIGZvcmVhY2ggKCRkcml2ZWVudHJ5IGluICRhbGxkcml2ZW9wdGlvbnMpewogICAgICAgICRFcnJvcmFjdGlvbnByZWZlcmVuY2UgPSAnU2lsZW50bHlDb250aW51ZScKICAgICAgICBpZigoKGdldC12YXJpYWJsZSAkZHJpdmVlbnRyeSkuVmFsdWUpIC1lcSAnVHJ1ZScpewoJICAgICROdU9mZHJpdmVzICs9IDEKICAgICAgICAgICAgJGRyaXZlID0gIiRkcml2ZWVudHJ5IiArICI6IgogICAgICAgICAgICBkZWZyYWdfZHJpdmUgLWRyaXZlbmFtZSAkZHJpdmUKICAgICAgICB9IAogICAgfQogICAgaWYoJE51T2Zkcml2ZXMgLWVxIDApewoJIi0iKjMwKyJgbltFUlJPUl06Tm8gZHJpdmVzIHNlbGVjdGVkYG4iKyItIiozMAoJRXhpdDsKICAgIH0KfQoKc3dpdGNoICgkRGVmcmFnRHJpdmUpewogICAgIkFsbCBEcml2ZXMie2FsbGRyaXZlc30KICAgICJXaW5kb3dzIERyaXZlcyJ7V2luZG93c2RyaXZlfQogICAgIlNwZWNpZnkgRHJpdmVzIntzZWxlY3RlZGRyaXZlc30KfQo=","jsonSchema":{"dependencies":{"DefragDrive":{"oneOf":[{"properties":{"DefragDrive":{"enum":["All Drives"]}}},{"properties":{"DefragDrive":{"enum":["Windows Drives"]}}},{"properties":{"A":{"title":"A:","type":"boolean"},"B":{"title":"B:","type":"boolean"},"C":{"title":"C:","type":"boolean"},"D":{"title":"D:","type":"boolean"},"DefragDrive":{"enum":["Specify Drives"]},"E":{"title":"E:","type":"boolean"},"F":{"title":"F:","type":"boolean"},"G":{"title":"G:","type":"boolean"},"H":{"title":"H:","type":"boolean"},"I":{"title":"I:","type":"boolean"},"J":{"title":"J:","type":"boolean"},"K":{"title":"K:","type":"boolean"},"L":{"title":"L:","type":"boolean"},"M":{"title":"M:","type":"boolean"},"N":{"title":"N:","type":"boolean"},"O":{"title":"O:","type":"boolean"},"P":{"title":"P:","type":"boolean"},"Q":{"title":"Q:","type":"boolean"},"R":{"title":"R:","type":"boolean"},"S":{"title":"S:","type":"boolean"},"T":{"title":"T:","type":"boolean"},"U":{"title":"U:","type":"boolean"},"V":{"title":"V:","type":"boolean"},"W":{"title":"W:","type":"boolean"},"X":{"title":"X:","type":"boolean"},"Y":{"title":"Y:","type":"boolean"},"Z":{"title":"Z:","type":"boolean"}}}]}},"properties":{"DefragDrive":{"enum":["All Drives","Windows Drives","Specify Drives"],"title":"Defrag","type":"string"}},"type":"object"},"uiSchema":{"A":{"classNames":"col-sm-2"},"B":{"classNames":"col-sm-2"},"C":{"classNames":"col-sm-2"},"D":{"classNames":"col-sm-2"},"DefragDrive":{"classNames":"col-sm-12","ui:options":{"inline":true},"ui:widget":"radio"},"E":{"classNames":"col-sm-2"},"F":{"classNames":"col-sm-2"},"G":{"classNames":"col-sm-2"},"H":{"classNames":"col-sm-2"},"I":{"classNames":"col-sm-2"},"J":{"classNames":"col-sm-2"},"K":{"classNames":"col-sm-2"},"L":{"classNames":"col-sm-2"},"M":{"classNames":"col-sm-2"},"N":{"classNames":"col-sm-2"},"O":{"classNames":"col-sm-2"},"P":{"classNames":"col-sm-2"},"Q":{"classNames":"col-sm-2"},"R":{"classNames":"col-sm-2"},"S":{"classNames":"col-sm-2"},"T":{"classNames":"col-sm-2"},"U":{"classNames":"col-sm-2"},"V":{"classNames":"col-sm-2"},"W":{"classNames":"col-sm-2"},"X":{"classNames":"col-sm-2"},"Y":{"classNames":"col-sm-2"},"Z":{"classNames":"col-sm-2"}},"isHDScript":false}