{"id":"d6a00df0-7d84-11e9-b292-00155d130b89","partnerId":"00000000-0000-0000-0000-000000000000","category":["HD Automation"],"description":"Initiate SentinelOne Scan","engine":"powershell","engineMaxVersion":5,"expectedExecutionTimeSec":300,"failureMessage":"Executed with errors","successMessage":"Executed Successfully","internal":false,"name":"InitiateSentinelOneScan","tags":["Windows 7","Windows 10"],"sequence":true,"content":"Q2xlYXItSG9zdA0KDQoNCiNbc3RyaW5nXSREcml2ZVRvU2NhbiA9ICRlbnY6U3lzdGVtRHJpdmUgDQojW3N0cmluZ10kRHJpdmVUb1NjYW4gPSAiQzoiDQoNCg0KZnVuY3Rpb24gRXNjYXBlLUpTT05TdHJpbmcoJHN0cil7DQogICAgaWYgKCRzdHIgLWVxICRudWxsKSB7cmV0dXJuICIifQ0KICAgICAgICAgJHN0ciA9ICRzdHIuVG9TdHJpbmcoKS5SZXBsYWNlKCciJywnXCInKS5SZXBsYWNlKCdcJywnXFwnKS5SZXBsYWNlKCJgbiIsJ1xuJykuUmVwbGFjZSgiYHIiLCdccicpLlJlcGxhY2UoImB0IiwnXHQnKQ0KICAgIHJldHVybiAkc3RyOw0KfQ0KDQoNCmZ1bmN0aW9uIENvbnZlcnRUby1KU09OUDIoJG1heERlcHRoID0gMTAsJGZvcmNlQXJyYXkgPSAkZmFsc2UpIHsNCmJlZ2luIHsNCiRkYXRhID0gQCgpDQp9DQpwcm9jZXNzew0KJGRhdGEgKz0gJF8NCn0NCmVuZHsNCmlmICgkZGF0YS5sZW5ndGggLWVxIDEgLWFuZCAkZm9yY2VBcnJheSAtZXEgJGZhbHNlKSB7DQokdmFsdWUgPSAkZGF0YVswXQ0KfSBlbHNlIHsgDQokdmFsdWUgPSAkZGF0YQ0KfQ0KDQoNCmlmICgkdmFsdWUgLWVxICRudWxsKSB7DQpyZXR1cm4gIm51bGwiDQp9DQoNCiRkYXRhVHlwZSA9ICR2YWx1ZS5HZXRUeXBlKCkuTmFtZQ0Kc3dpdGNoIC1yZWdleCAoJGRhdGFUeXBlKSB7DQogICAgICAgICAgICAnU3RyaW5nJyAgew0KcmV0dXJuICAiYCJ7MH1gIiIgLWYgKEVzY2FwZS1KU09OU3RyaW5nICR2YWx1ZSApDQp9DQogICAgICAgICAgICAnKFN5c3RlbVwuKT9EYXRlVGltZScgIHtyZXR1cm4gICJgInswOnl5eXktTU0tZGR9VHswOkhIOm1tOnNzfWAiIiAtZiAkdmFsdWV9DQogICAgICAgICAgICAnSW50MzJ8RG91YmxlJyB7cmV0dXJuICAiJHZhbHVlIn0NCidCb29sZWFuJyB7cmV0dXJuICAiJHZhbHVlIi5Ub0xvd2VyKCl9DQogICAgICAgICAgICAnKFN5c3RlbVwuKT9PYmplY3RcW1xdJyB7ICMgYXJyYXkNCmlmICgkbWF4RGVwdGggLWxlIDApe3JldHVybiAiYCIkdmFsdWVgIiJ9DQokanNvblJlc3VsdCA9ICcnDQpmb3JlYWNoKCRlbGVtIGluICR2YWx1ZSl7DQojaWYgKCRlbGVtIC1lcSAkbnVsbCkge2NvbnRpbnVlfQ0KaWYgKCRqc29uUmVzdWx0Lkxlbmd0aCAtZ3QgMCkgeyRqc29uUmVzdWx0ICs9JywgJ30gDQokanNvblJlc3VsdCArPSAoJGVsZW0gfCBDb252ZXJ0VG8tSlNPTlAyIC1tYXhEZXB0aCAoJG1heERlcHRoIC0xKSkNCn0NCnJldHVybiAiWyIgKyAkanNvblJlc3VsdCArICJdIg0KICAgICAgICAgICAgfQ0KJyhTeXN0ZW1cLik/SGFzaHRhYmxlJyB7ICMgaGFzaHRhYmxlDQokanNvblJlc3VsdCA9ICcnDQpmb3JlYWNoKCRrZXkgaW4gJHZhbHVlLktleXMpew0KaWYgKCRqc29uUmVzdWx0Lkxlbmd0aCAtZ3QgMCkgeyRqc29uUmVzdWx0ICs9JywgJ30NCiRqc29uUmVzdWx0ICs9IA0KQCINCiJ7MH0iOiB7MX0NCiJAIC1mICRrZXkgLCAoJHZhbHVlWyRrZXldIHwgQ29udmVydFRvLUpTT05QMiAtbWF4RGVwdGggKCRtYXhEZXB0aCAtMSkgKQ0KfQ0KcmV0dXJuICJ7IiArICRqc29uUmVzdWx0ICsgIn0iDQp9DQogICAgICAgICAgICBkZWZhdWx0IHsgI29iamVjdA0KaWYgKCRtYXhEZXB0aCAtbGUgMCl7cmV0dXJuICAiYCJ7MH1gIiIgLWYgKEVzY2FwZS1KU09OU3RyaW5nICR2YWx1ZSl9DQpyZXR1cm4gInsiICsNCigoJHZhbHVlIHwgR2V0LU1lbWJlciAtTWVtYmVyVHlwZSAqcHJvcGVydHkgfCAlIHsgDQpAIg0KInswfSI6IHsxfQ0KIkAgLWYgJF8uTmFtZSAsICgkdmFsdWUuKCRfLk5hbWUpIHwgQ29udmVydFRvLUpTT05QMiAtbWF4RGVwdGggKCRtYXhEZXB0aCAtMSkgKSANCn0pIC1qb2luICcsICcpICsgIn0iDQogICAgfQ0KfQ0KfQ0KfQ0KDQoNCmZ1bmN0aW9uIEluaXRpYXRlU2VudGluZWxPbmVTY2FuKCl7DQogICANCiAgICRTT09iamVjdCA9IE5ldy1PYmplY3QgLVR5cGVOYW1lIHBzb2JqZWN0DQogICAkU09PYmplY3QgfCBBZGQtTWVtYmVyIC1NZW1iZXJUeXBlIE5vdGVQcm9wZXJ0eSAtTmFtZSBUYXNrTmFtZSAtVmFsdWUgIkluaXRpYXRlIFNlbnRpbmVsIE9uZVNjYW4iDQoNCiAgICRob3N0VmVyU2lvbk1ham9yID0gKCRQU1ZlcnNpb25UYWJsZS5QU1ZlcnNpb24uTWFqb3IpLlRvU3RyaW5nKCkNCiAgICRob3N0VmVyU2lvbk1pbm9yID0gKCRQU1ZlcnNpb25UYWJsZS5QU1ZlcnNpb24uTWlub3IpLlRvU3RyaW5nKCkNCiAgICRob3N0VmVyc2lvbiA9ICRob3N0VmVyU2lvbk1ham9yICsnLicrICRob3N0VmVyU2lvbk1pbm9yIA0KDQogICAkb3NWZXJzaW9uTWFqb3IgPSAoW1N5c3RlbS5FbnZpcm9ubWVudF06Ok9TVmVyc2lvbi5WZXJzaW9uLm1ham9yKS5Ub1N0cmluZygpDQogICAkb3NWZXJzaW9uTWlub3IgPSAoW1N5c3RlbS5FbnZpcm9ubWVudF06Ok9TVmVyc2lvbi5WZXJzaW9uLm1pbm9yKS5Ub1N0cmluZygpDQogICAkb3NWZXJzaW9uID0gJG9zVmVyc2lvbk1ham9yICsnLicrICRvc1ZlcnNpb25NaW5vcg0KDQogICBbYm9vbGVhbl0kaXNQc1ZlcnNpb25PayA9IChbdmVyc2lvbl0kaG9zdFZlcnNpb24gLWdlIFt2ZXJzaW9uXScyLjAnKQ0KICAgW2Jvb2xlYW5dJGlzT1NWZXJzaW9uT2sgPSAoW3ZlcnNpb25dJG9zVmVyc2lvbiAtZ2UgW3ZlcnNpb25dJzYuMCcpDQoNCiAgICAjLS0tLS0tLS0tLSBDaGVjayBmb3IgUG93ZXJzaGVsbCB2ZXJzaW9uIC0tLS0tLS0tLS0tLS0tLS0tLSAgIA0KICAgICAgICAgICAgDQogICAgaWYoLW5vdCAkaXNQc1ZlcnNpb25Payl7DQogICAgICAgIA0KICAgICAgJFN0ZEVyckFyciA9IEAoKQ0KICAgICAgJHN0ZE91dEFyciA9IEAoKQ0KICAgICAgJFN0ZEVyciA9IE5ldy1PYmplY3QgUFNPYmplY3QgLVByb3BlcnR5IEB7CQkgICAgICAgDQoJCSAgICAgICAgICAgICAgICAgIGlkID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGUgPSAgIlBvd2VyU2hlbGwgdmVyc2lvbiBiZWxvdyAyLjAgaXMgbm90IHN1cHBvcnRlZCI7DQogICAgICAgICAgICAgICAgICAgICAgICAgIGRldGFpbCA9ICJQb3dlclNoZWxsIHZlcnNpb24gYmVsb3cgMi4wIGlzIG5vdCBzdXBwb3J0ZWQiOw0KDQogICAgICAgICAgICAgICB9DQogICAgICAgICANCiAgICAgJFN0ZEVyckFyciArPSAkU3RkRXJyDQogICAgICRzdGRPdXRBcnIgKz0gKCJQb3dlclNoZWxsIHZlcnNpb24gYmVsb3cgMi4wIGlzIG5vdCBzdXBwb3J0ZWQiKQ0KICAgIA0KICAgICAkU09PYmplY3QgfCBBZGQtTWVtYmVyIC1NZW1iZXJUeXBlIE5vdGVQcm9wZXJ0eSAtTmFtZSBTdGF0dXMgLVZhbHVlICJmYWlsIiANCiAgICAgJFNPT2JqZWN0IHwgQWRkLU1lbWJlciAtTWVtYmVyVHlwZSBOb3RlUHJvcGVydHkgLU5hbWUgQ29kZSAtVmFsdWUgMQ0KICAgICAkU09PYmplY3QgfCBBZGQtTWVtYmVyIC1NZW1iZXJUeXBlIE5vdGVQcm9wZXJ0eSAtTmFtZSBzdGRlcnIgLVZhbHVlICRTdGRFcnJBcnINCiAgICAgJFNPT2JqZWN0IHwgQWRkLU1lbWJlciAtTWVtYmVyVHlwZSBOb3RlUHJvcGVydHkgLU5hbWUgUmVzdWx0IC1WYWx1ZSAiUG93ZXJTaGVsbCB2ZXJzaW9uIGJlbG93IDIuMCBpcyBub3Qgc3VwcG9ydGVkIg0KICAgICAkU09PYmplY3QgfCBBZGQtTWVtYmVyIC1NZW1iZXJUeXBlIE5vdGVQcm9wZXJ0eSAtTmFtZSBzdGRvdXQgLVZhbHVlICAkc3RkT3V0QXJyICAgDQoNCiAgICAgcmV0dXJuICRTT09iamVjdA0KIA0KICAgIH0gICAgDQogDQogICAjLS0tLS0tLS0tLSBDaGVjayBPUyBWZXJzaW9uIC0tLS0tLS0tLS0tLS0tLS0tLQ0KICAgaWYoLW5vdCAkaXNPU1ZlcnNpb25Payl7DQogICAgICAgDQogICAgICAkU3RkRXJyQXJyID0gQCgpDQogICAgICAkc3RkT3V0QXJyID0gQCgpDQogICAgICAkU3RkRXJyID0gTmV3LU9iamVjdCBQU09iamVjdCAtUHJvcGVydHkgQHsJCSAgICAgICANCgkJICAgICAgICAgICAgICAgICAgaWQgPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZSA9ICAiUG93ZXJTaGVsbCBTY3JpcHQgc3VwcG9ydHMgV2luZG93IDcsIFdpbmRvdyAyMDA4UjIgYW5kIGhpZ2hlciB2ZXJzaW9uIG9wZXJhdGluZyBzeXN0ZW0iOw0KICAgICAgICAgICAgICAgICAgICAgICAgICBkZXRhaWwgPSAiUG93ZXJTaGVsbCBTY3JpcHQgc3VwcG9ydHMgV2luZG93IDcsIFdpbmRvdyAyMDA4UjIgYW5kIGhpZ2hlciB2ZXJzaW9uIG9wZXJhdGluZyBzeXN0ZW0iOw0KDQogICAgICAgICAgICAgICB9DQogICAgICAgICANCiAgICAgJFN0ZEVyckFyciArPSAkU3RkRXJyDQogICAgICRzdGRPdXRBcnIgKz0gKCJQb3dlclNoZWxsIFNjcmlwdCBzdXBwb3J0cyBXaW5kb3cgNywgV2luZG93IDIwMDhSMiBhbmQgaGlnaGVyIHZlcnNpb24gb3BlcmF0aW5nIHN5c3RlbSIpDQogICAgDQogICAgICRTT09iamVjdCB8IEFkZC1NZW1iZXIgLU1lbWJlclR5cGUgTm90ZVByb3BlcnR5IC1OYW1lIFN0YXR1cyAtVmFsdWUgImZhaWwiIA0KICAgICAkU09PYmplY3QgfCBBZGQtTWVtYmVyIC1NZW1iZXJUeXBlIE5vdGVQcm9wZXJ0eSAtTmFtZSBDb2RlIC1WYWx1ZSAxDQogICAgICRTT09iamVjdCB8IEFkZC1NZW1iZXIgLU1lbWJlclR5cGUgTm90ZVByb3BlcnR5IC1OYW1lIHN0ZGVyciAtVmFsdWUgJFN0ZEVyckFycg0KICAgICAkU09PYmplY3QgfCBBZGQtTWVtYmVyIC1NZW1iZXJUeXBlIE5vdGVQcm9wZXJ0eSAtTmFtZSBSZXN1bHQgLVZhbHVlICJQb3dlclNoZWxsIFNjcmlwdCBzdXBwb3J0cyBXaW5kb3cgNywgV2luZG93IDIwMDhSMiBhbmQgaGlnaGVyIHZlcnNpb24gb3BlcmF0aW5nIHN5c3RlbSINCiAgICAgJFNPT2JqZWN0IHwgQWRkLU1lbWJlciAtTWVtYmVyVHlwZSBOb3RlUHJvcGVydHkgLU5hbWUgc3Rkb3V0IC1WYWx1ZSAgJHN0ZE91dEFyciAgIA0KDQogICAgIHJldHVybiAkU09PYmplY3QNCg0KICAgfQ0KDQogICANCiAgaWYgKFtzdHJpbmddOjpJc051bGxPckVtcHR5KCREcml2ZVRvU2Nhbikpew0KICANCiAgICAgICRTdGRFcnJBcnIgPSBAKCkNCiAgICAgICRzdGRPdXRBcnIgPSBAKCkNCiAgICAgICRTdGRFcnIgPSBOZXctT2JqZWN0IFBTT2JqZWN0IC1Qcm9wZXJ0eSBAewkJICAgICAgIA0KCQkgICAgICAgICAgICAgICAgICBpZCA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlID0gICJQbGVhc2UgZW50ZXIgZHJpdmUgbmFtZSINCiAgICAgICAgICAgICAgICAgICAgICAgICAgZGV0YWlsID0gIlBsZWFzZSBlbnRlciBkcml2ZSBuYW1lIg0KDQogICAgICAgICAgICAgICB9DQogICAgICAgICANCiAgICAgJFN0ZEVyckFyciArPSAkU3RkRXJyDQogICAgICRzdGRPdXRBcnIgKz0gKCJQbGVhc2UgZW50ZXIgZHJpdmUgbmFtZSIpDQogICAgDQogICAgICRTT09iamVjdCB8IEFkZC1NZW1iZXIgLU1lbWJlclR5cGUgTm90ZVByb3BlcnR5IC1OYW1lIFN0YXR1cyAtVmFsdWUgImZhaWwiIA0KICAgICAkU09PYmplY3QgfCBBZGQtTWVtYmVyIC1NZW1iZXJUeXBlIE5vdGVQcm9wZXJ0eSAtTmFtZSBDb2RlIC1WYWx1ZSAxDQogICAgICRTT09iamVjdCB8IEFkZC1NZW1iZXIgLU1lbWJlclR5cGUgTm90ZVByb3BlcnR5IC1OYW1lIHN0ZGVyciAtVmFsdWUgJFN0ZEVyckFycg0KICAgICAkU09PYmplY3QgfCBBZGQtTWVtYmVyIC1NZW1iZXJUeXBlIE5vdGVQcm9wZXJ0eSAtTmFtZSBSZXN1bHQgLVZhbHVlICJQbGVhc2UgZW50ZXIgZHJpdmUgbmFtZSINCiAgICAgJFNPT2JqZWN0IHwgQWRkLU1lbWJlciAtTWVtYmVyVHlwZSBOb3RlUHJvcGVydHkgLU5hbWUgc3Rkb3V0IC1WYWx1ZSAgJHN0ZE91dEFyciAgIA0KDQogIA0KICAgICAgIHJldHVybiAkU09PYmplY3QNCiAgICB9DQoNCiAkRHJpdmUgPSBHZXQtV21pT2JqZWN0IC1DbGFzcyBXaW4zMl9sb2dpY2FsZGlzayB8IFdoZXJlLU9iamVjdCB7JF8uRGV2aWNlSUQgLWVxICREcml2ZVRvU2Nhbn0NCg0KICBpZigtbm90ICREcml2ZSl7DQogICANCiAgICAgJFN0ZEVyckFyciA9IEAoKQ0KICAgICAkc3RkT3V0QXJyID0gQCgpDQogICAgICRTdGRFcnIgPSBOZXctT2JqZWN0IFBTT2JqZWN0IC1Qcm9wZXJ0eSBAewkJICAgICAgIA0KCQkgICAgICAgICAgICAgICAgICBpZCA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlID0gICJEcml2ZSBub3QgZm91bmQgaW4gdGhlIHN5c3RlbSIgDQogICAgICAgICAgICAgICAgICAgICAgICAgIGRldGFpbCA9ICJEcml2ZSA6ICQoJERyaXZlVG9TY2FuKSBub3QgZm91bmQgaW4gdGhlIHN5c3RlbSIgDQoNCiAgICAgICAgICAgICAgIH0NCiAgICAgICAgIA0KICAgICAkU3RkRXJyQXJyICs9ICRTdGRFcnINCiAgICAgJHN0ZE91dEFyciArPSAoIkRyaXZlIDogJCgkRHJpdmVUb1NjYW4pIG5vdCBmb3VuZCBpbiB0aGUgc3lzdGVtIikNCiAgICANCiAgICAgJFNPT2JqZWN0IHwgQWRkLU1lbWJlciAtTWVtYmVyVHlwZSBOb3RlUHJvcGVydHkgLU5hbWUgU3RhdHVzIC1WYWx1ZSAiZmFpbCIgDQogICAgICRTT09iamVjdCB8IEFkZC1NZW1iZXIgLU1lbWJlclR5cGUgTm90ZVByb3BlcnR5IC1OYW1lIENvZGUgLVZhbHVlIDENCiAgICAgJFNPT2JqZWN0IHwgQWRkLU1lbWJlciAtTWVtYmVyVHlwZSBOb3RlUHJvcGVydHkgLU5hbWUgc3RkZXJyIC1WYWx1ZSAkU3RkRXJyQXJyDQogICAgICRTT09iamVjdCB8IEFkZC1NZW1iZXIgLU1lbWJlclR5cGUgTm90ZVByb3BlcnR5IC1OYW1lIFJlc3VsdCAtVmFsdWUgIkRyaXZlIDogJCgkRHJpdmVUb1NjYW4pIG5vdCBmb3VuZCBpbiB0aGUgc3lzdGVtIiANCiAgICAgJFNPT2JqZWN0IHwgQWRkLU1lbWJlciAtTWVtYmVyVHlwZSBOb3RlUHJvcGVydHkgLU5hbWUgc3Rkb3V0IC1WYWx1ZSAgJHN0ZE91dEFyciANCg0KICAgIHJldHVybiAkU09PYmplY3QNCiAgICANCiB9DQogICANCiAkZmlsdGVyID0gIlNlbnRpbmVsIEFnZW50Ig0KICRyZXN1bHRPYmogPSAkbnVsbA0KICRoaXZlID0gW01pY3Jvc29mdC5XaW4zMi5SZWdpc3RyeUtleV06Ok9wZW5SZW1vdGVCYXNlS2V5KFtNaWNyb3NvZnQuV2luMzIuUmVnaXN0cnlIaXZlXTo6TG9jYWxNYWNoaW5lLCRlbnY6Q09NUFVURVJOQU1FKQ0KICRyZWdQYXRoTGlzdCA9ICJTT0ZUV0FSRVxXb3c2NDMyTm9kZVxNaWNyb3NvZnRcV2luZG93c1xDdXJyZW50VmVyc2lvblxVbmluc3RhbGwiLA0KICAgICAgICAgICAgICAgICAiU09GVFdBUkVcTWljcm9zb2Z0XFdpbmRvd3NcQ3VycmVudFZlcnNpb25cVW5pbnN0YWxsIg0KDQogIGZvcmVhY2goJHJlZ1BhdGggaW4gJHJlZ1BhdGhMaXN0KSB7DQogICAgaWYoJGtleSA9ICRoaXZlLk9wZW5TdWJLZXkoJHJlZ1BhdGgpKSB7DQogICAgICAgIGlmKCRzdWJrZXlOYW1lcyA9ICRrZXkuR2V0U3ViS2V5TmFtZXMoKSkgew0KICAgICAgICAgICAgIGZvcmVhY2goJHN1YmtleU5hbWUgaW4gJHN1YmtleU5hbWVzKSB7DQogICAgICAgICAgICAgICAgJHByb2R1Y3RLZXkgPSAka2V5Lk9wZW5TdWJLZXkoJHN1YmtleU5hbWUpDQogICAgICAgICAgICAgICAgJHByb2R1Y3ROYW1lID0gJHByb2R1Y3RLZXkuR2V0VmFsdWUoIkRpc3BsYXlOYW1lIikNCiAgICAgICAgICAgICAgICAkcHJvZHVjdFZlcnNpb24gPSAkcHJvZHVjdEtleS5HZXRWYWx1ZSgiRGlzcGxheVZlcnNpb24iKQ0KICAgICAgICAgICAgICAgICRwcm9kdWN0Q29tbWVudHMgPSAkcHJvZHVjdEtleS5HZXRWYWx1ZSgiQ29tbWVudHMiKQ0KICAgICAgICAgICAgICAgICRVbmluc3RhbGxTdHJpbmcgPSAkcHJvZHVjdEtleS5HZXRWYWx1ZSgiVW5pbnN0YWxsU3RyaW5nIikNCiAgICAgICAgICAgICAgICAkSW5zdGFsbExvY2F0aW9uID0gJHByb2R1Y3RLZXkuR2V0VmFsdWUoIkluc3RhbGxMb2NhdGlvbiIpDQogICAgICAgICAgICAgICAgaWYoKCRwcm9kdWN0TmFtZSAtbWF0Y2ggJGZpbHRlcikgLW9yICgkcHJvZHVjdENvbW1lbnRzIC1tYXRjaCAkZmlsdGVyKSkgew0KICAgICAgICAgICAgICAgICAgICRyZXN1bHRPYmogPSBbUFNDdXN0b21PYmplY3RdQHsNCiAgICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgICBQcm9kdWN0ID0gJHByb2R1Y3ROYW1lDQogICAgICAgICAgICAgICAgICAgICAgVmVyc2lvbiA9ICRwcm9kdWN0VmVyc2lvbiAgICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgICBVbmluc3RhbGxTdHJpbmcgPSAkVW5pbnN0YWxsU3RyaW5nDQogICAgICAgICAgICAgICAgICAgICAgSW5zdGFsbExvY2F0aW9uID0gJEluc3RhbGxMb2NhdGlvbiANCiAgICAgICAgICAgICAgICAgICAgfSAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgfQ0KICAgICAgICAgIH0NCiAgICAgIH0NCiAgICAgICRrZXkuQ2xvc2UoKQ0KICB9DQoNCiBpZigkcmVzdWx0T2JqKXsNCiAgIA0KICAgICRTY2FuU3RyaW5nID0gJG51bGwNCiAgICAkVW5pbnN0YWxsU3RyaW5nID0gJHJlc3VsdE9iai5Vbmluc3RhbGxTdHJpbmcNCiAgICAkbGFzdEluZGV4ID0gJFVuaW5zdGFsbFN0cmluZy5MYXN0SW5kZXhPZignICcpDQogICAgJFVuaW5zdGFsbFN0cmluZyA9ICRVbmluc3RhbGxTdHJpbmcuU3Vic3RyaW5nKDAsJGxhc3RJbmRleCkNCiAgICAkVW5pbnN0YWxsU3RyaW5nID0gJFVuaW5zdGFsbFN0cmluZyAtcmVwbGFjZSAnIicsICIiDQoNCiAgICBpZigoJFVuaW5zdGFsbFN0cmluZyAtbGlrZSAnKmV4ZSonKSAtb3IgICgkVW5pbnN0YWxsU3RyaW5nIC1saWtlICcqRVhFKicpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICRsYXN0SW5kZXgxID0gJFVuaW5zdGFsbFN0cmluZy5MYXN0SW5kZXhPZignXCcpDQogICAgICAgICRVbmluc3RhbGxTdHJpbmcgPSAkVW5pbnN0YWxsU3RyaW5nLlN1YnN0cmluZygwLCRsYXN0SW5kZXgxKSANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgDQogICAgIH0NCiAgICAgICAgDQogICAgJEV4ZU5hbWUgPSAiU2VudGluZWxDdGwuZXhlIg0KICAgICRVbmluc3RhbGxTdHJpbmcgPSAkVW5pbnN0YWxsU3RyaW5nIA0KICAgICRTY2FuU3RyaW5nID0gam9pbi1wYXRoIC1wYXRoICQoJFVuaW5zdGFsbFN0cmluZykgLWNoaWxkcGF0aCAkKCRFeGVOYW1lKSANCg0KICAgICRTY2FuU3RyaW5nID0gJFNjYW5TdHJpbmcNCiAgICAkY29tbWFuZCA9IEAnDQogICAgY21kLmV4ZSAvQyAkKCRTY2FuU3RyaW5nKSBpc19zY2FuX2luX3Byb2dyZXNzDQonQA0KICAgJElzU2NhbkluUHJvZ3Jlc3NUZXh0ID0gSW52b2tlLUV4cHJlc3Npb24gLUNvbW1hbmQ6JGNvbW1hbmQgDQogICAkSXNTY2FuSW5Qcm9ncmVzcyA9ICRJc1NjYW5JblByb2dyZXNzVGV4dC5TcGxpdCgnOicpWzFdDQoNCiAgIGlmKCRJc1NjYW5JblByb2dyZXNzLnRyaW0oKSAtZXEgIkZhbHNlIil7DQogICAgDQogICAgJFNPT2JqZWN0IHwgQWRkLU1lbWJlciAtTWVtYmVyVHlwZSBOb3RlUHJvcGVydHkgLU5hbWUgTWVzc2FnZTEgLVZhbHVlICJTY2FuIGFyZSBydW5uaW5nIGFuZCB0aGUgU09DIHdpbGwgdGFrZSBmdXJ0aGVyIGFjdGlvbnMgYXMgbmVjZXNzYXJ5Ig0KDQoNCiAgICAkY29tbWFuZCA9IEAnDQogICAgY21kLmV4ZSAvQyAkKCRTY2FuU3RyaW5nKSBzY2FuX2ZvbGRlciAtaSAkKCREcml2ZVRvU2NhbikNCidADQogICAgSW52b2tlLUV4cHJlc3Npb24gLUNvbW1hbmQ6JGNvbW1hbmQgDQogICAgICAgICAgIA0KICAgIA0KICAgICAkc3RkT3V0QXJyID0gQCgpDQogICAgICAgICAgICAgDQogICAgICRTdGRFcnJBcnIgKz0gJFN0ZEVycg0KICAgICAkc3RkT3V0QXJyICs9ICgiU2NhbiBzdGFydGVkIGZvciBkcml2ZSAkKCREcml2ZVRvU2NhbikiKQ0KICAgIA0KICAgICAkU09PYmplY3QgfCBBZGQtTWVtYmVyIC1NZW1iZXJUeXBlIE5vdGVQcm9wZXJ0eSAtTmFtZSBTdGF0dXMgLVZhbHVlICJTdWNjZXNzIiANCiAgICAgJFNPT2JqZWN0IHwgQWRkLU1lbWJlciAtTWVtYmVyVHlwZSBOb3RlUHJvcGVydHkgLU5hbWUgQ29kZSAtVmFsdWUgMA0KICAgICAkU09PYmplY3QgfCBBZGQtTWVtYmVyIC1NZW1iZXJUeXBlIE5vdGVQcm9wZXJ0eSAtTmFtZSBSZXN1bHQgLVZhbHVlICJTY2FuIHN0YXJ0ZWQgZm9yIGRyaXZlICQoJERyaXZlVG9TY2FuKSINCiAgICAgJFNPT2JqZWN0IHwgQWRkLU1lbWJlciAtTWVtYmVyVHlwZSBOb3RlUHJvcGVydHkgLU5hbWUgc3Rkb3V0IC1WYWx1ZSAgJHN0ZE91dEFyciANCg0KICAgICByZXR1cm4gICRTT09iamVjdA0KDQogICB9ZWxzZXsNCg0KICAgICA8IyRTT09iamVjdCB8IEFkZC1NZW1iZXIgLU1lbWJlclR5cGUgTm90ZVByb3BlcnR5IC1OYW1lIE1lc3NhZ2UgLVZhbHVlICJTY2FuIGlzIGluIHByb2dyZXNzIGFuZCB0aGVyZSBpcyBubyBuZWVkIHRvIHJlLWluaXRpYXRlIHRoZSBzY2FuIg0KICAgICAkU09PYmplY3QgfCBBZGQtTWVtYmVyIC1NZW1iZXJUeXBlIE5vdGVQcm9wZXJ0eSAtTmFtZSBNZXNzYWdlMSAtVmFsdWUgIlNPQyB3aWxsIHRha2UgZnVydGhlciBhY3Rpb25zIGFzIG5lY2Vzc2FyeSINCiAgICAgDQogICAgICM+DQoNCg0KICAgICAkU3RkRXJyQXJyID0gQCgpDQogICAgICRzdGRPdXRBcnIgPSBAKCkNCiAgICAgJFN0ZEVycjEgPSBOZXctT2JqZWN0IFBTT2JqZWN0IC1Qcm9wZXJ0eSBAewkJICAgICAgIA0KCQkgICAgICAgICAgICAgICAgICBpZCA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlID0gICJTY2FuIGlzIGluIHByb2dyZXNzIGFuZCB0aGVyZSBpcyBubyBuZWVkIHRvIHJlLWluaXRpYXRlIHRoZSBzY2FuIg0KICAgICAgICAgICAgICAgICAgICAgICAgICBkZXRhaWwgPSAiU2NhbiBpcyBpbiBwcm9ncmVzcyBhbmQgdGhlcmUgaXMgbm8gbmVlZCB0byByZS1pbml0aWF0ZSB0aGUgc2NhbiINCg0KICAgICAgICAgICAgICAgfQ0KICAgICAkU3RkRXJyMiA9IE5ldy1PYmplY3QgUFNPYmplY3QgLVByb3BlcnR5IEB7CQkgICAgICAgDQoJCSAgICAgICAgICAgICAgICAgIGlkID0gMTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGUgPSAgIlNPQyB3aWxsIHRha2UgZnVydGhlciBhY3Rpb25zIGFzIG5lY2Vzc2FyeSINCiAgICAgICAgICAgICAgICAgICAgICAgICAgZGV0YWlsID0gIlNPQyB3aWxsIHRha2UgZnVydGhlciBhY3Rpb25zIGFzIG5lY2Vzc2FyeSINCg0KICAgICAgICAgICAgICAgfSANCiAgICAgICAgIA0KICAgICAkU3RkRXJyQXJyICs9ICRTdGRFcnIxDQogICAgICRTdGRFcnJBcnIgKz0gJFN0ZEVycjINCg0KICAgICAkc3RkT3V0QXJyICs9ICgiU2NhbiBpcyBpbiBwcm9ncmVzcyBhbmQgdGhlcmUgaXMgbm8gbmVlZCB0byByZS1pbml0aWF0ZSB0aGUgc2NhbiIpDQogICAgDQogICAgICRTT09iamVjdCB8IEFkZC1NZW1iZXIgLU1lbWJlclR5cGUgTm90ZVByb3BlcnR5IC1OYW1lIFN0YXR1cyAtVmFsdWUgImZhaWwiIA0KICAgICAkU09PYmplY3QgfCBBZGQtTWVtYmVyIC1NZW1iZXJUeXBlIE5vdGVQcm9wZXJ0eSAtTmFtZSBDb2RlIC1WYWx1ZSAxDQogICAgICRTT09iamVjdCB8IEFkZC1NZW1iZXIgLU1lbWJlclR5cGUgTm90ZVByb3BlcnR5IC1OYW1lIHN0ZGVyciAtVmFsdWUgJFN0ZEVyckFycg0KICAgICAkU09PYmplY3QgfCBBZGQtTWVtYmVyIC1NZW1iZXJUeXBlIE5vdGVQcm9wZXJ0eSAtTmFtZSBSZXN1bHQgLVZhbHVlICRzdGRPdXRBcnIgKz0gIlNjYW4gaXMgaW4gcHJvZ3Jlc3MgYW5kIHRoZXJlIGlzIG5vIG5lZWQgdG8gcmUtaW5pdGlhdGUgdGhlIHNjYW4iDQogICAgICRTT09iamVjdCB8IEFkZC1NZW1iZXIgLU1lbWJlclR5cGUgTm90ZVByb3BlcnR5IC1OYW1lIHN0ZG91dCAtVmFsdWUgICRzdGRPdXRBcnIgDQogICAgIA0KICAgICByZXR1cm4gJFNPT2JqZWN0IA0KDQogICB9DQogICAgDQoNCiB9ZWxzZXsNCiAgIA0KICAgDQogICAgICRTdGRFcnJBcnIgPSBAKCkNCiAgICAgJHN0ZE91dEFyciA9IEAoKQ0KICAgICAkU3RkRXJyID0gTmV3LU9iamVjdCBQU09iamVjdCAtUHJvcGVydHkgQHsJCSAgICAgICANCgkJICAgICAgICAgICAgICAgICAgaWQgPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZSA9ICAiU2VudGluZWwgaXMgbm90IGluc3RhbGxlZCBvbiB0aGUgZW5kcG9pbnQiDQogICAgICAgICAgICAgICAgICAgICAgICAgIGRldGFpbCA9ICJTZW50aW5lbCBpcyBub3QgaW5zdGFsbGVkIG9uIHRoZSBlbmRwb2ludCINCg0KICAgICAgICAgICAgICAgfQ0KICAgICAgICAgDQogICAgICRTdGRFcnJBcnIgKz0gJFN0ZEVycg0KICAgICAkc3RkT3V0QXJyICs9ICgiU2VudGluZWwgaXMgbm90IGluc3RhbGxlZCBvbiB0aGUgZW5kcG9pbnQiKQ0KICAgIA0KICAgICAkU09PYmplY3QgfCBBZGQtTWVtYmVyIC1NZW1iZXJUeXBlIE5vdGVQcm9wZXJ0eSAtTmFtZSBTdGF0dXMgLVZhbHVlICJmYWlsIiANCiAgICAgJFNPT2JqZWN0IHwgQWRkLU1lbWJlciAtTWVtYmVyVHlwZSBOb3RlUHJvcGVydHkgLU5hbWUgQ29kZSAtVmFsdWUgMQ0KICAgICAkU09PYmplY3QgfCBBZGQtTWVtYmVyIC1NZW1iZXJUeXBlIE5vdGVQcm9wZXJ0eSAtTmFtZSBzdGRlcnIgLVZhbHVlICRTdGRFcnJBcnINCiAgICAgJFNPT2JqZWN0IHwgQWRkLU1lbWJlciAtTWVtYmVyVHlwZSBOb3RlUHJvcGVydHkgLU5hbWUgUmVzdWx0IC1WYWx1ZSAiU2VudGluZWwgaXMgbm90IGluc3RhbGxlZCBvbiB0aGUgZW5kcG9pbnQiDQogICAgICRTT09iamVjdCB8IEFkZC1NZW1iZXIgLU1lbWJlclR5cGUgTm90ZVByb3BlcnR5IC1OYW1lIHN0ZG91dCAtVmFsdWUgICRzdGRPdXRBcnIgDQoNCg0KICAgcmV0dXJuICRTT09iamVjdA0KIH0NCn0NCg0KDQoNCmlmKCRQU1ZlcnNpb25UYWJsZS5QU1ZlcnNpb24uTWFqb3IgLWVxIDIpew0KDQogICAgSW5pdGlhdGVTZW50aW5lbE9uZVNjYW4gfCBDb252ZXJ0VG8tSlNPTlAyDQoNCn1lbHNlew0KDQogICAgSW5pdGlhdGVTZW50aW5lbE9uZVNjYW4gfCBDb252ZXJ0VG8tSnNvbiAtRGVwdGggMTANCn0=",
"jsonSchema":{
"type":"object",
"properties":{
	"DriveToScan":{
      "type":"string",
      "title":"Enter drive to scan",
      "minLength":1
    }
 },
  "required":[
  "DriveToScan"
  ],
  "additionalProperties": false
},
"uiSchema":{
"DriveToScan":{
    "ui:autofocus":true,
    "classNames":"col-sm-12"
  },
  "ui:order":["DriveToScan"]
},
"isHDScript":true}
