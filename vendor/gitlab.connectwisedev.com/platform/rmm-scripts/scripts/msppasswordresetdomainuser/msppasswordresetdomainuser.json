{"id":"5eb2ba25-913d-11e9-8c1e-00155d130b01","partnerId":"00000000-0000-0000-0000-000000000000","category":["Maintenance"],"description":"This script will reset password for domain user whose account is not locked or disabled","engine":"powershell","engineMaxVersion":5,"expectedExecutionTimeSec":300,"failureMessage":"Executed with errors","successMessage":"Password Reset for Domain Account is Successful","internal":false,"name":"Password Reset for Domain User","tags":["Windows 7","Windows 10"],"sequence":true,"content":"PCMKLlNZTk9QU0lTCkRldmVsb3BlZCBCeSA6IEdSVCBbSEQtQXV0b21hdGlvbl0gLCBDb250aW51dW0KRmlsZSBWZXNpb24gOiAyLjAKLkRFU0NSSVBUSU9OClRoZSBzY3JpcHQgaXMgZGVzaWduZWQgdG8gY2hhbmdlIHRoZSBwYXNzd29yZCBvZiBkb21haW4gdXNlciwgaWYgTG9jYWwgVXNlciBhY2NvdW50IGlzIExvY2tlZC9EaXNhYmxlZCBvciBib3RoIGl0IHdpbGwgbm90IGRvIGFueXRoaW5nLgouUEFSQU1FVEVSIApEb21haW5Vc2VySUQgaXMgdGhlIHZhcmlhYmxlIHJlcXVpcmVkIGZvciBjaGFuZ2luZyB0aGUgcGFzc3dvcmQuCi5QQVJBTUVURVIgCkNoYW5nZVBhc3N3b3JkIGlzIHRoZSBwYXNzd29yZCB3aGljaCBuZWVkcyB0byBiZSBzZXQgYXMgcGFzc3dvcmQgZm9yIHRoZSB1c2VyIGFjY291bnQuCiAKLlBBUkFNRVRFUgpDaGFuZ2VQd2ROZXh0TG9nb24gaXMgYSBib29sZWFuLiBUcnVlIG1lYW5zIHRvIHNldCBDaGFuZ2UgUGFzc3dvcmQgb24gbmV4dCBsb2dvbi4KIz4KaWYgKCRlbnY6UFJPQ0VTU09SX0FSQ0hJVEVXNjQzMiAtZXEgIkFNRDY0IikgewogICAgd3JpdGUtd2FybmluZyAiRXhjZWN1dGluZyB0aGUgc2NyaXB0IHVuZGVyIDY0IGJpdCBwb3dlcnNoZWxsIgogICAgaWYgKCRteUludm9jYXRpb24uTGluZSkgewogICAgICAgICYiJGVudjpzeXN0ZW1yb290XHN5c25hdGl2ZVx3aW5kb3dzcG93ZXJzaGVsbFx2MS4wXHBvd2Vyc2hlbGwuZXhlIiAtTm9uSW50ZXJhY3RpdmUgLU5vUHJvZmlsZSAkbXlJbnZvY2F0aW9uLkxpbmUKICAgIH1lbHNlewogICAgICAgICYiJGVudjpzeXN0ZW1yb290XHN5c25hdGl2ZVx3aW5kb3dzcG93ZXJzaGVsbFx2MS4wXHBvd2Vyc2hlbGwuZXhlIiAtTm9uSW50ZXJhY3RpdmUgLU5vUHJvZmlsZSAtZmlsZSAiJCgkbXlJbnZvY2F0aW9uLkludm9jYXRpb25OYW1lKSIgJGFyZ3MKICAgIH0KZXhpdCAkbGFzdGV4aXRjb2RlCn0KCiRPdXRwdXRNZXNzYWdlID0gQCgpIDwjIFZhcmlhYmxlIHRvIGNhcHR1cmUgT3V0cHV0IGZvciBkZWJ1Z2dpbmcgcHVycG9zZS4jPgo8IyBDb21wYXRpYmlsaXR5IENoZWNrIGlmIGZvdW5kIGluY29tcGF0aWJsdCB3aXRoIGV4aXQjPgp0cnl7CiAgICAkT1NWZXJzaW9uPShbc3lzdGVtLmVudmlyb25tZW50XTo6T1NWZXJzaW9uLlZlcnNpb24pLk1ham9yCiAgICAkUFNWZXJzaW9uID0oR2V0LUhvc3QpLnZlcnNpb24KICAgIGlmKCgkT1NWZXJzaW9uIC1sdCA2KSAtb3IgKCRQU1ZlcnNpb24uTWFqb3IgLWx0IDIpKQogICAgewogICAgICAgIFdyaXRlLU91dHB1dCAiW01TRyA6IEluY29tcGF0aWJsZSBTeXN0ZW0gRWl0aGVyIE9TIGlzIGJlbG93IHdpbmRvd3MgNy8yMDA4UjIgb3IgcG93ZXJzaGVsbCB2ZXJzaW9uIGxlc3MgdGhhbiAyLjBdIgogICAgICAgIEV4aXQKICAgIH0KICAgIDwjIGVsc2V7V3JpdGUtb3V0cHV0ICJbTVNHOiBHb29kIHRvIEdvXSJ9ICM+Cn1jYXRjaHsgV3JpdGUtZXJyb3IgIltNU0c6ICRfLkV4Y2VwdGlvbi5tZXNzYWdlXSJ9CjwjIENoZWNrIGlmIG1hY2hpbmUgaXMgaW4gRG9tYWluIG9yIFdvcmtncm91cCBFbnZpcm9ubWVudCAjPgp0cnl7CiAgICAkc3lzaW5mbyA9IEdldC1XbWlPYmplY3QgLUNsYXNzIFdpbjMyX0NvbXB1dGVyU3lzdGVtIH0KY2F0Y2h7V3JpdGUtRXJyb3IgIlVuYWJsZSB0byBjaGVjayBpZiBtYWNoaW5lIGlzIGluIERvbWFpbi4gJF8uRXhjZXB0aW9uLm1lc3NhZ2UifQoKaWYoJHN5c2luZm8uZG9tYWluIC1lcSAiV09SS0dST1VQIikKewogICAgJE91dHB1dE1lc3NhZ2UgKz0gIk1hY2hpbmUgQ29ubmVjdGVkIGlzIG5vdCBpbiBkb21haW4gZW52aXJvbm1lbnQuIgp9CkVsc2UKeyAgIDwjIElmICREQyBpcyBlcXVhbGwgdG8gNChiYWNrdXAgREMpIG9yIDUocHJpbWFyeSBEQykgIz4KICAgIHRyeXsKICAgICAgICAkREMgPSAoR2V0LVdtaU9iamVjdCBXaW4zMl9Db21wdXRlclN5c3RlbSkuZG9tYWlucm9sZQogICAgfWNhdGNoeyBXcml0ZS1lcnJvciAiIFVuYWJsZSB0byBDaGVjayBpZiBtYWNoaW5lIGlzIERvbWFpbiBDb250cm9sbGVyICRfLkV4Y2VwdGlvbi5tZXNzYWdlIiB9CgogICAgaWYoJERDIC1lcSAiNCIgLW9yICREQyAtZXEgIjUiICkKICAgIHsgICA8I0NoZWNrIGlmIFBvd2Vyc2hlbGwgbW9kdWxlIGlzIHByZXNlbnQjPgogICAgICAgIHRyeXsKICAgICAgICAgICAgSW1wb3J0LU1vZHVsZSBBY3RpdmVEaXJlY3RvcnkgLUVycm9yQWN0aW9uIFN0b3AKICAgICAgICAgICAgJE91dHB1dE1lc3NhZ2UgKz0gIkFjdGl2ZSBEaXJlY3RvcnkgcG93ZXJzaGVsbCBtb2R1bGUgaW1wb3J0ZWQiCiAgICAgICAgfWNhdGNoeyBXcml0ZS1FcnJvciAiRXhjZXB0aW9uIGVuY291bnRlcmVkIHdoaWxlIEltcG9ydGluZyBBRCBtb2R1bGUuIFBsZWFzZSBDb25uZWN0IHRvIE90aGVyIERvbWFpbiBDb250cm9sbGVyLiAgJF8uRXhjZXB0aW9uLm1lc3NhZ2UifQogICAgICAgIDwjQ2hlY2sgaWYgVXNlciBFeGlzdCM+CiAgICAgICAgdHJ5ewogICAgICAgICAgICAkQUR1c2VyPSRudWxsCiAgICAgICAgICAgICRBRHVzZXIgPSAgR2V0LUFEVXNlciAkRG9tYWluVXNlcklEIC1wcm9wZXJ0aWVzICogLUVycm9yQWN0aW9uIHN0b3AKICAgICAgICB9Y2F0Y2ggW01pY3Jvc29mdC5BY3RpdmVEaXJlY3RvcnkuTWFuYWdlbWVudC5BRElkZW50aXR5Tm90Rm91bmRFeGNlcHRpb25dIHskT3V0cHV0TWVzc2FnZSArPSAiW01TRzogVXNlciBEb2Vzbm90IEV4aXN0XSBGQUlMRUQgIn0KICAgICAgICBjYXRjaCB7IHdyaXRlLWVycm9yICIkXy5FeGNlcHRpb24ubWVzc2FnZSIgfQogICAgICAgIElmKCRBRHVzZXIpCiAgICAgICAgewogICAgICAgICAgICBpZigoJEFEVXNlci5FbmFibGVkIC1lcSAkdHJ1ZSkgLUFuZCAoJEFEdXNlci5Mb2NrZWRPdXQgLWVxICRGYWxzZSkpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIFNldC1hZGFjY291bnRwYXNzd29yZCAkRG9tYWluVXNlcklEIC1yZXNldCAtbmV3cGFzc3dvcmQgKENvbnZlcnRUby1TZWN1cmVTdHJpbmcgLUFzUGxhaW5UZXh0ICRDaGFuZ2VQYXNzd29yZCAtRm9yY2UpCgogICAgICAgICAgICAgICAgaWYoJENoYW5nZVB3ZE5leHRMb2dvbiAtZXEgJHRydWUpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgaWYoKCRBRFVzZXIuUGFzc3dvcmROZXZlckV4cGlyZXMgLWVxICRGYWxzZSkgLUFuZCAoJEFEVXNlci5DYW5ub3RDaGFuZ2VQYXNzd29yZCAtZXEgJEZhbHNlICkpCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBTZXQtQURVc2VyICREb21haW5Vc2VySUQgLUNoYW5nZVBhc3N3b3JkQXRMb2dvbiAkdHJ1ZQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAkT3V0cHV0TWVzc2FnZSArPSAiVW5hYmxlIHRvIGNoYW5nZSBwYXNzd29yZCBhdCBOZXh0IGxvZ29uIGFzICREb21haW5Vc2VySUQgQWNjb3VudCBpcyBDb25maWd1cmF0aW9uIGZvciBQYXNzd29yZCBFeGlwcmF0aW9uIDokQURVc2VyLlBhc3N3b3JkTmV2ZXJFeHBpcmVzIEFuZCBDYW5ub3RDaGFuZ2VQYXNzd29yZCA6ICRBRFVzZXIuQ2Fubm90Q2hhbmdlUGFzc3dvcmQiCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICRPdXRwdXRNZXNzYWdlICs9ICJUZWNobmljaWFuIGhhcyBub3Qgc2VsZWN0ZWQgdG8gY2hhbmdlIHRoZSBwYXNzd29yZCBhdCBuZXh0IGxvZ29uIGZvciB1c2VyICREb21haW5Vc2VySUQiCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAkT3V0cHV0TWVzc2FnZSArPSAiUGFzc3dvcmQgQ2hhbmdlZCIKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICRPdXRwdXRNZXNzYWdlICs9ICJBY2NvdW50IGlzIExvY2tlZCA6IiskQURVc2VyLkxvY2tlZE91dAogICAgICAgICAgICAgICAgJE91dHB1dE1lc3NhZ2UgKz0gIkFjY291bnQgaXMgRW5hYmxlZCA6ICIrJEFEVXNlci5FbmFibGVkCiAgICAgICAgICAgIH0KCiAgICAgICAgfQogICAgICAgIGVsc2UKICAgICAgICB7CiAgICAgICAgICAgIHRyeXsKICAgICAgICAgICAgICAgIDwjVXNlciBkb2VzIG5vdCBtYXRjaCAsIGdldCB0aGUgbGlzdCBvZiB1c2VyIGJhc2VkIG9uIGZpcnN0IDIgbGV0dGVycyAjPgogICAgICAgICAgICAgICAgJEFEdXNlciA9ICREb21haW5Vc2VySUQuU3Vic3RyaW5nKDAsMSkrIioiCiAgICAgICAgICAgICAgICAkQURVc2VyTGlzdFNpbWlsYXJUeXBlID0gR2V0LUFEVXNlciAtRmlsdGVyICduYW1lIC1saWtlICRBRHVzZXInIHwgc2VsZWN0IE5hbWUsIEVuYWJsZWQsIFVzZXJwcmluY2lwYWxOYW1lCiAgICAgICAgICAgICAgICAkT3V0cHV0TWVzc2FnZSArPSAkQURVc2VyTGlzdFNpbWlsYXJUeXBlCiAgICAgICAgICAgIH1jYXRjaHtXcml0ZS1FcnJvciAiVW5hYmxlIHRvIHB1bGwgdGhlIGxpc3Qgb2YgVXNlcnMgb2Ygc2ltaWxhciBOYW1lLiAgJF8uRXhjZXB0aW9uLm1lc3NhZ2UifQogICAgICAgIH0KICAgIH0KICAgIGVsc2UKICAgIHsKICAgICAgICB0cnl7CiAgICAgICAgICAgIDwjQ29sbGVjdCBMaXN0IG9mIERDIGluIGVudmlyb25tZW50Iz4KICAgICAgICAgICAgJENvbW1hbmQgPSAibmx0ZXN0IC9kY2xpc3Q6Iiskc3lzaW5mby5kb21haW4KICAgICAgICAgICAgJERDTGlzdCA9IEludm9rZS1leHByZXNzaW9uICRDb21tYW5kCiAgICAgICAgICAgICRPdXRwdXRNZXNzYWdlICs9ICJNYWNoaW5lIENvbm5lY3RlZCBpcyBub3QgREMuIFBsZWFzZSBjb25uZWN0IHRvIHRoZSBtZW50aW9uZWQgbGlzdCAuIgogICAgICAgICAgICAkT3V0cHV0TWVzc2FnZSArPSREQ0xpc3QKICAgICAgICB9Y2F0Y2h7IFdyaXRlLUVycm9yICJVbmFibGUgdG8gcHVsbCB0aGUgbGlzdCBvZiBEb21haW4gQ29udHJvbGxlcnMuICAkXy5FeGNlcHRpb24ubWVzc2FnZSJ9CiAgICB9Cgp9CldyaXRlLW91dHB1dCAkT3V0cHV0TWVzc2FnZXxGb3JtYXQtTGlzdAo=","jsonSchema":{"additionalProperties":false,"properties":{"ChangePassword":{"minLength":1,"title":"Password","type":"string"},"ChangePwdNextLogon":{"title":"Change password at next logon","type":"boolean"},"DomainUserID":{"minLength":1,"title":"User name","type":"string"}},"required":["DomainUserID","ChangePassword"],"type":"object"},"uiSchema":{"ChangePassword":{"classNames":"col-sm-6","ui:help":"Hint: Make it strong!","ui:widget":"password"},"ChangePwdNextLogon":{"classNames":"col-sm-6"},"DomainUserID":{"classNames":"col-sm-12","ui:autofocus":true},"ui:order":["DomainUserID","ChangePassword","ChangePwdNextLogon"]},"isHDScript":false}
