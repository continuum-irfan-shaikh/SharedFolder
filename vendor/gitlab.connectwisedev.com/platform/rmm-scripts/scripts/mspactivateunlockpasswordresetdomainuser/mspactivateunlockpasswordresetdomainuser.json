{"id":"828dea3b-9139-11e9-b4b8-00155d130b01","partnerId":"00000000-0000-0000-0000-000000000000","category":["Maintenance"],"description":"This script will reset the password of locked or disable domain user","engine":"powershell","engineMaxVersion":5,"expectedExecutionTimeSec":300,"failureMessage":"Executed with errors","successMessage":"Password Reset of Locked or disabled domain account Successful","internal":false,"name":"Password Reset for Domain Locked Or Disabled User","tags":["Windows 7","Windows 10"],"sequence":true,"content":"PCMKLlNZTk9QU0lTCkRldmVsb3BlZCBCeSA6IEdSVCBbSEQtQXV0b21hdGlvbl0gLCBDb250aW51dW0KRmlsZSBWZXNpb24gOiAyLjAKLkRFU0NSSVBUSU9OClRoZSBzY3JpcHQgaXMgZGVzaWduZWQgdG8gY2hhbmdlIHRoZSBwYXNzd29yZCBvZiBkb21haW4gdXNlciB3aG9zZSBhY2NvdW50IGlzIGxvY2tlZC9kaXNhYmxlZCBvciBib3RoIGFsc28gY2hhbmdlIGl0IHRvIEVuYWJsZSBhbmQgVW5sb2NrIGlmIGRvbWFpbiBVc2VyIGFjY291bnQgaXMgTG9ja2VkL0Rpc2FibGVkIG9yIGJvdGguCi5QQVJBTUVURVIKRG9tYWluVXNlcklEIGlzIHRvIHByb3ZpZGUgdGhlIERvbWFpbiBVc2VyIElEIC4KLlBBUkFNRVRFUgpDaGFuZ2VQYXNzd29yZCBpcyB0byBjaGFuZ2UgdGhlIHBhc3N3b3JkIC4KLlBBUkFNRVRFUgpDaGFuZ2VQd2ROZXh0TG9nb24gaXMgYm9vbGVhbiBmb3Igb3B0aW5nIGlmIHVzZXIgc2hvdWxkIGNoYW5nZSBpdHMgcGFzc3dvcmQgYXQgbmV4dCBsb2dvbi4gSWYgUGFzc3dvcmQgbmV2ZXIgZXhwaXJlcyBvciBVc2VyIGNhbid0IGNoYW5nZSBwYXNzd29yZCBpcyBvcHRlZCBpdCB3aWxsIG5vdCBjaGFuZ2UgdGhpcyBvcHRpb24uCiM+CgppZiAoJGVudjpQUk9DRVNTT1JfQVJDSElURVc2NDMyIC1lcSAiQU1ENjQiKSB7CiAgICB3cml0ZS13YXJuaW5nICJFeGNlY3V0aW5nIHRoZSBzY3JpcHQgdW5kZXIgNjQgYml0IHBvd2Vyc2hlbGwiCiAgICBpZiAoJG15SW52b2NhdGlvbi5MaW5lKSB7CiAgICAgICAgJiIkZW52OnN5c3RlbXJvb3Rcc3lzbmF0aXZlXHdpbmRvd3Nwb3dlcnNoZWxsXHYxLjBccG93ZXJzaGVsbC5leGUiIC1Ob25JbnRlcmFjdGl2ZSAtTm9Qcm9maWxlICRteUludm9jYXRpb24uTGluZQogICAgfWVsc2V7CiAgICAgICAgJiIkZW52OnN5c3RlbXJvb3Rcc3lzbmF0aXZlXHdpbmRvd3Nwb3dlcnNoZWxsXHYxLjBccG93ZXJzaGVsbC5leGUiIC1Ob25JbnRlcmFjdGl2ZSAtTm9Qcm9maWxlIC1maWxlICIkKCRteUludm9jYXRpb24uSW52b2NhdGlvbk5hbWUpIiAkYXJncwogICAgfQpleGl0ICRsYXN0ZXhpdGNvZGUKfQoKJE91dHB1dE1lc3NhZ2UgPSBAKCkgPCMgVmFyaWFibGUgdG8gY2FwdHVyZSBPdXRwdXQgZm9yIGRlYnVnZ2luZyBwdXJwb3NlLiM+CjwjIENvbXBhdGliaWxpdHkgQ2hlY2sgaWYgZm91bmQgaW5jb21wYXRpYmx0IHdpdGggZXhpdCM+CnRyeXsKICAgICRPU1ZlcnNpb249KFtzeXN0ZW0uZW52aXJvbm1lbnRdOjpPU1ZlcnNpb24uVmVyc2lvbikuTWFqb3IKICAgICRQU1ZlcnNpb24gPShHZXQtSG9zdCkudmVyc2lvbgogICAgaWYoKCRPU1ZlcnNpb24gLWx0IDYpIC1vciAoJFBTVmVyc2lvbi5NYWpvciAtbHQgMikpCiAgICB7CiAgICAgICAgV3JpdGUtT3V0cHV0ICs9ICJbTVNHIDogSW5jb21wYXRpYmxlIFN5c3RlbSBFaXRoZXIgT1MgaXMgYmVsb3cgd2luZG93cyA3LzIwMDhSMiBvciBwb3dlcnNoZWxsIHZlcnNpb24gbGVzcyB0aGFuIDIuMF0iCiAgICAgICAgRXhpdAogICAgfQp9Y2F0Y2h7IFdyaXRlLU91dHB1dCAiW01TRzogJF8uRXhjZXB0aW9uLm1lc3NhZ2VdIn0KPCMgQ29tcGF0aWJpbGl0eSBDaGVjayBFbmRzICM+CnRyeXsKICAgICRzeXNpbmZvID0gR2V0LVdtaU9iamVjdCAtQ2xhc3MgV2luMzJfQ29tcHV0ZXJTeXN0ZW0KICAgICROYW1lU3RhdHVzID0gICREb21haW5Vc2VySUQuQ29udGFpbnMoIkAiKQogICAgaWYoJE5hbWVTdGF0dXMgLWVxICRUcnVlKQogICAgewogICAgICAgICRQcm92aWRlZE5hbWUsJFByb3ZpZGVkRG9tYWluTmFtZSA9ICREb21haW5Vc2VySUQuc3BsaXQoJ0AnKQogICAgICAgIElmKCRQcm92aWRlZERvbWFpbk5hbWUgLWVxICRzeXNpbmZvLkRvbWFpbikKICAgICAgICB7CiAgICAgICAgICAgICREb21haW5Vc2VySUQgPSAkUHJvdmlkZWROYW1lCiAgICAgICAgfQogICAgICAgIGVsc2UKICAgICAgICB7CiAgICAgICAgICAgICRPdXRwdXRNZXNzYWdlICs9ICJbTVNHOiBEb21haW4gbmFtZSBtaXMtbWF0Y2ggXSIKICAgICAgICB9CiAgICB9Cn1jYXRjaHtXcml0ZS1FcnJvciAiJF8uRXhjZXB0aW9uLm1lc3NhZ2UifQo8IyBDaGVjayBpZiBtYWNoaW5lIGlzIGluIERvbWFpbiBvciBXb3JrZ3JvdXAgRW52aXJvbm1lbnQgIz4KaWYoJHN5c2luZm8uZG9tYWluIC1lcSAiV09SS0dST1VQIikKewogICAgJE91dHB1dE1lc3NhZ2UgKz0gIk1hY2hpbmUgQ29ubmVjdGVkIGlzIG5vdCBpbiBkb21haW4gZW52aXJvbm1lbnQuIgp9CmVsc2UKewogICAgPCMgSWYgJERDIGlzIGVxdWFsbCB0byA0KGJhY2t1cCBEQykgb3IgNShwcmltYXJ5IERDKSAjPgogICAgdHJ5ewogICAgICAgICREQyA9IChHZXQtV21pT2JqZWN0IFdpbjMyX0NvbXB1dGVyU3lzdGVtKS5kb21haW5yb2xlCiAgICB9Y2F0Y2h7IFdyaXRlLWVycm9yICIgVW5hYmxlIHRvIENoZWNrIGlmIG1hY2hpbmUgaXMgRG9tYWluIENvbnRyb2xsZXIgJF8uRXhjZXB0aW9uLm1lc3NhZ2UiIH0KICAgIGlmKCREQyAtZXEgIjQiIC1vciAkREMgLWVxICI1IiApCiAgICB7CiAgICAgICAgdHJ5ewogICAgICAgICAgICBJbXBvcnQtTW9kdWxlIEFjdGl2ZURpcmVjdG9yeSAtRXJyb3JBY3Rpb24gU3RvcAogICAgICAgICAgICAkT3V0cHV0TWVzc2FnZSArPSAiW01TRzogQUQgUG93ZXJzaGVsbCBNb2R1bGUgSW1wb3J0ZWRdICIKICAgICAgICB9Y2F0Y2h7IFdyaXRlLWVycm9yICJbTVNHOiBFeGNlcHRpb24gZW5jb3VudGVyZWQgd2hpbGUgSW1wb3J0aW5nIEFEIG1vZHVsZS5QbGVhc2UgQ29ubmVjdCB0byBPdGhlciBEb21haW4gQ29udHJvbGxlci4gXSAkXy5FeGNlcHRpb24ubWVzc2FnZSIgfQoKICAgICAgICB0cnl7ICAgJEFEdXNlcj0kbnVsbAogICAgICAgICRBRHVzZXIgPSAgR2V0LUFEVXNlciAkRG9tYWluVXNlcklEIC1wcm9wZXJ0aWVzICogLUVycm9yQWN0aW9uIFN0b3AKICAgICAgICB9Y2F0Y2ggW01pY3Jvc29mdC5BY3RpdmVEaXJlY3RvcnkuTWFuYWdlbWVudC5BRElkZW50aXR5Tm90Rm91bmRFeGNlcHRpb25dIHskT3V0cHV0TWVzc2FnZSArPSAiW01TRzogVXNlciBEb2Vzbm90IEV4aXN0XSBGQUlMRUQgIn0KICAgICAgICBjYXRjaCB7IHdyaXRlLWVycm9yICIkXy5FeGNlcHRpb24ubWVzc2FnZSIgfQoKICAgICAgICBJZigkQUR1c2VyKQogICAgICAgIHsKICAgICAgICAgICAgdHJ5ewogICAgICAgICAgICAgICAgaWYoJEFEVXNlci5FbmFibGVkIC1lcSAkRmFsc2UpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgRW5hYmxlLUFEQWNjb3VudCAtSWRlbnRpdHkgJERvbWFpblVzZXJJRAogICAgICAgICAgICAgICAgICAgICRPdXRwdXRNZXNzYWdlICs9ICJBY2NvdW50IEVuYWJsZWQiCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZigkQUR1c2VyLkxvY2tlZE91dCAtZXEgJFRydWUpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgVW5sb2NrLUFEQWNjb3VudCAtSWRlbnRpdHkgJERvbWFpblVzZXJJRAogICAgICAgICAgICAgICAgICAgICRPdXRwdXRNZXNzYWdlICs9ICJBY2NvdW50IFVubG9ja2VkIgogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgU2V0LWFkYWNjb3VudHBhc3N3b3JkICREb21haW5Vc2VySUQgLXJlc2V0IC1uZXdwYXNzd29yZCAoQ29udmVydFRvLVNlY3VyZVN0cmluZyAtQXNQbGFpblRleHQgJENoYW5nZVBhc3N3b3JkIC1Gb3JjZSkKICAgICAgICAgICAgICAgIGlmKCRDaGFuZ2VQd2ROZXh0TG9nb24gLWVxICR0cnVlKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGlmKCgkQURVc2VyLlBhc3N3b3JkTmV2ZXJFeHBpcmVzIC1lcSAkRmFsc2UpIC1BbmQgKCRBRFVzZXIuQ2Fubm90Q2hhbmdlUGFzc3dvcmQgLWVxICRGYWxzZSApKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgU2V0LUFEVXNlciAkRG9tYWluVXNlcklEIC1DaGFuZ2VQYXNzd29yZEF0TG9nb24gJHRydWUKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgJE91dHB1dE1lc3NhZ2UgKz0gIk1TRzogQ2hhbmdlUGFzc3dvcmRBdExvZ29uIGlzIG5vdCBjaGFuZ2VkIGZvciAkRG9tYWluVXNlcklEIGFzIHVzZXIgaXMgQ29uZmlndXJhdGlvbiBmb3IgOiIKICAgICAgICAgICAgICAgICAgICAgICAgJE91dHB1dE1lc3NhZ2UgKz0gIlBhc3N3b3JkIE5ldmVyIEV4cGlyZSA6ICIrJEFEVXNlci5QYXNzd29yZE5ldmVyRXhwaXJlcwogICAgICAgICAgICAgICAgICAgICAgICAkT3V0cHV0TWVzc2FnZSArPSAiQ2Fubm90Q2hhbmdlUGFzc3dvcmQgOiAiKyRBRFVzZXIuQ2Fubm90Q2hhbmdlUGFzc3dvcmQKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgJE91dHB1dE1lc3NhZ2UgKz0gIltNU0c6IENoYW5nZSBQYXNzd29yZCBhdCBuZXh0IGxvZ29uIGlzIG5vdCBzZWxlY3RlZCAgZm9yIHVzZXIgJERvbWFpblVzZXJJRF0gIgogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgJE91dHB1dE1lc3NhZ2UgKz0gIltNU0c6IFBhc3N3b3JkIGNoYW5nZWQgU3VjY2Vzc2Z1bF0iCiAgICAgICAgICAgIH1jYXRjaHsgV3JpdGUtRXJyb3IgIltNU0c6IEV4Y2VwdGlvbiBlbmNvdW50ZXJlZCB3aGlsZSByZXRyZWl2aW5nIFVzZXIgRGV0YWlscyBdICRfLkV4Y2VwdGlvbi5tZXNzYWdlIn0KICAgICAgICB9CiAgICAgICAgZWxzZQogICAgICAgIHsKICAgICAgICAgICAgdHJ5ewogICAgICAgICAgICAgICAgPCNVc2VyIGRvZXMgbm90IG1hdGNoICwgZ2V0IHRoZSBsaXN0IG9mIHVzZXIgYmFzZWQgb24gZmlyc3QgMiBsZXR0ZXJzICM+CiAgICAgICAgICAgICAgICAkT3V0cHV0TWVzc2FnZSArPSJCZWxvdyBhcmUgdGhlIGxpc3Qgb2Ygc2ltaWxhciB1c2VyIGluIGRvbWFpbiIKICAgICAgICAgICAgICAgICRBRHVzZXIgPSAkRG9tYWluVXNlcklELlN1YnN0cmluZygwLDEpKyIqIgogICAgICAgICAgICAgICAgJEFEVXNlckxpc3RTaW1pbGFyVHlwZSA9IEdldC1BRFVzZXIgLWZpbHRlciAnTmFtZSAtbGlrZSAkQUR1c2VyJyAtRXJyb3JBY3Rpb24gc3RvcCB8c2VsZWN0IE5hbWUsIFVzZXJQcmluY2lwYWxOYW1lLCBFbmFibGVkfGZ0CiAgICAgICAgICAgICAgICAkT3V0cHV0TWVzc2FnZSArPSAkQURVc2VyTGlzdFNpbWlsYXJUeXBlCiAgICAgICAgICAgIH1jYXRjaHtXcml0ZS1FcnJvciAiW01TRzogRXhjZXB0aW9uIGVuY291bnRlcmVkIHdoaWxlIHB1bGxpbmcgdGhlIHVzZXIgbGlzdF0gJF8uRXhjZXB0aW9uLm1lc3NhZ2UifQogICAgICAgIH0KICAgIH0KICAgIGVsc2UKICAgIHsKICAgICAgICB0cnl7CiAgICAgICAgICAgIDwjQ29sbGVjdCBMaXN0IG9mIERDIGluIGVudmlyb25tZW50Iz4KICAgICAgICAgICAgJENvbW1hbmQgPSAibmx0ZXN0IC9kY2xpc3Q6Iiskc3lzaW5mby5kb21haW4KICAgICAgICAgICAgJERDTGlzdCA9IEludm9rZS1leHByZXNzaW9uICRDb21tYW5kCiAgICAgICAgICAgICRPdXRwdXRNZXNzYWdlICs9ICJQbGVhc2UgY29ubmVjdCB0byBEb21haW4gQ29udHJvbGxlciBmb3IgZXhlY3V0aW5nIHRoZSBzY3JpcHQgZnJvbSBiZWxvdyBsaXN0IDoiCiAgICAgICAgICAgICRPdXRwdXRNZXNzYWdlICs9ICREQ0xpc3QKICAgICAgICB9Y2F0Y2h7IFdyaXRlLUVycm9yICJVbmFibGUgdG8gcHVsbCB0aGUgbGlzdCBvZiBEb21haW4gQ29udHJvbGxlcnMuICAkXy5FeGNlcHRpb24ubWVzc2FnZSJ9CiAgICB9Cn0KV3JpdGUtb3V0cHV0ICRPdXRwdXRNZXNzYWdlCg==","jsonSchema":{"additionalProperties":false,"properties":{"ChangePassword":{"minLength":1,"title":"Password","type":"string"},"ChangePwdNextLogon":{"title":"Change password at next logon","type":"boolean"},"DomainUserID":{"minLength":1,"title":"User name","type":"string"}},"required":["DomainUserID","ChangePassword"],"type":"object"},"uiSchema":{"ChangePassword":{"classNames":"col-sm-6","ui:help":"Hint: Make it strong!","ui:widget":"password"},"ChangePwdNextLogon":{"classNames":"col-sm-6"},"DomainUserID":{"classNames":"col-sm-12","ui:autofocus":true},"ui:order":["DomainUserID","ChangePassword","ChangePwdNextLogon"]},"isHDScript":false}
