{"id":"444e5ea2-4fed-11e9-bb98-00155d130b01","partnerId":"00000000-0000-0000-0000-000000000000","category":["Maintenance"],"description":"Backup windows event logs","engine":"powershell","engineMaxVersion":5,"expectedExecutionTimeSec":600,"failureMessage":"Executed with errors","successMessage":"Excecuted successfully","internal":false,"name":"Backup event log","tags":["Windows 7","Windows 10"],"sequence":true,"content":"PCMKTmFtZSA6IEJhY2t1cCBldmVudCBsb2csCkNhdGVnb3J5IDogTWFpbnRlbmFuY2UKCiRldmVudExvZ1R5cGUgPSAiRGVmYXVsdCIKJGV2ZW50TG9nID0gIkFwcGxpY2F0aW9uIgokbG9nRmlsZU5hbWUgPSAiQzpcdGVtcFxzYW5cc2FuMVxzYW4yXHNhbjNcc2FuNFxzYW41XHNhbjZcTmV3IgokbG9nRmlsZUV4dGVuc2lvbiA9ICIuZXZ0IgojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKJG92ZXJ3cml0ZUV4aXN0aW5nRmlsZSA9ICRGYWxzZQokY3JlYXRlRGlySWZSZXF1aXJlZCA9ICRUcnVlCiM+CgojIERlY2xhcmUgVmFyaWFibGVzCgppZiAoJGVudjpQUk9DRVNTT1JfQVJDSElURVc2NDMyIC1lcSAiQU1ENjQiKSB7CiAgICB3cml0ZS13YXJuaW5nICJFeGNlY3V0aW5nIHRoZSBzY3JpcHQgdW5kZXIgNjQgYml0IHBvd2Vyc2hlbGwiCiAgICBpZiAoJG15SW52b2NhdGlvbi5MaW5lKSB7CiAgICAgICAgJiIkZW52OnN5c3RlbXJvb3Rcc3lzbmF0aXZlXHdpbmRvd3Nwb3dlcnNoZWxsXHYxLjBccG93ZXJzaGVsbC5leGUiIC1Ob25JbnRlcmFjdGl2ZSAtTm9Qcm9maWxlICRteUludm9jYXRpb24uTGluZQogICAgfWVsc2V7CiAgICAgICAgJiIkZW52OnN5c3RlbXJvb3Rcc3lzbmF0aXZlXHdpbmRvd3Nwb3dlcnNoZWxsXHYxLjBccG93ZXJzaGVsbC5leGUiIC1Ob25JbnRlcmFjdGl2ZSAtTm9Qcm9maWxlIC1maWxlICIkKCRteUludm9jYXRpb24uSW52b2NhdGlvbk5hbWUpIiAkYXJncwogICAgfQpleGl0ICRsYXN0ZXhpdGNvZGUKfQoKCiMgVmFsaWRhdGlvbiBmb3IgTk9UIE5VTEwgb3IgZW1wdHkgZm9yIG1hbmRhdG9yeSBwYXJhbWF0ZXJzCgppZigoJGV2ZW50TG9nIC1lcSAkTlVMTCkgLW9yICgkZXZlbnRMb2cgLWVxICcnKSkKICB7CiAgICAgV3JpdGUtSG9zdCAiRXZlbnQgbG9nIGNhbiBub3QgYmUgZW1wdHkiICAKICAgICBFWElUCiAgfQogICAgCmlmKCgkbG9nRmlsZU5hbWUgLWVxICROVUxMKSAtb3IgKCRsb2dGaWxlTmFtZSAtZXEgJycpKQogIHsKICAgICBXcml0ZS1Ib3N0ICJMb2cgRmlsZSBOYW1lIGNhbiBub3QgYmUgZW1wdHkiICAKICAgICBFWElUCiAgfQoKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwojIEZ1bmN0aW9uIHRvIHN0b3JlIGJhY2t1cCBvZiB0aGUgRXZlbnQgTG9nCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKCgpGdW5jdGlvbiBDcmVhdGVfRGlyZWN0b3J5IHsKCiAgW0NtZGxldEJpbmRpbmcoQ29uZmlybUltcGFjdD0nTG93JyldIAogICAgUGFyYW0oCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnk9JHRydWUsCiAgICAgICAgICAgICAgICAgICBWYWx1ZUZyb21QaXBlTGluZT0kdHJ1ZSwKICAgICAgICAgICAgICAgICAgIFZhbHVlRnJvbVBpcGVMaW5lQnlQcm9wZXJ0eU5hbWU9JHRydWUsCiAgICAgICAgICAgICAgICAgICBQb3NpdGlvbj0wKV0KICAgICAgICAgICAgW1N0cmluZ10kRm9sZGVyTmFtZSwgCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnk9JGZhbHNlLAogICAgICAgICAgICAgICAgICAgUG9zaXRpb249MSldCiAgICAgICAgICAgIFtTd2l0Y2hdJE5vQ3JlYXRlID0gJGZhbHNlCiAgICApCgogICBpZiAoJEZvbGRlck5hbWUuTGVuZ3RoIC1ndCAyNTQpIHsKICAgICAgICBXcml0ZS1FcnJvciAiRm9sZGVyIG5hbWUgJyRGb2xkZXJOYW1lJyBpcyB0b28gbG9uZyAtICgkKCRGb2xkZXJOYW1lLkxlbmd0aCkpIGNoYXJhY3RlcnMiCiAgICAgICAgYnJlYWsKICAgIH0KICAgIGlmIChUZXN0LVBhdGggJEZvbGRlck5hbWUpIHsKICAgICAgICBXcml0ZS1WZXJib3NlICJDb25maXJtZWQgZm9sZGVyICckRm9sZGVyTmFtZScgZXhpc3RzIgogICAgICAgICMkdHJ1ZQogICAgfSBlbHNlIHsKICAgICAgICBXcml0ZS1WZXJib3NlICJGb2xkZXIgJyRGb2xkZXJOYW1lJyBkb2VzIG5vdCBleGlzdCIKICAgICAgICBpZiAoJE5vQ3JlYXRlKSB7CiAgICAgICAgICAgICRmYWxzZQogICAgICAgICAgICBicmVhayAgCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiQ3JlYXRpbmcgZm9sZGVyICckRm9sZGVyTmFtZSciCiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBOZXctSXRlbSAtUGF0aCAkRm9sZGVyTmFtZSAtSXRlbVR5cGUgZGlyZWN0b3J5IC1Gb3JjZSAtRXJyb3JBY3Rpb24gU3RvcCB8IE91dC1OdWxsCiAgICAgICAgICAgICAgICBXcml0ZS1WZXJib3NlICJTdWNjZXNzZnVsbHkgY3JlYXRlZCBmb2xkZXIgJyRGb2xkZXJOYW1lJyIKICAgICAgICAgICAgICAgICMkdHJ1ZQogICAgICAgICAgICB9IGNhdGNoIHsKICAgICAgICAgICAgICAgIFdyaXRlLUVycm9yICJGYWlsZWQgdG8gY3JlYXRlIGZvbGRlciAnJEZvbGRlck5hbWUnIgogICAgICAgICAgICAgICAgJGZhbHNlCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9Cn0KCgpGdW5jdGlvbiBCYWNrdXBFdmVudExvZygkZXZlbnRMb2csJGxvZ0ZpbGVOYW1lLCRsb2dGaWxlRXh0ZW5zaW9uLCRvdmVyd3JpdGVFeGlzdGluZ0ZpbGUsJGNyZWF0ZURpcklmUmVxdWlyZWQpCnsKClRyeQp7CiAgICAjZ2VuZXJhdGluZyBmaWxlIG5hbWUKICAgICRGaWxlTmFtZT0gJGxvZ0ZpbGVOYW1lKyRsb2dGaWxlRXh0ZW5zaW9uCgogICAgI2NoZWNrIHdoZXRoZXIgdGhlIGRpcmVjdG9yeS9maWxlIHBhdGggaXMgcHJlc2VudCBvciBub3QKICAgICNGb3IgRGlyZWN0b3J5CiAgICBpZighKFRlc3QtUGF0aCAoU3BsaXQtUGF0aCAtUGF0aCAkRmlsZU5hbWUpKSkKICAgIHsKICAgICAgV3JpdGUtSG9zdCAiRGlyZWN0b3J5IGlzIG5vdCBwcmVzZW50IgogICAgICBpZigkY3JlYXRlRGlySWZSZXF1aXJlZCAtZXEgJFRydWUpCiAgICAgIHsKICAgICAgICAkTGFzdCA9ICRGaWxlTmFtZS5TcGxpdCgnXCcpWy0xXQogICAgICAgICREYXRhID0gJEZpbGVOYW1lLlJlcGxhY2UoJExhc3QsIiIpCgogICAgICAgIENyZWF0ZV9EaXJlY3RvcnkgLUZvbGRlck5hbWUgJERhdGEKICAgICAgfQogICAgICBlbHNlCiAgICAgIHsKICAgICAgICAgV3JpdGUtSG9zdCAiVW5hYmxlIHRvIGNyZWF0ZSBkaXJlY3RvcnkgYXMgdXNlciBzZWxlY3RlZCAnTm8nIGZvciBjcmVhdGluZyBuZXcgZGlyZWN0b3J5IGlmIG5vdCBwcmVzZW50IgogICAgICAgICBFWElUCiAgICAgIH0KICAgIH0KICAgICNGb3IgRmlsZQogICAgaWYoVGVzdC1QYXRoICRGaWxlTmFtZSkKICAgIHsKICAgICAgIFdyaXRlLUhvc3QgIlVuYWJsZSB0byBjcmVhdGUgRmlsZXMgJGZpbGVuYW1lIGFzIHVzZXIgc2VsZWN0ZWQgJ05vJyBmb3IgT3ZlciBXcml0ZSBFeGlzdGluZyBGaWxlIgoKICAgIH1lbHNlewogICAgCiAgICAjYmFzZWQgb24gdGhlICBsb2cgZmlsZSBleHRlbnNpb24gY3JlYXRlIGxvZyBmaWxlCiAgICBpZigkbG9nRmlsZUV4dGVuc2lvbiAtZXEgIi50eHQiKQogICAgIHsKICAgICAgICBHZXQtRXZlbnRMb2cgLUxvZ05hbWUgJGV2ZW50TG9nIHxTZWxlY3QtT2JqZWN0IEV2ZW50SUQsTWFjaGluZU5hbWUsSW5kZXgsQ2F0ZWdvcnksQ2F0ZWdvcnlOdW1iZXIsRW50cnlUeXBlLCBgCiAgICAgICAgICAgICAgICAgICAgIE1lc3NhZ2UsU291cmNlLEluc3RhbmNlSWQsVGltZUdlbmVyYXRlZCxUaW1lV3JpdHRlbixVc2VyTmFtZSxTaXRlLENvbnRhaW5lcnwgYAogICAgICAgICAgICAgICAgICAgICBPdXQtRmlsZSAkRmlsZU5hbWUgLUZvcmNlCiAgICAgICAgJGhvc3QuVUkuV3JpdGVMaW5lKCJMb2cgZmlsZSBoYXMgYmVlbiBnZW5lcmF0ZWQgc3VjY2Vzc2Z1bGx5LCBGaWxlIE5hbWU6ICRGaWxlTmFtZSIpCiAgICAgfQogICAgZWxzZWlmKCAkbG9nRmlsZUV4dGVuc2lvbiAtZXEgIi5jc3YiKQogICAgewogICAgICAgIEdldC1FdmVudExvZyAtTG9nTmFtZSAkZXZlbnRMb2cgfFNlbGVjdC1PYmplY3QgRXZlbnRJRCxNYWNoaW5lTmFtZSxJbmRleCxDYXRlZ29yeSxDYXRlZ29yeU51bWJlcixFbnRyeVR5cGUsIGAKICAgICAgICAgICAgICAgICAgTWVzc2FnZSxTb3VyY2UsSW5zdGFuY2VJZCxUaW1lR2VuZXJhdGVkLFRpbWVXcml0dGVuLFVzZXJOYW1lLFNpdGUsQ29udGFpbmVyfCBgCiAgICAgICAgICAgICAgICAgIEV4cG9ydC1Dc3YgJEZpbGVOYW1lIC1Ob1R5cGVJbmZvcm1hdGlvbiAtTm9DbG9iYmVyIC1Gb3JjZQogICAgICAgICRob3N0LlVJLldyaXRlTGluZSgiTG9nIGZpbGUgaGFzIGJlZW4gZ2VuZXJhdGVkIHN1Y2Nlc3NmdWxseSwgRmlsZSBOYW1lOiAkRmlsZU5hbWUiKQogICAgfQoKICAgIGVsc2VpZiggJGxvZ0ZpbGVFeHRlbnNpb24gLWVxICIuZXZ0IikKICAgIHsKICAgICAgICAkbG9nRmlsZSA9IEdldC1XbWlPYmplY3QgV2luMzJfTlRFdmVudGxvZ0ZpbGUgfCBXaGVyZS1PYmplY3QgeyRfLmxvZ2ZpbGVuYW1lIC1lcSAkZXZlbnRMb2d9CiAgICAgICAgJGxvZ0ZpbGUuYmFja3VwZXZlbnRsb2coJEZpbGVOYW1lKSB8IE91dC1OdWxsCiAgICAgICAgJGhvc3QuVUkuV3JpdGVMaW5lKCJMb2cgZmlsZSBoYXMgYmVlbiBnZW5lcmF0ZWQgc3VjY2Vzc2Z1bGx5LCBGaWxlIE5hbWU6ICRGaWxlTmFtZSIpCiAgICB9CiAgICB9CgogfQogQ2F0Y2gKIHsKICRIb3N0LlVJLldyaXRlRXJyb3JMaW5lKCRFcnJvclswXS5FeGNlcHRpb24uTWVzc2FnZSkKIH0KfQojIyMjIyMjIyMjIEVuZCBGdW5jdGlvbiBCYWNrdXAgRXZlbnQgTG9nIAoKI0NhbGxpbmcgRnVuY3Rpb24KVHJ5CnsKCiAgIEJhY2t1cEV2ZW50TG9nIC1ldmVudExvZyAkZXZlbnRMb2cgLWxvZ0ZpbGVOYW1lICRsb2dGaWxlTmFtZSAtbG9nRmlsZUV4dGVuc2lvbiAkbG9nRmlsZUV4dGVuc2lvbiAtb3ZlcndyaXRlRXhpc3RpbmdGaWxlICRvdmVyd3JpdGVFeGlzdGluZ0ZpbGUgLWNyZWF0ZURpcklmUmVxdWlyZWQgJGNyZWF0ZURpcklmUmVxdWlyZWQKfQpDYXRjaHsKCiAkSG9zdC5VSS5Xcml0ZUVycm9yTGluZSgkRXJyb3JbMF0uRXhjZXB0aW9uLk1lc3NhZ2UpCn0K","jsonSchema":{"type":"object","properties":{"eventLogType":{"title":"Event Log Type","type":"string","enum":["default","userDefined"],"enumNames":["Default","User Defined"]},"logFileName":{"title":"Log file name","type":"string"},"logFileExtension":{"title":"Log file extension","type":"string","enum":[".evt",".evtx",".txt",".csv"],"enumNames":[".Evt",".Evtx",".txt",".csv"]},"overwriteExistingFile":{"title":"Overwrite Existing File","type":"boolean"},"createDirIfRequired":{"title":"Create directory if required","type":"boolean"}},"patternProperties":{"^eventLog$":{}},"additionalProperties":false,"required":["logFileName"],"dependencies":{"eventLogType":{"oneOf":[{"properties":{"eventLogType":{"enum":["default"]},"eventLog":{"title":"Event Log","type":"string","enum":["application","system","Security","Internet Explorer"]}}},{"properties":{"eventLogType":{"enum":["userDefined"]},"eventLog":{"title":"Event Log","type":"string"}}}]}}},"uiSchema":{"eventLogType":{"classNames":"col-sm=4 col-sm-offset-right-8","ui:autofocus":true,"ui:placeholder":"Select log"},"logFileName":{"classNames":"col-sm=6 col-sm-offset-right-6","ui:autofocus":true},"logFileExtension":{"classNames":"col-sm=3 col-sm-offset-right-9","ui:autofocus":true,"ui:placeholder":"Select ext."},"overwriteExistingFile":{"classNames":"col-sm=3","ui:autofocus":true},"createDirIfRequired":{"classNames":"col-sm=3 col-sm-offset-right-6","ui:autofocus":true},"eventLog":{"classNames":"col-sm=4 col-sm-offset-right-8","ui:autofocus":true,"ui:placeholder":"Select event log"},"ui:order":["eventLogType","eventLog","logFileName","logFileExtension","overwriteExistingFile","createDirIfRequired"]},"isHDScript":false}
