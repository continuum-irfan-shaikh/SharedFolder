{"id":"bc586a8f-4fea-11e9-950f-00155d130b01","partnerId":"00000000-0000-0000-0000-000000000000","category":["Data Collection"],"description":"Lists out the files from the specified folder","engine":"powershell","engineMaxVersion":5,"expectedExecutionTimeSec":300,"failureMessage":"Executed with errors","successMessage":"Excecuted successfully","internal":false,"name":"Retrieve files list","tags":["Windows 7","Windows 10"],"sequence":true,"content":"IyAkZmlsZU5hbWUgPSAnelNhYXpBY2Nlc3MuZXhlJwojICRmaWxlRGF0ZU9wdGlvbiA9ICdtb2RpZmllZGJlZm9yZScKIyAkZGF0ZSA9ICIyMDE5LTAzLTIwVDIxOjI3OjAwLjAwMFoiCiMgJGx0T1JndCA9ICdMZXNzdGhhbicKIyAkc2l6ZUluS0IgPSAyMDAKIyAkUmVhZE9ubHkgPSAkZmFsc2UKIyAkYXJjaGl2ZSA9ICRmYWxzZQojICRzeXN0ZW0gPSAkZmFsc2UKIyAkaGlkZGVuID0gJGZhbHNlCiMgJGVuY3J5cHRlZCA9ICRmYWxzZQojICRjb21wcmVzc2VkID0gJGZhbHNlCiMgJHJlY3Vyc2l2ZVNlYXJjaCA9ICR0cnVlCiMgJHNlYXJjaEluID0gJ3BhdGgnCiMgJHNlYXJjaFBhdGggPSAnQzpcUHJvZ3JhbSBGaWxlc1xTQUFaT0QnCgppZiAoJGVudjpQUk9DRVNTT1JfQVJDSElURVc2NDMyIC1lcSAiQU1ENjQiKSB7CiAgICBpZiAoJG15SW52b2NhdGlvbi5MaW5lKSB7CiAgICAgICAgJiIkZW52OnN5c3RlbXJvb3Rcc3lzbmF0aXZlXHdpbmRvd3Nwb3dlcnNoZWxsXHYxLjBccG93ZXJzaGVsbC5leGUiIC1Ob25JbnRlcmFjdGl2ZSAtTm9Qcm9maWxlICRteUludm9jYXRpb24uTGluZQogICAgfQogICAgZWxzZSB7CiAgICAgICAgJiIkZW52OnN5c3RlbXJvb3Rcc3lzbmF0aXZlXHdpbmRvd3Nwb3dlcnNoZWxsXHYxLjBccG93ZXJzaGVsbC5leGUiIC1Ob25JbnRlcmFjdGl2ZSAtTm9Qcm9maWxlIC1maWxlICIkKCRteUludm9jYXRpb24uSW52b2NhdGlvbk5hbWUpIiAkYXJncwogICAgfQogICAgZXhpdCAkbGFzdGV4aXRjb2RlCn0gIAogICAgCiRTdWJzdGl0dXRpb24gPSBAewogICAgJ0xlc3NUaGFuJyAgICAgICAgICAgPSAnJF8ubGVuZ3RoIC1sdCAkc2l6ZUluS0InCiAgICAnR3JlYXRlclRoYW4nICAgICAgICA9ICckXy5sZW5ndGggLWd0ICRzaXplSW5LQicKICAgICdNb2RpZmllZEJlZm9yZScgICAgID0gJyRfLkxhc3RXcml0ZVRpbWUgLWx0ICREYXRlJwogICAgJ01vZGlmaWVkQWZ0ZXInICAgICAgPSAnJF8uTGFzdFdyaXRlVGltZSAtZ3QgJERhdGUnCiAgICAnQ3JlYXRlZEJlZm9yZScgICAgICA9ICckXy5DcmVhdGlvblRpbWUgLWx0ICREYXRlJwogICAgJ0NyZWF0ZWRBZnRlcicgICAgICAgPSAnJF8uQ3JlYXRpb25UaW1lIC1ndCAkRGF0ZScKICAgICdMYXN0QWNjZXNzZWRCZWZvcmUnID0gJyRfLkxhc3RBY2Nlc3NUaW1lIC1sdCAkRGF0ZScKICAgICdMYXN0QWNjZXNzZWRBZnRlcicgID0gJyRfLkxhc3RBY2Nlc3NUaW1lIC1ndCAkRGF0ZScKfQp0cnkgewogICAgaWYoJGRhdGUpeyRkYXRlID0gW0RhdGV0aW1lXSRkYXRlfQogICAgIyBCdWlsZCBhdHRyaWJ1dGVzIGFycmF5CiAgICAkQXR0cmlidXRlcyA9IEAoKQogICAgaWYgKCRSZWFkT25seSkgeyRBdHRyaWJ1dGVzICs9ICdSZWFkT25seSd9CiAgICBpZiAoJEFyY2hpdmUpIHskQXR0cmlidXRlcyArPSAnQXJjaGl2ZSd9CiAgICBpZiAoJFN5c3RlbSkgeyRBdHRyaWJ1dGVzICs9ICdTeXN0ZW0nfQogICAgaWYgKCRIaWRkZW4pIHskQXR0cmlidXRlcyArPSAnSGlkZGVuJ30KICAgIGlmICgkRW5jcnlwdGVkKSB7JEF0dHJpYnV0ZXMgKz0gJ0VuY3J5cHRlZCd9CiAgICBpZiAoJENvbXByZXNzZWQpIHskQXR0cmlidXRlcyArPSAnQ29tcHJlc3NlZCd9CgogICAgIyBCdWlsZCB0aGUgJ0dldC1DaGlsZEl0ZW0nIENvbW1hbmQgYW5kIEZpbHRlciBhcyBwZXIgdGhlIHVzZXIgaW5wdXQKICAgICRTdHJpbmcgPSAnJwoKICAgIHN3aXRjaCAoJFNlYXJjaEluKSB7CiAgICAgICAgJ1BhdGgnIHsKICAgICAgICAgICAgaWYgKFRlc3QtUGF0aCAkc2VhcmNoUGF0aCkgeyRTdHJpbmcgPSAoIkdldC1DaGlsZEl0ZW0iLCAiYCckc2VhcmNoUGF0aGAnIiAtam9pbiAnICcpLnRyaW0oKX0KICAgICAgICAgICAgZWxzZSB7V3JpdGUtT3V0cHV0ICJgblBhdGggZG9lc24ndCBleGlzdDogJHNlYXJjaFBhdGgiOyBjb250aW51ZSB9CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgICAnQWxsTG9jYWxEcml2ZScgewogICAgICAgICAgICAkU3RyaW5nID0gKCJHZXQtQ2hpbGRJdGVtIiwgJCgoR2V0LVdtaU9iamVjdCB3aW4zMl9sb2dpY2FsZGlzayAtZmlsdGVyICJEcml2ZVR5cGUgPSAzInwgRm9yRWFjaC1PYmplY3QgeyAkXy5kZXZpY2VpZCwgJ1wnIC1qb2luICcnfSkgLWpvaW4gJywnKSAtam9pbiAnICcpLnRyaW0oKQogICAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICB9CgogICAgJFN0cmluZyA9ICRTdHJpbmcsICctRm9yY2UnIC1qb2luICcgJwogICAgaWYgKCRyZWN1cnNpdmVTZWFyY2gpIHsgJFN0cmluZyA9ICRTdHJpbmcsICItUmVjdXJzZSIgLWpvaW4gJyAnIH0KICAgICRTdHJpbmcgPSAkU3RyaW5nLCAiIHwgV2hlcmUtT2JqZWN0IHshYCRfLlBTSXNDb250YWluZXIgLWFuZCBgJF8ubmFtZSAtZXEgYCckRmlsZW5hbWVgJyIgLWpvaW4gJycKICAgIGlmICgkQXR0cmlidXRlcykgeyBGb3JFYWNoICgkYXR0cmlidXRlIGluICRBdHRyaWJ1dGVzKSB7ICRhdHRyaWJ1dGUgPSAkYXR0cmlidXRlIC1yZXBsYWNlICctJywgJyc7ICRTdHJpbmcgPSAkU3RyaW5nLCAiYCRfLmF0dHJpYnV0ZXMgLWxpa2UgJyokQXR0cmlidXRlKiciIC1qb2luICcgLWFuZCAnIH0gfQogICAgaWYgKCRmaWxlRGF0ZU9wdGlvbiAtYW5kICRkYXRlKSB7ICRTdHJpbmcgPSAkU3RyaW5nLCAkU3Vic3RpdHV0aW9uWyRmaWxlRGF0ZU9wdGlvbl0gLWpvaW4gJyAtYW5kICd9CiAgICBpZiAoJGx0T1JndCAtYW5kICRzaXplSW5LQikgeyRzaXplSW5LQj0kc2l6ZUluS0IqMWtiOyRTdHJpbmcgPSAkU3RyaW5nLCAkU3Vic3RpdHV0aW9uWyRsdE9SZ3RdIC1qb2luICcgLWFuZCAnfQogICAgJFN0cmluZyA9ICRTdHJpbmcsICd9JyAtam9pbiAnJwoKICAgICMgSW52b2tlIHRoZSBjb21tYW5kIHN0cmluZwogICAgJEVycm9yQWN0aW9uUHJlZmVyZW5jZSA9ICdTaWxlbnRseUNvbnRpbnVlJwogICAgJExpc3QgPSBJbnZva2UtRXhwcmVzc2lvbiAtQ29tbWFuZCAkU3RyaW5nIAogICAgaWYgKCRMaXN0KSB7IFdyaXRlLU91dHB1dCAiYG5MaXN0IG9mIEZpbGVzOmBuIjsgJExpc3QgfCBGb3JFYWNoLU9iamVjdCB7IFdyaXRlLU91dHB1dCAkXy5GdWxsbmFtZSB9IH0KICAgIGVsc2UgeyBXcml0ZS1PdXRwdXQgImBuTm8gZmlsZXMgZm91bmQgd2l0aCBzcGVjaWZpZWQgY3JpdGVyaWEuYG4iIH0KfQpjYXRjaCB7IFdyaXRlLUVycm9yICRfIH0K","jsonSchema":{"additionalProperties":false,"dependencies":{"fileDateOption":{"oneOf":[{"properties":{"date":{"format":"date-time","title":"Date","type":"string"},"fileDateOption":{"enum":["modifiedBefore","modifiedAfter","createdBefore","createdAfter","lastAccessedBefore","lastAccessedAfter"]}},"required":["date"]}]},"searchIn":{"oneOf":[{"properties":{"searchIn":{"enum":["path"]},"searchPath":{"title":"Search Path","type":"string"}},"required":["searchPath"]},{"properties":{"searchIn":{"enum":["allLocalDrive"]}}}]}},"patternProperties":{"^date$":{},"^searchPath$":{}},"properties":{"ReadOnly":{"title":"Read Only","type":"boolean"},"archive":{"title":"Archive","type":"boolean"},"compressed":{"title":"Compressed","type":"boolean"},"encrypted":{"title":"Encrypted","type":"boolean"},"fileDateOption":{"enum":["modifiedBefore","modifiedAfter","createdBefore","createdAfter","lastAccessedBefore","lastAccessedAfter"],"enumNames":["Modified Before","Modified After","Created Before","Created After","Last Accessed Before","Last Accessed After"],"title":"Date/Time Specification","type":"string"},"fileName":{"title":"File Name","type":"string"},"hidden":{"title":"Hidden","type":"boolean"},"ltORgt":{"enum":["lessthan","greaterthan"],"enumNames":["Less than","Greater than"],"title":"Size","type":"string"},"recursiveSearch":{"title":"Perfom a recursive search-include subfolders","type":"boolean"},"searchIn":{"enum":["allLocalDrive","path"],"enumNames":["All local drive","Path"],"title":"Search in:"},"sizeInKB":{"title":"Size in KB","type":"integer"},"system":{"title":"System","type":"boolean"}},"required":["fileName"],"type":"object"},"uiSchema":{"ReadOnly":{"classNames":"col-sm-2"},"archive":{"classNames":"col-sm-2"},"compressed":{"classNames":"col-sm-2"},"date":{"classNames":"col-sm-6","ui:autofocus":true},"encrypted":{"classNames":"col-sm-2"},"fileDateOption":{"classNames":"col-sm-6","ui:autofocus":true},"fileName":{"classNames":"col-sm-12","ui:autofocus":true},"hidden":{"classNames":"col-sm-2"},"ltORgt":{"classNames":"col-sm-3","ui:autofocus":true},"recursiveSearch":{"classNames":"col-sm-6"},"searchIn":{"classNames":"col-sm-3","ui:autofocus":true},"searchPath":{"classNames":"col-sm-9","ui:autofocus":true},"sizeInKB":{"classNames":"col-sm-3","ui:autofocus":true},"system":{"classNames":"col-sm-2"},"ui:order":["fileName","fileDateOption","date","ltORgt","sizeInKB","ReadOnly","archive","system","hidden","encrypted","compressed","searchIn","searchPath","recursiveSearch"]},"isHDScript":false}